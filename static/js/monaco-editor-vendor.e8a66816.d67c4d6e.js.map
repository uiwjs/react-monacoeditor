{"version":3,"file":"static/js/monaco-editor-vendor.e8a66816.d67c4d6e.js","mappings":"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","sources":["../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/commandsQuickAccess.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/editorNavigationQuickAccess.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoLineQuickAccess.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoSymbolQuickAccess.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/readOnlyMessage/browser/contribution.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/renameInputField.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/rename.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/browser/documentSemanticTokens.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/browser/viewportSemanticTokens.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/common/getSemanticTokens.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/common/semanticTokensConfig.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/bracketSelections.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/wordSelections.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/smartSelect.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetController2.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetParser.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetVariables.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetSession.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollElement.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollModelProvider.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollProvider.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollActions.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollContribution.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/completionModel.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggest.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordContextKey.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestAlternatives.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestCommitCharacters.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestModel.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestOvertypingCapturer.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetStatus.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetDetails.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetRenderer.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestInlineCompletions.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestMemory.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordDistance.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/symbolIcons/browser/symbolIcons.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { stripIcons } from '../../../../base/common/iconLabels.js';\nimport { AbstractCommandsQuickAccessProvider } from '../../../../platform/quickinput/browser/commandsQuickAccess.js';\nexport class AbstractEditorCommandsQuickAccessProvider extends AbstractCommandsQuickAccessProvider {\n    constructor(options, instantiationService, keybindingService, commandService, telemetryService, dialogService) {\n        super(options, instantiationService, keybindingService, commandService, telemetryService, dialogService);\n    }\n    getCodeEditorCommandPicks() {\n        const activeTextEditorControl = this.activeTextEditorControl;\n        if (!activeTextEditorControl) {\n            return [];\n        }\n        const editorCommandPicks = [];\n        for (const editorAction of activeTextEditorControl.getSupportedActions()) {\n            editorCommandPicks.push({\n                commandId: editorAction.id,\n                commandAlias: editorAction.alias,\n                label: stripIcons(editorAction.label) || editorAction.id,\n            });\n        }\n        return editorCommandPicks;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createSingleCallFunction } from '../../../../base/common/functional.js';\nimport { DisposableStore, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { getCodeEditor, isDiffEditor } from '../../../browser/editorBrowser.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { overviewRulerRangeHighlight } from '../../../common/core/editorColorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\n/**\n * A reusable quick access provider for the editor with support\n * for adding decorations for navigating in the currently active file\n * (for example \"Go to line\", \"Go to symbol\").\n */\nexport class AbstractEditorNavigationQuickAccessProvider {\n    constructor(options) {\n        this.options = options;\n        //#endregion\n        //#region Decorations Utils\n        this.rangeHighlightDecorationId = undefined;\n    }\n    //#region Provider methods\n    provide(picker, token) {\n        var _a;\n        const disposables = new DisposableStore();\n        // Apply options if any\n        picker.canAcceptInBackground = !!((_a = this.options) === null || _a === void 0 ? void 0 : _a.canAcceptInBackground);\n        // Disable filtering & sorting, we control the results\n        picker.matchOnLabel = picker.matchOnDescription = picker.matchOnDetail = picker.sortByLabel = false;\n        // Provide based on current active editor\n        const pickerDisposable = disposables.add(new MutableDisposable());\n        pickerDisposable.value = this.doProvide(picker, token);\n        // Re-create whenever the active editor changes\n        disposables.add(this.onDidActiveTextEditorControlChange(() => {\n            // Clear old\n            pickerDisposable.value = undefined;\n            // Add new\n            pickerDisposable.value = this.doProvide(picker, token);\n        }));\n        return disposables;\n    }\n    doProvide(picker, token) {\n        var _a;\n        const disposables = new DisposableStore();\n        // With text control\n        const editor = this.activeTextEditorControl;\n        if (editor && this.canProvideWithTextEditor(editor)) {\n            const context = { editor };\n            // Restore any view state if this picker was closed\n            // without actually going to a line\n            const codeEditor = getCodeEditor(editor);\n            if (codeEditor) {\n                // Remember view state and update it when the cursor position\n                // changes even later because it could be that the user has\n                // configured quick access to remain open when focus is lost and\n                // we always want to restore the current location.\n                let lastKnownEditorViewState = (_a = editor.saveViewState()) !== null && _a !== void 0 ? _a : undefined;\n                disposables.add(codeEditor.onDidChangeCursorPosition(() => {\n                    var _a;\n                    lastKnownEditorViewState = (_a = editor.saveViewState()) !== null && _a !== void 0 ? _a : undefined;\n                }));\n                context.restoreViewState = () => {\n                    if (lastKnownEditorViewState && editor === this.activeTextEditorControl) {\n                        editor.restoreViewState(lastKnownEditorViewState);\n                    }\n                };\n                disposables.add(createSingleCallFunction(token.onCancellationRequested)(() => { var _a; return (_a = context.restoreViewState) === null || _a === void 0 ? void 0 : _a.call(context); }));\n            }\n            // Clean up decorations on dispose\n            disposables.add(toDisposable(() => this.clearDecorations(editor)));\n            // Ask subclass for entries\n            disposables.add(this.provideWithTextEditor(context, picker, token));\n        }\n        // Without text control\n        else {\n            disposables.add(this.provideWithoutTextEditor(picker, token));\n        }\n        return disposables;\n    }\n    /**\n     * Subclasses to implement if they can operate on the text editor.\n     */\n    canProvideWithTextEditor(editor) {\n        return true;\n    }\n    gotoLocation({ editor }, options) {\n        editor.setSelection(options.range);\n        editor.revealRangeInCenter(options.range, 0 /* ScrollType.Smooth */);\n        if (!options.preserveFocus) {\n            editor.focus();\n        }\n        const model = editor.getModel();\n        if (model && 'getLineContent' in model) {\n            status(`${model.getLineContent(options.range.startLineNumber)}`);\n        }\n    }\n    getModel(editor) {\n        var _a;\n        return isDiffEditor(editor) ?\n            (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.modified :\n            editor.getModel();\n    }\n    addDecorations(editor, range) {\n        editor.changeDecorations(changeAccessor => {\n            // Reset old decorations if any\n            const deleteDecorations = [];\n            if (this.rangeHighlightDecorationId) {\n                deleteDecorations.push(this.rangeHighlightDecorationId.overviewRulerDecorationId);\n                deleteDecorations.push(this.rangeHighlightDecorationId.rangeHighlightId);\n                this.rangeHighlightDecorationId = undefined;\n            }\n            // Add new decorations for the range\n            const newDecorations = [\n                // highlight the entire line on the range\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight',\n                        className: 'rangeHighlight',\n                        isWholeLine: true\n                    }\n                },\n                // also add overview ruler highlight\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight-overview',\n                        overviewRuler: {\n                            color: themeColorFromId(overviewRulerRangeHighlight),\n                            position: OverviewRulerLane.Full\n                        }\n                    }\n                }\n            ];\n            const [rangeHighlightId, overviewRulerDecorationId] = changeAccessor.deltaDecorations(deleteDecorations, newDecorations);\n            this.rangeHighlightDecorationId = { rangeHighlightId, overviewRulerDecorationId };\n        });\n    }\n    clearDecorations(editor) {\n        const rangeHighlightDecorationId = this.rangeHighlightDecorationId;\n        if (rangeHighlightDecorationId) {\n            editor.changeDecorations(changeAccessor => {\n                changeAccessor.deltaDecorations([\n                    rangeHighlightDecorationId.overviewRulerDecorationId,\n                    rangeHighlightDecorationId.rangeHighlightId\n                ], []);\n            });\n            this.rangeHighlightDecorationId = undefined;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { getCodeEditor } from '../../../browser/editorBrowser.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nexport class AbstractGotoLineQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    constructor() {\n        super({ canAcceptInBackground: true });\n    }\n    provideWithoutTextEditor(picker) {\n        const label = localize('cannotRunGotoLine', \"Open a text editor first to go to a line.\");\n        picker.items = [{ label }];\n        picker.ariaLabel = label;\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token) {\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto line once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item) {\n                if (!this.isValidLineNumber(editor, item.lineNumber)) {\n                    return;\n                }\n                this.gotoLocation(context, { range: this.toRange(item.lineNumber, item.column), keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // React to picker changes\n        const updatePickerAndEditor = () => {\n            const position = this.parsePosition(editor, picker.value.trim().substr(AbstractGotoLineQuickAccessProvider.PREFIX.length));\n            const label = this.getPickLabel(editor, position.lineNumber, position.column);\n            // Picker\n            picker.items = [{\n                    lineNumber: position.lineNumber,\n                    column: position.column,\n                    label\n                }];\n            // ARIA Label\n            picker.ariaLabel = label;\n            // Clear decorations for invalid range\n            if (!this.isValidLineNumber(editor, position.lineNumber)) {\n                this.clearDecorations(editor);\n                return;\n            }\n            // Reveal\n            const range = this.toRange(position.lineNumber, position.column);\n            editor.revealRangeInCenter(range, 0 /* ScrollType.Smooth */);\n            // Decorate\n            this.addDecorations(editor, range);\n        };\n        updatePickerAndEditor();\n        disposables.add(picker.onDidChangeValue(() => updatePickerAndEditor()));\n        // Adjust line number visibility as needed\n        const codeEditor = getCodeEditor(editor);\n        if (codeEditor) {\n            const options = codeEditor.getOptions();\n            const lineNumbers = options.get(67 /* EditorOption.lineNumbers */);\n            if (lineNumbers.renderType === 2 /* RenderLineNumbersType.Relative */) {\n                codeEditor.updateOptions({ lineNumbers: 'on' });\n                disposables.add(toDisposable(() => codeEditor.updateOptions({ lineNumbers: 'relative' })));\n            }\n        }\n        return disposables;\n    }\n    toRange(lineNumber = 1, column = 1) {\n        return {\n            startLineNumber: lineNumber,\n            startColumn: column,\n            endLineNumber: lineNumber,\n            endColumn: column\n        };\n    }\n    parsePosition(editor, value) {\n        // Support line-col formats of `line,col`, `line:col`, `line#col`\n        const numbers = value.split(/,|:|#/).map(part => parseInt(part, 10)).filter(part => !isNaN(part));\n        const endLine = this.lineCount(editor) + 1;\n        return {\n            lineNumber: numbers[0] > 0 ? numbers[0] : endLine + numbers[0],\n            column: numbers[1]\n        };\n    }\n    getPickLabel(editor, lineNumber, column) {\n        // Location valid: indicate this as picker label\n        if (this.isValidLineNumber(editor, lineNumber)) {\n            if (this.isValidColumn(editor, lineNumber, column)) {\n                return localize('gotoLineColumnLabel', \"Go to line {0} and character {1}.\", lineNumber, column);\n            }\n            return localize('gotoLineLabel', \"Go to line {0}.\", lineNumber);\n        }\n        // Location invalid: show generic label\n        const position = editor.getPosition() || { lineNumber: 1, column: 1 };\n        const lineCount = this.lineCount(editor);\n        if (lineCount > 1) {\n            return localize('gotoLineLabelEmptyWithLimit', \"Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.\", position.lineNumber, position.column, lineCount);\n        }\n        return localize('gotoLineLabelEmpty', \"Current Line: {0}, Character: {1}. Type a line number to navigate to.\", position.lineNumber, position.column);\n    }\n    isValidLineNumber(editor, lineNumber) {\n        if (!lineNumber || typeof lineNumber !== 'number') {\n            return false;\n        }\n        return lineNumber > 0 && lineNumber <= this.lineCount(editor);\n    }\n    isValidColumn(editor, lineNumber, column) {\n        if (!column || typeof column !== 'number') {\n            return false;\n        }\n        const model = this.getModel(editor);\n        if (!model) {\n            return false;\n        }\n        const positionCandidate = { lineNumber, column };\n        return model.validatePosition(positionCandidate).equals(positionCandidate);\n    }\n    lineCount(editor) {\n        var _a, _b;\n        return (_b = (_a = this.getModel(editor)) === null || _a === void 0 ? void 0 : _a.getLineCount()) !== null && _b !== void 0 ? _b : 0;\n    }\n}\nAbstractGotoLineQuickAccessProvider.PREFIX = ':';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar AbstractGotoSymbolQuickAccessProvider_1;\nimport { DeferredPromise } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { pieceToQuery, prepareQuery, scoreFuzzy2 } from '../../../../base/common/fuzzyScorer.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { format, trim } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { SymbolKinds, getAriaLabelForSymbol } from '../../../common/languages.js';\nimport { IOutlineModelService } from '../../documentSymbols/browser/outlineModel.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { findLast } from '../../../../base/common/arraysFind.js';\nlet AbstractGotoSymbolQuickAccessProvider = AbstractGotoSymbolQuickAccessProvider_1 = class AbstractGotoSymbolQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    constructor(_languageFeaturesService, _outlineModelService, options = Object.create(null)) {\n        super(options);\n        this._languageFeaturesService = _languageFeaturesService;\n        this._outlineModelService = _outlineModelService;\n        this.options = options;\n        this.options.canAcceptInBackground = true;\n    }\n    provideWithoutTextEditor(picker) {\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutEditor', \"To go to a symbol, first open a text editor with symbol information.\"));\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token) {\n        const editor = context.editor;\n        const model = this.getModel(editor);\n        if (!model) {\n            return Disposable.None;\n        }\n        // Provide symbols from model if available in registry\n        if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n            return this.doProvideWithEditorSymbols(context, model, picker, token);\n        }\n        // Otherwise show an entry for a model without registry\n        // But give a chance to resolve the symbols at a later\n        // point if possible\n        return this.doProvideWithoutEditorSymbols(context, model, picker, token);\n    }\n    doProvideWithoutEditorSymbols(context, model, picker, token) {\n        const disposables = new DisposableStore();\n        // Generic pick for not having any symbol information\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutSymbolProvider', \"The active text editor does not provide symbol information.\"));\n        // Wait for changes to the registry and see if eventually\n        // we do get symbols. This can happen if the picker is opened\n        // very early after the model has loaded but before the\n        // language registry is ready.\n        // https://github.com/microsoft/vscode/issues/70607\n        (() => __awaiter(this, void 0, void 0, function* () {\n            const result = yield this.waitForLanguageSymbolRegistry(model, disposables);\n            if (!result || token.isCancellationRequested) {\n                return;\n            }\n            disposables.add(this.doProvideWithEditorSymbols(context, model, picker, token));\n        }))();\n        return disposables;\n    }\n    provideLabelPick(picker, label) {\n        picker.items = [{ label, index: 0, kind: 14 /* SymbolKind.String */ }];\n        picker.ariaLabel = label;\n    }\n    waitForLanguageSymbolRegistry(model, disposables) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n                return true;\n            }\n            const symbolProviderRegistryPromise = new DeferredPromise();\n            // Resolve promise when registry knows model\n            const symbolProviderListener = disposables.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => {\n                if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n                    symbolProviderListener.dispose();\n                    symbolProviderRegistryPromise.complete(true);\n                }\n            }));\n            // Resolve promise when we get disposed too\n            disposables.add(toDisposable(() => symbolProviderRegistryPromise.complete(false)));\n            return symbolProviderRegistryPromise.p;\n        });\n    }\n    doProvideWithEditorSymbols(context, model, picker, token) {\n        var _a;\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto symbol once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // Goto symbol side by side if enabled\n        disposables.add(picker.onDidTriggerItemButton(({ item }) => {\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, forceSideBySide: true });\n                picker.hide();\n            }\n        }));\n        // Resolve symbols from document once and reuse this\n        // request for all filtering and typing then on\n        const symbolsPromise = this.getDocumentSymbols(model, token);\n        // Set initial picks and update on type\n        let picksCts = undefined;\n        const updatePickerItems = (positionToEnclose) => __awaiter(this, void 0, void 0, function* () {\n            // Cancel any previous ask for picks and busy\n            picksCts === null || picksCts === void 0 ? void 0 : picksCts.dispose(true);\n            picker.busy = false;\n            // Create new cancellation source for this run\n            picksCts = new CancellationTokenSource(token);\n            // Collect symbol picks\n            picker.busy = true;\n            try {\n                const query = prepareQuery(picker.value.substr(AbstractGotoSymbolQuickAccessProvider_1.PREFIX.length).trim());\n                const items = yield this.doGetSymbolPicks(symbolsPromise, query, undefined, picksCts.token);\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                if (items.length > 0) {\n                    picker.items = items;\n                    if (positionToEnclose && query.original.length === 0) {\n                        const candidate = findLast(items, item => Boolean(item.type !== 'separator' && item.range && Range.containsPosition(item.range.decoration, positionToEnclose)));\n                        if (candidate) {\n                            picker.activeItems = [candidate];\n                        }\n                    }\n                }\n                else {\n                    if (query.original.length > 0) {\n                        this.provideLabelPick(picker, localize('noMatchingSymbolResults', \"No matching editor symbols\"));\n                    }\n                    else {\n                        this.provideLabelPick(picker, localize('noSymbolResults', \"No editor symbols\"));\n                    }\n                }\n            }\n            finally {\n                if (!token.isCancellationRequested) {\n                    picker.busy = false;\n                }\n            }\n        });\n        disposables.add(picker.onDidChangeValue(() => updatePickerItems(undefined)));\n        updatePickerItems((_a = editor.getSelection()) === null || _a === void 0 ? void 0 : _a.getPosition());\n        // Reveal and decorate when active item changes\n        disposables.add(picker.onDidChangeActive(() => {\n            const [item] = picker.activeItems;\n            if (item && item.range) {\n                // Reveal\n                editor.revealRangeInCenter(item.range.selection, 0 /* ScrollType.Smooth */);\n                // Decorate\n                this.addDecorations(editor, item.range.decoration);\n            }\n        }));\n        return disposables;\n    }\n    doGetSymbolPicks(symbolsPromise, query, options, token) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            const symbols = yield symbolsPromise;\n            if (token.isCancellationRequested) {\n                return [];\n            }\n            const filterBySymbolKind = query.original.indexOf(AbstractGotoSymbolQuickAccessProvider_1.SCOPE_PREFIX) === 0;\n            const filterPos = filterBySymbolKind ? 1 : 0;\n            // Split between symbol and container query\n            let symbolQuery;\n            let containerQuery;\n            if (query.values && query.values.length > 1) {\n                symbolQuery = pieceToQuery(query.values[0]); // symbol: only match on first part\n                containerQuery = pieceToQuery(query.values.slice(1)); // container: match on all but first parts\n            }\n            else {\n                symbolQuery = query;\n            }\n            // Convert to symbol picks and apply filtering\n            let buttons;\n            const openSideBySideDirection = (_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.openSideBySideDirection) === null || _b === void 0 ? void 0 : _b.call(_a);\n            if (openSideBySideDirection) {\n                buttons = [{\n                        iconClass: openSideBySideDirection === 'right' ? ThemeIcon.asClassName(Codicon.splitHorizontal) : ThemeIcon.asClassName(Codicon.splitVertical),\n                        tooltip: openSideBySideDirection === 'right' ? localize('openToSide', \"Open to the Side\") : localize('openToBottom', \"Open to the Bottom\")\n                    }];\n            }\n            const filteredSymbolPicks = [];\n            for (let index = 0; index < symbols.length; index++) {\n                const symbol = symbols[index];\n                const symbolLabel = trim(symbol.name);\n                const symbolLabelWithIcon = `$(${SymbolKinds.toIcon(symbol.kind).id}) ${symbolLabel}`;\n                const symbolLabelIconOffset = symbolLabelWithIcon.length - symbolLabel.length;\n                let containerLabel = symbol.containerName;\n                if (options === null || options === void 0 ? void 0 : options.extraContainerLabel) {\n                    if (containerLabel) {\n                        containerLabel = `${options.extraContainerLabel}  ${containerLabel}`;\n                    }\n                    else {\n                        containerLabel = options.extraContainerLabel;\n                    }\n                }\n                let symbolScore = undefined;\n                let symbolMatches = undefined;\n                let containerScore = undefined;\n                let containerMatches = undefined;\n                if (query.original.length > filterPos) {\n                    // First: try to score on the entire query, it is possible that\n                    // the symbol matches perfectly (e.g. searching for \"change log\"\n                    // can be a match on a markdown symbol \"change log\"). In that\n                    // case we want to skip the container query altogether.\n                    let skipContainerQuery = false;\n                    if (symbolQuery !== query) {\n                        [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, Object.assign(Object.assign({}, query), { values: undefined /* disable multi-query support */ }), filterPos, symbolLabelIconOffset);\n                        if (typeof symbolScore === 'number') {\n                            skipContainerQuery = true; // since we consumed the query, skip any container matching\n                        }\n                    }\n                    // Otherwise: score on the symbol query and match on the container later\n                    if (typeof symbolScore !== 'number') {\n                        [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, symbolQuery, filterPos, symbolLabelIconOffset);\n                        if (typeof symbolScore !== 'number') {\n                            continue;\n                        }\n                    }\n                    // Score by container if specified\n                    if (!skipContainerQuery && containerQuery) {\n                        if (containerLabel && containerQuery.original.length > 0) {\n                            [containerScore, containerMatches] = scoreFuzzy2(containerLabel, containerQuery);\n                        }\n                        if (typeof containerScore !== 'number') {\n                            continue;\n                        }\n                        if (typeof symbolScore === 'number') {\n                            symbolScore += containerScore; // boost symbolScore by containerScore\n                        }\n                    }\n                }\n                const deprecated = symbol.tags && symbol.tags.indexOf(1 /* SymbolTag.Deprecated */) >= 0;\n                filteredSymbolPicks.push({\n                    index,\n                    kind: symbol.kind,\n                    score: symbolScore,\n                    label: symbolLabelWithIcon,\n                    ariaLabel: getAriaLabelForSymbol(symbol.name, symbol.kind),\n                    description: containerLabel,\n                    highlights: deprecated ? undefined : {\n                        label: symbolMatches,\n                        description: containerMatches\n                    },\n                    range: {\n                        selection: Range.collapseToStart(symbol.selectionRange),\n                        decoration: symbol.range\n                    },\n                    strikethrough: deprecated,\n                    buttons\n                });\n            }\n            // Sort by score\n            const sortedFilteredSymbolPicks = filteredSymbolPicks.sort((symbolA, symbolB) => filterBySymbolKind ?\n                this.compareByKindAndScore(symbolA, symbolB) :\n                this.compareByScore(symbolA, symbolB));\n            // Add separator for types\n            // - @  only total number of symbols\n            // - @: grouped by symbol kind\n            let symbolPicks = [];\n            if (filterBySymbolKind) {\n                let lastSymbolKind = undefined;\n                let lastSeparator = undefined;\n                let lastSymbolKindCounter = 0;\n                function updateLastSeparatorLabel() {\n                    if (lastSeparator && typeof lastSymbolKind === 'number' && lastSymbolKindCounter > 0) {\n                        lastSeparator.label = format(NLS_SYMBOL_KIND_CACHE[lastSymbolKind] || FALLBACK_NLS_SYMBOL_KIND, lastSymbolKindCounter);\n                    }\n                }\n                for (const symbolPick of sortedFilteredSymbolPicks) {\n                    // Found new kind\n                    if (lastSymbolKind !== symbolPick.kind) {\n                        // Update last separator with number of symbols we found for kind\n                        updateLastSeparatorLabel();\n                        lastSymbolKind = symbolPick.kind;\n                        lastSymbolKindCounter = 1;\n                        // Add new separator for new kind\n                        lastSeparator = { type: 'separator' };\n                        symbolPicks.push(lastSeparator);\n                    }\n                    // Existing kind, keep counting\n                    else {\n                        lastSymbolKindCounter++;\n                    }\n                    // Add to final result\n                    symbolPicks.push(symbolPick);\n                }\n                // Update last separator with number of symbols we found for kind\n                updateLastSeparatorLabel();\n            }\n            else if (sortedFilteredSymbolPicks.length > 0) {\n                symbolPicks = [\n                    { label: localize('symbols', \"symbols ({0})\", filteredSymbolPicks.length), type: 'separator' },\n                    ...sortedFilteredSymbolPicks\n                ];\n            }\n            return symbolPicks;\n        });\n    }\n    compareByScore(symbolA, symbolB) {\n        if (typeof symbolA.score !== 'number' && typeof symbolB.score === 'number') {\n            return 1;\n        }\n        else if (typeof symbolA.score === 'number' && typeof symbolB.score !== 'number') {\n            return -1;\n        }\n        if (typeof symbolA.score === 'number' && typeof symbolB.score === 'number') {\n            if (symbolA.score > symbolB.score) {\n                return -1;\n            }\n            else if (symbolA.score < symbolB.score) {\n                return 1;\n            }\n        }\n        if (symbolA.index < symbolB.index) {\n            return -1;\n        }\n        else if (symbolA.index > symbolB.index) {\n            return 1;\n        }\n        return 0;\n    }\n    compareByKindAndScore(symbolA, symbolB) {\n        const kindA = NLS_SYMBOL_KIND_CACHE[symbolA.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        const kindB = NLS_SYMBOL_KIND_CACHE[symbolB.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        // Sort by type first if scoped search\n        const result = kindA.localeCompare(kindB);\n        if (result === 0) {\n            return this.compareByScore(symbolA, symbolB);\n        }\n        return result;\n    }\n    getDocumentSymbols(document, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = yield this._outlineModelService.getOrCreate(document, token);\n            return token.isCancellationRequested ? [] : model.asListOfDocumentSymbols();\n        });\n    }\n};\nAbstractGotoSymbolQuickAccessProvider.PREFIX = '@';\nAbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX = ':';\nAbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY = `${AbstractGotoSymbolQuickAccessProvider_1.PREFIX}${AbstractGotoSymbolQuickAccessProvider_1.SCOPE_PREFIX}`;\nAbstractGotoSymbolQuickAccessProvider = AbstractGotoSymbolQuickAccessProvider_1 = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IOutlineModelService)\n], AbstractGotoSymbolQuickAccessProvider);\nexport { AbstractGotoSymbolQuickAccessProvider };\n// #region NLS Helpers\nconst FALLBACK_NLS_SYMBOL_KIND = localize('property', \"properties ({0})\");\nconst NLS_SYMBOL_KIND_CACHE = {\n    [5 /* SymbolKind.Method */]: localize('method', \"methods ({0})\"),\n    [11 /* SymbolKind.Function */]: localize('function', \"functions ({0})\"),\n    [8 /* SymbolKind.Constructor */]: localize('_constructor', \"constructors ({0})\"),\n    [12 /* SymbolKind.Variable */]: localize('variable', \"variables ({0})\"),\n    [4 /* SymbolKind.Class */]: localize('class', \"classes ({0})\"),\n    [22 /* SymbolKind.Struct */]: localize('struct', \"structs ({0})\"),\n    [23 /* SymbolKind.Event */]: localize('event', \"events ({0})\"),\n    [24 /* SymbolKind.Operator */]: localize('operator', \"operators ({0})\"),\n    [10 /* SymbolKind.Interface */]: localize('interface', \"interfaces ({0})\"),\n    [2 /* SymbolKind.Namespace */]: localize('namespace', \"namespaces ({0})\"),\n    [3 /* SymbolKind.Package */]: localize('package', \"packages ({0})\"),\n    [25 /* SymbolKind.TypeParameter */]: localize('typeParameter', \"type parameters ({0})\"),\n    [1 /* SymbolKind.Module */]: localize('modules', \"modules ({0})\"),\n    [6 /* SymbolKind.Property */]: localize('property', \"properties ({0})\"),\n    [9 /* SymbolKind.Enum */]: localize('enum', \"enumerations ({0})\"),\n    [21 /* SymbolKind.EnumMember */]: localize('enumMember', \"enumeration members ({0})\"),\n    [14 /* SymbolKind.String */]: localize('string', \"strings ({0})\"),\n    [0 /* SymbolKind.File */]: localize('file', \"files ({0})\"),\n    [17 /* SymbolKind.Array */]: localize('array', \"arrays ({0})\"),\n    [15 /* SymbolKind.Number */]: localize('number', \"numbers ({0})\"),\n    [16 /* SymbolKind.Boolean */]: localize('boolean', \"booleans ({0})\"),\n    [18 /* SymbolKind.Object */]: localize('object', \"objects ({0})\"),\n    [19 /* SymbolKind.Key */]: localize('key', \"keys ({0})\"),\n    [7 /* SymbolKind.Field */]: localize('field', \"fields ({0})\"),\n    [13 /* SymbolKind.Constant */]: localize('constant', \"constants ({0})\")\n};\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nexport class ReadOnlyMessageController extends Disposable {\n    constructor(editor) {\n        super();\n        this.editor = editor;\n        this._register(this.editor.onDidAttemptReadOnlyEdit(() => this._onDidAttemptReadOnlyEdit()));\n    }\n    _onDidAttemptReadOnlyEdit() {\n        const messageController = MessageController.get(this.editor);\n        if (messageController && this.editor.hasModel()) {\n            let message = this.editor.getOptions().get(91 /* EditorOption.readOnlyMessage */);\n            if (!message) {\n                if (this.editor.isSimpleWidget) {\n                    message = new MarkdownString(nls.localize('editor.simple.readonly', \"Cannot edit in read-only input\"));\n                }\n                else {\n                    message = new MarkdownString(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"));\n                }\n            }\n            messageController.showMessage(message, this.editor.getPosition());\n        }\n    }\n}\nReadOnlyMessageController.ID = 'editor.contrib.readOnlyMessageController';\nregisterEditorContribution(ReadOnlyMessageController.ID, ReadOnlyMessageController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport './renameInputField.css';\nimport { Position } from '../../../common/core/position.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { editorWidgetBackground, inputBackground, inputBorder, inputForeground, widgetBorder, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false, localize('renameInputVisible', \"Whether the rename input widget is visible\"));\nlet RenameInputField = class RenameInputField {\n    constructor(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService) {\n        this._editor = _editor;\n        this._acceptKeybindings = _acceptKeybindings;\n        this._themeService = _themeService;\n        this._keybindingService = _keybindingService;\n        this._disposables = new DisposableStore();\n        this.allowEditorOverflow = true;\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._editor.addContentWidget(this);\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return '__renameInputWidget';\n    }\n    getDomNode() {\n        if (!this._domNode) {\n            this._domNode = document.createElement('div');\n            this._domNode.className = 'monaco-editor rename-box';\n            this._input = document.createElement('input');\n            this._input.className = 'rename-input';\n            this._input.type = 'text';\n            this._input.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n            this._domNode.appendChild(this._input);\n            this._label = document.createElement('div');\n            this._label.className = 'rename-label';\n            this._domNode.appendChild(this._label);\n            this._updateFont();\n            this._updateStyles(this._themeService.getColorTheme());\n        }\n        return this._domNode;\n    }\n    _updateStyles(theme) {\n        var _a, _b, _c, _d;\n        if (!this._input || !this._domNode) {\n            return;\n        }\n        const widgetShadowColor = theme.getColor(widgetShadow);\n        const widgetBorderColor = theme.getColor(widgetBorder);\n        this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\n        this._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\n        this._domNode.style.border = widgetBorderColor ? `1px solid ${widgetBorderColor}` : '';\n        this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\n        this._input.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\n        // this._input.style.color = String(theme.getColor(inputForeground) ?? '');\n        const border = theme.getColor(inputBorder);\n        this._input.style.borderWidth = border ? '1px' : '0px';\n        this._input.style.borderStyle = border ? 'solid' : 'none';\n        this._input.style.borderColor = (_d = border === null || border === void 0 ? void 0 : border.toString()) !== null && _d !== void 0 ? _d : 'none';\n    }\n    _updateFont() {\n        if (!this._input || !this._label) {\n            return;\n        }\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._input.style.fontFamily = fontInfo.fontFamily;\n        this._input.style.fontWeight = fontInfo.fontWeight;\n        this._input.style.fontSize = `${fontInfo.fontSize}px`;\n        this._label.style.fontSize = `${fontInfo.fontSize * 0.8}px`;\n    }\n    getPosition() {\n        if (!this._visible) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    beforeRender() {\n        var _a, _b;\n        const [accept, preview] = this._acceptKeybindings;\n        this._label.innerText = localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"'] }, \"{0} to Rename, {1} to Preview\", (_a = this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\n        return null;\n    }\n    afterRender(position) {\n        if (!position) {\n            // cancel rename when input widget isn't rendered anymore\n            this.cancelInput(true);\n        }\n    }\n    acceptInput(wantsPreview) {\n        var _a;\n        (_a = this._currentAcceptInput) === null || _a === void 0 ? void 0 : _a.call(this, wantsPreview);\n    }\n    cancelInput(focusEditor) {\n        var _a;\n        (_a = this._currentCancelInput) === null || _a === void 0 ? void 0 : _a.call(this, focusEditor);\n    }\n    getInput(where, value, selectionStart, selectionEnd, supportPreview, token) {\n        this._domNode.classList.toggle('preview', supportPreview);\n        this._position = new Position(where.startLineNumber, where.startColumn);\n        this._input.value = value;\n        this._input.setAttribute('selectionStart', selectionStart.toString());\n        this._input.setAttribute('selectionEnd', selectionEnd.toString());\n        this._input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\n        const disposeOnDone = new DisposableStore();\n        return new Promise(resolve => {\n            this._currentCancelInput = (focusEditor) => {\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                resolve(focusEditor);\n                return true;\n            };\n            this._currentAcceptInput = (wantsPreview) => {\n                if (this._input.value.trim().length === 0 || this._input.value === value) {\n                    // empty or whitespace only or not changed\n                    this.cancelInput(true);\n                    return;\n                }\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                resolve({\n                    newName: this._input.value,\n                    wantsPreview: supportPreview && wantsPreview\n                });\n            };\n            disposeOnDone.add(token.onCancellationRequested(() => this.cancelInput(true)));\n            disposeOnDone.add(this._editor.onDidBlurEditorWidget(() => { var _a; return this.cancelInput(!((_a = this._domNode) === null || _a === void 0 ? void 0 : _a.ownerDocument.hasFocus())); }));\n            this._show();\n        }).finally(() => {\n            disposeOnDone.dispose();\n            this._hide();\n        });\n    }\n    _show() {\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* ScrollType.Smooth */);\n        this._visible = true;\n        this._visibleContextKey.set(true);\n        this._editor.layoutContentWidget(this);\n        setTimeout(() => {\n            this._input.focus();\n            this._input.setSelectionRange(parseInt(this._input.getAttribute('selectionStart')), parseInt(this._input.getAttribute('selectionEnd')));\n        }, 100);\n    }\n    _hide() {\n        this._visible = false;\n        this._visibleContextKey.reset();\n        this._editor.layoutContentWidget(this);\n    }\n};\nRenameInputField = __decorate([\n    __param(2, IThemeService),\n    __param(3, IKeybindingService),\n    __param(4, IContextKeyService)\n], RenameInputField);\nexport { RenameInputField };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar RenameController_1;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ITextResourceConfigurationService } from '../../../common/services/textResourceConfiguration.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { CONTEXT_RENAME_INPUT_VISIBLE, RenameInputField } from './renameInputField.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nclass RenameSkeleton {\n    constructor(model, position, registry) {\n        this.model = model;\n        this.position = position;\n        this._providerRenameIdx = 0;\n        this._providers = registry.ordered(model);\n    }\n    hasProvider() {\n        return this._providers.length > 0;\n    }\n    resolveRenameLocation(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const rejects = [];\n            for (this._providerRenameIdx = 0; this._providerRenameIdx < this._providers.length; this._providerRenameIdx++) {\n                const provider = this._providers[this._providerRenameIdx];\n                if (!provider.resolveRenameLocation) {\n                    break;\n                }\n                const res = yield provider.resolveRenameLocation(this.model, this.position, token);\n                if (!res) {\n                    continue;\n                }\n                if (res.rejectReason) {\n                    rejects.push(res.rejectReason);\n                    continue;\n                }\n                return res;\n            }\n            const word = this.model.getWordAtPosition(this.position);\n            if (!word) {\n                return {\n                    range: Range.fromPositions(this.position),\n                    text: '',\n                    rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n                };\n            }\n            return {\n                range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\n                text: word.word,\n                rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n            };\n        });\n    }\n    provideRenameEdits(newName, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this._provideRenameEdits(newName, this._providerRenameIdx, [], token);\n        });\n    }\n    _provideRenameEdits(newName, i, rejects, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const provider = this._providers[i];\n            if (!provider) {\n                return {\n                    edits: [],\n                    rejectReason: rejects.join('\\n')\n                };\n            }\n            const result = yield provider.provideRenameEdits(this.model, this.position, newName, token);\n            if (!result) {\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token);\n            }\n            else if (result.rejectReason) {\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token);\n            }\n            return result;\n        });\n    }\n}\nexport function rename(registry, model, position, newName) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const skeleton = new RenameSkeleton(model, position, registry);\n        const loc = yield skeleton.resolveRenameLocation(CancellationToken.None);\n        if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n            return { edits: [], rejectReason: loc.rejectReason };\n        }\n        return skeleton.provideRenameEdits(newName, CancellationToken.None);\n    });\n}\n// ---  register actions and commands\nlet RenameController = RenameController_1 = class RenameController {\n    static get(editor) {\n        return editor.getContribution(RenameController_1.ID);\n    }\n    constructor(editor, _instaService, _notificationService, _bulkEditService, _progressService, _logService, _configService, _languageFeaturesService) {\n        this.editor = editor;\n        this._instaService = _instaService;\n        this._notificationService = _notificationService;\n        this._bulkEditService = _bulkEditService;\n        this._progressService = _progressService;\n        this._logService = _logService;\n        this._configService = _configService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._disposableStore = new DisposableStore();\n        this._cts = new CancellationTokenSource();\n        this._renameInputField = this._disposableStore.add(this._instaService.createInstance(RenameInputField, this.editor, ['acceptRenameInput', 'acceptRenameInputWithPreview']));\n    }\n    dispose() {\n        this._disposableStore.dispose();\n        this._cts.dispose(true);\n    }\n    run() {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            // set up cancellation token to prevent reentrant rename, this\n            // is the parent to the resolve- and rename-tokens\n            this._cts.dispose(true);\n            this._cts = new CancellationTokenSource();\n            if (!this.editor.hasModel()) {\n                return undefined;\n            }\n            const position = this.editor.getPosition();\n            const skeleton = new RenameSkeleton(this.editor.getModel(), position, this._languageFeaturesService.renameProvider);\n            if (!skeleton.hasProvider()) {\n                return undefined;\n            }\n            // part 1 - resolve rename location\n            const cts1 = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, undefined, this._cts.token);\n            let loc;\n            try {\n                const resolveLocationOperation = skeleton.resolveRenameLocation(cts1.token);\n                this._progressService.showWhile(resolveLocationOperation, 250);\n                loc = yield resolveLocationOperation;\n            }\n            catch (e) {\n                (_a = MessageController.get(this.editor)) === null || _a === void 0 ? void 0 : _a.showMessage(e || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\n                return undefined;\n            }\n            finally {\n                cts1.dispose();\n            }\n            if (!loc) {\n                return undefined;\n            }\n            if (loc.rejectReason) {\n                (_b = MessageController.get(this.editor)) === null || _b === void 0 ? void 0 : _b.showMessage(loc.rejectReason, position);\n                return undefined;\n            }\n            if (cts1.token.isCancellationRequested) {\n                return undefined;\n            }\n            // part 2 - do rename at location\n            const cts2 = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, loc.range, this._cts.token);\n            const selection = this.editor.getSelection();\n            let selectionStart = 0;\n            let selectionEnd = loc.text.length;\n            if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(loc.range, selection)) {\n                selectionStart = Math.max(0, selection.startColumn - loc.range.startColumn);\n                selectionEnd = Math.min(loc.range.endColumn, selection.endColumn) - loc.range.startColumn;\n            }\n            const supportPreview = this._bulkEditService.hasPreviewHandler() && this._configService.getValue(this.editor.getModel().uri, 'editor.rename.enablePreview');\n            const inputFieldResult = yield this._renameInputField.getInput(loc.range, loc.text, selectionStart, selectionEnd, supportPreview, cts2.token);\n            // no result, only hint to focus the editor or not\n            if (typeof inputFieldResult === 'boolean') {\n                if (inputFieldResult) {\n                    this.editor.focus();\n                }\n                cts2.dispose();\n                return undefined;\n            }\n            this.editor.focus();\n            const renameOperation = raceCancellation(skeleton.provideRenameEdits(inputFieldResult.newName, cts2.token), cts2.token).then((renameResult) => __awaiter(this, void 0, void 0, function* () {\n                if (!renameResult || !this.editor.hasModel()) {\n                    return;\n                }\n                if (renameResult.rejectReason) {\n                    this._notificationService.info(renameResult.rejectReason);\n                    return;\n                }\n                // collapse selection to active end\n                this.editor.setSelection(Range.fromPositions(this.editor.getSelection().getPosition()));\n                this._bulkEditService.apply(renameResult, {\n                    editor: this.editor,\n                    showPreview: inputFieldResult.wantsPreview,\n                    label: nls.localize('label', \"Renaming '{0}' to '{1}'\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                    code: 'undoredo.rename',\n                    quotableLabel: nls.localize('quotableLabel', \"Renaming {0} to {1}\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                    respectAutoSaveConfig: true\n                }).then(result => {\n                    if (result.ariaSummary) {\n                        alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, inputFieldResult.newName, result.ariaSummary));\n                    }\n                }).catch(err => {\n                    this._notificationService.error(nls.localize('rename.failedApply', \"Rename failed to apply edits\"));\n                    this._logService.error(err);\n                });\n            }), err => {\n                this._notificationService.error(nls.localize('rename.failed', \"Rename failed to compute edits\"));\n                this._logService.error(err);\n            }).finally(() => {\n                cts2.dispose();\n            });\n            this._progressService.showWhile(renameOperation, 250);\n            return renameOperation;\n        });\n    }\n    acceptRenameInput(wantsPreview) {\n        this._renameInputField.acceptInput(wantsPreview);\n    }\n    cancelRenameInput() {\n        this._renameInputField.cancelInput(true);\n    }\n};\nRenameController.ID = 'editor.contrib.renameController';\nRenameController = RenameController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, INotificationService),\n    __param(3, IBulkEditService),\n    __param(4, IEditorProgressService),\n    __param(5, ILogService),\n    __param(6, ITextResourceConfigurationService),\n    __param(7, ILanguageFeaturesService)\n], RenameController);\n// ---- action implementation\nexport class RenameAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.rename',\n            label: nls.localize('rename.label', \"Rename Symbol\"),\n            alias: 'Rename Symbol',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.1\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(accessor, editor) {\n        const controller = RenameController.get(editor);\n        if (controller) {\n            return controller.run();\n        }\n        return Promise.resolve();\n    }\n}\nregisterEditorContribution(RenameController.ID, RenameController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(RenameAction);\nconst RenameCommand = EditorCommand.bindToContribution(RenameController.get);\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.acceptRenameInput(false),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInputWithPreview',\n    precondition: ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE, ContextKeyExpr.has('config.editor.rename.enablePreview')),\n    handler: x => x.acceptRenameInput(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 1024 /* KeyMod.Shift */ + 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'cancelRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.cancelRenameInput(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n// ---- api bridge command\nregisterModelAndPositionCommand('_executeDocumentRenameProvider', function (accessor, model, position, ...args) {\n    const [newName] = args;\n    assertType(typeof newName === 'string');\n    const { renameProvider } = accessor.get(ILanguageFeaturesService);\n    return rename(renameProvider, model, position, newName);\n});\nregisterModelAndPositionCommand('_executePrepareRename', function (accessor, model, position) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const { renameProvider } = accessor.get(ILanguageFeaturesService);\n        const skeleton = new RenameSkeleton(model, position, renameProvider);\n        const loc = yield skeleton.resolveRenameLocation(CancellationToken.None);\n        if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n            throw new Error(loc.rejectReason);\n        }\n        return loc;\n    });\n});\n//todo@jrieken use editor options world\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    id: 'editor',\n    properties: {\n        'editor.rename.enablePreview': {\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('enablePreview', \"Enable/disable the ability to preview changes before renaming\"),\n            default: true,\n            type: 'boolean'\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ModelSemanticColoring_1;\nimport { Disposable, dispose } from '../../../../base/common/lifecycle.js';\nimport * as errors from '../../../../base/common/errors.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { toMultilineTokens2 } from '../../../common/services/semanticTokensProviderStyling.js';\nimport { getDocumentSemanticTokens, hasDocumentSemanticTokensProvider, isSemanticTokens, isSemanticTokensEdits } from '../common/getSemanticTokens.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ISemanticTokensStylingService } from '../../../common/services/semanticTokensStyling.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { SEMANTIC_HIGHLIGHTING_SETTING_ID, isSemanticColoringEnabled } from '../common/semanticTokensConfig.js';\nlet DocumentSemanticTokensFeature = class DocumentSemanticTokensFeature extends Disposable {\n    constructor(semanticTokensStylingService, modelService, themeService, configurationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._watchers = Object.create(null);\n        const register = (model) => {\n            this._watchers[model.uri.toString()] = new ModelSemanticColoring(model, semanticTokensStylingService, themeService, languageFeatureDebounceService, languageFeaturesService);\n        };\n        const deregister = (model, modelSemanticColoring) => {\n            modelSemanticColoring.dispose();\n            delete this._watchers[model.uri.toString()];\n        };\n        const handleSettingOrThemeChange = () => {\n            for (const model of modelService.getModels()) {\n                const curr = this._watchers[model.uri.toString()];\n                if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                    if (!curr) {\n                        register(model);\n                    }\n                }\n                else {\n                    if (curr) {\n                        deregister(model, curr);\n                    }\n                }\n            }\n        };\n        this._register(modelService.onModelAdded((model) => {\n            if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                register(model);\n            }\n        }));\n        this._register(modelService.onModelRemoved((model) => {\n            const curr = this._watchers[model.uri.toString()];\n            if (curr) {\n                deregister(model, curr);\n            }\n        }));\n        this._register(configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\n                handleSettingOrThemeChange();\n            }\n        }));\n        this._register(themeService.onDidColorThemeChange(handleSettingOrThemeChange));\n    }\n    dispose() {\n        // Dispose all watchers\n        for (const watcher of Object.values(this._watchers)) {\n            watcher.dispose();\n        }\n        super.dispose();\n    }\n};\nDocumentSemanticTokensFeature = __decorate([\n    __param(0, ISemanticTokensStylingService),\n    __param(1, IModelService),\n    __param(2, IThemeService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], DocumentSemanticTokensFeature);\nexport { DocumentSemanticTokensFeature };\nlet ModelSemanticColoring = ModelSemanticColoring_1 = class ModelSemanticColoring extends Disposable {\n    constructor(model, _semanticTokensStylingService, themeService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._semanticTokensStylingService = _semanticTokensStylingService;\n        this._isDisposed = false;\n        this._model = model;\n        this._provider = languageFeaturesService.documentSemanticTokensProvider;\n        this._debounceInformation = languageFeatureDebounceService.for(this._provider, 'DocumentSemanticTokens', { min: ModelSemanticColoring_1.REQUEST_MIN_DELAY, max: ModelSemanticColoring_1.REQUEST_MAX_DELAY });\n        this._fetchDocumentSemanticTokens = this._register(new RunOnceScheduler(() => this._fetchDocumentSemanticTokensNow(), ModelSemanticColoring_1.REQUEST_MIN_DELAY));\n        this._currentDocumentResponse = null;\n        this._currentDocumentRequestCancellationTokenSource = null;\n        this._documentProvidersChangeListeners = [];\n        this._providersChangedDuringRequest = false;\n        this._register(this._model.onDidChangeContent(() => {\n            if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        }));\n        this._register(this._model.onDidChangeAttached(() => {\n            if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        }));\n        this._register(this._model.onDidChangeLanguage(() => {\n            // clear any outstanding state\n            if (this._currentDocumentResponse) {\n                this._currentDocumentResponse.dispose();\n                this._currentDocumentResponse = null;\n            }\n            if (this._currentDocumentRequestCancellationTokenSource) {\n                this._currentDocumentRequestCancellationTokenSource.cancel();\n                this._currentDocumentRequestCancellationTokenSource = null;\n            }\n            this._setDocumentSemanticTokens(null, null, null, []);\n            this._fetchDocumentSemanticTokens.schedule(0);\n        }));\n        const bindDocumentChangeListeners = () => {\n            dispose(this._documentProvidersChangeListeners);\n            this._documentProvidersChangeListeners = [];\n            for (const provider of this._provider.all(model)) {\n                if (typeof provider.onDidChange === 'function') {\n                    this._documentProvidersChangeListeners.push(provider.onDidChange(() => {\n                        if (this._currentDocumentRequestCancellationTokenSource) {\n                            // there is already a request running,\n                            this._providersChangedDuringRequest = true;\n                            return;\n                        }\n                        this._fetchDocumentSemanticTokens.schedule(0);\n                    }));\n                }\n            }\n        };\n        bindDocumentChangeListeners();\n        this._register(this._provider.onDidChange(() => {\n            bindDocumentChangeListeners();\n            this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n        }));\n        this._register(themeService.onDidColorThemeChange(_ => {\n            // clear out existing tokens\n            this._setDocumentSemanticTokens(null, null, null, []);\n            this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n        }));\n        this._fetchDocumentSemanticTokens.schedule(0);\n    }\n    dispose() {\n        if (this._currentDocumentResponse) {\n            this._currentDocumentResponse.dispose();\n            this._currentDocumentResponse = null;\n        }\n        if (this._currentDocumentRequestCancellationTokenSource) {\n            this._currentDocumentRequestCancellationTokenSource.cancel();\n            this._currentDocumentRequestCancellationTokenSource = null;\n        }\n        dispose(this._documentProvidersChangeListeners);\n        this._documentProvidersChangeListeners = [];\n        this._setDocumentSemanticTokens(null, null, null, []);\n        this._isDisposed = true;\n        super.dispose();\n    }\n    _fetchDocumentSemanticTokensNow() {\n        if (this._currentDocumentRequestCancellationTokenSource) {\n            // there is already a request running, let it finish...\n            return;\n        }\n        if (!hasDocumentSemanticTokensProvider(this._provider, this._model)) {\n            // there is no provider\n            if (this._currentDocumentResponse) {\n                // there are semantic tokens set\n                this._model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        if (!this._model.isAttachedToEditor()) {\n            // this document is not visible, there is no need to fetch semantic tokens for it\n            return;\n        }\n        const cancellationTokenSource = new CancellationTokenSource();\n        const lastProvider = this._currentDocumentResponse ? this._currentDocumentResponse.provider : null;\n        const lastResultId = this._currentDocumentResponse ? this._currentDocumentResponse.resultId || null : null;\n        const request = getDocumentSemanticTokens(this._provider, this._model, lastProvider, lastResultId, cancellationTokenSource.token);\n        this._currentDocumentRequestCancellationTokenSource = cancellationTokenSource;\n        this._providersChangedDuringRequest = false;\n        const pendingChanges = [];\n        const contentChangeListener = this._model.onDidChangeContent((e) => {\n            pendingChanges.push(e);\n        });\n        const sw = new StopWatch(false);\n        request.then((res) => {\n            this._debounceInformation.update(this._model, sw.elapsed());\n            this._currentDocumentRequestCancellationTokenSource = null;\n            contentChangeListener.dispose();\n            if (!res) {\n                this._setDocumentSemanticTokens(null, null, null, pendingChanges);\n            }\n            else {\n                const { provider, tokens } = res;\n                const styling = this._semanticTokensStylingService.getStyling(provider);\n                this._setDocumentSemanticTokens(provider, tokens || null, styling, pendingChanges);\n            }\n        }, (err) => {\n            const isExpectedError = err && (errors.isCancellationError(err) || (typeof err.message === 'string' && err.message.indexOf('busy') !== -1));\n            if (!isExpectedError) {\n                errors.onUnexpectedError(err);\n            }\n            // Semantic tokens eats up all errors and considers errors to mean that the result is temporarily not available\n            // The API does not have a special error kind to express this...\n            this._currentDocumentRequestCancellationTokenSource = null;\n            contentChangeListener.dispose();\n            if (pendingChanges.length > 0 || this._providersChangedDuringRequest) {\n                // More changes occurred while the request was running\n                if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                    this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n                }\n            }\n        });\n    }\n    static _copy(src, srcOffset, dest, destOffset, length) {\n        // protect against overflows\n        length = Math.min(length, dest.length - destOffset, src.length - srcOffset);\n        for (let i = 0; i < length; i++) {\n            dest[destOffset + i] = src[srcOffset + i];\n        }\n    }\n    _setDocumentSemanticTokens(provider, tokens, styling, pendingChanges) {\n        const currentResponse = this._currentDocumentResponse;\n        const rescheduleIfNeeded = () => {\n            if ((pendingChanges.length > 0 || this._providersChangedDuringRequest) && !this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        };\n        if (this._currentDocumentResponse) {\n            this._currentDocumentResponse.dispose();\n            this._currentDocumentResponse = null;\n        }\n        if (this._isDisposed) {\n            // disposed!\n            if (provider && tokens) {\n                provider.releaseDocumentSemanticTokens(tokens.resultId);\n            }\n            return;\n        }\n        if (!provider || !styling) {\n            this._model.tokenization.setSemanticTokens(null, false);\n            return;\n        }\n        if (!tokens) {\n            this._model.tokenization.setSemanticTokens(null, true);\n            rescheduleIfNeeded();\n            return;\n        }\n        if (isSemanticTokensEdits(tokens)) {\n            if (!currentResponse) {\n                // not possible!\n                this._model.tokenization.setSemanticTokens(null, true);\n                return;\n            }\n            if (tokens.edits.length === 0) {\n                // nothing to do!\n                tokens = {\n                    resultId: tokens.resultId,\n                    data: currentResponse.data\n                };\n            }\n            else {\n                let deltaLength = 0;\n                for (const edit of tokens.edits) {\n                    deltaLength += (edit.data ? edit.data.length : 0) - edit.deleteCount;\n                }\n                const srcData = currentResponse.data;\n                const destData = new Uint32Array(srcData.length + deltaLength);\n                let srcLastStart = srcData.length;\n                let destLastStart = destData.length;\n                for (let i = tokens.edits.length - 1; i >= 0; i--) {\n                    const edit = tokens.edits[i];\n                    if (edit.start > srcData.length) {\n                        styling.warnInvalidEditStart(currentResponse.resultId, tokens.resultId, i, edit.start, srcData.length);\n                        // The edits are invalid and there's no way to recover\n                        this._model.tokenization.setSemanticTokens(null, true);\n                        return;\n                    }\n                    const copyCount = srcLastStart - (edit.start + edit.deleteCount);\n                    if (copyCount > 0) {\n                        ModelSemanticColoring_1._copy(srcData, srcLastStart - copyCount, destData, destLastStart - copyCount, copyCount);\n                        destLastStart -= copyCount;\n                    }\n                    if (edit.data) {\n                        ModelSemanticColoring_1._copy(edit.data, 0, destData, destLastStart - edit.data.length, edit.data.length);\n                        destLastStart -= edit.data.length;\n                    }\n                    srcLastStart = edit.start;\n                }\n                if (srcLastStart > 0) {\n                    ModelSemanticColoring_1._copy(srcData, 0, destData, 0, srcLastStart);\n                }\n                tokens = {\n                    resultId: tokens.resultId,\n                    data: destData\n                };\n            }\n        }\n        if (isSemanticTokens(tokens)) {\n            this._currentDocumentResponse = new SemanticTokensResponse(provider, tokens.resultId, tokens.data);\n            const result = toMultilineTokens2(tokens, styling, this._model.getLanguageId());\n            // Adjust incoming semantic tokens\n            if (pendingChanges.length > 0) {\n                // More changes occurred while the request was running\n                // We need to:\n                // 1. Adjust incoming semantic tokens\n                // 2. Request them again\n                for (const change of pendingChanges) {\n                    for (const area of result) {\n                        for (const singleChange of change.changes) {\n                            area.applyEdit(singleChange.range, singleChange.text);\n                        }\n                    }\n                }\n            }\n            this._model.tokenization.setSemanticTokens(result, true);\n        }\n        else {\n            this._model.tokenization.setSemanticTokens(null, true);\n        }\n        rescheduleIfNeeded();\n    }\n};\nModelSemanticColoring.REQUEST_MIN_DELAY = 300;\nModelSemanticColoring.REQUEST_MAX_DELAY = 2000;\nModelSemanticColoring = ModelSemanticColoring_1 = __decorate([\n    __param(1, ISemanticTokensStylingService),\n    __param(2, IThemeService),\n    __param(3, ILanguageFeatureDebounceService),\n    __param(4, ILanguageFeaturesService)\n], ModelSemanticColoring);\nclass SemanticTokensResponse {\n    constructor(provider, resultId, data) {\n        this.provider = provider;\n        this.resultId = resultId;\n        this.data = data;\n    }\n    dispose() {\n        this.provider.releaseDocumentSemanticTokens(this.resultId);\n    }\n}\nregisterEditorFeature(DocumentSemanticTokensFeature);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { getDocumentRangeSemanticTokens, hasDocumentRangeSemanticTokensProvider } from '../common/getSemanticTokens.js';\nimport { isSemanticColoringEnabled, SEMANTIC_HIGHLIGHTING_SETTING_ID } from '../common/semanticTokensConfig.js';\nimport { toMultilineTokens2 } from '../../../common/services/semanticTokensProviderStyling.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ISemanticTokensStylingService } from '../../../common/services/semanticTokensStyling.js';\nlet ViewportSemanticTokensContribution = class ViewportSemanticTokensContribution extends Disposable {\n    constructor(editor, _semanticTokensStylingService, _themeService, _configurationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._semanticTokensStylingService = _semanticTokensStylingService;\n        this._themeService = _themeService;\n        this._configurationService = _configurationService;\n        this._editor = editor;\n        this._provider = languageFeaturesService.documentRangeSemanticTokensProvider;\n        this._debounceInformation = languageFeatureDebounceService.for(this._provider, 'DocumentRangeSemanticTokens', { min: 100, max: 500 });\n        this._tokenizeViewport = this._register(new RunOnceScheduler(() => this._tokenizeViewportNow(), 100));\n        this._outstandingRequests = [];\n        const scheduleTokenizeViewport = () => {\n            if (this._editor.hasModel()) {\n                this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()));\n            }\n        };\n        this._register(this._editor.onDidScrollChange(() => {\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModelContent((e) => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._provider.onDidChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\n                this._cancelAll();\n                scheduleTokenizeViewport();\n            }\n        }));\n        this._register(this._themeService.onDidColorThemeChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        scheduleTokenizeViewport();\n    }\n    _cancelAll() {\n        for (const request of this._outstandingRequests) {\n            request.cancel();\n        }\n        this._outstandingRequests = [];\n    }\n    _removeOutstandingRequest(req) {\n        for (let i = 0, len = this._outstandingRequests.length; i < len; i++) {\n            if (this._outstandingRequests[i] === req) {\n                this._outstandingRequests.splice(i, 1);\n                return;\n            }\n        }\n    }\n    _tokenizeViewportNow() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (model.tokenization.hasCompleteSemanticTokens()) {\n            return;\n        }\n        if (!isSemanticColoringEnabled(model, this._themeService, this._configurationService)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        if (!hasDocumentRangeSemanticTokensProvider(this._provider, model)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        this._outstandingRequests = this._outstandingRequests.concat(visibleRanges.map(range => this._requestRange(model, range)));\n    }\n    _requestRange(model, range) {\n        const requestVersionId = model.getVersionId();\n        const request = createCancelablePromise(token => Promise.resolve(getDocumentRangeSemanticTokens(this._provider, model, range, token)));\n        const sw = new StopWatch(false);\n        request.then((r) => {\n            this._debounceInformation.update(model, sw.elapsed());\n            if (!r || !r.tokens || model.isDisposed() || model.getVersionId() !== requestVersionId) {\n                return;\n            }\n            const { provider, tokens: result } = r;\n            const styling = this._semanticTokensStylingService.getStyling(provider);\n            model.tokenization.setPartialSemanticTokens(range, toMultilineTokens2(result, styling, model.getLanguageId()));\n        }).then(() => this._removeOutstandingRequest(request), () => this._removeOutstandingRequest(request));\n        return request;\n    }\n};\nViewportSemanticTokensContribution.ID = 'editor.contrib.viewportSemanticTokens';\nViewportSemanticTokensContribution = __decorate([\n    __param(1, ISemanticTokensStylingService),\n    __param(2, IThemeService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], ViewportSemanticTokensContribution);\nexport { ViewportSemanticTokensContribution };\nregisterEditorContribution(ViewportSemanticTokensContribution.ID, ViewportSemanticTokensContribution, 1 /* EditorContributionInstantiation.AfterFirstRender */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { encodeSemanticTokensDto } from '../../../common/services/semanticTokensDto.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport function isSemanticTokens(v) {\n    return v && !!(v.data);\n}\nexport function isSemanticTokensEdits(v) {\n    return v && Array.isArray(v.edits);\n}\nexport class DocumentSemanticTokensResult {\n    constructor(provider, tokens, error) {\n        this.provider = provider;\n        this.tokens = tokens;\n        this.error = error;\n    }\n}\nexport function hasDocumentSemanticTokensProvider(registry, model) {\n    return registry.has(model);\n}\nfunction getDocumentSemanticTokensProviders(registry, model) {\n    const groups = registry.orderedGroups(model);\n    return (groups.length > 0 ? groups[0] : []);\n}\nexport function getDocumentSemanticTokens(registry, model, lastProvider, lastResultId, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = getDocumentSemanticTokensProviders(registry, model);\n        // Get tokens from all providers at the same time.\n        const results = yield Promise.all(providers.map((provider) => __awaiter(this, void 0, void 0, function* () {\n            let result;\n            let error = null;\n            try {\n                result = yield provider.provideDocumentSemanticTokens(model, (provider === lastProvider ? lastResultId : null), token);\n            }\n            catch (err) {\n                error = err;\n                result = null;\n            }\n            if (!result || (!isSemanticTokens(result) && !isSemanticTokensEdits(result))) {\n                result = null;\n            }\n            return new DocumentSemanticTokensResult(provider, result, error);\n        })));\n        // Try to return the first result with actual tokens or\n        // the first result which threw an error (!!)\n        for (const result of results) {\n            if (result.error) {\n                throw result.error;\n            }\n            if (result.tokens) {\n                return result;\n            }\n        }\n        // Return the first result, even if it doesn't have tokens\n        if (results.length > 0) {\n            return results[0];\n        }\n        return null;\n    });\n}\nfunction _getDocumentSemanticTokensProviderHighestGroup(registry, model) {\n    const result = registry.orderedGroups(model);\n    return (result.length > 0 ? result[0] : null);\n}\nclass DocumentRangeSemanticTokensResult {\n    constructor(provider, tokens) {\n        this.provider = provider;\n        this.tokens = tokens;\n    }\n}\nexport function hasDocumentRangeSemanticTokensProvider(providers, model) {\n    return providers.has(model);\n}\nfunction getDocumentRangeSemanticTokensProviders(providers, model) {\n    const groups = providers.orderedGroups(model);\n    return (groups.length > 0 ? groups[0] : []);\n}\nexport function getDocumentRangeSemanticTokens(registry, model, range, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = getDocumentRangeSemanticTokensProviders(registry, model);\n        // Get tokens from all providers at the same time.\n        const results = yield Promise.all(providers.map((provider) => __awaiter(this, void 0, void 0, function* () {\n            let result;\n            try {\n                result = yield provider.provideDocumentRangeSemanticTokens(model, range, token);\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n                result = null;\n            }\n            if (!result || !isSemanticTokens(result)) {\n                result = null;\n            }\n            return new DocumentRangeSemanticTokensResult(provider, result);\n        })));\n        // Try to return the first result with actual tokens\n        for (const result of results) {\n            if (result.tokens) {\n                return result;\n            }\n        }\n        // Return the first result, even if it doesn't have tokens\n        if (results.length > 0) {\n            return results[0];\n        }\n        return null;\n    });\n}\nCommandsRegistry.registerCommand('_provideDocumentSemanticTokensLegend', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const providers = _getDocumentSemanticTokensProviderHighestGroup(documentSemanticTokensProvider, model);\n    if (!providers) {\n        // there is no provider => fall back to a document range semantic tokens provider\n        return accessor.get(ICommandService).executeCommand('_provideDocumentRangeSemanticTokensLegend', uri);\n    }\n    return providers[0].getLegend();\n}));\nCommandsRegistry.registerCommand('_provideDocumentSemanticTokens', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    if (!hasDocumentSemanticTokensProvider(documentSemanticTokensProvider, model)) {\n        // there is no provider => fall back to a document range semantic tokens provider\n        return accessor.get(ICommandService).executeCommand('_provideDocumentRangeSemanticTokens', uri, model.getFullModelRange());\n    }\n    const r = yield getDocumentSemanticTokens(documentSemanticTokensProvider, model, null, null, CancellationToken.None);\n    if (!r) {\n        return undefined;\n    }\n    const { provider, tokens } = r;\n    if (!tokens || !isSemanticTokens(tokens)) {\n        return undefined;\n    }\n    const buff = encodeSemanticTokensDto({\n        id: 0,\n        type: 'full',\n        data: tokens.data\n    });\n    if (tokens.resultId) {\n        provider.releaseDocumentSemanticTokens(tokens.resultId);\n    }\n    return buff;\n}));\nCommandsRegistry.registerCommand('_provideDocumentRangeSemanticTokensLegend', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, range] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentRangeSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const providers = getDocumentRangeSemanticTokensProviders(documentRangeSemanticTokensProvider, model);\n    if (providers.length === 0) {\n        // no providers\n        return undefined;\n    }\n    if (providers.length === 1) {\n        // straight forward case, just a single provider\n        return providers[0].getLegend();\n    }\n    if (!range || !Range.isIRange(range)) {\n        // if no range is provided, we cannot support multiple providers\n        // as we cannot fall back to the one which would give results\n        // => return the first legend for backwards compatibility and print a warning\n        console.warn(`provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in`);\n        return providers[0].getLegend();\n    }\n    const result = yield getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider, model, Range.lift(range), CancellationToken.None);\n    if (!result) {\n        return undefined;\n    }\n    return result.provider.getLegend();\n}));\nCommandsRegistry.registerCommand('_provideDocumentRangeSemanticTokens', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, range] = args;\n    assertType(uri instanceof URI);\n    assertType(Range.isIRange(range));\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentRangeSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const result = yield getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider, model, Range.lift(range), CancellationToken.None);\n    if (!result || !result.tokens) {\n        // there is no provider or it didn't return tokens\n        return undefined;\n    }\n    return encodeSemanticTokensDto({\n        id: 0,\n        type: 'full',\n        data: result.tokens.data\n    });\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const SEMANTIC_HIGHLIGHTING_SETTING_ID = 'editor.semanticHighlighting';\nexport function isSemanticColoringEnabled(model, themeService, configurationService) {\n    var _a;\n    const setting = (_a = configurationService.getValue(SEMANTIC_HIGHLIGHTING_SETTING_ID, { overrideIdentifier: model.getLanguageId(), resource: model.uri })) === null || _a === void 0 ? void 0 : _a.enabled;\n    if (typeof setting === 'boolean') {\n        return setting;\n    }\n    return themeService.getColorTheme().semanticHighlighting;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nexport class BracketSelectionRangeProvider {\n    provideSelectionRanges(model, positions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = [];\n            for (const position of positions) {\n                const bucket = [];\n                result.push(bucket);\n                const ranges = new Map();\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsRightYield(resolve, 0, model, position, ranges));\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsLeftYield(resolve, 0, model, position, ranges, bucket));\n            }\n            return result;\n        });\n    }\n    static _bracketsRightYield(resolve, round, model, pos, ranges) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findNextBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsRightYield(resolve, round + 1, model, pos, ranges));\n                break;\n            }\n            if (bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.bracketText;\n                // wait for closing\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.getOpeningBrackets()[0].bracketText;\n                // process closing\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    let list = ranges.get(key);\n                    if (!list) {\n                        list = new LinkedList();\n                        ranges.set(key, list);\n                    }\n                    list.push(bracket.range);\n                }\n            }\n            pos = bracket.range.getEndPosition();\n        }\n    }\n    static _bracketsLeftYield(resolve, round, model, pos, ranges, bucket) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds && ranges.size === 0) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findPrevBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsLeftYield(resolve, round + 1, model, pos, ranges, bucket));\n                break;\n            }\n            if (!bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.getOpeningBrackets()[0].bracketText;\n                // wait for opening\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.bracketText;\n                // opening\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    const list = ranges.get(key);\n                    if (list) {\n                        const closing = list.shift();\n                        if (list.size === 0) {\n                            ranges.delete(key);\n                        }\n                        const innerBracket = Range.fromPositions(bracket.range.getEndPosition(), closing.getStartPosition());\n                        const outerBracket = Range.fromPositions(bracket.range.getStartPosition(), closing.getEndPosition());\n                        bucket.push({ range: innerBracket });\n                        bucket.push({ range: outerBracket });\n                        BracketSelectionRangeProvider._addBracketLeading(model, outerBracket, bucket);\n                    }\n                }\n            }\n            pos = bracket.range.getStartPosition();\n        }\n    }\n    static _addBracketLeading(model, bracket, bucket) {\n        if (bracket.startLineNumber === bracket.endLineNumber) {\n            return;\n        }\n        // xxxxxxxx {\n        //\n        // }\n        const startLine = bracket.startLineNumber;\n        const column = model.getLineFirstNonWhitespaceColumn(startLine);\n        if (column !== 0 && column !== bracket.startColumn) {\n            bucket.push({ range: Range.fromPositions(new Position(startLine, column), bracket.getEndPosition()) });\n            bucket.push({ range: Range.fromPositions(new Position(startLine, 1), bracket.getEndPosition()) });\n        }\n        // xxxxxxxx\n        // {\n        //\n        // }\n        const aboveLine = startLine - 1;\n        if (aboveLine > 0) {\n            const column = model.getLineFirstNonWhitespaceColumn(aboveLine);\n            if (column === bracket.startColumn && column !== model.getLineLastNonWhitespaceColumn(aboveLine)) {\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, column), bracket.getEndPosition()) });\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, 1), bracket.getEndPosition()) });\n            }\n        }\n    }\n}\nBracketSelectionRangeProvider._maxDuration = 30;\nBracketSelectionRangeProvider._maxRounds = 2;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isLowerAsciiLetter, isUpperAsciiLetter } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nexport class WordSelectionRangeProvider {\n    constructor(selectSubwords = true) {\n        this.selectSubwords = selectSubwords;\n    }\n    provideSelectionRanges(model, positions) {\n        const result = [];\n        for (const position of positions) {\n            const bucket = [];\n            result.push(bucket);\n            if (this.selectSubwords) {\n                this._addInWordRanges(bucket, model, position);\n            }\n            this._addWordRanges(bucket, model, position);\n            this._addWhitespaceLine(bucket, model, position);\n            bucket.push({ range: model.getFullModelRange() });\n        }\n        return result;\n    }\n    _addInWordRanges(bucket, model, pos) {\n        const obj = model.getWordAtPosition(pos);\n        if (!obj) {\n            return;\n        }\n        const { word, startColumn } = obj;\n        const offset = pos.column - startColumn;\n        let start = offset;\n        let end = offset;\n        let lastCh = 0;\n        // LEFT anchor (start)\n        for (; start >= 0; start--) {\n            const ch = word.charCodeAt(start);\n            if ((start !== offset) && (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */)) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            else if (isLowerAsciiLetter(ch) && isUpperAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            lastCh = ch;\n        }\n        start += 1;\n        // RIGHT anchor (end)\n        for (; end < word.length; end++) {\n            const ch = word.charCodeAt(end);\n            if (isUpperAsciiLetter(ch) && isLowerAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            else if (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            lastCh = ch;\n        }\n        if (start < end) {\n            bucket.push({ range: new Range(pos.lineNumber, startColumn + start, pos.lineNumber, startColumn + end) });\n        }\n    }\n    _addWordRanges(bucket, model, pos) {\n        const word = model.getWordAtPosition(pos);\n        if (word) {\n            bucket.push({ range: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn) });\n        }\n    }\n    _addWhitespaceLine(bucket, model, pos) {\n        if (model.getLineLength(pos.lineNumber) > 0\n            && model.getLineFirstNonWhitespaceColumn(pos.lineNumber) === 0\n            && model.getLineLastNonWhitespaceColumn(pos.lineNumber) === 0) {\n            bucket.push({ range: new Range(pos.lineNumber, 1, pos.lineNumber, model.getLineMaxColumn(pos.lineNumber)) });\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar SmartSelectController_1;\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { BracketSelectionRangeProvider } from './bracketSelections.js';\nimport { WordSelectionRangeProvider } from './wordSelections.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nclass SelectionRanges {\n    constructor(index, ranges) {\n        this.index = index;\n        this.ranges = ranges;\n    }\n    mov(fwd) {\n        const index = this.index + (fwd ? 1 : -1);\n        if (index < 0 || index >= this.ranges.length) {\n            return this;\n        }\n        const res = new SelectionRanges(index, this.ranges);\n        if (res.ranges[index].equalsRange(this.ranges[this.index])) {\n            // next range equals this range, retry with next-next\n            return res.mov(fwd);\n        }\n        return res;\n    }\n}\nlet SmartSelectController = SmartSelectController_1 = class SmartSelectController {\n    static get(editor) {\n        return editor.getContribution(SmartSelectController_1.ID);\n    }\n    constructor(_editor, _languageFeaturesService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._ignoreSelection = false;\n    }\n    dispose() {\n        var _a;\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n    }\n    run(forward) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            const selections = this._editor.getSelections();\n            const model = this._editor.getModel();\n            if (!this._state) {\n                yield provideSelectionRanges(this._languageFeaturesService.selectionRangeProvider, model, selections.map(s => s.getPosition()), this._editor.getOption(112 /* EditorOption.smartSelect */), CancellationToken.None).then(ranges => {\n                    var _a;\n                    if (!arrays.isNonEmptyArray(ranges) || ranges.length !== selections.length) {\n                        // invalid result\n                        return;\n                    }\n                    if (!this._editor.hasModel() || !arrays.equals(this._editor.getSelections(), selections, (a, b) => a.equalsSelection(b))) {\n                        // invalid editor state\n                        return;\n                    }\n                    for (let i = 0; i < ranges.length; i++) {\n                        ranges[i] = ranges[i].filter(range => {\n                            // filter ranges inside the selection\n                            return range.containsPosition(selections[i].getStartPosition()) && range.containsPosition(selections[i].getEndPosition());\n                        });\n                        // prepend current selection\n                        ranges[i].unshift(selections[i]);\n                    }\n                    this._state = ranges.map(ranges => new SelectionRanges(0, ranges));\n                    // listen to caret move and forget about state\n                    (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                    this._selectionListener = this._editor.onDidChangeCursorPosition(() => {\n                        var _a;\n                        if (!this._ignoreSelection) {\n                            (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                            this._state = undefined;\n                        }\n                    });\n                });\n            }\n            if (!this._state) {\n                // no state\n                return;\n            }\n            this._state = this._state.map(state => state.mov(forward));\n            const newSelections = this._state.map(state => Selection.fromPositions(state.ranges[state.index].getStartPosition(), state.ranges[state.index].getEndPosition()));\n            this._ignoreSelection = true;\n            try {\n                this._editor.setSelections(newSelections);\n            }\n            finally {\n                this._ignoreSelection = false;\n            }\n        });\n    }\n};\nSmartSelectController.ID = 'editor.contrib.smartSelectController';\nSmartSelectController = SmartSelectController_1 = __decorate([\n    __param(1, ILanguageFeaturesService)\n], SmartSelectController);\nexport { SmartSelectController };\nclass AbstractSmartSelect extends EditorAction {\n    constructor(forward, opts) {\n        super(opts);\n        this._forward = forward;\n    }\n    run(_accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = SmartSelectController.get(editor);\n            if (controller) {\n                yield controller.run(this._forward);\n            }\n        });\n    }\n}\nclass GrowSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(true, {\n            id: 'editor.action.smartSelect.expand',\n            label: nls.localize('smartSelect.expand', \"Expand Selection\"),\n            alias: 'Expand Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectGrow', comment: ['&& denotes a mnemonic'] }, \"&&Expand Selection\"),\n                order: 2\n            }\n        });\n    }\n}\n// renamed command id\nCommandsRegistry.registerCommandAlias('editor.action.smartSelect.grow', 'editor.action.smartSelect.expand');\nclass ShrinkSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(false, {\n            id: 'editor.action.smartSelect.shrink',\n            label: nls.localize('smartSelect.shrink', \"Shrink Selection\"),\n            alias: 'Shrink Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectShrink', comment: ['&& denotes a mnemonic'] }, \"&&Shrink Selection\"),\n                order: 3\n            }\n        });\n    }\n}\nregisterEditorContribution(SmartSelectController.ID, SmartSelectController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(GrowSelectionAction);\nregisterEditorAction(ShrinkSelectionAction);\nexport function provideSelectionRanges(registry, model, positions, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = registry.all(model)\n            .concat(new WordSelectionRangeProvider(options.selectSubwords)); // ALWAYS have word based selection range\n        if (providers.length === 1) {\n            // add word selection and bracket selection when no provider exists\n            providers.unshift(new BracketSelectionRangeProvider());\n        }\n        const work = [];\n        const allRawRanges = [];\n        for (const provider of providers) {\n            work.push(Promise.resolve(provider.provideSelectionRanges(model, positions, token)).then(allProviderRanges => {\n                if (arrays.isNonEmptyArray(allProviderRanges) && allProviderRanges.length === positions.length) {\n                    for (let i = 0; i < positions.length; i++) {\n                        if (!allRawRanges[i]) {\n                            allRawRanges[i] = [];\n                        }\n                        for (const oneProviderRanges of allProviderRanges[i]) {\n                            if (Range.isIRange(oneProviderRanges.range) && Range.containsPosition(oneProviderRanges.range, positions[i])) {\n                                allRawRanges[i].push(Range.lift(oneProviderRanges.range));\n                            }\n                        }\n                    }\n                }\n            }, onUnexpectedExternalError));\n        }\n        yield Promise.all(work);\n        return allRawRanges.map(oneRawRanges => {\n            if (oneRawRanges.length === 0) {\n                return [];\n            }\n            // sort all by start/end position\n            oneRawRanges.sort((a, b) => {\n                if (Position.isBefore(a.getStartPosition(), b.getStartPosition())) {\n                    return 1;\n                }\n                else if (Position.isBefore(b.getStartPosition(), a.getStartPosition())) {\n                    return -1;\n                }\n                else if (Position.isBefore(a.getEndPosition(), b.getEndPosition())) {\n                    return -1;\n                }\n                else if (Position.isBefore(b.getEndPosition(), a.getEndPosition())) {\n                    return 1;\n                }\n                else {\n                    return 0;\n                }\n            });\n            // remove ranges that don't contain the former range or that are equal to the\n            // former range\n            const oneRanges = [];\n            let last;\n            for (const range of oneRawRanges) {\n                if (!last || (Range.containsRange(range, last) && !Range.equalsRange(range, last))) {\n                    oneRanges.push(range);\n                    last = range;\n                }\n            }\n            if (!options.selectLeadingAndTrailingWhitespace) {\n                return oneRanges;\n            }\n            // add ranges that expand trivia at line starts and ends whenever a range\n            // wraps onto the a new line\n            const oneRangesWithTrivia = [oneRanges[0]];\n            for (let i = 1; i < oneRanges.length; i++) {\n                const prev = oneRanges[i - 1];\n                const cur = oneRanges[i];\n                if (cur.startLineNumber !== prev.startLineNumber || cur.endLineNumber !== prev.endLineNumber) {\n                    // add line/block range without leading/failing whitespace\n                    const rangeNoWhitespace = new Range(prev.startLineNumber, model.getLineFirstNonWhitespaceColumn(prev.startLineNumber), prev.endLineNumber, model.getLineLastNonWhitespaceColumn(prev.endLineNumber));\n                    if (rangeNoWhitespace.containsRange(prev) && !rangeNoWhitespace.equalsRange(prev) && cur.containsRange(rangeNoWhitespace) && !cur.equalsRange(rangeNoWhitespace)) {\n                        oneRangesWithTrivia.push(rangeNoWhitespace);\n                    }\n                    // add line/block range\n                    const rangeFull = new Range(prev.startLineNumber, 1, prev.endLineNumber, model.getLineMaxColumn(prev.endLineNumber));\n                    if (rangeFull.containsRange(prev) && !rangeFull.equalsRange(rangeNoWhitespace) && cur.containsRange(rangeFull) && !cur.equalsRange(rangeFull)) {\n                        oneRangesWithTrivia.push(rangeFull);\n                    }\n                }\n                oneRangesWithTrivia.push(cur);\n            }\n            return oneRangesWithTrivia;\n        });\n    });\n}\nCommandsRegistry.registerCommand('_executeSelectionRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, positions] = args;\n        assertType(URI.isUri(resource));\n        const registry = accessor.get(ILanguageFeaturesService).selectionRangeProvider;\n        const reference = yield accessor.get(ITextModelService).createModelReference(resource);\n        try {\n            return provideSelectionRanges(registry, reference.object.textEditorModel, positions, { selectLeadingAndTrailingWhitespace: true, selectSubwords: true }, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SnippetController2_1;\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { showSimpleSuggestions } from '../../suggest/browser/suggest.js';\nimport { localize } from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { SnippetSession } from './snippetSession.js';\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    undoStopBefore: true,\n    undoStopAfter: true,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetController2 = SnippetController2_1 = class SnippetController2 {\n    static get(editor) {\n        return editor.getContribution(SnippetController2_1.ID);\n    }\n    constructor(_editor, _logService, _languageFeaturesService, contextKeyService, _languageConfigurationService) {\n        this._editor = _editor;\n        this._logService = _logService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._snippetListener = new DisposableStore();\n        this._modelVersionId = -1;\n        this._inSnippet = SnippetController2_1.InSnippetMode.bindTo(contextKeyService);\n        this._hasNextTabstop = SnippetController2_1.HasNextTabstop.bindTo(contextKeyService);\n        this._hasPrevTabstop = SnippetController2_1.HasPrevTabstop.bindTo(contextKeyService);\n    }\n    dispose() {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._snippetListener.dispose();\n    }\n    insert(template, opts) {\n        // this is here to find out more about the yet-not-understood\n        // error that sometimes happens when we fail to inserted a nested\n        // snippet\n        try {\n            this._doInsert(template, typeof opts === 'undefined' ? _defaultOptions : Object.assign(Object.assign({}, _defaultOptions), opts));\n        }\n        catch (e) {\n            this.cancel();\n            this._logService.error(e);\n            this._logService.error('snippet_error');\n            this._logService.error('insert_template=', template);\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\n        }\n    }\n    _doInsert(template, opts) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // don't listen while inserting the snippet\n        // as that is the inflight state causing cancelation\n        this._snippetListener.clear();\n        if (opts.undoStopBefore) {\n            this._editor.getModel().pushStackElement();\n        }\n        // don't merge\n        if (this._session && typeof template !== 'string') {\n            this.cancel();\n        }\n        if (!this._session) {\n            this._modelVersionId = this._editor.getModel().getAlternativeVersionId();\n            this._session = new SnippetSession(this._editor, template, opts, this._languageConfigurationService);\n            this._session.insert();\n        }\n        else {\n            assertType(typeof template === 'string');\n            this._session.merge(template, opts);\n        }\n        if (opts.undoStopAfter) {\n            this._editor.getModel().pushStackElement();\n        }\n        // regster completion item provider when there is any choice element\n        if ((_a = this._session) === null || _a === void 0 ? void 0 : _a.hasChoice) {\n            const provider = {\n                _debugDisplayName: 'snippetChoiceCompletions',\n                provideCompletionItems: (model, position) => {\n                    if (!this._session || model !== this._editor.getModel() || !Position.equals(this._editor.getPosition(), position)) {\n                        return undefined;\n                    }\n                    const { activeChoice } = this._session;\n                    if (!activeChoice || activeChoice.choice.options.length === 0) {\n                        return undefined;\n                    }\n                    const word = model.getValueInRange(activeChoice.range);\n                    const isAnyOfOptions = Boolean(activeChoice.choice.options.find(o => o.value === word));\n                    const suggestions = [];\n                    for (let i = 0; i < activeChoice.choice.options.length; i++) {\n                        const option = activeChoice.choice.options[i];\n                        suggestions.push({\n                            kind: 13 /* CompletionItemKind.Value */,\n                            label: option.value,\n                            insertText: option.value,\n                            sortText: 'a'.repeat(i + 1),\n                            range: activeChoice.range,\n                            filterText: isAnyOfOptions ? `${word}_${option.value}` : undefined,\n                            command: { id: 'jumpToNextSnippetPlaceholder', title: localize('next', 'Go to next placeholder...') }\n                        });\n                    }\n                    return { suggestions };\n                }\n            };\n            const model = this._editor.getModel();\n            let registration;\n            let isRegistered = false;\n            const disable = () => {\n                registration === null || registration === void 0 ? void 0 : registration.dispose();\n                isRegistered = false;\n            };\n            const enable = () => {\n                if (!isRegistered) {\n                    registration = this._languageFeaturesService.completionProvider.register({\n                        language: model.getLanguageId(),\n                        pattern: model.uri.fsPath,\n                        scheme: model.uri.scheme,\n                        exclusive: true\n                    }, provider);\n                    this._snippetListener.add(registration);\n                    isRegistered = true;\n                }\n            };\n            this._choiceCompletions = { provider, enable, disable };\n        }\n        this._updateState();\n        this._snippetListener.add(this._editor.onDidChangeModelContent(e => e.isFlush && this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeModel(() => this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeCursorSelection(() => this._updateState()));\n    }\n    _updateState() {\n        if (!this._session || !this._editor.hasModel()) {\n            // canceled in the meanwhile\n            return;\n        }\n        if (this._modelVersionId === this._editor.getModel().getAlternativeVersionId()) {\n            // undo until the 'before' state happened\n            // and makes use cancel snippet mode\n            return this.cancel();\n        }\n        if (!this._session.hasPlaceholder) {\n            // don't listen for selection changes and don't\n            // update context keys when the snippet is plain text\n            return this.cancel();\n        }\n        if (this._session.isAtLastPlaceholder || !this._session.isSelectionWithinPlaceholders()) {\n            this._editor.getModel().pushStackElement();\n            return this.cancel();\n        }\n        this._inSnippet.set(true);\n        this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder);\n        this._hasNextTabstop.set(!this._session.isAtLastPlaceholder);\n        this._handleChoice();\n    }\n    _handleChoice() {\n        var _a;\n        if (!this._session || !this._editor.hasModel()) {\n            this._currentChoice = undefined;\n            return;\n        }\n        const { activeChoice } = this._session;\n        if (!activeChoice || !this._choiceCompletions) {\n            (_a = this._choiceCompletions) === null || _a === void 0 ? void 0 : _a.disable();\n            this._currentChoice = undefined;\n            return;\n        }\n        if (this._currentChoice !== activeChoice.choice) {\n            this._currentChoice = activeChoice.choice;\n            this._choiceCompletions.enable();\n            // trigger suggest with the special choice completion provider\n            queueMicrotask(() => {\n                showSimpleSuggestions(this._editor, this._choiceCompletions.provider);\n            });\n        }\n    }\n    finish() {\n        while (this._inSnippet.get()) {\n            this.next();\n        }\n    }\n    cancel(resetSelection = false) {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        this._snippetListener.clear();\n        this._currentChoice = undefined;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._session = undefined;\n        this._modelVersionId = -1;\n        if (resetSelection) {\n            // reset selection to the primary cursor when being asked\n            // for. this happens when explicitly cancelling snippet mode,\n            // e.g. when pressing ESC\n            this._editor.setSelections([this._editor.getSelection()]);\n        }\n    }\n    prev() {\n        var _a;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.prev();\n        this._updateState();\n    }\n    next() {\n        var _a;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.next();\n        this._updateState();\n    }\n    isInSnippet() {\n        return Boolean(this._inSnippet.get());\n    }\n};\nSnippetController2.ID = 'snippetController2';\nSnippetController2.InSnippetMode = new RawContextKey('inSnippetMode', false, localize('inSnippetMode', \"Whether the editor in current in snippet mode\"));\nSnippetController2.HasNextTabstop = new RawContextKey('hasNextTabstop', false, localize('hasNextTabstop', \"Whether there is a next tab stop when in snippet mode\"));\nSnippetController2.HasPrevTabstop = new RawContextKey('hasPrevTabstop', false, localize('hasPrevTabstop', \"Whether there is a previous tab stop when in snippet mode\"));\nSnippetController2 = SnippetController2_1 = __decorate([\n    __param(1, ILogService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IContextKeyService),\n    __param(4, ILanguageConfigurationService)\n], SnippetController2);\nexport { SnippetController2 };\nregisterEditorContribution(SnippetController2.ID, SnippetController2, 4 /* EditorContributionInstantiation.Lazy */);\nconst CommandCtor = EditorCommand.bindToContribution(SnippetController2.get);\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToNextSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasNextTabstop),\n    handler: ctrl => ctrl.next(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToPrevSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasPrevTabstop),\n    handler: ctrl => ctrl.prev(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'leaveSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.cancel(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'acceptSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.finish(),\n    // kbOpts: {\n    // \tweight: KeybindingWeight.EditorContrib + 30,\n    // \tkbExpr: EditorContextKeys.textFocus,\n    // \tprimary: KeyCode.Enter,\n    // }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class Scanner {\n    constructor() {\n        this.value = '';\n        this.pos = 0;\n    }\n    static isDigitCharacter(ch) {\n        return ch >= 48 /* CharCode.Digit0 */ && ch <= 57 /* CharCode.Digit9 */;\n    }\n    static isVariableCharacter(ch) {\n        return ch === 95 /* CharCode.Underline */\n            || (ch >= 97 /* CharCode.a */ && ch <= 122 /* CharCode.z */)\n            || (ch >= 65 /* CharCode.A */ && ch <= 90 /* CharCode.Z */);\n    }\n    text(value) {\n        this.value = value;\n        this.pos = 0;\n    }\n    tokenText(token) {\n        return this.value.substr(token.pos, token.len);\n    }\n    next() {\n        if (this.pos >= this.value.length) {\n            return { type: 14 /* TokenType.EOF */, pos: this.pos, len: 0 };\n        }\n        const pos = this.pos;\n        let len = 0;\n        let ch = this.value.charCodeAt(pos);\n        let type;\n        // static types\n        type = Scanner._table[ch];\n        if (typeof type === 'number') {\n            this.pos += 1;\n            return { type, pos, len: 1 };\n        }\n        // number\n        if (Scanner.isDigitCharacter(ch)) {\n            type = 8 /* TokenType.Int */;\n            do {\n                len += 1;\n                ch = this.value.charCodeAt(pos + len);\n            } while (Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // variable name\n        if (Scanner.isVariableCharacter(ch)) {\n            type = 9 /* TokenType.VariableName */;\n            do {\n                ch = this.value.charCodeAt(pos + (++len));\n            } while (Scanner.isVariableCharacter(ch) || Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // format\n        type = 10 /* TokenType.Format */;\n        do {\n            len += 1;\n            ch = this.value.charCodeAt(pos + len);\n        } while (!isNaN(ch)\n            && typeof Scanner._table[ch] === 'undefined' // not static token\n            && !Scanner.isDigitCharacter(ch) // not number\n            && !Scanner.isVariableCharacter(ch) // not variable\n        );\n        this.pos += len;\n        return { type, pos, len };\n    }\n}\nScanner._table = {\n    [36 /* CharCode.DollarSign */]: 0 /* TokenType.Dollar */,\n    [58 /* CharCode.Colon */]: 1 /* TokenType.Colon */,\n    [44 /* CharCode.Comma */]: 2 /* TokenType.Comma */,\n    [123 /* CharCode.OpenCurlyBrace */]: 3 /* TokenType.CurlyOpen */,\n    [125 /* CharCode.CloseCurlyBrace */]: 4 /* TokenType.CurlyClose */,\n    [92 /* CharCode.Backslash */]: 5 /* TokenType.Backslash */,\n    [47 /* CharCode.Slash */]: 6 /* TokenType.Forwardslash */,\n    [124 /* CharCode.Pipe */]: 7 /* TokenType.Pipe */,\n    [43 /* CharCode.Plus */]: 11 /* TokenType.Plus */,\n    [45 /* CharCode.Dash */]: 12 /* TokenType.Dash */,\n    [63 /* CharCode.QuestionMark */]: 13 /* TokenType.QuestionMark */,\n};\nexport class Marker {\n    constructor() {\n        this._children = [];\n    }\n    appendChild(child) {\n        if (child instanceof Text && this._children[this._children.length - 1] instanceof Text) {\n            // this and previous child are text -> merge them\n            this._children[this._children.length - 1].value += child.value;\n        }\n        else {\n            // normal adoption of child\n            child.parent = this;\n            this._children.push(child);\n        }\n        return this;\n    }\n    replace(child, others) {\n        const { parent } = child;\n        const idx = parent.children.indexOf(child);\n        const newChildren = parent.children.slice(0);\n        newChildren.splice(idx, 1, ...others);\n        parent._children = newChildren;\n        (function _fixParent(children, parent) {\n            for (const child of children) {\n                child.parent = parent;\n                _fixParent(child.children, child);\n            }\n        })(others, parent);\n    }\n    get children() {\n        return this._children;\n    }\n    get rightMostDescendant() {\n        if (this._children.length > 0) {\n            return this._children[this._children.length - 1].rightMostDescendant;\n        }\n        return this;\n    }\n    get snippet() {\n        let candidate = this;\n        while (true) {\n            if (!candidate) {\n                return undefined;\n            }\n            if (candidate instanceof TextmateSnippet) {\n                return candidate;\n            }\n            candidate = candidate.parent;\n        }\n    }\n    toString() {\n        return this.children.reduce((prev, cur) => prev + cur.toString(), '');\n    }\n    len() {\n        return 0;\n    }\n}\nexport class Text extends Marker {\n    constructor(value) {\n        super();\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n    len() {\n        return this.value.length;\n    }\n    clone() {\n        return new Text(this.value);\n    }\n}\nexport class TransformableMarker extends Marker {\n}\nexport class Placeholder extends TransformableMarker {\n    static compareByIndex(a, b) {\n        if (a.index === b.index) {\n            return 0;\n        }\n        else if (a.isFinalTabstop) {\n            return 1;\n        }\n        else if (b.isFinalTabstop) {\n            return -1;\n        }\n        else if (a.index < b.index) {\n            return -1;\n        }\n        else if (a.index > b.index) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    constructor(index) {\n        super();\n        this.index = index;\n    }\n    get isFinalTabstop() {\n        return this.index === 0;\n    }\n    get choice() {\n        return this._children.length === 1 && this._children[0] instanceof Choice\n            ? this._children[0]\n            : undefined;\n    }\n    clone() {\n        const ret = new Placeholder(this.index);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class Choice extends Marker {\n    constructor() {\n        super(...arguments);\n        this.options = [];\n    }\n    appendChild(marker) {\n        if (marker instanceof Text) {\n            marker.parent = this;\n            this.options.push(marker);\n        }\n        return this;\n    }\n    toString() {\n        return this.options[0].value;\n    }\n    len() {\n        return this.options[0].len();\n    }\n    clone() {\n        const ret = new Choice();\n        this.options.forEach(ret.appendChild, ret);\n        return ret;\n    }\n}\nexport class Transform extends Marker {\n    constructor() {\n        super(...arguments);\n        this.regexp = new RegExp('');\n    }\n    resolve(value) {\n        const _this = this;\n        let didMatch = false;\n        let ret = value.replace(this.regexp, function () {\n            didMatch = true;\n            return _this._replace(Array.prototype.slice.call(arguments, 0, -2));\n        });\n        // when the regex didn't match and when the transform has\n        // else branches, then run those\n        if (!didMatch && this._children.some(child => child instanceof FormatString && Boolean(child.elseValue))) {\n            ret = this._replace([]);\n        }\n        return ret;\n    }\n    _replace(groups) {\n        let ret = '';\n        for (const marker of this._children) {\n            if (marker instanceof FormatString) {\n                let value = groups[marker.index] || '';\n                value = marker.resolve(value);\n                ret += value;\n            }\n            else {\n                ret += marker.toString();\n            }\n        }\n        return ret;\n    }\n    toString() {\n        return '';\n    }\n    clone() {\n        const ret = new Transform();\n        ret.regexp = new RegExp(this.regexp.source, '' + (this.regexp.ignoreCase ? 'i' : '') + (this.regexp.global ? 'g' : ''));\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class FormatString extends Marker {\n    constructor(index, shorthandName, ifValue, elseValue) {\n        super();\n        this.index = index;\n        this.shorthandName = shorthandName;\n        this.ifValue = ifValue;\n        this.elseValue = elseValue;\n    }\n    resolve(value) {\n        if (this.shorthandName === 'upcase') {\n            return !value ? '' : value.toLocaleUpperCase();\n        }\n        else if (this.shorthandName === 'downcase') {\n            return !value ? '' : value.toLocaleLowerCase();\n        }\n        else if (this.shorthandName === 'capitalize') {\n            return !value ? '' : (value[0].toLocaleUpperCase() + value.substr(1));\n        }\n        else if (this.shorthandName === 'pascalcase') {\n            return !value ? '' : this._toPascalCase(value);\n        }\n        else if (this.shorthandName === 'camelcase') {\n            return !value ? '' : this._toCamelCase(value);\n        }\n        else if (Boolean(value) && typeof this.ifValue === 'string') {\n            return this.ifValue;\n        }\n        else if (!Boolean(value) && typeof this.elseValue === 'string') {\n            return this.elseValue;\n        }\n        else {\n            return value || '';\n        }\n    }\n    _toPascalCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map(word => {\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    _toCamelCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map((word, index) => {\n            if (index === 0) {\n                return word.charAt(0).toLowerCase() + word.substr(1);\n            }\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    clone() {\n        const ret = new FormatString(this.index, this.shorthandName, this.ifValue, this.elseValue);\n        return ret;\n    }\n}\nexport class Variable extends TransformableMarker {\n    constructor(name) {\n        super();\n        this.name = name;\n    }\n    resolve(resolver) {\n        let value = resolver.resolve(this);\n        if (this.transform) {\n            value = this.transform.resolve(value || '');\n        }\n        if (value !== undefined) {\n            this._children = [new Text(value)];\n            return true;\n        }\n        return false;\n    }\n    clone() {\n        const ret = new Variable(this.name);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nfunction walk(marker, visitor) {\n    const stack = [...marker];\n    while (stack.length > 0) {\n        const marker = stack.shift();\n        const recurse = visitor(marker);\n        if (!recurse) {\n            break;\n        }\n        stack.unshift(...marker.children);\n    }\n}\nexport class TextmateSnippet extends Marker {\n    get placeholderInfo() {\n        if (!this._placeholders) {\n            // fill in placeholders\n            const all = [];\n            let last;\n            this.walk(function (candidate) {\n                if (candidate instanceof Placeholder) {\n                    all.push(candidate);\n                    last = !last || last.index < candidate.index ? candidate : last;\n                }\n                return true;\n            });\n            this._placeholders = { all, last };\n        }\n        return this._placeholders;\n    }\n    get placeholders() {\n        const { all } = this.placeholderInfo;\n        return all;\n    }\n    offset(marker) {\n        let pos = 0;\n        let found = false;\n        this.walk(candidate => {\n            if (candidate === marker) {\n                found = true;\n                return false;\n            }\n            pos += candidate.len();\n            return true;\n        });\n        if (!found) {\n            return -1;\n        }\n        return pos;\n    }\n    fullLen(marker) {\n        let ret = 0;\n        walk([marker], marker => {\n            ret += marker.len();\n            return true;\n        });\n        return ret;\n    }\n    enclosingPlaceholders(placeholder) {\n        const ret = [];\n        let { parent } = placeholder;\n        while (parent) {\n            if (parent instanceof Placeholder) {\n                ret.push(parent);\n            }\n            parent = parent.parent;\n        }\n        return ret;\n    }\n    resolveVariables(resolver) {\n        this.walk(candidate => {\n            if (candidate instanceof Variable) {\n                if (candidate.resolve(resolver)) {\n                    this._placeholders = undefined;\n                }\n            }\n            return true;\n        });\n        return this;\n    }\n    appendChild(child) {\n        this._placeholders = undefined;\n        return super.appendChild(child);\n    }\n    replace(child, others) {\n        this._placeholders = undefined;\n        return super.replace(child, others);\n    }\n    clone() {\n        const ret = new TextmateSnippet();\n        this._children = this.children.map(child => child.clone());\n        return ret;\n    }\n    walk(visitor) {\n        walk(this.children, visitor);\n    }\n}\nexport class SnippetParser {\n    constructor() {\n        this._scanner = new Scanner();\n        this._token = { type: 14 /* TokenType.EOF */, pos: 0, len: 0 };\n    }\n    static escape(value) {\n        return value.replace(/\\$|}|\\\\/g, '\\\\$&');\n    }\n    static guessNeedsClipboard(template) {\n        return /\\${?CLIPBOARD/.test(template);\n    }\n    parse(value, insertFinalTabstop, enforceFinalTabstop) {\n        const snippet = new TextmateSnippet();\n        this.parseFragment(value, snippet);\n        this.ensureFinalTabstop(snippet, enforceFinalTabstop !== null && enforceFinalTabstop !== void 0 ? enforceFinalTabstop : false, insertFinalTabstop !== null && insertFinalTabstop !== void 0 ? insertFinalTabstop : false);\n        return snippet;\n    }\n    parseFragment(value, snippet) {\n        const offset = snippet.children.length;\n        this._scanner.text(value);\n        this._token = this._scanner.next();\n        while (this._parse(snippet)) {\n            // nothing\n        }\n        // fill in values for placeholders. the first placeholder of an index\n        // that has a value defines the value for all placeholders with that index\n        const placeholderDefaultValues = new Map();\n        const incompletePlaceholders = [];\n        snippet.walk(marker => {\n            if (marker instanceof Placeholder) {\n                if (marker.isFinalTabstop) {\n                    placeholderDefaultValues.set(0, undefined);\n                }\n                else if (!placeholderDefaultValues.has(marker.index) && marker.children.length > 0) {\n                    placeholderDefaultValues.set(marker.index, marker.children);\n                }\n                else {\n                    incompletePlaceholders.push(marker);\n                }\n            }\n            return true;\n        });\n        const fillInIncompletePlaceholder = (placeholder, stack) => {\n            const defaultValues = placeholderDefaultValues.get(placeholder.index);\n            if (!defaultValues) {\n                return;\n            }\n            const clone = new Placeholder(placeholder.index);\n            clone.transform = placeholder.transform;\n            for (const child of defaultValues) {\n                const newChild = child.clone();\n                clone.appendChild(newChild);\n                // \"recurse\" on children that are again placeholders\n                if (newChild instanceof Placeholder && placeholderDefaultValues.has(newChild.index) && !stack.has(newChild.index)) {\n                    stack.add(newChild.index);\n                    fillInIncompletePlaceholder(newChild, stack);\n                    stack.delete(newChild.index);\n                }\n            }\n            snippet.replace(placeholder, [clone]);\n        };\n        const stack = new Set();\n        for (const placeholder of incompletePlaceholders) {\n            fillInIncompletePlaceholder(placeholder, stack);\n        }\n        return snippet.children.slice(offset);\n    }\n    ensureFinalTabstop(snippet, enforceFinalTabstop, insertFinalTabstop) {\n        if (enforceFinalTabstop || insertFinalTabstop && snippet.placeholders.length > 0) {\n            const finalTabstop = snippet.placeholders.find(p => p.index === 0);\n            if (!finalTabstop) {\n                // the snippet uses placeholders but has no\n                // final tabstop defined -> insert at the end\n                snippet.appendChild(new Placeholder(0));\n            }\n        }\n    }\n    _accept(type, value) {\n        if (type === undefined || this._token.type === type) {\n            const ret = !value ? true : this._scanner.tokenText(this._token);\n            this._token = this._scanner.next();\n            return ret;\n        }\n        return false;\n    }\n    _backTo(token) {\n        this._scanner.pos = token.pos + token.len;\n        this._token = token;\n        return false;\n    }\n    _until(type) {\n        const start = this._token;\n        while (this._token.type !== type) {\n            if (this._token.type === 14 /* TokenType.EOF */) {\n                return false;\n            }\n            else if (this._token.type === 5 /* TokenType.Backslash */) {\n                const nextToken = this._scanner.next();\n                if (nextToken.type !== 0 /* TokenType.Dollar */\n                    && nextToken.type !== 4 /* TokenType.CurlyClose */\n                    && nextToken.type !== 5 /* TokenType.Backslash */) {\n                    return false;\n                }\n            }\n            this._token = this._scanner.next();\n        }\n        const value = this._scanner.value.substring(start.pos, this._token.pos).replace(/\\\\(\\$|}|\\\\)/g, '$1');\n        this._token = this._scanner.next();\n        return value;\n    }\n    _parse(marker) {\n        return this._parseEscaped(marker)\n            || this._parseTabstopOrVariableName(marker)\n            || this._parseComplexPlaceholder(marker)\n            || this._parseComplexVariable(marker)\n            || this._parseAnything(marker);\n    }\n    // \\$, \\\\, \\} -> just text\n    _parseEscaped(marker) {\n        let value;\n        if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n            // saw a backslash, append escaped token or that backslash\n            value = this._accept(0 /* TokenType.Dollar */, true)\n                || this._accept(4 /* TokenType.CurlyClose */, true)\n                || this._accept(5 /* TokenType.Backslash */, true)\n                || value;\n            marker.appendChild(new Text(value));\n            return true;\n        }\n        return false;\n    }\n    // $foo -> variable, $1 -> tabstop\n    _parseTabstopOrVariableName(parent) {\n        let value;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && (value = this._accept(9 /* TokenType.VariableName */, true) || this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        parent.appendChild(/^\\d+$/.test(value)\n            ? new Placeholder(Number(value))\n            : new Variable(value));\n        return true;\n    }\n    // ${1:<children>}, ${1} -> placeholder\n    _parseComplexPlaceholder(parent) {\n        let index;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (index = this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const placeholder = new Placeholder(Number(index));\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${1:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(placeholder);\n                    return true;\n                }\n                if (this._parse(placeholder)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + index + ':'));\n                placeholder.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (placeholder.index > 0 && this._accept(7 /* TokenType.Pipe */)) {\n            // ${1|one,two,three|}\n            const choice = new Choice();\n            while (true) {\n                if (this._parseChoiceElement(choice)) {\n                    if (this._accept(2 /* TokenType.Comma */)) {\n                        // opt, -> more\n                        continue;\n                    }\n                    if (this._accept(7 /* TokenType.Pipe */)) {\n                        placeholder.appendChild(choice);\n                        if (this._accept(4 /* TokenType.CurlyClose */)) {\n                            // ..|} -> done\n                            parent.appendChild(placeholder);\n                            return true;\n                        }\n                    }\n                }\n                this._backTo(token);\n                return false;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1/<regex>/<format>/<options>}\n            if (this._parseTransform(placeholder)) {\n                parent.appendChild(placeholder);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(placeholder);\n            return true;\n        }\n        else {\n            // ${1 <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseChoiceElement(parent) {\n        const token = this._token;\n        const values = [];\n        while (true) {\n            if (this._token.type === 2 /* TokenType.Comma */ || this._token.type === 7 /* TokenType.Pipe */) {\n                break;\n            }\n            let value;\n            if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n                // \\, \\|, or \\\\\n                value = this._accept(2 /* TokenType.Comma */, true)\n                    || this._accept(7 /* TokenType.Pipe */, true)\n                    || this._accept(5 /* TokenType.Backslash */, true)\n                    || value;\n            }\n            else {\n                value = this._accept(undefined, true);\n            }\n            if (!value) {\n                // EOF\n                this._backTo(token);\n                return false;\n            }\n            values.push(value);\n        }\n        if (values.length === 0) {\n            this._backTo(token);\n            return false;\n        }\n        parent.appendChild(new Text(values.join('')));\n        return true;\n    }\n    // ${foo:<children>}, ${foo} -> variable\n    _parseComplexVariable(parent) {\n        let name;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (name = this._accept(9 /* TokenType.VariableName */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const variable = new Variable(name);\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${foo:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(variable);\n                    return true;\n                }\n                if (this._parse(variable)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + name + ':'));\n                variable.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${foo/<regex>/<format>/<options>}\n            if (this._parseTransform(variable)) {\n                parent.appendChild(variable);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${foo}\n            parent.appendChild(variable);\n            return true;\n        }\n        else {\n            // ${foo <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseTransform(parent) {\n        // ...<regex>/<format>/<options>}\n        const transform = new Transform();\n        let regexValue = '';\n        let regexOptions = '';\n        // (1) /regex\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                regexValue += escaped;\n                continue;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexValue += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        // (2) /format\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(5 /* TokenType.Backslash */, true) || this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                transform.appendChild(new Text(escaped));\n                continue;\n            }\n            if (this._parseFormatString(transform) || this._parseAnything(transform)) {\n                continue;\n            }\n            return false;\n        }\n        // (3) /option\n        while (true) {\n            if (this._accept(4 /* TokenType.CurlyClose */)) {\n                break;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexOptions += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        try {\n            transform.regexp = new RegExp(regexValue, regexOptions);\n        }\n        catch (e) {\n            // invalid regexp\n            return false;\n        }\n        parent.transform = transform;\n        return true;\n    }\n    _parseFormatString(parent) {\n        const token = this._token;\n        if (!this._accept(0 /* TokenType.Dollar */)) {\n            return false;\n        }\n        let complex = false;\n        if (this._accept(3 /* TokenType.CurlyOpen */)) {\n            complex = true;\n        }\n        const index = this._accept(8 /* TokenType.Int */, true);\n        if (!index) {\n            this._backTo(token);\n            return false;\n        }\n        else if (!complex) {\n            // $1\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (!this._accept(1 /* TokenType.Colon */)) {\n            this._backTo(token);\n            return false;\n        }\n        if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1:/upcase}\n            const shorthand = this._accept(9 /* TokenType.VariableName */, true);\n            if (!shorthand || !this._accept(4 /* TokenType.CurlyClose */)) {\n                this._backTo(token);\n                return false;\n            }\n            else {\n                parent.appendChild(new FormatString(Number(index), shorthand));\n                return true;\n            }\n        }\n        else if (this._accept(11 /* TokenType.Plus */)) {\n            // ${1:+<if>}\n            const ifValue = this._until(4 /* TokenType.CurlyClose */);\n            if (ifValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, ifValue, undefined));\n                return true;\n            }\n        }\n        else if (this._accept(12 /* TokenType.Dash */)) {\n            // ${2:-<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        else if (this._accept(13 /* TokenType.QuestionMark */)) {\n            // ${2:?<if>:<else>}\n            const ifValue = this._until(1 /* TokenType.Colon */);\n            if (ifValue) {\n                const elseValue = this._until(4 /* TokenType.CurlyClose */);\n                if (elseValue) {\n                    parent.appendChild(new FormatString(Number(index), undefined, ifValue, elseValue));\n                    return true;\n                }\n            }\n        }\n        else {\n            // ${1:<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        this._backTo(token);\n        return false;\n    }\n    _parseAnything(marker) {\n        if (this._token.type !== 14 /* TokenType.EOF */) {\n            marker.appendChild(new Text(this._scanner.tokenText(this._token)));\n            this._accept(undefined);\n            return true;\n        }\n        return false;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { normalizeDriveLetter } from '../../../../base/common/labels.js';\nimport * as path from '../../../../base/common/path.js';\nimport { dirname } from '../../../../base/common/resources.js';\nimport { commonPrefixLength, getLeadingWhitespace, isFalsyOrWhitespace, splitLines } from '../../../../base/common/strings.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { Text } from './snippetParser.js';\nimport * as nls from '../../../../nls.js';\nimport { WORKSPACE_EXTENSION, isSingleFolderWorkspaceIdentifier, toWorkspaceIdentifier, isEmptyWorkspaceIdentifier } from '../../../../platform/workspace/common/workspace.js';\nexport const KnownSnippetVariableNames = Object.freeze({\n    'CURRENT_YEAR': true,\n    'CURRENT_YEAR_SHORT': true,\n    'CURRENT_MONTH': true,\n    'CURRENT_DATE': true,\n    'CURRENT_HOUR': true,\n    'CURRENT_MINUTE': true,\n    'CURRENT_SECOND': true,\n    'CURRENT_DAY_NAME': true,\n    'CURRENT_DAY_NAME_SHORT': true,\n    'CURRENT_MONTH_NAME': true,\n    'CURRENT_MONTH_NAME_SHORT': true,\n    'CURRENT_SECONDS_UNIX': true,\n    'CURRENT_TIMEZONE_OFFSET': true,\n    'SELECTION': true,\n    'CLIPBOARD': true,\n    'TM_SELECTED_TEXT': true,\n    'TM_CURRENT_LINE': true,\n    'TM_CURRENT_WORD': true,\n    'TM_LINE_INDEX': true,\n    'TM_LINE_NUMBER': true,\n    'TM_FILENAME': true,\n    'TM_FILENAME_BASE': true,\n    'TM_DIRECTORY': true,\n    'TM_FILEPATH': true,\n    'CURSOR_INDEX': true, // 0-offset\n    'CURSOR_NUMBER': true, // 1-offset\n    'RELATIVE_FILEPATH': true,\n    'BLOCK_COMMENT_START': true,\n    'BLOCK_COMMENT_END': true,\n    'LINE_COMMENT': true,\n    'WORKSPACE_NAME': true,\n    'WORKSPACE_FOLDER': true,\n    'RANDOM': true,\n    'RANDOM_HEX': true,\n    'UUID': true\n});\nexport class CompositeSnippetVariableResolver {\n    constructor(_delegates) {\n        this._delegates = _delegates;\n        //\n    }\n    resolve(variable) {\n        for (const delegate of this._delegates) {\n            const value = delegate.resolve(variable);\n            if (value !== undefined) {\n                return value;\n            }\n        }\n        return undefined;\n    }\n}\nexport class SelectionBasedVariableResolver {\n    constructor(_model, _selection, _selectionIdx, _overtypingCapturer) {\n        this._model = _model;\n        this._selection = _selection;\n        this._selectionIdx = _selectionIdx;\n        this._overtypingCapturer = _overtypingCapturer;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'SELECTION' || name === 'TM_SELECTED_TEXT') {\n            let value = this._model.getValueInRange(this._selection) || undefined;\n            let isMultiline = this._selection.startLineNumber !== this._selection.endLineNumber;\n            // If there was no selected text, try to get last overtyped text\n            if (!value && this._overtypingCapturer) {\n                const info = this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);\n                if (info) {\n                    value = info.value;\n                    isMultiline = info.multiline;\n                }\n            }\n            if (value && isMultiline && variable.snippet) {\n                // Selection is a multiline string which we indentation we now\n                // need to adjust. We compare the indentation of this variable\n                // with the indentation at the editor position and add potential\n                // extra indentation to the value\n                const line = this._model.getLineContent(this._selection.startLineNumber);\n                const lineLeadingWhitespace = getLeadingWhitespace(line, 0, this._selection.startColumn - 1);\n                let varLeadingWhitespace = lineLeadingWhitespace;\n                variable.snippet.walk(marker => {\n                    if (marker === variable) {\n                        return false;\n                    }\n                    if (marker instanceof Text) {\n                        varLeadingWhitespace = getLeadingWhitespace(splitLines(marker.value).pop());\n                    }\n                    return true;\n                });\n                const whitespaceCommonLength = commonPrefixLength(varLeadingWhitespace, lineLeadingWhitespace);\n                value = value.replace(/(\\r\\n|\\r|\\n)(.*)/g, (m, newline, rest) => `${newline}${varLeadingWhitespace.substr(whitespaceCommonLength)}${rest}`);\n            }\n            return value;\n        }\n        else if (name === 'TM_CURRENT_LINE') {\n            return this._model.getLineContent(this._selection.positionLineNumber);\n        }\n        else if (name === 'TM_CURRENT_WORD') {\n            const info = this._model.getWordAtPosition({\n                lineNumber: this._selection.positionLineNumber,\n                column: this._selection.positionColumn\n            });\n            return info && info.word || undefined;\n        }\n        else if (name === 'TM_LINE_INDEX') {\n            return String(this._selection.positionLineNumber - 1);\n        }\n        else if (name === 'TM_LINE_NUMBER') {\n            return String(this._selection.positionLineNumber);\n        }\n        else if (name === 'CURSOR_INDEX') {\n            return String(this._selectionIdx);\n        }\n        else if (name === 'CURSOR_NUMBER') {\n            return String(this._selectionIdx + 1);\n        }\n        return undefined;\n    }\n}\nexport class ModelBasedVariableResolver {\n    constructor(_labelService, _model) {\n        this._labelService = _labelService;\n        this._model = _model;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'TM_FILENAME') {\n            return path.basename(this._model.uri.fsPath);\n        }\n        else if (name === 'TM_FILENAME_BASE') {\n            const name = path.basename(this._model.uri.fsPath);\n            const idx = name.lastIndexOf('.');\n            if (idx <= 0) {\n                return name;\n            }\n            else {\n                return name.slice(0, idx);\n            }\n        }\n        else if (name === 'TM_DIRECTORY') {\n            if (path.dirname(this._model.uri.fsPath) === '.') {\n                return '';\n            }\n            return this._labelService.getUriLabel(dirname(this._model.uri));\n        }\n        else if (name === 'TM_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri);\n        }\n        else if (name === 'RELATIVE_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri, { relative: true, noPrefix: true });\n        }\n        return undefined;\n    }\n}\nexport class ClipboardBasedVariableResolver {\n    constructor(_readClipboardText, _selectionIdx, _selectionCount, _spread) {\n        this._readClipboardText = _readClipboardText;\n        this._selectionIdx = _selectionIdx;\n        this._selectionCount = _selectionCount;\n        this._spread = _spread;\n        //\n    }\n    resolve(variable) {\n        if (variable.name !== 'CLIPBOARD') {\n            return undefined;\n        }\n        const clipboardText = this._readClipboardText();\n        if (!clipboardText) {\n            return undefined;\n        }\n        // `spread` is assigning each cursor a line of the clipboard\n        // text whenever there the line count equals the cursor count\n        // and when enabled\n        if (this._spread) {\n            const lines = clipboardText.split(/\\r\\n|\\n|\\r/).filter(s => !isFalsyOrWhitespace(s));\n            if (lines.length === this._selectionCount) {\n                return lines[this._selectionIdx];\n            }\n        }\n        return clipboardText;\n    }\n}\nlet CommentBasedVariableResolver = class CommentBasedVariableResolver {\n    constructor(_model, _selection, _languageConfigurationService) {\n        this._model = _model;\n        this._selection = _selection;\n        this._languageConfigurationService = _languageConfigurationService;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        const langId = this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber, this._selection.selectionStartColumn);\n        const config = this._languageConfigurationService.getLanguageConfiguration(langId).comments;\n        if (!config) {\n            return undefined;\n        }\n        if (name === 'LINE_COMMENT') {\n            return config.lineCommentToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_START') {\n            return config.blockCommentStartToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_END') {\n            return config.blockCommentEndToken || undefined;\n        }\n        return undefined;\n    }\n};\nCommentBasedVariableResolver = __decorate([\n    __param(2, ILanguageConfigurationService)\n], CommentBasedVariableResolver);\nexport { CommentBasedVariableResolver };\nexport class TimeBasedVariableResolver {\n    constructor() {\n        this._date = new Date();\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'CURRENT_YEAR') {\n            return String(this._date.getFullYear());\n        }\n        else if (name === 'CURRENT_YEAR_SHORT') {\n            return String(this._date.getFullYear()).slice(-2);\n        }\n        else if (name === 'CURRENT_MONTH') {\n            return String(this._date.getMonth().valueOf() + 1).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DATE') {\n            return String(this._date.getDate().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_HOUR') {\n            return String(this._date.getHours().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_MINUTE') {\n            return String(this._date.getMinutes().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_SECOND') {\n            return String(this._date.getSeconds().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DAY_NAME') {\n            return TimeBasedVariableResolver.dayNames[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_DAY_NAME_SHORT') {\n            return TimeBasedVariableResolver.dayNamesShort[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME') {\n            return TimeBasedVariableResolver.monthNames[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME_SHORT') {\n            return TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_SECONDS_UNIX') {\n            return String(Math.floor(this._date.getTime() / 1000));\n        }\n        else if (name === 'CURRENT_TIMEZONE_OFFSET') {\n            const rawTimeOffset = this._date.getTimezoneOffset();\n            const sign = rawTimeOffset > 0 ? '-' : '+';\n            const hours = Math.trunc(Math.abs(rawTimeOffset / 60));\n            const hoursString = (hours < 10 ? '0' + hours : hours);\n            const minutes = Math.abs(rawTimeOffset) - hours * 60;\n            const minutesString = (minutes < 10 ? '0' + minutes : minutes);\n            return sign + hoursString + ':' + minutesString;\n        }\n        return undefined;\n    }\n}\nTimeBasedVariableResolver.dayNames = [nls.localize('Sunday', \"Sunday\"), nls.localize('Monday', \"Monday\"), nls.localize('Tuesday', \"Tuesday\"), nls.localize('Wednesday', \"Wednesday\"), nls.localize('Thursday', \"Thursday\"), nls.localize('Friday', \"Friday\"), nls.localize('Saturday', \"Saturday\")];\nTimeBasedVariableResolver.dayNamesShort = [nls.localize('SundayShort', \"Sun\"), nls.localize('MondayShort', \"Mon\"), nls.localize('TuesdayShort', \"Tue\"), nls.localize('WednesdayShort', \"Wed\"), nls.localize('ThursdayShort', \"Thu\"), nls.localize('FridayShort', \"Fri\"), nls.localize('SaturdayShort', \"Sat\")];\nTimeBasedVariableResolver.monthNames = [nls.localize('January', \"January\"), nls.localize('February', \"February\"), nls.localize('March', \"March\"), nls.localize('April', \"April\"), nls.localize('May', \"May\"), nls.localize('June', \"June\"), nls.localize('July', \"July\"), nls.localize('August', \"August\"), nls.localize('September', \"September\"), nls.localize('October', \"October\"), nls.localize('November', \"November\"), nls.localize('December', \"December\")];\nTimeBasedVariableResolver.monthNamesShort = [nls.localize('JanuaryShort', \"Jan\"), nls.localize('FebruaryShort', \"Feb\"), nls.localize('MarchShort', \"Mar\"), nls.localize('AprilShort', \"Apr\"), nls.localize('MayShort', \"May\"), nls.localize('JuneShort', \"Jun\"), nls.localize('JulyShort', \"Jul\"), nls.localize('AugustShort', \"Aug\"), nls.localize('SeptemberShort', \"Sep\"), nls.localize('OctoberShort', \"Oct\"), nls.localize('NovemberShort', \"Nov\"), nls.localize('DecemberShort', \"Dec\")];\nexport class WorkspaceBasedVariableResolver {\n    constructor(_workspaceService) {\n        this._workspaceService = _workspaceService;\n        //\n    }\n    resolve(variable) {\n        if (!this._workspaceService) {\n            return undefined;\n        }\n        const workspaceIdentifier = toWorkspaceIdentifier(this._workspaceService.getWorkspace());\n        if (isEmptyWorkspaceIdentifier(workspaceIdentifier)) {\n            return undefined;\n        }\n        if (variable.name === 'WORKSPACE_NAME') {\n            return this._resolveWorkspaceName(workspaceIdentifier);\n        }\n        else if (variable.name === 'WORKSPACE_FOLDER') {\n            return this._resoveWorkspacePath(workspaceIdentifier);\n        }\n        return undefined;\n    }\n    _resolveWorkspaceName(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return path.basename(workspaceIdentifier.uri.path);\n        }\n        let filename = path.basename(workspaceIdentifier.configPath.path);\n        if (filename.endsWith(WORKSPACE_EXTENSION)) {\n            filename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\n        }\n        return filename;\n    }\n    _resoveWorkspacePath(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return normalizeDriveLetter(workspaceIdentifier.uri.fsPath);\n        }\n        const filename = path.basename(workspaceIdentifier.configPath.path);\n        let folderpath = workspaceIdentifier.configPath.fsPath;\n        if (folderpath.endsWith(filename)) {\n            folderpath = folderpath.substr(0, folderpath.length - filename.length - 1);\n        }\n        return (folderpath ? normalizeDriveLetter(folderpath) : '/');\n    }\n}\nexport class RandomBasedVariableResolver {\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'RANDOM') {\n            return Math.random().toString().slice(-6);\n        }\n        else if (name === 'RANDOM_HEX') {\n            return Math.random().toString(16).slice(-6);\n        }\n        else if (name === 'UUID') {\n            return generateUuid();\n        }\n        return undefined;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SnippetSession_1;\nimport { groupBy } from '../../../../base/common/arrays.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace } from '../../../../base/common/strings.js';\nimport './snippetSession.css';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { Choice, Placeholder, SnippetParser, Text, TextmateSnippet } from './snippetParser.js';\nimport { ClipboardBasedVariableResolver, CommentBasedVariableResolver, CompositeSnippetVariableResolver, ModelBasedVariableResolver, RandomBasedVariableResolver, SelectionBasedVariableResolver, TimeBasedVariableResolver, WorkspaceBasedVariableResolver } from './snippetVariables.js';\nexport class OneSnippet {\n    constructor(_editor, _snippet, _snippetLineLeadingWhitespace) {\n        this._editor = _editor;\n        this._snippet = _snippet;\n        this._snippetLineLeadingWhitespace = _snippetLineLeadingWhitespace;\n        this._offset = -1;\n        this._nestingLevel = 1;\n        this._placeholderGroups = groupBy(_snippet.placeholders, Placeholder.compareByIndex);\n        this._placeholderGroupsIdx = -1;\n    }\n    initialize(textChange) {\n        this._offset = textChange.newPosition;\n    }\n    dispose() {\n        if (this._placeholderDecorations) {\n            this._editor.removeDecorations([...this._placeholderDecorations.values()]);\n        }\n        this._placeholderGroups.length = 0;\n    }\n    _initDecorations() {\n        if (this._offset === -1) {\n            throw new Error(`Snippet not initialized!`);\n        }\n        if (this._placeholderDecorations) {\n            // already initialized\n            return;\n        }\n        this._placeholderDecorations = new Map();\n        const model = this._editor.getModel();\n        this._editor.changeDecorations(accessor => {\n            // create a decoration for each placeholder\n            for (const placeholder of this._snippet.placeholders) {\n                const placeholderOffset = this._snippet.offset(placeholder);\n                const placeholderLen = this._snippet.fullLen(placeholder);\n                const range = Range.fromPositions(model.getPositionAt(this._offset + placeholderOffset), model.getPositionAt(this._offset + placeholderOffset + placeholderLen));\n                const options = placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive;\n                const handle = accessor.addDecoration(range, options);\n                this._placeholderDecorations.set(placeholder, handle);\n            }\n        });\n    }\n    move(fwd) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        this._initDecorations();\n        // Transform placeholder text if necessary\n        if (this._placeholderGroupsIdx >= 0) {\n            const operations = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                // Check if the placeholder has a transformation\n                if (placeholder.transform) {\n                    const id = this._placeholderDecorations.get(placeholder);\n                    const range = this._editor.getModel().getDecorationRange(id);\n                    const currentValue = this._editor.getModel().getValueInRange(range);\n                    const transformedValueLines = placeholder.transform.resolve(currentValue).split(/\\r\\n|\\r|\\n/);\n                    // fix indentation for transformed lines\n                    for (let i = 1; i < transformedValueLines.length; i++) {\n                        transformedValueLines[i] = this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace + transformedValueLines[i]);\n                    }\n                    operations.push(EditOperation.replace(range, transformedValueLines.join(this._editor.getModel().getEOL())));\n                }\n            }\n            if (operations.length > 0) {\n                this._editor.executeEdits('snippet.placeholderTransform', operations);\n            }\n        }\n        let couldSkipThisPlaceholder = false;\n        if (fwd === true && this._placeholderGroupsIdx < this._placeholderGroups.length - 1) {\n            this._placeholderGroupsIdx += 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else if (fwd === false && this._placeholderGroupsIdx > 0) {\n            this._placeholderGroupsIdx -= 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else {\n            // the selection of the current placeholder might\n            // not acurate any more -> simply restore it\n        }\n        const newSelections = this._editor.getModel().changeDecorations(accessor => {\n            const activePlaceholders = new Set();\n            // change stickiness to always grow when typing at its edges\n            // because these decorations represent the currently active\n            // tabstop.\n            // Special case #1: reaching the final tabstop\n            // Special case #2: placeholders enclosing active placeholders\n            const selections = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                selections.push(new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn));\n                // consider to skip this placeholder index when the decoration\n                // range is empty but when the placeholder wasn't. that's a strong\n                // hint that the placeholder has been deleted. (all placeholder must match this)\n                couldSkipThisPlaceholder = couldSkipThisPlaceholder && this._hasPlaceholderBeenCollapsed(placeholder);\n                accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                activePlaceholders.add(placeholder);\n                for (const enclosingPlaceholder of this._snippet.enclosingPlaceholders(placeholder)) {\n                    const id = this._placeholderDecorations.get(enclosingPlaceholder);\n                    accessor.changeDecorationOptions(id, enclosingPlaceholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                    activePlaceholders.add(enclosingPlaceholder);\n                }\n            }\n            // change stickness to never grow when typing at its edges\n            // so that in-active tabstops never grow\n            for (const [placeholder, id] of this._placeholderDecorations) {\n                if (!activePlaceholders.has(placeholder)) {\n                    accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive);\n                }\n            }\n            return selections;\n        });\n        return !couldSkipThisPlaceholder ? newSelections !== null && newSelections !== void 0 ? newSelections : [] : this.move(fwd);\n    }\n    _hasPlaceholderBeenCollapsed(placeholder) {\n        // A placeholder is empty when it wasn't empty when authored but\n        // when its tracking decoration is empty. This also applies to all\n        // potential parent placeholders\n        let marker = placeholder;\n        while (marker) {\n            if (marker instanceof Placeholder) {\n                const id = this._placeholderDecorations.get(marker);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (range.isEmpty() && marker.toString().length > 0) {\n                    return true;\n                }\n            }\n            marker = marker.parent;\n        }\n        return false;\n    }\n    get isAtFirstPlaceholder() {\n        return this._placeholderGroupsIdx <= 0 || this._placeholderGroups.length === 0;\n    }\n    get isAtLastPlaceholder() {\n        return this._placeholderGroupsIdx === this._placeholderGroups.length - 1;\n    }\n    get hasPlaceholder() {\n        return this._snippet.placeholders.length > 0;\n    }\n    /**\n     * A snippet is trivial when it has no placeholder or only a final placeholder at\n     * its very end\n     */\n    get isTrivialSnippet() {\n        if (this._snippet.placeholders.length === 0) {\n            return true;\n        }\n        if (this._snippet.placeholders.length === 1) {\n            const [placeholder] = this._snippet.placeholders;\n            if (placeholder.isFinalTabstop) {\n                if (this._snippet.rightMostDescendant === placeholder) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    computePossibleSelections() {\n        const result = new Map();\n        for (const placeholdersWithEqualIndex of this._placeholderGroups) {\n            let ranges;\n            for (const placeholder of placeholdersWithEqualIndex) {\n                if (placeholder.isFinalTabstop) {\n                    // ignore those\n                    break;\n                }\n                if (!ranges) {\n                    ranges = [];\n                    result.set(placeholder.index, ranges);\n                }\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (!range) {\n                    // one of the placeholder lost its decoration and\n                    // therefore we bail out and pretend the placeholder\n                    // (with its mirrors) doesn't exist anymore.\n                    result.delete(placeholder.index);\n                    break;\n                }\n                ranges.push(range);\n            }\n        }\n        return result;\n    }\n    get activeChoice() {\n        if (!this._placeholderDecorations) {\n            return undefined;\n        }\n        const placeholder = this._placeholderGroups[this._placeholderGroupsIdx][0];\n        if (!(placeholder === null || placeholder === void 0 ? void 0 : placeholder.choice)) {\n            return undefined;\n        }\n        const id = this._placeholderDecorations.get(placeholder);\n        if (!id) {\n            return undefined;\n        }\n        const range = this._editor.getModel().getDecorationRange(id);\n        if (!range) {\n            return undefined;\n        }\n        return { range, choice: placeholder.choice };\n    }\n    get hasChoice() {\n        let result = false;\n        this._snippet.walk(marker => {\n            result = marker instanceof Choice;\n            return !result;\n        });\n        return result;\n    }\n    merge(others) {\n        const model = this._editor.getModel();\n        this._nestingLevel *= 10;\n        this._editor.changeDecorations(accessor => {\n            // For each active placeholder take one snippet and merge it\n            // in that the placeholder (can be many for `$1foo$1foo`). Because\n            // everything is sorted by editor selection we can simply remove\n            // elements from the beginning of the array\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const nested = others.shift();\n                console.assert(nested._offset !== -1);\n                console.assert(!nested._placeholderDecorations);\n                // Massage placeholder-indicies of the nested snippet to be\n                // sorted right after the insertion point. This ensures we move\n                // through the placeholders in the correct order\n                const indexLastPlaceholder = nested._snippet.placeholderInfo.last.index;\n                for (const nestedPlaceholder of nested._snippet.placeholderInfo.all) {\n                    if (nestedPlaceholder.isFinalTabstop) {\n                        nestedPlaceholder.index = placeholder.index + ((indexLastPlaceholder + 1) / this._nestingLevel);\n                    }\n                    else {\n                        nestedPlaceholder.index = placeholder.index + (nestedPlaceholder.index / this._nestingLevel);\n                    }\n                }\n                this._snippet.replace(placeholder, nested._snippet.children);\n                // Remove the placeholder at which position are inserting\n                // the snippet and also remove its decoration.\n                const id = this._placeholderDecorations.get(placeholder);\n                accessor.removeDecoration(id);\n                this._placeholderDecorations.delete(placeholder);\n                // For each *new* placeholder we create decoration to monitor\n                // how and if it grows/shrinks.\n                for (const placeholder of nested._snippet.placeholders) {\n                    const placeholderOffset = nested._snippet.offset(placeholder);\n                    const placeholderLen = nested._snippet.fullLen(placeholder);\n                    const range = Range.fromPositions(model.getPositionAt(nested._offset + placeholderOffset), model.getPositionAt(nested._offset + placeholderOffset + placeholderLen));\n                    const handle = accessor.addDecoration(range, OneSnippet._decor.inactive);\n                    this._placeholderDecorations.set(placeholder, handle);\n                }\n            }\n            // Last, re-create the placeholder groups by sorting placeholders by their index.\n            this._placeholderGroups = groupBy(this._snippet.placeholders, Placeholder.compareByIndex);\n        });\n    }\n}\nOneSnippet._decor = {\n    active: ModelDecorationOptions.register({ description: 'snippet-placeholder-1', stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    inactive: ModelDecorationOptions.register({ description: 'snippet-placeholder-2', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    activeFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-3', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n    inactiveFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-4', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n};\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetSession = SnippetSession_1 = class SnippetSession {\n    static adjustWhitespace(model, position, adjustIndentation, snippet, filter) {\n        const line = model.getLineContent(position.lineNumber);\n        const lineLeadingWhitespace = getLeadingWhitespace(line, 0, position.column - 1);\n        // the snippet as inserted\n        let snippetTextString;\n        snippet.walk(marker => {\n            // all text elements that are not inside choice\n            if (!(marker instanceof Text) || marker.parent instanceof Choice) {\n                return true;\n            }\n            // check with filter (iff provided)\n            if (filter && !filter.has(marker)) {\n                return true;\n            }\n            const lines = marker.value.split(/\\r\\n|\\r|\\n/);\n            if (adjustIndentation) {\n                // adjust indentation of snippet test\n                // -the snippet-start doesn't get extra-indented (lineLeadingWhitespace), only normalized\n                // -all N+1 lines get extra-indented and normalized\n                // -the text start get extra-indented and normalized when following a linebreak\n                const offset = snippet.offset(marker);\n                if (offset === 0) {\n                    // snippet start\n                    lines[0] = model.normalizeIndentation(lines[0]);\n                }\n                else {\n                    // check if text start is after a linebreak\n                    snippetTextString = snippetTextString !== null && snippetTextString !== void 0 ? snippetTextString : snippet.toString();\n                    const prevChar = snippetTextString.charCodeAt(offset - 1);\n                    if (prevChar === 10 /* CharCode.LineFeed */ || prevChar === 13 /* CharCode.CarriageReturn */) {\n                        lines[0] = model.normalizeIndentation(lineLeadingWhitespace + lines[0]);\n                    }\n                }\n                for (let i = 1; i < lines.length; i++) {\n                    lines[i] = model.normalizeIndentation(lineLeadingWhitespace + lines[i]);\n                }\n            }\n            const newValue = lines.join(model.getEOL());\n            if (newValue !== marker.value) {\n                marker.parent.replace(marker, [new Text(newValue)]);\n                snippetTextString = undefined;\n            }\n            return true;\n        });\n        return lineLeadingWhitespace;\n    }\n    static adjustSelection(model, selection, overwriteBefore, overwriteAfter) {\n        if (overwriteBefore !== 0 || overwriteAfter !== 0) {\n            // overwrite[Before|After] is compute using the position, not the whole\n            // selection. therefore we adjust the selection around that position\n            const { positionLineNumber, positionColumn } = selection;\n            const positionColumnBefore = positionColumn - overwriteBefore;\n            const positionColumnAfter = positionColumn + overwriteAfter;\n            const range = model.validateRange({\n                startLineNumber: positionLineNumber,\n                startColumn: positionColumnBefore,\n                endLineNumber: positionLineNumber,\n                endColumn: positionColumnAfter\n            });\n            selection = Selection.createWithDirection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn, selection.getDirection());\n        }\n        return selection;\n    }\n    static createEditsAndSnippetsFromSelections(editor, template, overwriteBefore, overwriteAfter, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        const edits = [];\n        const snippets = [];\n        if (!editor.hasModel()) {\n            return { edits, snippets };\n        }\n        const model = editor.getModel();\n        const workspaceService = editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService));\n        const modelBasedVariableResolver = editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model));\n        const readClipboardText = () => clipboardText;\n        // know what text the overwrite[Before|After] extensions\n        // of the primary curser have selected because only when\n        // secondary selections extend to the same text we can grow them\n        const firstBeforeText = model.getValueInRange(SnippetSession_1.adjustSelection(model, editor.getSelection(), overwriteBefore, 0));\n        const firstAfterText = model.getValueInRange(SnippetSession_1.adjustSelection(model, editor.getSelection(), 0, overwriteAfter));\n        // remember the first non-whitespace column to decide if\n        // `keepWhitespace` should be overruled for secondary selections\n        const firstLineFirstNonWhitespace = model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);\n        // sort selections by their start position but remeber\n        // the original index. that allows you to create correct\n        // offset-based selection logic without changing the\n        // primary selection\n        const indexedSelections = editor.getSelections()\n            .map((selection, idx) => ({ selection, idx }))\n            .sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        for (const { selection, idx } of indexedSelections) {\n            // extend selection with the `overwriteBefore` and `overwriteAfter` and then\n            // compare if this matches the extensions of the primary selection\n            let extensionBefore = SnippetSession_1.adjustSelection(model, selection, overwriteBefore, 0);\n            let extensionAfter = SnippetSession_1.adjustSelection(model, selection, 0, overwriteAfter);\n            if (firstBeforeText !== model.getValueInRange(extensionBefore)) {\n                extensionBefore = selection;\n            }\n            if (firstAfterText !== model.getValueInRange(extensionAfter)) {\n                extensionAfter = selection;\n            }\n            // merge the before and after selection into one\n            const snippetSelection = selection\n                .setStartPosition(extensionBefore.startLineNumber, extensionBefore.startColumn)\n                .setEndPosition(extensionAfter.endLineNumber, extensionAfter.endColumn);\n            const snippet = new SnippetParser().parse(template, true, enforceFinalTabstop);\n            // adjust the template string to match the indentation and\n            // whitespace rules of this insert location (can be different for each cursor)\n            // happens when being asked for (default) or when this is a secondary\n            // cursor and the leading whitespace is different\n            const start = snippetSelection.getStartPosition();\n            const snippetLineLeadingWhitespace = SnippetSession_1.adjustWhitespace(model, start, adjustWhitespace || (idx > 0 && firstLineFirstNonWhitespace !== model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber)), snippet);\n            snippet.resolveVariables(new CompositeSnippetVariableResolver([\n                modelBasedVariableResolver,\n                new ClipboardBasedVariableResolver(readClipboardText, idx, indexedSelections.length, editor.getOption(78 /* EditorOption.multiCursorPaste */) === 'spread'),\n                new SelectionBasedVariableResolver(model, selection, idx, overtypingCapturer),\n                new CommentBasedVariableResolver(model, selection, languageConfigurationService),\n                new TimeBasedVariableResolver,\n                new WorkspaceBasedVariableResolver(workspaceService),\n                new RandomBasedVariableResolver,\n            ]));\n            // store snippets with the index of their originating selection.\n            // that ensures the primiary cursor stays primary despite not being\n            // the one with lowest start position\n            edits[idx] = EditOperation.replace(snippetSelection, snippet.toString());\n            edits[idx].identifier = { major: idx, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edits[idx]._isTracked = true;\n            snippets[idx] = new OneSnippet(editor, snippet, snippetLineLeadingWhitespace);\n        }\n        return { edits, snippets };\n    }\n    static createEditsAndSnippetsFromEdits(editor, snippetEdits, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        if (!editor.hasModel() || snippetEdits.length === 0) {\n            return { edits: [], snippets: [] };\n        }\n        const edits = [];\n        const model = editor.getModel();\n        const parser = new SnippetParser();\n        const snippet = new TextmateSnippet();\n        // snippet variables resolver\n        const resolver = new CompositeSnippetVariableResolver([\n            editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model)),\n            new ClipboardBasedVariableResolver(() => clipboardText, 0, editor.getSelections().length, editor.getOption(78 /* EditorOption.multiCursorPaste */) === 'spread'),\n            new SelectionBasedVariableResolver(model, editor.getSelection(), 0, overtypingCapturer),\n            new CommentBasedVariableResolver(model, editor.getSelection(), languageConfigurationService),\n            new TimeBasedVariableResolver,\n            new WorkspaceBasedVariableResolver(editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService))),\n            new RandomBasedVariableResolver,\n        ]);\n        //\n        snippetEdits = snippetEdits.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n        let offset = 0;\n        for (let i = 0; i < snippetEdits.length; i++) {\n            const { range, template } = snippetEdits[i];\n            // gaps between snippet edits are appended as text nodes. this\n            // ensures placeholder-offsets are later correct\n            if (i > 0) {\n                const lastRange = snippetEdits[i - 1].range;\n                const textRange = Range.fromPositions(lastRange.getEndPosition(), range.getStartPosition());\n                const textNode = new Text(model.getValueInRange(textRange));\n                snippet.appendChild(textNode);\n                offset += textNode.value.length;\n            }\n            const newNodes = parser.parseFragment(template, snippet);\n            SnippetSession_1.adjustWhitespace(model, range.getStartPosition(), true, snippet, new Set(newNodes));\n            snippet.resolveVariables(resolver);\n            const snippetText = snippet.toString();\n            const snippetFragmentText = snippetText.slice(offset);\n            offset = snippetText.length;\n            // make edit\n            const edit = EditOperation.replace(range, snippetFragmentText);\n            edit.identifier = { major: i, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edit._isTracked = true;\n            edits.push(edit);\n        }\n        //\n        parser.ensureFinalTabstop(snippet, enforceFinalTabstop, true);\n        return {\n            edits,\n            snippets: [new OneSnippet(editor, snippet, '')]\n        };\n    }\n    constructor(_editor, _template, _options = _defaultOptions, _languageConfigurationService) {\n        this._editor = _editor;\n        this._template = _template;\n        this._options = _options;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._templateMerges = [];\n        this._snippets = [];\n    }\n    dispose() {\n        dispose(this._snippets);\n    }\n    _logInfo() {\n        return `template=\"${this._template}\", merged_templates=\"${this._templateMerges.join(' -> ')}\"`;\n    }\n    insert() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // make insert edit and start with first selections\n        const { edits, snippets } = typeof this._template === 'string'\n            ? SnippetSession_1.createEditsAndSnippetsFromSelections(this._editor, this._template, this._options.overwriteBefore, this._options.overwriteAfter, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService)\n            : SnippetSession_1.createEditsAndSnippetsFromEdits(this._editor, this._template, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService);\n        this._snippets = snippets;\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            if (this._snippets[0].hasPlaceholder) {\n                return this._move(true);\n            }\n            else {\n                return undoEdits\n                    .map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n        this._editor.revealRange(this._editor.getSelections()[0]);\n    }\n    merge(template, options = _defaultOptions) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._templateMerges.push([this._snippets[0]._nestingLevel, this._snippets[0]._placeholderGroupsIdx, template]);\n        const { edits, snippets } = SnippetSession_1.createEditsAndSnippetsFromSelections(this._editor, template, options.overwriteBefore, options.overwriteAfter, true, options.adjustWhitespace, options.clipboardText, options.overtypingCapturer, this._languageConfigurationService);\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            // Trivial snippets have no placeholder or are just the final placeholder. That means they\n            // are just text insertions and we don't need to merge the nested snippet into the existing\n            // snippet\n            const isTrivialSnippet = snippets[0].isTrivialSnippet;\n            if (!isTrivialSnippet) {\n                for (const snippet of this._snippets) {\n                    snippet.merge(snippets);\n                }\n                console.assert(snippets.length === 0);\n            }\n            if (this._snippets[0].hasPlaceholder && !isTrivialSnippet) {\n                return this._move(undefined);\n            }\n            else {\n                return undoEdits.map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n    }\n    next() {\n        const newSelections = this._move(true);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    prev() {\n        const newSelections = this._move(false);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    _move(fwd) {\n        const selections = [];\n        for (const snippet of this._snippets) {\n            const oneSelection = snippet.move(fwd);\n            selections.push(...oneSelection);\n        }\n        return selections;\n    }\n    get isAtFirstPlaceholder() {\n        return this._snippets[0].isAtFirstPlaceholder;\n    }\n    get isAtLastPlaceholder() {\n        return this._snippets[0].isAtLastPlaceholder;\n    }\n    get hasPlaceholder() {\n        return this._snippets[0].hasPlaceholder;\n    }\n    get hasChoice() {\n        return this._snippets[0].hasChoice;\n    }\n    get activeChoice() {\n        return this._snippets[0].activeChoice;\n    }\n    isSelectionWithinPlaceholders() {\n        if (!this.hasPlaceholder) {\n            return false;\n        }\n        const selections = this._editor.getSelections();\n        if (selections.length < this._snippets.length) {\n            // this means we started snippet mode with N\n            // selections and have M (N > M) selections.\n            // So one snippet is without selection -> cancel\n            return false;\n        }\n        const allPossibleSelections = new Map();\n        for (const snippet of this._snippets) {\n            const possibleSelections = snippet.computePossibleSelections();\n            // for the first snippet find the placeholder (and its ranges)\n            // that contain at least one selection. for all remaining snippets\n            // the same placeholder (and their ranges) must be used.\n            if (allPossibleSelections.size === 0) {\n                for (const [index, ranges] of possibleSelections) {\n                    ranges.sort(Range.compareRangesUsingStarts);\n                    for (const selection of selections) {\n                        if (ranges[0].containsRange(selection)) {\n                            allPossibleSelections.set(index, []);\n                            break;\n                        }\n                    }\n                }\n            }\n            if (allPossibleSelections.size === 0) {\n                // return false if we couldn't associate a selection to\n                // this (the first) snippet\n                return false;\n            }\n            // add selections from 'this' snippet so that we know all\n            // selections for this placeholder\n            allPossibleSelections.forEach((array, index) => {\n                array.push(...possibleSelections.get(index));\n            });\n        }\n        // sort selections (and later placeholder-ranges). then walk both\n        // arrays and make sure the placeholder-ranges contain the corresponding\n        // selection\n        selections.sort(Range.compareRangesUsingStarts);\n        for (const [index, ranges] of allPossibleSelections) {\n            if (ranges.length !== selections.length) {\n                allPossibleSelections.delete(index);\n                continue;\n            }\n            ranges.sort(Range.compareRangesUsingStarts);\n            for (let i = 0; i < ranges.length; i++) {\n                if (!ranges[i].containsRange(selections[i])) {\n                    allPossibleSelections.delete(index);\n                    continue;\n                }\n            }\n        }\n        // from all possible selections we have deleted those\n        // that don't match with the current selection. if we don't\n        // have any left, we don't have a selection anymore\n        return allPossibleSelections.size > 0;\n    }\n};\nSnippetSession = SnippetSession_1 = __decorate([\n    __param(3, ILanguageConfigurationService)\n], SnippetSession);\nexport { SnippetSession };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './stickyScroll.css';\nimport { getColumnOfNodeOffset } from '../../../browser/viewParts/lines/viewLine.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Position } from '../../../common/core/position.js';\nimport { StringBuilder } from '../../../common/core/stringBuilder.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { foldingCollapsedIcon, foldingExpandedIcon } from '../../folding/browser/foldingDecorations.js';\nexport class StickyScrollWidgetState {\n    constructor(startLineNumbers, endLineNumbers, lastLineRelativePosition, showEndForLine = null) {\n        this.startLineNumbers = startLineNumbers;\n        this.endLineNumbers = endLineNumbers;\n        this.lastLineRelativePosition = lastLineRelativePosition;\n        this.showEndForLine = showEndForLine;\n    }\n    equals(other) {\n        return !!other\n            && this.lastLineRelativePosition === other.lastLineRelativePosition\n            && this.showEndForLine === other.showEndForLine\n            && equals(this.startLineNumbers, other.startLineNumbers)\n            && equals(this.endLineNumbers, other.endLineNumbers);\n    }\n}\nconst _ttPolicy = createTrustedTypesPolicy('stickyScrollViewLayer', { createHTML: value => value });\nconst STICKY_INDEX_ATTR = 'data-sticky-line-index';\nconst STICKY_IS_LINE_ATTR = 'data-sticky-is-line';\nconst STICKY_IS_LINE_NUMBER_ATTR = 'data-sticky-is-line-number';\nconst STICKY_IS_FOLDING_ICON_ATTR = 'data-sticky-is-folding-icon';\nexport class StickyScrollWidget extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._foldingIconStore = new DisposableStore();\n        this._rootDomNode = document.createElement('div');\n        this._lineNumbersDomNode = document.createElement('div');\n        this._linesDomNodeScrollable = document.createElement('div');\n        this._linesDomNode = document.createElement('div');\n        this._lineHeight = this._editor.getOption(66 /* EditorOption.lineHeight */);\n        this._stickyLines = [];\n        this._lineNumbers = [];\n        this._lastLineRelativePosition = 0;\n        this._minContentWidthInPx = 0;\n        this._isOnGlyphMargin = false;\n        this._lineNumbersDomNode.className = 'sticky-widget-line-numbers';\n        this._lineNumbersDomNode.setAttribute('role', 'none');\n        this._linesDomNode.className = 'sticky-widget-lines';\n        this._linesDomNode.setAttribute('role', 'list');\n        this._linesDomNodeScrollable.className = 'sticky-widget-lines-scrollable';\n        this._linesDomNodeScrollable.appendChild(this._linesDomNode);\n        this._rootDomNode.className = 'sticky-widget';\n        this._rootDomNode.classList.toggle('peek', _editor instanceof EmbeddedCodeEditorWidget);\n        this._rootDomNode.appendChild(this._lineNumbersDomNode);\n        this._rootDomNode.appendChild(this._linesDomNodeScrollable);\n        const updateScrollLeftPosition = () => {\n            this._linesDomNode.style.left = this._editor.getOption(114 /* EditorOption.stickyScroll */).scrollWithEditor ? `-${this._editor.getScrollLeft()}px` : '0px';\n        };\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(114 /* EditorOption.stickyScroll */)) {\n                updateScrollLeftPosition();\n            }\n            if (e.hasChanged(66 /* EditorOption.lineHeight */)) {\n                this._lineHeight = this._editor.getOption(66 /* EditorOption.lineHeight */);\n            }\n        }));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollLeftChanged) {\n                updateScrollLeftPosition();\n            }\n            if (e.scrollWidthChanged) {\n                this._updateWidgetWidth();\n            }\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            updateScrollLeftPosition();\n            this._updateWidgetWidth();\n        }));\n        this._register(this._foldingIconStore);\n        updateScrollLeftPosition();\n        this._register(this._editor.onDidLayoutChange((e) => {\n            this._updateWidgetWidth();\n        }));\n        this._updateWidgetWidth();\n    }\n    get lineNumbers() {\n        return this._lineNumbers;\n    }\n    get lineNumberCount() {\n        return this._lineNumbers.length;\n    }\n    getStickyLineForLine(lineNumber) {\n        return this._stickyLines.find(stickyLine => stickyLine.lineNumber === lineNumber);\n    }\n    getCurrentLines() {\n        return this._lineNumbers;\n    }\n    setState(state, foldingModel, rebuildFromLine = Infinity) {\n        if (((!this._previousState && !state) || (this._previousState && this._previousState.equals(state)))\n            && rebuildFromLine === Infinity) {\n            return;\n        }\n        this._previousState = state;\n        const previousStickyLines = this._stickyLines;\n        this._clearStickyWidget();\n        if (!state || !this._editor._getViewModel()) {\n            return;\n        }\n        const futureWidgetHeight = state.startLineNumbers.length * this._lineHeight + state.lastLineRelativePosition;\n        if (futureWidgetHeight > 0) {\n            this._lastLineRelativePosition = state.lastLineRelativePosition;\n            const lineNumbers = [...state.startLineNumbers];\n            if (state.showEndForLine !== null) {\n                lineNumbers[state.showEndForLine] = state.endLineNumbers[state.showEndForLine];\n            }\n            this._lineNumbers = lineNumbers;\n        }\n        else {\n            this._lastLineRelativePosition = 0;\n            this._lineNumbers = [];\n        }\n        this._renderRootNode(previousStickyLines, foldingModel, rebuildFromLine);\n    }\n    _updateWidgetWidth() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        const lineNumbersWidth = layoutInfo.contentLeft;\n        this._lineNumbersDomNode.style.width = `${lineNumbersWidth}px`;\n        this._linesDomNodeScrollable.style.setProperty('--vscode-editorStickyScroll-scrollableWidth', `${this._editor.getScrollWidth() - layoutInfo.verticalScrollbarWidth}px`);\n        this._rootDomNode.style.width = `${layoutInfo.width - layoutInfo.verticalScrollbarWidth}px`;\n    }\n    _clearStickyWidget() {\n        this._stickyLines = [];\n        this._foldingIconStore.clear();\n        dom.clearNode(this._lineNumbersDomNode);\n        dom.clearNode(this._linesDomNode);\n        this._rootDomNode.style.display = 'none';\n    }\n    _useFoldingOpacityTransition(requireTransitions) {\n        this._lineNumbersDomNode.style.setProperty('--vscode-editorStickyScroll-foldingOpacityTransition', `opacity ${requireTransitions ? 0.5 : 0}s`);\n    }\n    _setFoldingIconsVisibility(allVisible) {\n        for (const line of this._stickyLines) {\n            const foldingIcon = line.foldingIcon;\n            if (!foldingIcon) {\n                continue;\n            }\n            foldingIcon.setVisible(allVisible ? true : foldingIcon.isCollapsed);\n        }\n    }\n    _renderRootNode(previousStickyLines, foldingModel, rebuildFromLine = Infinity) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const layoutInfo = this._editor.getLayoutInfo();\n            for (const [index, line] of this._lineNumbers.entries()) {\n                const previousStickyLine = previousStickyLines[index];\n                const stickyLine = (line >= rebuildFromLine || (previousStickyLine === null || previousStickyLine === void 0 ? void 0 : previousStickyLine.lineNumber) !== line)\n                    ? this._renderChildNode(index, line, foldingModel, layoutInfo)\n                    : this._updateTopAndZIndexOfStickyLine(previousStickyLine);\n                if (!stickyLine) {\n                    continue;\n                }\n                this._linesDomNode.appendChild(stickyLine.lineDomNode);\n                this._lineNumbersDomNode.appendChild(stickyLine.lineNumberDomNode);\n                this._stickyLines.push(stickyLine);\n            }\n            if (foldingModel) {\n                this._setFoldingHoverListeners();\n                this._useFoldingOpacityTransition(!this._isOnGlyphMargin);\n            }\n            const widgetHeight = this._lineNumbers.length * this._lineHeight + this._lastLineRelativePosition;\n            if (widgetHeight === 0) {\n                this._clearStickyWidget();\n                return;\n            }\n            this._rootDomNode.style.display = 'block';\n            this._lineNumbersDomNode.style.height = `${widgetHeight}px`;\n            this._linesDomNodeScrollable.style.height = `${widgetHeight}px`;\n            this._rootDomNode.style.height = `${widgetHeight}px`;\n            this._rootDomNode.style.marginLeft = '0px';\n            this._updateMinContentWidth();\n            this._editor.layoutOverlayWidget(this);\n        });\n    }\n    _setFoldingHoverListeners() {\n        const showFoldingControls = this._editor.getOption(109 /* EditorOption.showFoldingControls */);\n        if (showFoldingControls !== 'mouseover') {\n            return;\n        }\n        this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_ENTER, (e) => {\n            this._isOnGlyphMargin = true;\n            this._setFoldingIconsVisibility(true);\n        }));\n        this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_LEAVE, () => {\n            this._isOnGlyphMargin = false;\n            this._useFoldingOpacityTransition(true);\n            this._setFoldingIconsVisibility(false);\n        }));\n    }\n    _renderChildNode(index, line, foldingModel, layoutInfo) {\n        const viewModel = this._editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        const viewLineNumber = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(line, 1)).lineNumber;\n        const lineRenderingData = viewModel.getViewLineRenderingData(viewLineNumber);\n        const lineNumberOption = this._editor.getOption(67 /* EditorOption.lineNumbers */);\n        let actualInlineDecorations;\n        try {\n            actualInlineDecorations = LineDecoration.filter(lineRenderingData.inlineDecorations, viewLineNumber, lineRenderingData.minColumn, lineRenderingData.maxColumn);\n        }\n        catch (err) {\n            actualInlineDecorations = [];\n        }\n        const renderLineInput = new RenderLineInput(true, true, lineRenderingData.content, lineRenderingData.continuesWithWrappedLine, lineRenderingData.isBasicASCII, lineRenderingData.containsRTL, 0, lineRenderingData.tokens, actualInlineDecorations, lineRenderingData.tabSize, lineRenderingData.startVisibleColumn, 1, 1, 1, 500, 'none', true, true, null);\n        const sb = new StringBuilder(2000);\n        const renderOutput = renderViewLine(renderLineInput, sb);\n        let newLine;\n        if (_ttPolicy) {\n            newLine = _ttPolicy.createHTML(sb.build());\n        }\n        else {\n            newLine = sb.build();\n        }\n        const lineHTMLNode = document.createElement('span');\n        lineHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n        lineHTMLNode.setAttribute(STICKY_IS_LINE_ATTR, '');\n        lineHTMLNode.setAttribute('role', 'listitem');\n        lineHTMLNode.tabIndex = 0;\n        lineHTMLNode.className = 'sticky-line-content';\n        lineHTMLNode.classList.add(`stickyLine${line}`);\n        lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineHTMLNode.innerHTML = newLine;\n        const lineNumberHTMLNode = document.createElement('span');\n        lineNumberHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n        lineNumberHTMLNode.setAttribute(STICKY_IS_LINE_NUMBER_ATTR, '');\n        lineNumberHTMLNode.className = 'sticky-line-number';\n        lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        const lineNumbersWidth = layoutInfo.contentLeft;\n        lineNumberHTMLNode.style.width = `${lineNumbersWidth}px`;\n        const innerLineNumberHTML = document.createElement('span');\n        if (lineNumberOption.renderType === 1 /* RenderLineNumbersType.On */ || lineNumberOption.renderType === 3 /* RenderLineNumbersType.Interval */ && line % 10 === 0) {\n            innerLineNumberHTML.innerText = line.toString();\n        }\n        else if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            innerLineNumberHTML.innerText = Math.abs(line - this._editor.getPosition().lineNumber).toString();\n        }\n        innerLineNumberHTML.className = 'sticky-line-number-inner';\n        innerLineNumberHTML.style.lineHeight = `${this._lineHeight}px`;\n        innerLineNumberHTML.style.width = `${layoutInfo.lineNumbersWidth}px`;\n        innerLineNumberHTML.style.paddingLeft = `${layoutInfo.lineNumbersLeft}px`;\n        lineNumberHTMLNode.appendChild(innerLineNumberHTML);\n        const foldingIcon = this._renderFoldingIconForLine(foldingModel, line);\n        if (foldingIcon) {\n            lineNumberHTMLNode.appendChild(foldingIcon.domNode);\n        }\n        this._editor.applyFontInfo(lineHTMLNode);\n        this._editor.applyFontInfo(innerLineNumberHTML);\n        lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineNumberHTMLNode.style.height = `${this._lineHeight}px`;\n        lineHTMLNode.style.height = `${this._lineHeight}px`;\n        const renderedLine = new RenderedStickyLine(index, line, lineHTMLNode, lineNumberHTMLNode, foldingIcon, renderOutput.characterMapping);\n        return this._updateTopAndZIndexOfStickyLine(renderedLine);\n    }\n    _updateTopAndZIndexOfStickyLine(stickyLine) {\n        var _a;\n        const index = stickyLine.index;\n        const lineHTMLNode = stickyLine.lineDomNode;\n        const lineNumberHTMLNode = stickyLine.lineNumberDomNode;\n        const isLastLine = index === this._lineNumbers.length - 1;\n        const lastLineZIndex = '0';\n        const intermediateLineZIndex = '1';\n        lineHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n        lineNumberHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n        const lastLineTop = `${index * this._lineHeight + this._lastLineRelativePosition + (((_a = stickyLine.foldingIcon) === null || _a === void 0 ? void 0 : _a.isCollapsed) ? 1 : 0)}px`;\n        const intermediateLineTop = `${index * this._lineHeight}px`;\n        lineHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n        lineNumberHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n        return stickyLine;\n    }\n    _renderFoldingIconForLine(foldingModel, line) {\n        const showFoldingControls = this._editor.getOption(109 /* EditorOption.showFoldingControls */);\n        if (!foldingModel || showFoldingControls === 'never') {\n            return;\n        }\n        const foldingRegions = foldingModel.regions;\n        const indexOfFoldingRegion = foldingRegions.findRange(line);\n        const startLineNumber = foldingRegions.getStartLineNumber(indexOfFoldingRegion);\n        const isFoldingScope = line === startLineNumber;\n        if (!isFoldingScope) {\n            return;\n        }\n        const isCollapsed = foldingRegions.isCollapsed(indexOfFoldingRegion);\n        const foldingIcon = new StickyFoldingIcon(isCollapsed, startLineNumber, foldingRegions.getEndLineNumber(indexOfFoldingRegion), this._lineHeight);\n        foldingIcon.setVisible(this._isOnGlyphMargin ? true : (isCollapsed || showFoldingControls === 'always'));\n        foldingIcon.domNode.setAttribute(STICKY_IS_FOLDING_ICON_ATTR, '');\n        return foldingIcon;\n    }\n    _updateMinContentWidth() {\n        this._minContentWidthInPx = 0;\n        for (const stickyLine of this._stickyLines) {\n            if (stickyLine.lineDomNode.scrollWidth > this._minContentWidthInPx) {\n                this._minContentWidthInPx = stickyLine.lineDomNode.scrollWidth;\n            }\n        }\n        this._minContentWidthInPx += this._editor.getLayoutInfo().verticalScrollbarWidth;\n    }\n    getId() {\n        return 'editor.contrib.stickyScrollWidget';\n    }\n    getDomNode() {\n        return this._rootDomNode;\n    }\n    getPosition() {\n        return {\n            preference: null\n        };\n    }\n    getMinContentWidthInPx() {\n        return this._minContentWidthInPx;\n    }\n    focusLineWithIndex(index) {\n        if (0 <= index && index < this._stickyLines.length) {\n            this._stickyLines[index].lineDomNode.focus();\n        }\n    }\n    /**\n     * Given a leaf dom node, tries to find the editor position.\n     */\n    getEditorPositionFromNode(spanDomNode) {\n        if (!spanDomNode || spanDomNode.children.length > 0) {\n            // This is not a leaf node\n            return null;\n        }\n        const renderedStickyLine = this._getRenderedStickyLineFromChildDomNode(spanDomNode);\n        if (!renderedStickyLine) {\n            return null;\n        }\n        const column = getColumnOfNodeOffset(renderedStickyLine.characterMapping, spanDomNode, 0);\n        return new Position(renderedStickyLine.lineNumber, column);\n    }\n    getLineNumberFromChildDomNode(domNode) {\n        var _a, _b;\n        return (_b = (_a = this._getRenderedStickyLineFromChildDomNode(domNode)) === null || _a === void 0 ? void 0 : _a.lineNumber) !== null && _b !== void 0 ? _b : null;\n    }\n    _getRenderedStickyLineFromChildDomNode(domNode) {\n        const index = this.getLineIndexFromChildDomNode(domNode);\n        if (index === null || index < 0 || index >= this._stickyLines.length) {\n            return null;\n        }\n        return this._stickyLines[index];\n    }\n    /**\n     * Given a child dom node, tries to find the line number attribute that was stored in the node.\n     * @returns the attribute value or null if none is found.\n     */\n    getLineIndexFromChildDomNode(domNode) {\n        const lineIndex = this._getAttributeValue(domNode, STICKY_INDEX_ATTR);\n        return lineIndex ? parseInt(lineIndex, 10) : null;\n    }\n    /**\n     * Given a child dom node, tries to find if it is (contained in) a sticky line.\n     * @returns a boolean.\n     */\n    isInStickyLine(domNode) {\n        const isInLine = this._getAttributeValue(domNode, STICKY_IS_LINE_ATTR);\n        return isInLine !== undefined;\n    }\n    /**\n     * Given a child dom node, tries to find if this dom node is (contained in) a sticky folding icon.\n     * @returns a boolean.\n     */\n    isInFoldingIconDomNode(domNode) {\n        const isInFoldingIcon = this._getAttributeValue(domNode, STICKY_IS_FOLDING_ICON_ATTR);\n        return isInFoldingIcon !== undefined;\n    }\n    /**\n     * Given the dom node, finds if it or its parent sequence contains the given attribute.\n     * @returns the attribute value or undefined.\n     */\n    _getAttributeValue(domNode, attribute) {\n        while (domNode && domNode !== this._rootDomNode) {\n            const line = domNode.getAttribute(attribute);\n            if (line !== null) {\n                return line;\n            }\n            domNode = domNode.parentElement;\n        }\n        return;\n    }\n}\nclass RenderedStickyLine {\n    constructor(index, lineNumber, lineDomNode, lineNumberDomNode, foldingIcon, characterMapping) {\n        this.index = index;\n        this.lineNumber = lineNumber;\n        this.lineDomNode = lineDomNode;\n        this.lineNumberDomNode = lineNumberDomNode;\n        this.foldingIcon = foldingIcon;\n        this.characterMapping = characterMapping;\n    }\n}\nclass StickyFoldingIcon {\n    constructor(isCollapsed, foldingStartLine, foldingEndLine, dimension) {\n        this.isCollapsed = isCollapsed;\n        this.foldingStartLine = foldingStartLine;\n        this.foldingEndLine = foldingEndLine;\n        this.dimension = dimension;\n        this.domNode = document.createElement('div');\n        this.domNode.style.width = `${dimension}px`;\n        this.domNode.style.height = `${dimension}px`;\n        this.domNode.className = ThemeIcon.asClassName(isCollapsed ? foldingCollapsedIcon : foldingExpandedIcon);\n    }\n    setVisible(visible) {\n        this.domNode.style.cursor = visible ? 'pointer' : 'default';\n        this.domNode.style.opacity = visible ? '1' : '0';\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class StickyRange {\n    constructor(startLineNumber, endLineNumber) {\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n    }\n}\nexport class StickyElement {\n    constructor(\n    /**\n     * Range of line numbers spanned by the current scope\n     */\n    range, \n    /**\n     * Must be sorted by start line number\n    */\n    children, \n    /**\n     * Parent sticky outline element\n     */\n    parent) {\n        this.range = range;\n        this.children = children;\n        this.parent = parent;\n    }\n}\nexport class StickyModel {\n    constructor(uri, version, element, outlineProviderId) {\n        this.uri = uri;\n        this.version = version;\n        this.element = element;\n        this.outlineProviderId = outlineProviderId;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { OutlineElement, OutlineGroup, OutlineModel } from '../../documentSymbols/browser/outlineModel.js';\nimport { createCancelablePromise, Delayer } from '../../../../base/common/async.js';\nimport { FoldingController, RangesLimitReporter } from '../../folding/browser/folding.js';\nimport { SyntaxRangeProvider } from '../../folding/browser/syntaxRangeProvider.js';\nimport { IndentRangeProvider } from '../../folding/browser/indentRangeProvider.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { StickyElement, StickyModel, StickyRange } from './stickyScrollElement.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nvar ModelProvider;\n(function (ModelProvider) {\n    ModelProvider[\"OUTLINE_MODEL\"] = \"outlineModel\";\n    ModelProvider[\"FOLDING_PROVIDER_MODEL\"] = \"foldingProviderModel\";\n    ModelProvider[\"INDENTATION_MODEL\"] = \"indentationModel\";\n})(ModelProvider || (ModelProvider = {}));\nvar Status;\n(function (Status) {\n    Status[Status[\"VALID\"] = 0] = \"VALID\";\n    Status[Status[\"INVALID\"] = 1] = \"INVALID\";\n    Status[Status[\"CANCELED\"] = 2] = \"CANCELED\";\n})(Status || (Status = {}));\nlet StickyModelProvider = class StickyModelProvider extends Disposable {\n    constructor(_editor, _languageConfigurationService, _languageFeaturesService, defaultModel) {\n        super();\n        this._editor = _editor;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._modelProviders = [];\n        this._modelPromise = null;\n        this._updateScheduler = this._register(new Delayer(300));\n        this._updateOperation = this._register(new DisposableStore());\n        const stickyModelFromCandidateOutlineProvider = new StickyModelFromCandidateOutlineProvider(_languageFeaturesService);\n        const stickyModelFromSyntaxFoldingProvider = new StickyModelFromCandidateSyntaxFoldingProvider(this._editor, _languageFeaturesService);\n        const stickyModelFromIndentationFoldingProvider = new StickyModelFromCandidateIndentationFoldingProvider(this._editor, _languageConfigurationService);\n        switch (defaultModel) {\n            case ModelProvider.OUTLINE_MODEL:\n                this._modelProviders.push(stickyModelFromCandidateOutlineProvider);\n                this._modelProviders.push(stickyModelFromSyntaxFoldingProvider);\n                this._modelProviders.push(stickyModelFromIndentationFoldingProvider);\n                break;\n            case ModelProvider.FOLDING_PROVIDER_MODEL:\n                this._modelProviders.push(stickyModelFromSyntaxFoldingProvider);\n                this._modelProviders.push(stickyModelFromIndentationFoldingProvider);\n                break;\n            case ModelProvider.INDENTATION_MODEL:\n                this._modelProviders.push(stickyModelFromIndentationFoldingProvider);\n                break;\n        }\n    }\n    _cancelModelPromise() {\n        if (this._modelPromise) {\n            this._modelPromise.cancel();\n            this._modelPromise = null;\n        }\n    }\n    update(textModel, textModelVersionId, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._updateOperation.clear();\n            this._updateOperation.add({\n                dispose: () => {\n                    this._cancelModelPromise();\n                    this._updateScheduler.cancel();\n                }\n            });\n            this._cancelModelPromise();\n            return yield this._updateScheduler.trigger(() => __awaiter(this, void 0, void 0, function* () {\n                for (const modelProvider of this._modelProviders) {\n                    const { statusPromise, modelPromise } = modelProvider.computeStickyModel(textModel, textModelVersionId, token);\n                    this._modelPromise = modelPromise;\n                    const status = yield statusPromise;\n                    if (this._modelPromise !== modelPromise) {\n                        return null;\n                    }\n                    switch (status) {\n                        case Status.CANCELED:\n                            this._updateOperation.clear();\n                            return null;\n                        case Status.VALID:\n                            return modelProvider.stickyModel;\n                    }\n                }\n                return null;\n            })).catch((error) => {\n                onUnexpectedError(error);\n                return null;\n            });\n        });\n    }\n};\nStickyModelProvider = __decorate([\n    __param(1, ILanguageConfigurationService),\n    __param(2, ILanguageFeaturesService)\n], StickyModelProvider);\nexport { StickyModelProvider };\nclass StickyModelCandidateProvider {\n    constructor() {\n        this._stickyModel = null;\n    }\n    get stickyModel() {\n        return this._stickyModel;\n    }\n    _invalid() {\n        this._stickyModel = null;\n        return Status.INVALID;\n    }\n    computeStickyModel(textModel, modelVersionId, token) {\n        if (token.isCancellationRequested || !this.isProviderValid(textModel)) {\n            return { statusPromise: this._invalid(), modelPromise: null };\n        }\n        const providerModelPromise = createCancelablePromise(token => this.createModelFromProvider(textModel, modelVersionId, token));\n        return {\n            statusPromise: providerModelPromise.then(providerModel => {\n                if (!this.isModelValid(providerModel)) {\n                    return this._invalid();\n                }\n                if (token.isCancellationRequested) {\n                    return Status.CANCELED;\n                }\n                this._stickyModel = this.createStickyModel(textModel, modelVersionId, token, providerModel);\n                return Status.VALID;\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return Status.CANCELED;\n            }),\n            modelPromise: providerModelPromise\n        };\n    }\n    /**\n     * Method which checks whether the model returned by the provider is valid and can be used to compute a sticky model.\n     * This method by default returns true.\n     * @param model model returned by the provider\n     * @returns boolean indicating whether the model is valid\n     */\n    isModelValid(model) {\n        return true;\n    }\n    /**\n     * Method which checks whether the provider is valid before applying it to find the provider model.\n     * This method by default returns true.\n     * @param textModel text-model of the editor\n     * @returns boolean indicating whether the provider is valid\n     */\n    isProviderValid(textModel) {\n        return true;\n    }\n}\nlet StickyModelFromCandidateOutlineProvider = class StickyModelFromCandidateOutlineProvider extends StickyModelCandidateProvider {\n    constructor(_languageFeaturesService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n    }\n    createModelFromProvider(textModel, modelVersionId, token) {\n        return OutlineModel.create(this._languageFeaturesService.documentSymbolProvider, textModel, token);\n    }\n    createStickyModel(textModel, modelVersionId, token, model) {\n        var _a;\n        const { stickyOutlineElement, providerID } = this._stickyModelFromOutlineModel(model, (_a = this._stickyModel) === null || _a === void 0 ? void 0 : _a.outlineProviderId);\n        return new StickyModel(textModel.uri, modelVersionId, stickyOutlineElement, providerID);\n    }\n    isModelValid(model) {\n        return model && model.children.size > 0;\n    }\n    _stickyModelFromOutlineModel(outlineModel, preferredProvider) {\n        let outlineElements;\n        // When several possible outline providers\n        if (Iterable.first(outlineModel.children.values()) instanceof OutlineGroup) {\n            const provider = Iterable.find(outlineModel.children.values(), outlineGroupOfModel => outlineGroupOfModel.id === preferredProvider);\n            if (provider) {\n                outlineElements = provider.children;\n            }\n            else {\n                let tempID = '';\n                let maxTotalSumOfRanges = -1;\n                let optimalOutlineGroup = undefined;\n                for (const [_key, outlineGroup] of outlineModel.children.entries()) {\n                    const totalSumRanges = this._findSumOfRangesOfGroup(outlineGroup);\n                    if (totalSumRanges > maxTotalSumOfRanges) {\n                        optimalOutlineGroup = outlineGroup;\n                        maxTotalSumOfRanges = totalSumRanges;\n                        tempID = outlineGroup.id;\n                    }\n                }\n                preferredProvider = tempID;\n                outlineElements = optimalOutlineGroup.children;\n            }\n        }\n        else {\n            outlineElements = outlineModel.children;\n        }\n        const stickyChildren = [];\n        const outlineElementsArray = Array.from(outlineElements.values()).sort((element1, element2) => {\n            const range1 = new StickyRange(element1.symbol.range.startLineNumber, element1.symbol.range.endLineNumber);\n            const range2 = new StickyRange(element2.symbol.range.startLineNumber, element2.symbol.range.endLineNumber);\n            return this._comparator(range1, range2);\n        });\n        for (const outlineElement of outlineElementsArray) {\n            stickyChildren.push(this._stickyModelFromOutlineElement(outlineElement, outlineElement.symbol.selectionRange.startLineNumber));\n        }\n        const stickyOutlineElement = new StickyElement(undefined, stickyChildren, undefined);\n        return {\n            stickyOutlineElement: stickyOutlineElement,\n            providerID: preferredProvider\n        };\n    }\n    _stickyModelFromOutlineElement(outlineElement, previousStartLine) {\n        const children = [];\n        for (const child of outlineElement.children.values()) {\n            if (child.symbol.selectionRange.startLineNumber !== child.symbol.range.endLineNumber) {\n                if (child.symbol.selectionRange.startLineNumber !== previousStartLine) {\n                    children.push(this._stickyModelFromOutlineElement(child, child.symbol.selectionRange.startLineNumber));\n                }\n                else {\n                    for (const subchild of child.children.values()) {\n                        children.push(this._stickyModelFromOutlineElement(subchild, child.symbol.selectionRange.startLineNumber));\n                    }\n                }\n            }\n        }\n        children.sort((child1, child2) => this._comparator(child1.range, child2.range));\n        const range = new StickyRange(outlineElement.symbol.selectionRange.startLineNumber, outlineElement.symbol.range.endLineNumber);\n        return new StickyElement(range, children, undefined);\n    }\n    _comparator(range1, range2) {\n        if (range1.startLineNumber !== range2.startLineNumber) {\n            return range1.startLineNumber - range2.startLineNumber;\n        }\n        else {\n            return range2.endLineNumber - range1.endLineNumber;\n        }\n    }\n    _findSumOfRangesOfGroup(outline) {\n        let res = 0;\n        for (const child of outline.children.values()) {\n            res += this._findSumOfRangesOfGroup(child);\n        }\n        if (outline instanceof OutlineElement) {\n            return res + outline.symbol.range.endLineNumber - outline.symbol.selectionRange.startLineNumber;\n        }\n        else {\n            return res;\n        }\n    }\n};\nStickyModelFromCandidateOutlineProvider = __decorate([\n    __param(0, ILanguageFeaturesService)\n], StickyModelFromCandidateOutlineProvider);\nclass StickyModelFromCandidateFoldingProvider extends StickyModelCandidateProvider {\n    constructor(editor) {\n        super();\n        this._foldingLimitReporter = new RangesLimitReporter(editor);\n    }\n    createStickyModel(textModel, modelVersionId, token, model) {\n        const foldingElement = this._fromFoldingRegions(model);\n        return new StickyModel(textModel.uri, modelVersionId, foldingElement, undefined);\n    }\n    isModelValid(model) {\n        return model !== null;\n    }\n    _fromFoldingRegions(foldingRegions) {\n        const length = foldingRegions.length;\n        const orderedStickyElements = [];\n        // The root sticky outline element\n        const stickyOutlineElement = new StickyElement(undefined, [], undefined);\n        for (let i = 0; i < length; i++) {\n            // Finding the parent index of the current range\n            const parentIndex = foldingRegions.getParentIndex(i);\n            let parentNode;\n            if (parentIndex !== -1) {\n                // Access the reference of the parent node\n                parentNode = orderedStickyElements[parentIndex];\n            }\n            else {\n                // In that case the parent node is the root node\n                parentNode = stickyOutlineElement;\n            }\n            const child = new StickyElement(new StickyRange(foldingRegions.getStartLineNumber(i), foldingRegions.getEndLineNumber(i) + 1), [], parentNode);\n            parentNode.children.push(child);\n            orderedStickyElements.push(child);\n        }\n        return stickyOutlineElement;\n    }\n}\nlet StickyModelFromCandidateIndentationFoldingProvider = class StickyModelFromCandidateIndentationFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n    constructor(editor, _languageConfigurationService) {\n        super(editor);\n        this._languageConfigurationService = _languageConfigurationService;\n    }\n    createModelFromProvider(textModel, modelVersionId, token) {\n        const provider = new IndentRangeProvider(textModel, this._languageConfigurationService, this._foldingLimitReporter);\n        return provider.compute(token);\n    }\n};\nStickyModelFromCandidateIndentationFoldingProvider = __decorate([\n    __param(1, ILanguageConfigurationService)\n], StickyModelFromCandidateIndentationFoldingProvider);\nlet StickyModelFromCandidateSyntaxFoldingProvider = class StickyModelFromCandidateSyntaxFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n    constructor(editor, _languageFeaturesService) {\n        super(editor);\n        this._languageFeaturesService = _languageFeaturesService;\n    }\n    isProviderValid(textModel) {\n        const selectedProviders = FoldingController.getFoldingRangeProviders(this._languageFeaturesService, textModel);\n        return selectedProviders.length > 0;\n    }\n    createModelFromProvider(textModel, modelVersionId, token) {\n        const selectedProviders = FoldingController.getFoldingRangeProviders(this._languageFeaturesService, textModel);\n        const provider = new SyntaxRangeProvider(textModel, selectedProviders, () => this.createModelFromProvider(textModel, modelVersionId, token), this._foldingLimitReporter, undefined);\n        return provider.compute(token);\n    }\n};\nStickyModelFromCandidateSyntaxFoldingProvider = __decorate([\n    __param(1, ILanguageFeaturesService)\n], StickyModelFromCandidateSyntaxFoldingProvider);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { StickyModelProvider } from './stickyScrollModelProvider.js';\nexport class StickyLineCandidate {\n    constructor(startLineNumber, endLineNumber, nestingDepth) {\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n        this.nestingDepth = nestingDepth;\n    }\n}\nlet StickyLineCandidateProvider = class StickyLineCandidateProvider extends Disposable {\n    constructor(editor, _languageFeaturesService, _languageConfigurationService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._onDidChangeStickyScroll = this._register(new Emitter());\n        this.onDidChangeStickyScroll = this._onDidChangeStickyScroll.event;\n        this._options = null;\n        this._model = null;\n        this._cts = null;\n        this._stickyModelProvider = null;\n        this._editor = editor;\n        this._sessionStore = this._register(new DisposableStore());\n        this._updateSoon = this._register(new RunOnceScheduler(() => this.update(), 50));\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(114 /* EditorOption.stickyScroll */)) {\n                this.readConfiguration();\n            }\n        }));\n        this.readConfiguration();\n    }\n    readConfiguration() {\n        this._stickyModelProvider = null;\n        this._sessionStore.clear();\n        this._options = this._editor.getOption(114 /* EditorOption.stickyScroll */);\n        if (!this._options.enabled) {\n            return;\n        }\n        this._stickyModelProvider = this._sessionStore.add(new StickyModelProvider(this._editor, this._languageConfigurationService, this._languageFeaturesService, this._options.defaultModel));\n        this._sessionStore.add(this._editor.onDidChangeModel(() => {\n            // We should not show an old model for a different file, it will always be wrong.\n            // So we clear the model here immediately and then trigger an update.\n            this._model = null;\n            this._onDidChangeStickyScroll.fire();\n            this.update();\n        }));\n        this._sessionStore.add(this._editor.onDidChangeHiddenAreas(() => this.update()));\n        this._sessionStore.add(this._editor.onDidChangeModelContent(() => this._updateSoon.schedule()));\n        this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => this.update()));\n        this.update();\n    }\n    getVersionId() {\n        var _a;\n        return (_a = this._model) === null || _a === void 0 ? void 0 : _a.version;\n    }\n    update() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            (_a = this._cts) === null || _a === void 0 ? void 0 : _a.dispose(true);\n            this._cts = new CancellationTokenSource();\n            yield this.updateStickyModel(this._cts.token);\n            this._onDidChangeStickyScroll.fire();\n        });\n    }\n    updateStickyModel(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._stickyModelProvider || this._editor.getModel().isTooLargeForTokenization()) {\n                this._model = null;\n                return;\n            }\n            const textModel = this._editor.getModel();\n            const modelVersionId = textModel.getVersionId();\n            const model = yield this._stickyModelProvider.update(textModel, modelVersionId, token);\n            if (token.isCancellationRequested) {\n                // the computation was canceled, so do not overwrite the model\n                return;\n            }\n            this._model = model;\n        });\n    }\n    updateIndex(index) {\n        if (index === -1) {\n            index = 0;\n        }\n        else if (index < 0) {\n            index = -index - 2;\n        }\n        return index;\n    }\n    getCandidateStickyLinesIntersectingFromStickyModel(range, outlineModel, result, depth, lastStartLineNumber) {\n        if (outlineModel.children.length === 0) {\n            return;\n        }\n        let lastLine = lastStartLineNumber;\n        const childrenStartLines = [];\n        for (let i = 0; i < outlineModel.children.length; i++) {\n            const child = outlineModel.children[i];\n            if (child.range) {\n                childrenStartLines.push(child.range.startLineNumber);\n            }\n        }\n        const lowerBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber, (a, b) => { return a - b; }));\n        const upperBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber + depth, (a, b) => { return a - b; }));\n        for (let i = lowerBound; i <= upperBound; i++) {\n            const child = outlineModel.children[i];\n            if (!child) {\n                return;\n            }\n            if (child.range) {\n                const childStartLine = child.range.startLineNumber;\n                const childEndLine = child.range.endLineNumber;\n                if (range.startLineNumber <= childEndLine + 1 && childStartLine - 1 <= range.endLineNumber && childStartLine !== lastLine) {\n                    lastLine = childStartLine;\n                    result.push(new StickyLineCandidate(childStartLine, childEndLine - 1, depth + 1));\n                    this.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth + 1, childStartLine);\n                }\n            }\n            else {\n                this.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth, lastStartLineNumber);\n            }\n        }\n    }\n    getCandidateStickyLinesIntersecting(range) {\n        var _a, _b;\n        if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.element)) {\n            return [];\n        }\n        let stickyLineCandidates = [];\n        this.getCandidateStickyLinesIntersectingFromStickyModel(range, this._model.element, stickyLineCandidates, 0, -1);\n        const hiddenRanges = (_b = this._editor._getViewModel()) === null || _b === void 0 ? void 0 : _b.getHiddenAreas();\n        if (hiddenRanges) {\n            for (const hiddenRange of hiddenRanges) {\n                stickyLineCandidates = stickyLineCandidates.filter(stickyLine => !(stickyLine.startLineNumber >= hiddenRange.startLineNumber && stickyLine.endLineNumber <= hiddenRange.endLineNumber + 1));\n            }\n        }\n        return stickyLineCandidates;\n    }\n};\nStickyLineCandidateProvider = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageConfigurationService)\n], StickyLineCandidateProvider);\nexport { StickyLineCandidateProvider };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar StickyScrollController_1;\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { FoldingController } from '../../folding/browser/folding.js';\nimport { toggleCollapseState } from '../../folding/browser/foldingModel.js';\nlet StickyScrollController = StickyScrollController_1 = class StickyScrollController extends Disposable {\n    constructor(_editor, _contextMenuService, _languageFeaturesService, _instaService, _languageConfigurationService, _languageFeatureDebounceService, _contextKeyService) {\n        super();\n        this._editor = _editor;\n        this._contextMenuService = _contextMenuService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instaService = _instaService;\n        this._contextKeyService = _contextKeyService;\n        this._sessionStore = new DisposableStore();\n        this._foldingModel = null;\n        this._maxStickyLines = Number.MAX_SAFE_INTEGER;\n        this._candidateDefinitionsLength = -1;\n        this._focusedStickyElementIndex = -1;\n        this._enabled = false;\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n        this._endLineNumbers = [];\n        this._showEndForLine = null;\n        this._stickyScrollWidget = new StickyScrollWidget(this._editor);\n        this._stickyLineCandidateProvider = new StickyLineCandidateProvider(this._editor, _languageFeaturesService, _languageConfigurationService);\n        this._register(this._stickyScrollWidget);\n        this._register(this._stickyLineCandidateProvider);\n        this._widgetState = new StickyScrollWidgetState([], [], 0);\n        this._readConfiguration();\n        const stickyScrollDomNode = this._stickyScrollWidget.getDomNode();\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(114 /* EditorOption.stickyScroll */)\n                || e.hasChanged(72 /* EditorOption.minimap */)\n                || e.hasChanged(66 /* EditorOption.lineHeight */)\n                || e.hasChanged(109 /* EditorOption.showFoldingControls */)) {\n                this._readConfiguration();\n            }\n        }));\n        this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.CONTEXT_MENU, (event) => __awaiter(this, void 0, void 0, function* () {\n            this._onContextMenu(event);\n        })));\n        this._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService);\n        this._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);\n        const focusTracker = this._register(dom.trackFocus(stickyScrollDomNode));\n        this._register(focusTracker.onDidBlur(_ => {\n            // Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n            // This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n            if (this._positionRevealed === false && stickyScrollDomNode.clientHeight === 0) {\n                this._focusedStickyElementIndex = -1;\n                this.focus();\n            }\n            // In all other casees, dispose the focus on the sticky scroll\n            else {\n                this._disposeFocusStickyScrollStore();\n            }\n        }));\n        this._register(focusTracker.onDidFocus(_ => {\n            this.focus();\n        }));\n        this._registerMouseListeners();\n        // Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n        this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.MOUSE_DOWN, (e) => {\n            this._onMouseDown = true;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(StickyScrollController_1.ID);\n    }\n    _disposeFocusStickyScrollStore() {\n        var _a;\n        this._stickyScrollFocusedContextKey.set(false);\n        (_a = this._focusDisposableStore) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n    }\n    focus() {\n        // If the mouse is down, do not focus on the sticky scroll\n        if (this._onMouseDown) {\n            this._onMouseDown = false;\n            this._editor.focus();\n            return;\n        }\n        const focusState = this._stickyScrollFocusedContextKey.get();\n        if (focusState === true) {\n            return;\n        }\n        this._focused = true;\n        this._focusDisposableStore = new DisposableStore();\n        this._stickyScrollFocusedContextKey.set(true);\n        this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n    focusNext() {\n        if (this._focusedStickyElementIndex < this._stickyScrollWidget.lineNumberCount - 1) {\n            this._focusNav(true);\n        }\n    }\n    focusPrevious() {\n        if (this._focusedStickyElementIndex > 0) {\n            this._focusNav(false);\n        }\n    }\n    selectEditor() {\n        this._editor.focus();\n    }\n    // True is next, false is previous\n    _focusNav(direction) {\n        this._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n    goToFocused() {\n        const lineNumbers = this._stickyScrollWidget.lineNumbers;\n        this._disposeFocusStickyScrollStore();\n        this._revealPosition({ lineNumber: lineNumbers[this._focusedStickyElementIndex], column: 1 });\n    }\n    _revealPosition(position) {\n        this._reveaInEditor(position, () => this._editor.revealPosition(position));\n    }\n    _revealLineInCenterIfOutsideViewport(position) {\n        this._reveaInEditor(position, () => this._editor.revealLineInCenterIfOutsideViewport(position.lineNumber, 0 /* ScrollType.Smooth */));\n    }\n    _reveaInEditor(position, revealFunction) {\n        if (this._focused) {\n            this._disposeFocusStickyScrollStore();\n        }\n        this._positionRevealed = true;\n        revealFunction();\n        this._editor.setSelection(Range.fromPositions(position));\n        this._editor.focus();\n    }\n    _registerMouseListeners() {\n        const sessionStore = this._register(new DisposableStore());\n        const gesture = this._register(new ClickLinkGesture(this._editor, {\n            extractLineNumberFromMouseEvent: (e) => {\n                const position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n                return position ? position.lineNumber : 0;\n            }\n        }));\n        const getMouseEventTarget = (mouseEvent) => {\n            if (!this._editor.hasModel()) {\n                return null;\n            }\n            if (mouseEvent.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || mouseEvent.target.detail !== this._stickyScrollWidget.getId()) {\n                // not hovering over our widget\n                return null;\n            }\n            const mouseTargetElement = mouseEvent.target.element;\n            if (!mouseTargetElement || mouseTargetElement.innerText !== mouseTargetElement.innerHTML) {\n                // not on a span element rendering text\n                return null;\n            }\n            const position = this._stickyScrollWidget.getEditorPositionFromNode(mouseTargetElement);\n            if (!position) {\n                // not hovering a sticky scroll line\n                return null;\n            }\n            return {\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column + mouseTargetElement.innerText.length),\n                textElement: mouseTargetElement\n            };\n        };\n        const stickyScrollWidgetDomNode = this._stickyScrollWidget.getDomNode();\n        this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.CLICK, (mouseEvent) => {\n            if (mouseEvent.ctrlKey || mouseEvent.altKey || mouseEvent.metaKey) {\n                // modifier pressed\n                return;\n            }\n            if (!mouseEvent.leftButton) {\n                // not left click\n                return;\n            }\n            if (mouseEvent.shiftKey) {\n                // shift click\n                const lineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n                if (lineIndex === null) {\n                    return;\n                }\n                const position = new Position(this._endLineNumbers[lineIndex], 1);\n                this._revealLineInCenterIfOutsideViewport(position);\n                return;\n            }\n            const isInFoldingIconDomNode = this._stickyScrollWidget.isInFoldingIconDomNode(mouseEvent.target);\n            if (isInFoldingIconDomNode) {\n                // clicked on folding icon\n                const lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n                this._toggleFoldingRegionForLine(lineNumber);\n                return;\n            }\n            const isInStickyLine = this._stickyScrollWidget.isInStickyLine(mouseEvent.target);\n            if (!isInStickyLine) {\n                return;\n            }\n            // normal click\n            let position = this._stickyScrollWidget.getEditorPositionFromNode(mouseEvent.target);\n            if (!position) {\n                const lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n                if (lineNumber === null) {\n                    // not hovering a sticky scroll line\n                    return;\n                }\n                position = new Position(lineNumber, 1);\n            }\n            this._revealPosition(position);\n        }));\n        this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_MOVE, (mouseEvent) => {\n            if (mouseEvent.shiftKey) {\n                const currentEndForLineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n                if (currentEndForLineIndex === null || this._showEndForLine !== null && this._showEndForLine === currentEndForLineIndex) {\n                    return;\n                }\n                this._showEndForLine = currentEndForLineIndex;\n                this._renderStickyScroll();\n                return;\n            }\n            if (this._showEndForLine !== null) {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }\n        }));\n        this._register(dom.addDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_LEAVE, (e) => {\n            if (this._showEndForLine !== null) {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }\n        }));\n        this._register(gesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, _keyboardEvent]) => {\n            const mouseTarget = getMouseEventTarget(mouseEvent);\n            if (!mouseTarget || !mouseEvent.hasTriggerModifier || !this._editor.hasModel()) {\n                sessionStore.clear();\n                return;\n            }\n            const { range, textElement } = mouseTarget;\n            if (!range.equalsRange(this._stickyRangeProjectedOnEditor)) {\n                this._stickyRangeProjectedOnEditor = range;\n                sessionStore.clear();\n            }\n            else if (textElement.style.textDecoration === 'underline') {\n                return;\n            }\n            const cancellationToken = new CancellationTokenSource();\n            sessionStore.add(toDisposable(() => cancellationToken.dispose(true)));\n            let currentHTMLChild;\n            getDefinitionsAtPosition(this._languageFeaturesService.definitionProvider, this._editor.getModel(), new Position(range.startLineNumber, range.startColumn + 1), cancellationToken.token).then((candidateDefinitions => {\n                if (cancellationToken.token.isCancellationRequested) {\n                    return;\n                }\n                if (candidateDefinitions.length !== 0) {\n                    this._candidateDefinitionsLength = candidateDefinitions.length;\n                    const childHTML = textElement;\n                    if (currentHTMLChild !== childHTML) {\n                        sessionStore.clear();\n                        currentHTMLChild = childHTML;\n                        currentHTMLChild.style.textDecoration = 'underline';\n                        sessionStore.add(toDisposable(() => {\n                            currentHTMLChild.style.textDecoration = 'none';\n                        }));\n                    }\n                    else if (!currentHTMLChild) {\n                        currentHTMLChild = childHTML;\n                        currentHTMLChild.style.textDecoration = 'underline';\n                        sessionStore.add(toDisposable(() => {\n                            currentHTMLChild.style.textDecoration = 'none';\n                        }));\n                    }\n                }\n                else {\n                    sessionStore.clear();\n                }\n            }));\n        }));\n        this._register(gesture.onCancel(() => {\n            sessionStore.clear();\n        }));\n        this._register(gesture.onExecute((e) => __awaiter(this, void 0, void 0, function* () {\n            if (e.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || e.target.detail !== this._stickyScrollWidget.getId()) {\n                // not hovering over our widget\n                return;\n            }\n            const position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n            if (!position) {\n                // not hovering a sticky scroll line\n                return;\n            }\n            if (this._candidateDefinitionsLength > 1) {\n                if (this._focused) {\n                    this._disposeFocusStickyScrollStore();\n                }\n                this._revealPosition({ lineNumber: position.lineNumber, column: 1 });\n            }\n            this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, { uri: this._editor.getModel().uri, range: this._stickyRangeProjectedOnEditor });\n        })));\n    }\n    _onContextMenu(e) {\n        const event = new StandardMouseEvent(e);\n        this._contextMenuService.showContextMenu({\n            menuId: MenuId.StickyScrollContext,\n            getAnchor: () => event,\n        });\n    }\n    _toggleFoldingRegionForLine(line) {\n        if (!this._foldingModel || line === null) {\n            return;\n        }\n        const stickyLine = this._stickyScrollWidget.getStickyLineForLine(line);\n        const foldingIcon = stickyLine === null || stickyLine === void 0 ? void 0 : stickyLine.foldingIcon;\n        if (!foldingIcon) {\n            return;\n        }\n        toggleCollapseState(this._foldingModel, Number.MAX_VALUE, [line]);\n        foldingIcon.isCollapsed = !foldingIcon.isCollapsed;\n        const scrollTop = (foldingIcon.isCollapsed ?\n            this._editor.getTopForLineNumber(foldingIcon.foldingEndLine)\n            : this._editor.getTopForLineNumber(foldingIcon.foldingStartLine))\n            - this._editor.getOption(66 /* EditorOption.lineHeight */) * stickyLine.index + 1;\n        this._editor.setScrollTop(scrollTop);\n        this._renderStickyScroll(line);\n    }\n    _readConfiguration() {\n        const options = this._editor.getOption(114 /* EditorOption.stickyScroll */);\n        if (options.enabled === false) {\n            this._editor.removeOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.clear();\n            this._enabled = false;\n            return;\n        }\n        else if (options.enabled && !this._enabled) {\n            // When sticky scroll was just enabled, add the listeners on the sticky scroll\n            this._editor.addOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.add(this._editor.onDidScrollChange((e) => {\n                if (e.scrollTopChanged) {\n                    this._showEndForLine = null;\n                    this._renderStickyScroll();\n                }\n            }));\n            this._sessionStore.add(this._editor.onDidLayoutChange(() => this._onDidResize()));\n            this._sessionStore.add(this._editor.onDidChangeModelTokens((e) => this._onTokensChange(e)));\n            this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(() => {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }));\n            this._enabled = true;\n        }\n        const lineNumberOption = this._editor.getOption(67 /* EditorOption.lineNumbers */);\n        if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            this._sessionStore.add(this._editor.onDidChangeCursorPosition(() => {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }));\n        }\n    }\n    _needsUpdate(event) {\n        const stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n        for (const stickyLineNumber of stickyLineNumbers) {\n            for (const range of event.ranges) {\n                if (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    _onTokensChange(event) {\n        if (this._needsUpdate(event)) {\n            // Rebuilding the whole widget from line -1\n            this._renderStickyScroll(-1);\n        }\n    }\n    _onDidResize() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        // Make sure sticky scroll doesn't take up more than 25% of the editor\n        const theoreticalLines = layoutInfo.height / this._editor.getOption(66 /* EditorOption.lineHeight */);\n        this._maxStickyLines = Math.round(theoreticalLines * .25);\n    }\n    _renderStickyScroll(rebuildFromLine = Infinity) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = this._editor.getModel();\n            if (!model || model.isTooLargeForTokenization()) {\n                this._foldingModel = null;\n                this._stickyScrollWidget.setState(undefined, null, rebuildFromLine);\n                return;\n            }\n            const stickyLineVersion = this._stickyLineCandidateProvider.getVersionId();\n            if (stickyLineVersion === undefined || stickyLineVersion === model.getVersionId()) {\n                this._foldingModel = (_b = yield ((_a = FoldingController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.getFoldingModel())) !== null && _b !== void 0 ? _b : null;\n                this._widgetState = this.findScrollWidgetState();\n                this._stickyScrollVisibleContextKey.set(!(this._widgetState.startLineNumbers.length === 0));\n                if (!this._focused) {\n                    this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n                }\n                else {\n                    // Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n                    if (this._focusedStickyElementIndex === -1) {\n                        this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n                        this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                        if (this._focusedStickyElementIndex !== -1) {\n                            this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                        }\n                    }\n                    else {\n                        const focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n                        this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n                        // Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n                        if (this._stickyScrollWidget.lineNumberCount === 0) {\n                            this._focusedStickyElementIndex = -1;\n                        }\n                        else {\n                            const previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber);\n                            // If the line number is still there, do not change anything\n                            // If the line number is not there, set the new focused line to be the last line\n                            if (!previousFocusedLineNumberExists) {\n                                this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                            }\n                            this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                        }\n                    }\n                }\n            }\n        });\n    }\n    findScrollWidgetState() {\n        const lineHeight = this._editor.getOption(66 /* EditorOption.lineHeight */);\n        const maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(114 /* EditorOption.stickyScroll */).maxLineCount);\n        const scrollTop = this._editor.getScrollTop();\n        let lastLineRelativePosition = 0;\n        const startLineNumbers = [];\n        const endLineNumbers = [];\n        const arrayVisibleRanges = this._editor.getVisibleRanges();\n        if (arrayVisibleRanges.length !== 0) {\n            const fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n            const candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n            for (const range of candidateRanges) {\n                const start = range.startLineNumber;\n                const end = range.endLineNumber;\n                const depth = range.nestingDepth;\n                if (end - start > 0) {\n                    const topOfElementAtDepth = (depth - 1) * lineHeight;\n                    const bottomOfElementAtDepth = depth * lineHeight;\n                    const bottomOfBeginningLine = this._editor.getBottomForLineNumber(start) - scrollTop;\n                    const topOfEndLine = this._editor.getTopForLineNumber(end) - scrollTop;\n                    const bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n                    if (topOfElementAtDepth > topOfEndLine && topOfElementAtDepth <= bottomOfEndLine) {\n                        startLineNumbers.push(start);\n                        endLineNumbers.push(end + 1);\n                        lastLineRelativePosition = bottomOfEndLine - bottomOfElementAtDepth;\n                        break;\n                    }\n                    else if (bottomOfElementAtDepth > bottomOfBeginningLine && bottomOfElementAtDepth <= bottomOfEndLine) {\n                        startLineNumbers.push(start);\n                        endLineNumbers.push(end + 1);\n                    }\n                    if (startLineNumbers.length === maxNumberStickyLines) {\n                        break;\n                    }\n                }\n            }\n        }\n        this._endLineNumbers = endLineNumbers;\n        return new StickyScrollWidgetState(startLineNumbers, endLineNumbers, lastLineRelativePosition, this._showEndForLine);\n    }\n    dispose() {\n        super.dispose();\n        this._sessionStore.dispose();\n    }\n};\nStickyScrollController.ID = 'store.contrib.stickyScrollController';\nStickyScrollController = StickyScrollController_1 = __decorate([\n    __param(1, IContextMenuService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IInstantiationService),\n    __param(4, ILanguageConfigurationService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, IContextKeyService)\n], StickyScrollController);\nexport { StickyScrollController };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { localize } from '../../../../nls.js';\nimport { Categories } from '../../../../platform/action/common/actionCommonCategories.js';\nimport { Action2, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nexport class ToggleStickyScroll extends Action2 {\n    constructor() {\n        super({\n            id: 'editor.action.toggleStickyScroll',\n            title: {\n                value: localize('toggleStickyScroll', \"Toggle Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'mitoggleStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Sticky Scroll\"),\n                original: 'Toggle Sticky Scroll',\n            },\n            category: Categories.View,\n            toggled: {\n                condition: ContextKeyExpr.equals('config.editor.stickyScroll.enabled', true),\n                title: localize('stickyScroll', \"Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'miStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Sticky Scroll\"),\n            },\n            menu: [\n                { id: MenuId.CommandPalette },\n                { id: MenuId.MenubarAppearanceMenu, group: '4_editor', order: 3 },\n                { id: MenuId.StickyScrollContext }\n            ]\n        });\n    }\n    run(accessor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const configurationService = accessor.get(IConfigurationService);\n            const newValue = !configurationService.getValue('editor.stickyScroll.enabled');\n            return configurationService.updateValue('editor.stickyScroll.enabled', newValue);\n        });\n    }\n}\nconst weight = 100 /* KeybindingWeight.EditorContrib */;\nexport class FocusStickyScroll extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.focusStickyScroll',\n            title: {\n                value: localize('focusStickyScroll', \"Focus Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'mifocusStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Focus Sticky Scroll\"),\n                original: 'Focus Sticky Scroll',\n            },\n            precondition: ContextKeyExpr.and(ContextKeyExpr.has('config.editor.stickyScroll.enabled'), EditorContextKeys.stickyScrollVisible),\n            menu: [\n                { id: MenuId.CommandPalette },\n            ]\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n}\nexport class SelectNextStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectNextStickyScrollLine',\n            title: {\n                value: localize('selectNextStickyScrollLine.title', \"Select next sticky scroll line\"),\n                original: 'Select next sticky scroll line'\n            },\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 18 /* KeyCode.DownArrow */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.focusNext();\n    }\n}\nexport class SelectPreviousStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectPreviousStickyScrollLine',\n            title: {\n                value: localize('selectPreviousStickyScrollLine.title', \"Select previous sticky scroll line\"),\n                original: 'Select previous sticky scroll line'\n            },\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 16 /* KeyCode.UpArrow */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.focusPrevious();\n    }\n}\nexport class GoToStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.goToFocusedStickyScrollLine',\n            title: {\n                value: localize('goToFocusedStickyScrollLine.title', \"Go to focused sticky scroll line\"),\n                original: 'Go to focused sticky scroll line'\n            },\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 3 /* KeyCode.Enter */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.goToFocused();\n    }\n}\nexport class SelectEditor extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectEditor',\n            title: {\n                value: localize('selectEditor.title', \"Select Editor\"),\n                original: 'Select Editor'\n            },\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 9 /* KeyCode.Escape */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.selectEditor();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ToggleStickyScroll, FocusStickyScroll, SelectEditor, SelectPreviousStickyScrollLine, SelectNextStickyScrollLine, GoToStickyScrollLine } from './stickyScrollActions.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nimport { registerAction2 } from '../../../../platform/actions/common/actions.js';\nregisterEditorContribution(StickyScrollController.ID, StickyScrollController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterAction2(ToggleStickyScroll);\nregisterAction2(FocusStickyScroll);\nregisterAction2(SelectPreviousStickyScrollLine);\nregisterAction2(SelectNextStickyScrollLine);\nregisterAction2(GoToStickyScrollLine);\nregisterAction2(SelectEditor);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { quickSelect } from '../../../../base/common/arrays.js';\nimport { anyScore, fuzzyScore, FuzzyScore, fuzzyScoreGracefulAggressive, FuzzyScoreOptions } from '../../../../base/common/filters.js';\nimport { compareIgnoreCase } from '../../../../base/common/strings.js';\nexport class LineContext {\n    constructor(leadingLineContent, characterCountDelta) {\n        this.leadingLineContent = leadingLineContent;\n        this.characterCountDelta = characterCountDelta;\n    }\n}\n/**\n * Sorted, filtered completion view model\n * */\nexport class CompletionModel {\n    constructor(items, column, lineContext, wordDistance, options, snippetSuggestions, fuzzyScoreOptions = FuzzyScoreOptions.default, clipboardText = undefined) {\n        this.clipboardText = clipboardText;\n        this._snippetCompareFn = CompletionModel._compareCompletionItems;\n        this._items = items;\n        this._column = column;\n        this._wordDistance = wordDistance;\n        this._options = options;\n        this._refilterKind = 1 /* Refilter.All */;\n        this._lineContext = lineContext;\n        this._fuzzyScoreOptions = fuzzyScoreOptions;\n        if (snippetSuggestions === 'top') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsUp;\n        }\n        else if (snippetSuggestions === 'bottom') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsDown;\n        }\n    }\n    get lineContext() {\n        return this._lineContext;\n    }\n    set lineContext(value) {\n        if (this._lineContext.leadingLineContent !== value.leadingLineContent\n            || this._lineContext.characterCountDelta !== value.characterCountDelta) {\n            this._refilterKind = this._lineContext.characterCountDelta < value.characterCountDelta && this._filteredItems ? 2 /* Refilter.Incr */ : 1 /* Refilter.All */;\n            this._lineContext = value;\n        }\n    }\n    get items() {\n        this._ensureCachedState();\n        return this._filteredItems;\n    }\n    getItemsByProvider() {\n        this._ensureCachedState();\n        return this._itemsByProvider;\n    }\n    getIncompleteProvider() {\n        this._ensureCachedState();\n        const result = new Set();\n        for (const [provider, items] of this.getItemsByProvider()) {\n            if (items.length > 0 && items[0].container.incomplete) {\n                result.add(provider);\n            }\n        }\n        return result;\n    }\n    get stats() {\n        this._ensureCachedState();\n        return this._stats;\n    }\n    _ensureCachedState() {\n        if (this._refilterKind !== 0 /* Refilter.Nothing */) {\n            this._createCachedState();\n        }\n    }\n    _createCachedState() {\n        this._itemsByProvider = new Map();\n        const labelLengths = [];\n        const { leadingLineContent, characterCountDelta } = this._lineContext;\n        let word = '';\n        let wordLow = '';\n        // incrementally filter less\n        const source = this._refilterKind === 1 /* Refilter.All */ ? this._items : this._filteredItems;\n        const target = [];\n        // picks a score function based on the number of\n        // items that we have to score/filter and based on the\n        // user-configuration\n        const scoreFn = (!this._options.filterGraceful || source.length > 2000) ? fuzzyScore : fuzzyScoreGracefulAggressive;\n        for (let i = 0; i < source.length; i++) {\n            const item = source[i];\n            if (item.isInvalid) {\n                continue; // SKIP invalid items\n            }\n            // keep all items by their provider\n            const arr = this._itemsByProvider.get(item.provider);\n            if (arr) {\n                arr.push(item);\n            }\n            else {\n                this._itemsByProvider.set(item.provider, [item]);\n            }\n            // 'word' is that remainder of the current line that we\n            // filter and score against. In theory each suggestion uses a\n            // different word, but in practice not - that's why we cache\n            const overwriteBefore = item.position.column - item.editStart.column;\n            const wordLen = overwriteBefore + characterCountDelta - (item.position.column - this._column);\n            if (word.length !== wordLen) {\n                word = wordLen === 0 ? '' : leadingLineContent.slice(-wordLen);\n                wordLow = word.toLowerCase();\n            }\n            // remember the word against which this item was\n            // scored\n            item.word = word;\n            if (wordLen === 0) {\n                // when there is nothing to score against, don't\n                // event try to do. Use a const rank and rely on\n                // the fallback-sort using the initial sort order.\n                // use a score of `-100` because that is out of the\n                // bound of values `fuzzyScore` will return\n                item.score = FuzzyScore.Default;\n            }\n            else {\n                // skip word characters that are whitespace until\n                // we have hit the replace range (overwriteBefore)\n                let wordPos = 0;\n                while (wordPos < overwriteBefore) {\n                    const ch = word.charCodeAt(wordPos);\n                    if (ch === 32 /* CharCode.Space */ || ch === 9 /* CharCode.Tab */) {\n                        wordPos += 1;\n                    }\n                    else {\n                        break;\n                    }\n                }\n                if (wordPos >= wordLen) {\n                    // the wordPos at which scoring starts is the whole word\n                    // and therefore the same rules as not having a word apply\n                    item.score = FuzzyScore.Default;\n                }\n                else if (typeof item.completion.filterText === 'string') {\n                    // when there is a `filterText` it must match the `word`.\n                    // if it matches we check with the label to compute highlights\n                    // and if that doesn't yield a result we have no highlights,\n                    // despite having the match\n                    const match = scoreFn(word, wordLow, wordPos, item.completion.filterText, item.filterTextLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    if (compareIgnoreCase(item.completion.filterText, item.textLabel) === 0) {\n                        // filterText and label are actually the same -> use good highlights\n                        item.score = match;\n                    }\n                    else {\n                        // re-run the scorer on the label in the hope of a result BUT use the rank\n                        // of the filterText-match\n                        item.score = anyScore(word, wordLow, wordPos, item.textLabel, item.labelLow, 0);\n                        item.score[0] = match[0]; // use score from filterText\n                    }\n                }\n                else {\n                    // by default match `word` against the `label`\n                    const match = scoreFn(word, wordLow, wordPos, item.textLabel, item.labelLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    item.score = match;\n                }\n            }\n            item.idx = i;\n            item.distance = this._wordDistance.distance(item.position, item.completion);\n            target.push(item);\n            // update stats\n            labelLengths.push(item.textLabel.length);\n        }\n        this._filteredItems = target.sort(this._snippetCompareFn);\n        this._refilterKind = 0 /* Refilter.Nothing */;\n        this._stats = {\n            pLabelLen: labelLengths.length ?\n                quickSelect(labelLengths.length - .85, labelLengths, (a, b) => a - b)\n                : 0\n        };\n    }\n    static _compareCompletionItems(a, b) {\n        if (a.score[0] > b.score[0]) {\n            return -1;\n        }\n        else if (a.score[0] < b.score[0]) {\n            return 1;\n        }\n        else if (a.distance < b.distance) {\n            return -1;\n        }\n        else if (a.distance > b.distance) {\n            return 1;\n        }\n        else if (a.idx < b.idx) {\n            return -1;\n        }\n        else if (a.idx > b.idx) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    static _compareCompletionItemsSnippetsDown(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n    static _compareCompletionItemsSnippetsUp(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { CancellationError, isCancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { DisposableStore, isDisposable } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { historyNavigationVisible } from '../../../../platform/history/browser/contextScopedHistoryWidget.js';\nexport const Context = {\n    Visible: historyNavigationVisible,\n    HasFocusedSuggestion: new RawContextKey('suggestWidgetHasFocusedSuggestion', false, localize('suggestWidgetHasSelection', \"Whether any suggestion is focused\")),\n    DetailsVisible: new RawContextKey('suggestWidgetDetailsVisible', false, localize('suggestWidgetDetailsVisible', \"Whether suggestion details are visible\")),\n    MultipleSuggestions: new RawContextKey('suggestWidgetMultipleSuggestions', false, localize('suggestWidgetMultipleSuggestions', \"Whether there are multiple suggestions to pick from\")),\n    MakesTextEdit: new RawContextKey('suggestionMakesTextEdit', true, localize('suggestionMakesTextEdit', \"Whether inserting the current suggestion yields in a change or has everything already been typed\")),\n    AcceptSuggestionsOnEnter: new RawContextKey('acceptSuggestionOnEnter', true, localize('acceptSuggestionOnEnter', \"Whether suggestions are inserted when pressing Enter\")),\n    HasInsertAndReplaceRange: new RawContextKey('suggestionHasInsertAndReplaceRange', false, localize('suggestionHasInsertAndReplaceRange', \"Whether the current suggestion has insert and replace behaviour\")),\n    InsertMode: new RawContextKey('suggestionInsertMode', undefined, { type: 'string', description: localize('suggestionInsertMode', \"Whether the default behaviour is to insert or replace\") }),\n    CanResolve: new RawContextKey('suggestionCanResolve', false, localize('suggestionCanResolve', \"Whether the current suggestion supports to resolve further details\")),\n};\nexport const suggestWidgetStatusbarMenu = new MenuId('suggestWidgetStatusBar');\nexport class CompletionItem {\n    constructor(position, completion, container, provider) {\n        var _a;\n        this.position = position;\n        this.completion = completion;\n        this.container = container;\n        this.provider = provider;\n        // validation\n        this.isInvalid = false;\n        // sorting, filtering\n        this.score = FuzzyScore.Default;\n        this.distance = 0;\n        this.textLabel = typeof completion.label === 'string'\n            ? completion.label\n            : (_a = completion.label) === null || _a === void 0 ? void 0 : _a.label;\n        // ensure lower-variants (perf)\n        this.labelLow = this.textLabel.toLowerCase();\n        // validate label\n        this.isInvalid = !this.textLabel;\n        this.sortTextLow = completion.sortText && completion.sortText.toLowerCase();\n        this.filterTextLow = completion.filterText && completion.filterText.toLowerCase();\n        this.extensionId = completion.extensionId;\n        // normalize ranges\n        if (Range.isIRange(completion.range)) {\n            this.editStart = new Position(completion.range.startLineNumber, completion.range.startColumn);\n            this.editInsertEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            this.editReplaceEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            // validate range\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range) || completion.range.startLineNumber !== position.lineNumber;\n        }\n        else {\n            this.editStart = new Position(completion.range.insert.startLineNumber, completion.range.insert.startColumn);\n            this.editInsertEnd = new Position(completion.range.insert.endLineNumber, completion.range.insert.endColumn);\n            this.editReplaceEnd = new Position(completion.range.replace.endLineNumber, completion.range.replace.endColumn);\n            // validate ranges\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range.insert) || Range.spansMultipleLines(completion.range.replace)\n                || completion.range.insert.startLineNumber !== position.lineNumber || completion.range.replace.startLineNumber !== position.lineNumber\n                || completion.range.insert.startColumn !== completion.range.replace.startColumn;\n        }\n        // create the suggestion resolver\n        if (typeof provider.resolveCompletionItem !== 'function') {\n            this._resolveCache = Promise.resolve();\n            this._resolveDuration = 0;\n        }\n    }\n    // ---- resolving\n    get isResolved() {\n        return this._resolveDuration !== undefined;\n    }\n    get resolveDuration() {\n        return this._resolveDuration !== undefined ? this._resolveDuration : -1;\n    }\n    resolve(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._resolveCache) {\n                const sub = token.onCancellationRequested(() => {\n                    this._resolveCache = undefined;\n                    this._resolveDuration = undefined;\n                });\n                const sw = new StopWatch(true);\n                this._resolveCache = Promise.resolve(this.provider.resolveCompletionItem(this.completion, token)).then(value => {\n                    Object.assign(this.completion, value);\n                    this._resolveDuration = sw.elapsed();\n                }, err => {\n                    if (isCancellationError(err)) {\n                        // the IPC queue will reject the request with the\n                        // cancellation error -> reset cached\n                        this._resolveCache = undefined;\n                        this._resolveDuration = undefined;\n                    }\n                }).finally(() => {\n                    sub.dispose();\n                });\n            }\n            return this._resolveCache;\n        });\n    }\n}\nexport class CompletionOptions {\n    constructor(snippetSortOrder = 2 /* SnippetSortOrder.Bottom */, kindFilter = new Set(), providerFilter = new Set(), providerItemsToReuse = new Map(), showDeprecated = true) {\n        this.snippetSortOrder = snippetSortOrder;\n        this.kindFilter = kindFilter;\n        this.providerFilter = providerFilter;\n        this.providerItemsToReuse = providerItemsToReuse;\n        this.showDeprecated = showDeprecated;\n    }\n}\nCompletionOptions.default = new CompletionOptions();\nlet _snippetSuggestSupport;\nexport function getSnippetSuggestSupport() {\n    return _snippetSuggestSupport;\n}\nexport class CompletionItemModel {\n    constructor(items, needsClipboard, durations, disposable) {\n        this.items = items;\n        this.needsClipboard = needsClipboard;\n        this.durations = durations;\n        this.disposable = disposable;\n    }\n}\nexport function provideSuggestionItems(registry, model, position, options = CompletionOptions.default, context = { triggerKind: 0 /* languages.CompletionTriggerKind.Invoke */ }, token = CancellationToken.None) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const sw = new StopWatch();\n        position = position.clone();\n        const word = model.getWordAtPosition(position);\n        const defaultReplaceRange = word ? new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn) : Range.fromPositions(position);\n        const defaultRange = { replace: defaultReplaceRange, insert: defaultReplaceRange.setEndPosition(position.lineNumber, position.column) };\n        const result = [];\n        const disposables = new DisposableStore();\n        const durations = [];\n        let needsClipboard = false;\n        const onCompletionList = (provider, container, sw) => {\n            var _a, _b, _c;\n            let didAddResult = false;\n            if (!container) {\n                return didAddResult;\n            }\n            for (const suggestion of container.suggestions) {\n                if (!options.kindFilter.has(suggestion.kind)) {\n                    // skip if not showing deprecated suggestions\n                    if (!options.showDeprecated && ((_a = suggestion === null || suggestion === void 0 ? void 0 : suggestion.tags) === null || _a === void 0 ? void 0 : _a.includes(1 /* languages.CompletionItemTag.Deprecated */))) {\n                        continue;\n                    }\n                    // fill in default range when missing\n                    if (!suggestion.range) {\n                        suggestion.range = defaultRange;\n                    }\n                    // fill in default sortText when missing\n                    if (!suggestion.sortText) {\n                        suggestion.sortText = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.label;\n                    }\n                    if (!needsClipboard && suggestion.insertTextRules && suggestion.insertTextRules & 4 /* languages.CompletionItemInsertTextRule.InsertAsSnippet */) {\n                        needsClipboard = SnippetParser.guessNeedsClipboard(suggestion.insertText);\n                    }\n                    result.push(new CompletionItem(position, suggestion, container, provider));\n                    didAddResult = true;\n                }\n            }\n            if (isDisposable(container)) {\n                disposables.add(container);\n            }\n            durations.push({\n                providerName: (_b = provider._debugDisplayName) !== null && _b !== void 0 ? _b : 'unknown_provider', elapsedProvider: (_c = container.duration) !== null && _c !== void 0 ? _c : -1, elapsedOverall: sw.elapsed()\n            });\n            return didAddResult;\n        };\n        // ask for snippets in parallel to asking \"real\" providers. Only do something if configured to\n        // do so - no snippet filter, no special-providers-only request\n        const snippetCompletions = (() => __awaiter(this, void 0, void 0, function* () {\n            if (!_snippetSuggestSupport || options.kindFilter.has(27 /* languages.CompletionItemKind.Snippet */)) {\n                return;\n            }\n            // we have items from a previous session that we can reuse\n            const reuseItems = options.providerItemsToReuse.get(_snippetSuggestSupport);\n            if (reuseItems) {\n                reuseItems.forEach(item => result.push(item));\n                return;\n            }\n            if (options.providerFilter.size > 0 && !options.providerFilter.has(_snippetSuggestSupport)) {\n                return;\n            }\n            const sw = new StopWatch();\n            const list = yield _snippetSuggestSupport.provideCompletionItems(model, position, context, token);\n            onCompletionList(_snippetSuggestSupport, list, sw);\n        }))();\n        // add suggestions from contributed providers - providers are ordered in groups of\n        // equal score and once a group produces a result the process stops\n        // get provider groups, always add snippet suggestion provider\n        for (const providerGroup of registry.orderedGroups(model)) {\n            // for each support in the group ask for suggestions\n            let didAddResult = false;\n            yield Promise.all(providerGroup.map((provider) => __awaiter(this, void 0, void 0, function* () {\n                // we have items from a previous session that we can reuse\n                if (options.providerItemsToReuse.has(provider)) {\n                    const items = options.providerItemsToReuse.get(provider);\n                    items.forEach(item => result.push(item));\n                    didAddResult = didAddResult || items.length > 0;\n                    return;\n                }\n                // check if this provider is filtered out\n                if (options.providerFilter.size > 0 && !options.providerFilter.has(provider)) {\n                    return;\n                }\n                try {\n                    const sw = new StopWatch();\n                    const list = yield provider.provideCompletionItems(model, position, context, token);\n                    didAddResult = onCompletionList(provider, list, sw) || didAddResult;\n                }\n                catch (err) {\n                    onUnexpectedExternalError(err);\n                }\n            })));\n            if (didAddResult || token.isCancellationRequested) {\n                break;\n            }\n        }\n        yield snippetCompletions;\n        if (token.isCancellationRequested) {\n            disposables.dispose();\n            return Promise.reject(new CancellationError());\n        }\n        return new CompletionItemModel(result.sort(getSuggestionComparator(options.snippetSortOrder)), needsClipboard, { entries: durations, elapsed: sw.elapsed() }, disposables);\n    });\n}\nfunction defaultComparator(a, b) {\n    // check with 'sortText'\n    if (a.sortTextLow && b.sortTextLow) {\n        if (a.sortTextLow < b.sortTextLow) {\n            return -1;\n        }\n        else if (a.sortTextLow > b.sortTextLow) {\n            return 1;\n        }\n    }\n    // check with 'label'\n    if (a.textLabel < b.textLabel) {\n        return -1;\n    }\n    else if (a.textLabel > b.textLabel) {\n        return 1;\n    }\n    // check with 'type'\n    return a.completion.kind - b.completion.kind;\n}\nfunction snippetUpComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nfunction snippetDownComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nconst _snippetComparators = new Map();\n_snippetComparators.set(0 /* SnippetSortOrder.Top */, snippetUpComparator);\n_snippetComparators.set(2 /* SnippetSortOrder.Bottom */, snippetDownComparator);\n_snippetComparators.set(1 /* SnippetSortOrder.Inline */, defaultComparator);\nexport function getSuggestionComparator(snippetConfig) {\n    return _snippetComparators.get(snippetConfig);\n}\nCommandsRegistry.registerCommand('_executeCompletionItemProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, position, triggerCharacter, maxItemsToResolve] = args;\n    assertType(URI.isUri(uri));\n    assertType(Position.isIPosition(position));\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\n    assertType(typeof maxItemsToResolve === 'number' || !maxItemsToResolve);\n    const { completionProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = yield accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const result = {\n            incomplete: false,\n            suggestions: []\n        };\n        const resolving = [];\n        const actualPosition = ref.object.textEditorModel.validatePosition(position);\n        const completions = yield provideSuggestionItems(completionProvider, ref.object.textEditorModel, actualPosition, undefined, { triggerCharacter: triggerCharacter !== null && triggerCharacter !== void 0 ? triggerCharacter : undefined, triggerKind: triggerCharacter ? 1 /* languages.CompletionTriggerKind.TriggerCharacter */ : 0 /* languages.CompletionTriggerKind.Invoke */ });\n        for (const item of completions.items) {\n            if (resolving.length < (maxItemsToResolve !== null && maxItemsToResolve !== void 0 ? maxItemsToResolve : 0)) {\n                resolving.push(item.resolve(CancellationToken.None));\n            }\n            result.incomplete = result.incomplete || item.container.incomplete;\n            result.suggestions.push(item.completion);\n        }\n        try {\n            yield Promise.all(resolving);\n            return result;\n        }\n        finally {\n            setTimeout(() => completions.disposable.dispose(), 100);\n        }\n    }\n    finally {\n        ref.dispose();\n    }\n}));\nexport function showSimpleSuggestions(editor, provider) {\n    var _a;\n    (_a = editor.getContribution('editor.contrib.suggestController')) === null || _a === void 0 ? void 0 : _a.triggerSuggest(new Set().add(provider), undefined, true);\n}\nexport class QuickSuggestionsOptions {\n    static isAllOff(config) {\n        return config.other === 'off' && config.comments === 'off' && config.strings === 'off';\n    }\n    static isAllOn(config) {\n        return config.other === 'on' && config.comments === 'on' && config.strings === 'on';\n    }\n    static valueFor(config, tokenType) {\n        switch (tokenType) {\n            case 1 /* StandardTokenType.Comment */: return config.comments;\n            case 2 /* StandardTokenType.String */: return config.strings;\n            default: return config.other;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar WordContextKey_1;\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet WordContextKey = WordContextKey_1 = class WordContextKey {\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._enabled = false;\n        this._ckAtEnd = WordContextKey_1.AtEnd.bindTo(contextKeyService);\n        this._configListener = this._editor.onDidChangeConfiguration(e => e.hasChanged(122 /* EditorOption.tabCompletion */) && this._update());\n        this._update();\n    }\n    dispose() {\n        var _a;\n        this._configListener.dispose();\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._ckAtEnd.reset();\n    }\n    _update() {\n        // only update this when tab completions are enabled\n        const enabled = this._editor.getOption(122 /* EditorOption.tabCompletion */) === 'on';\n        if (this._enabled === enabled) {\n            return;\n        }\n        this._enabled = enabled;\n        if (this._enabled) {\n            const checkForWordEnd = () => {\n                if (!this._editor.hasModel()) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                const model = this._editor.getModel();\n                const selection = this._editor.getSelection();\n                const word = model.getWordAtPosition(selection.getStartPosition());\n                if (!word) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                this._ckAtEnd.set(word.endColumn === selection.getStartPosition().column);\n            };\n            this._selectionListener = this._editor.onDidChangeCursorSelection(checkForWordEnd);\n            checkForWordEnd();\n        }\n        else if (this._selectionListener) {\n            this._ckAtEnd.reset();\n            this._selectionListener.dispose();\n            this._selectionListener = undefined;\n        }\n    }\n};\nWordContextKey.AtEnd = new RawContextKey('atEndOfWord', false);\nWordContextKey = WordContextKey_1 = __decorate([\n    __param(1, IContextKeyService)\n], WordContextKey);\nexport { WordContextKey };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestAlternatives_1;\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet SuggestAlternatives = SuggestAlternatives_1 = class SuggestAlternatives {\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._index = 0;\n        this._ckOtherSuggestions = SuggestAlternatives_1.OtherSuggestions.bindTo(contextKeyService);\n    }\n    dispose() {\n        this.reset();\n    }\n    reset() {\n        var _a;\n        this._ckOtherSuggestions.reset();\n        (_a = this._listener) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._model = undefined;\n        this._acceptNext = undefined;\n        this._ignore = false;\n    }\n    set({ model, index }, acceptNext) {\n        // no suggestions -> nothing to do\n        if (model.items.length === 0) {\n            this.reset();\n            return;\n        }\n        // no alternative suggestions -> nothing to do\n        const nextIndex = SuggestAlternatives_1._moveIndex(true, model, index);\n        if (nextIndex === index) {\n            this.reset();\n            return;\n        }\n        this._acceptNext = acceptNext;\n        this._model = model;\n        this._index = index;\n        this._listener = this._editor.onDidChangeCursorPosition(() => {\n            if (!this._ignore) {\n                this.reset();\n            }\n        });\n        this._ckOtherSuggestions.set(true);\n    }\n    static _moveIndex(fwd, model, index) {\n        let newIndex = index;\n        for (let rounds = model.items.length; rounds > 0; rounds--) {\n            newIndex = (newIndex + model.items.length + (fwd ? +1 : -1)) % model.items.length;\n            if (newIndex === index) {\n                break;\n            }\n            if (!model.items[newIndex].completion.additionalTextEdits) {\n                break;\n            }\n        }\n        return newIndex;\n    }\n    next() {\n        this._move(true);\n    }\n    prev() {\n        this._move(false);\n    }\n    _move(fwd) {\n        if (!this._model) {\n            // nothing to reason about\n            return;\n        }\n        try {\n            this._ignore = true;\n            this._index = SuggestAlternatives_1._moveIndex(fwd, this._model, this._index);\n            this._acceptNext({ index: this._index, item: this._model.items[this._index], model: this._model });\n        }\n        finally {\n            this._ignore = false;\n        }\n    }\n};\nSuggestAlternatives.OtherSuggestions = new RawContextKey('hasOtherSuggestions', false);\nSuggestAlternatives = SuggestAlternatives_1 = __decorate([\n    __param(1, IContextKeyService)\n], SuggestAlternatives);\nexport { SuggestAlternatives };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nexport class CommitCharacterController {\n    constructor(editor, widget, model, accept) {\n        this._disposables = new DisposableStore();\n        this._disposables.add(model.onDidSuggest(e => {\n            if (e.completionModel.items.length === 0) {\n                this.reset();\n            }\n        }));\n        this._disposables.add(model.onDidCancel(e => {\n            this.reset();\n        }));\n        this._disposables.add(widget.onDidShow(() => this._onItem(widget.getFocusedItem())));\n        this._disposables.add(widget.onDidFocus(this._onItem, this));\n        this._disposables.add(widget.onDidHide(this.reset, this));\n        this._disposables.add(editor.onWillType(text => {\n            if (this._active && !widget.isFrozen() && model.state !== 0 /* State.Idle */) {\n                const ch = text.charCodeAt(text.length - 1);\n                if (this._active.acceptCharacters.has(ch) && editor.getOption(0 /* EditorOption.acceptSuggestionOnCommitCharacter */)) {\n                    accept(this._active.item);\n                }\n            }\n        }));\n    }\n    _onItem(selected) {\n        if (!selected || !isNonEmptyArray(selected.item.completion.commitCharacters)) {\n            // no item or no commit characters\n            this.reset();\n            return;\n        }\n        if (this._active && this._active.item.item === selected.item) {\n            // still the same item\n            return;\n        }\n        // keep item and its commit characters\n        const acceptCharacters = new CharacterSet();\n        for (const ch of selected.item.completion.commitCharacters) {\n            if (ch.length > 0) {\n                acceptCharacters.add(ch.charCodeAt(0));\n            }\n        }\n        this._active = { acceptCharacters, item: selected };\n    }\n    reset() {\n        this._active = undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar SuggestModel_1;\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace, isHighSurrogate, isLowSurrogate } from '../../../../base/common/strings.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CompletionModel } from './completionModel.js';\nimport { CompletionOptions, getSnippetSuggestSupport, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { FuzzyScoreOptions } from '../../../../base/common/filters.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { InlineCompletionContextKeys } from '../../inlineCompletions/browser/inlineCompletionContextKeys.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nexport class LineContext {\n    static shouldAutoTrigger(editor) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const pos = editor.getPosition();\n        model.tokenization.tokenizeIfCheap(pos.lineNumber);\n        const word = model.getWordAtPosition(pos);\n        if (!word) {\n            return false;\n        }\n        if (word.endColumn !== pos.column &&\n            word.startColumn + 1 !== pos.column /* after typing a single character before a word */) {\n            return false;\n        }\n        if (!isNaN(Number(word.word))) {\n            return false;\n        }\n        return true;\n    }\n    constructor(model, position, triggerOptions) {\n        this.leadingLineContent = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n        this.leadingWord = model.getWordUntilPosition(position);\n        this.lineNumber = position.lineNumber;\n        this.column = position.column;\n        this.triggerOptions = triggerOptions;\n    }\n}\nfunction canShowQuickSuggest(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue(InlineCompletionContextKeys.inlineSuggestionVisible.key))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const suppressSuggestions = contextKeyService.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);\n    if (suppressSuggestions !== undefined) {\n        return !suppressSuggestions;\n    }\n    return !editor.getOption(62 /* EditorOption.inlineSuggest */).suppressSuggestions;\n}\nfunction canShowSuggestOnTriggerCharacters(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue('inlineSuggestionVisible'))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const suppressSuggestions = contextKeyService.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);\n    if (suppressSuggestions !== undefined) {\n        return !suppressSuggestions;\n    }\n    return !editor.getOption(62 /* EditorOption.inlineSuggest */).suppressSuggestions;\n}\nlet SuggestModel = SuggestModel_1 = class SuggestModel {\n    constructor(_editor, _editorWorkerService, _clipboardService, _telemetryService, _logService, _contextKeyService, _configurationService, _languageFeaturesService, _envService) {\n        this._editor = _editor;\n        this._editorWorkerService = _editorWorkerService;\n        this._clipboardService = _clipboardService;\n        this._telemetryService = _telemetryService;\n        this._logService = _logService;\n        this._contextKeyService = _contextKeyService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._envService = _envService;\n        this._toDispose = new DisposableStore();\n        this._triggerCharacterListener = new DisposableStore();\n        this._triggerQuickSuggest = new TimeoutTimer();\n        this._triggerState = undefined;\n        this._completionDisposables = new DisposableStore();\n        this._onDidCancel = new Emitter();\n        this._onDidTrigger = new Emitter();\n        this._onDidSuggest = new Emitter();\n        this.onDidCancel = this._onDidCancel.event;\n        this.onDidTrigger = this._onDidTrigger.event;\n        this.onDidSuggest = this._onDidSuggest.event;\n        this._telemetryGate = 0;\n        this._currentSelection = this._editor.getSelection() || new Selection(1, 1, 1, 1);\n        // wire up various listeners\n        this._toDispose.add(this._editor.onDidChangeModel(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelLanguage(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeConfiguration(() => {\n            this._updateTriggerCharacters();\n        }));\n        this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(() => {\n            this._updateTriggerCharacters();\n            this._updateActiveSuggestSession();\n        }));\n        let editorIsComposing = false;\n        this._toDispose.add(this._editor.onDidCompositionStart(() => {\n            editorIsComposing = true;\n        }));\n        this._toDispose.add(this._editor.onDidCompositionEnd(() => {\n            editorIsComposing = false;\n            this._onCompositionEnd();\n        }));\n        this._toDispose.add(this._editor.onDidChangeCursorSelection(e => {\n            // only trigger suggest when the editor isn't composing a character\n            if (!editorIsComposing) {\n                this._onCursorChange(e);\n            }\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelContent(() => {\n            // only filter completions when the editor isn't composing a character\n            // allow-any-unicode-next-line\n            // e.g.  + u makes  but just  cannot be used for filtering\n            if (!editorIsComposing && this._triggerState !== undefined) {\n                this._refilterCompletionItems();\n            }\n        }));\n        this._updateTriggerCharacters();\n    }\n    dispose() {\n        dispose(this._triggerCharacterListener);\n        dispose([this._onDidCancel, this._onDidSuggest, this._onDidTrigger, this._triggerQuickSuggest]);\n        this._toDispose.dispose();\n        this._completionDisposables.dispose();\n        this.cancel();\n    }\n    _updateTriggerCharacters() {\n        this._triggerCharacterListener.clear();\n        if (this._editor.getOption(90 /* EditorOption.readOnly */)\n            || !this._editor.hasModel()\n            || !this._editor.getOption(120 /* EditorOption.suggestOnTriggerCharacters */)) {\n            return;\n        }\n        const supportsByTriggerCharacter = new Map();\n        for (const support of this._languageFeaturesService.completionProvider.all(this._editor.getModel())) {\n            for (const ch of support.triggerCharacters || []) {\n                let set = supportsByTriggerCharacter.get(ch);\n                if (!set) {\n                    set = new Set();\n                    set.add(getSnippetSuggestSupport());\n                    supportsByTriggerCharacter.set(ch, set);\n                }\n                set.add(support);\n            }\n        }\n        const checkTriggerCharacter = (text) => {\n            var _a;\n            if (!canShowSuggestOnTriggerCharacters(this._editor, this._contextKeyService, this._configurationService)) {\n                return;\n            }\n            if (LineContext.shouldAutoTrigger(this._editor)) {\n                // don't trigger by trigger characters when this is a case for quick suggest\n                return;\n            }\n            if (!text) {\n                // came here from the compositionEnd-event\n                const position = this._editor.getPosition();\n                const model = this._editor.getModel();\n                text = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n            }\n            let lastChar = '';\n            if (isLowSurrogate(text.charCodeAt(text.length - 1))) {\n                if (isHighSurrogate(text.charCodeAt(text.length - 2))) {\n                    lastChar = text.substr(text.length - 2);\n                }\n            }\n            else {\n                lastChar = text.charAt(text.length - 1);\n            }\n            const supports = supportsByTriggerCharacter.get(lastChar);\n            if (supports) {\n                // keep existing items that where not computed by the\n                // supports/providers that want to trigger now\n                const providerItemsToReuse = new Map();\n                if (this._completionModel) {\n                    for (const [provider, items] of this._completionModel.getItemsByProvider()) {\n                        if (!supports.has(provider)) {\n                            providerItemsToReuse.set(provider, items);\n                        }\n                    }\n                }\n                this.trigger({\n                    auto: true,\n                    triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */,\n                    triggerCharacter: lastChar,\n                    retrigger: Boolean(this._completionModel),\n                    clipboardText: (_a = this._completionModel) === null || _a === void 0 ? void 0 : _a.clipboardText,\n                    completionOptions: { providerFilter: supports, providerItemsToReuse }\n                });\n            }\n        };\n        this._triggerCharacterListener.add(this._editor.onDidType(checkTriggerCharacter));\n        this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(() => checkTriggerCharacter()));\n    }\n    // --- trigger/retrigger/cancel suggest\n    get state() {\n        if (!this._triggerState) {\n            return 0 /* State.Idle */;\n        }\n        else if (!this._triggerState.auto) {\n            return 1 /* State.Manual */;\n        }\n        else {\n            return 2 /* State.Auto */;\n        }\n    }\n    cancel(retrigger = false) {\n        var _a;\n        if (this._triggerState !== undefined) {\n            this._triggerQuickSuggest.cancel();\n            (_a = this._requestToken) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._requestToken = undefined;\n            this._triggerState = undefined;\n            this._completionModel = undefined;\n            this._context = undefined;\n            this._onDidCancel.fire({ retrigger });\n        }\n    }\n    clear() {\n        this._completionDisposables.clear();\n    }\n    _updateActiveSuggestSession() {\n        if (this._triggerState !== undefined) {\n            if (!this._editor.hasModel() || !this._languageFeaturesService.completionProvider.has(this._editor.getModel())) {\n                this.cancel();\n            }\n            else {\n                this.trigger({ auto: this._triggerState.auto, retrigger: true });\n            }\n        }\n    }\n    _onCursorChange(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const prevSelection = this._currentSelection;\n        this._currentSelection = this._editor.getSelection();\n        if (!e.selection.isEmpty()\n            || (e.reason !== 0 /* CursorChangeReason.NotSet */ && e.reason !== 3 /* CursorChangeReason.Explicit */)\n            || (e.source !== 'keyboard' && e.source !== 'deleteLeft')) {\n            // Early exit if nothing needs to be done!\n            // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n            this.cancel();\n            return;\n        }\n        if (this._triggerState === undefined && e.reason === 0 /* CursorChangeReason.NotSet */) {\n            if (prevSelection.containsRange(this._currentSelection) || prevSelection.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition())) {\n                // cursor did move RIGHT due to typing -> trigger quick suggest\n                this._doTriggerQuickSuggest();\n            }\n        }\n        else if (this._triggerState !== undefined && e.reason === 3 /* CursorChangeReason.Explicit */) {\n            // suggest is active and something like cursor keys are used to move\n            // the cursor. this means we can refilter at the new position\n            this._refilterCompletionItems();\n        }\n    }\n    _onCompositionEnd() {\n        // trigger or refilter when composition ends\n        if (this._triggerState === undefined) {\n            this._doTriggerQuickSuggest();\n        }\n        else {\n            this._refilterCompletionItems();\n        }\n    }\n    _doTriggerQuickSuggest() {\n        var _a;\n        if (QuickSuggestionsOptions.isAllOff(this._editor.getOption(88 /* EditorOption.quickSuggestions */))) {\n            // not enabled\n            return;\n        }\n        if (this._editor.getOption(117 /* EditorOption.suggest */).snippetsPreventQuickSuggestions && ((_a = SnippetController2.get(this._editor)) === null || _a === void 0 ? void 0 : _a.isInSnippet())) {\n            // no quick suggestion when in snippet mode\n            return;\n        }\n        this.cancel();\n        this._triggerQuickSuggest.cancelAndSet(() => {\n            if (this._triggerState !== undefined) {\n                return;\n            }\n            if (!LineContext.shouldAutoTrigger(this._editor)) {\n                return;\n            }\n            if (!this._editor.hasModel() || !this._editor.hasWidgetFocus()) {\n                return;\n            }\n            const model = this._editor.getModel();\n            const pos = this._editor.getPosition();\n            // validate enabled now\n            const config = this._editor.getOption(88 /* EditorOption.quickSuggestions */);\n            if (QuickSuggestionsOptions.isAllOff(config)) {\n                return;\n            }\n            if (!QuickSuggestionsOptions.isAllOn(config)) {\n                // Check the type of the token that triggered this\n                model.tokenization.tokenizeIfCheap(pos.lineNumber);\n                const lineTokens = model.tokenization.getLineTokens(pos.lineNumber);\n                const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(pos.column - 1 - 1, 0)));\n                if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'on') {\n                    return;\n                }\n            }\n            if (!canShowQuickSuggest(this._editor, this._contextKeyService, this._configurationService)) {\n                // do not trigger quick suggestions if inline suggestions are shown\n                return;\n            }\n            if (!this._languageFeaturesService.completionProvider.has(model)) {\n                return;\n            }\n            // we made it till here -> trigger now\n            this.trigger({ auto: true });\n        }, this._editor.getOption(89 /* EditorOption.quickSuggestionsDelay */));\n    }\n    _refilterCompletionItems() {\n        assertType(this._editor.hasModel());\n        assertType(this._triggerState !== undefined);\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const ctx = new LineContext(model, position, Object.assign(Object.assign({}, this._triggerState), { refilter: true }));\n        this._onNewContext(ctx);\n    }\n    trigger(options) {\n        var _a, _b, _c, _d, _e, _f;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const ctx = new LineContext(model, this._editor.getPosition(), options);\n        // Cancel previous requests, change state & update UI\n        this.cancel(options.retrigger);\n        this._triggerState = options;\n        this._onDidTrigger.fire({ auto: options.auto, shy: (_a = options.shy) !== null && _a !== void 0 ? _a : false, position: this._editor.getPosition() });\n        // Capture context when request was sent\n        this._context = ctx;\n        // Build context for request\n        let suggestCtx = { triggerKind: (_b = options.triggerKind) !== null && _b !== void 0 ? _b : 0 /* CompletionTriggerKind.Invoke */ };\n        if (options.triggerCharacter) {\n            suggestCtx = {\n                triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */,\n                triggerCharacter: options.triggerCharacter\n            };\n        }\n        this._requestToken = new CancellationTokenSource();\n        // kind filter and snippet sort rules\n        const snippetSuggestions = this._editor.getOption(111 /* EditorOption.snippetSuggestions */);\n        let snippetSortOrder = 1 /* SnippetSortOrder.Inline */;\n        switch (snippetSuggestions) {\n            case 'top':\n                snippetSortOrder = 0 /* SnippetSortOrder.Top */;\n                break;\n            // \t that's the default anyways...\n            // case 'inline':\n            // \tsnippetSortOrder = SnippetSortOrder.Inline;\n            // \tbreak;\n            case 'bottom':\n                snippetSortOrder = 2 /* SnippetSortOrder.Bottom */;\n                break;\n        }\n        const { itemKind: itemKindFilter, showDeprecated } = SuggestModel_1._createSuggestFilter(this._editor);\n        const completionOptions = new CompletionOptions(snippetSortOrder, (_d = (_c = options.completionOptions) === null || _c === void 0 ? void 0 : _c.kindFilter) !== null && _d !== void 0 ? _d : itemKindFilter, (_e = options.completionOptions) === null || _e === void 0 ? void 0 : _e.providerFilter, (_f = options.completionOptions) === null || _f === void 0 ? void 0 : _f.providerItemsToReuse, showDeprecated);\n        const wordDistance = WordDistance.create(this._editorWorkerService, this._editor);\n        const completions = provideSuggestionItems(this._languageFeaturesService.completionProvider, model, this._editor.getPosition(), completionOptions, suggestCtx, this._requestToken.token);\n        Promise.all([completions, wordDistance]).then(([completions, wordDistance]) => __awaiter(this, void 0, void 0, function* () {\n            var _g;\n            (_g = this._requestToken) === null || _g === void 0 ? void 0 : _g.dispose();\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            let clipboardText = options === null || options === void 0 ? void 0 : options.clipboardText;\n            if (!clipboardText && completions.needsClipboard) {\n                clipboardText = yield this._clipboardService.readText();\n            }\n            if (this._triggerState === undefined) {\n                return;\n            }\n            const model = this._editor.getModel();\n            // const items = completions.items;\n            // if (existing) {\n            // \tconst cmpFn = getSuggestionComparator(snippetSortOrder);\n            // \titems = items.concat(existing.items).sort(cmpFn);\n            // }\n            const ctx = new LineContext(model, this._editor.getPosition(), options);\n            const fuzzySearchOptions = Object.assign(Object.assign({}, FuzzyScoreOptions.default), { firstMatchCanBeWeak: !this._editor.getOption(117 /* EditorOption.suggest */).matchOnWordStartOnly });\n            this._completionModel = new CompletionModel(completions.items, this._context.column, {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            }, wordDistance, this._editor.getOption(117 /* EditorOption.suggest */), this._editor.getOption(111 /* EditorOption.snippetSuggestions */), fuzzySearchOptions, clipboardText);\n            // store containers so that they can be disposed later\n            this._completionDisposables.add(completions.disposable);\n            this._onNewContext(ctx);\n            // finally report telemetry about durations\n            this._reportDurationsTelemetry(completions.durations);\n            // report invalid completions by source\n            if (!this._envService.isBuilt || this._envService.isExtensionDevelopment) {\n                for (const item of completions.items) {\n                    if (item.isInvalid) {\n                        this._logService.warn(`[suggest] did IGNORE invalid completion item from ${item.provider._debugDisplayName}`, item.completion);\n                    }\n                }\n            }\n        })).catch(onUnexpectedError);\n    }\n    _reportDurationsTelemetry(durations) {\n        if (this._telemetryGate++ % 230 !== 0) {\n            return;\n        }\n        setTimeout(() => {\n            this._telemetryService.publicLog2('suggest.durations.json', { data: JSON.stringify(durations) });\n            this._logService.debug('suggest.durations.json', durations);\n        });\n    }\n    static _createSuggestFilter(editor) {\n        // kind filter and snippet sort rules\n        const result = new Set();\n        // snippet setting\n        const snippetSuggestions = editor.getOption(111 /* EditorOption.snippetSuggestions */);\n        if (snippetSuggestions === 'none') {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        // type setting\n        const suggestOptions = editor.getOption(117 /* EditorOption.suggest */);\n        if (!suggestOptions.showMethods) {\n            result.add(0 /* CompletionItemKind.Method */);\n        }\n        if (!suggestOptions.showFunctions) {\n            result.add(1 /* CompletionItemKind.Function */);\n        }\n        if (!suggestOptions.showConstructors) {\n            result.add(2 /* CompletionItemKind.Constructor */);\n        }\n        if (!suggestOptions.showFields) {\n            result.add(3 /* CompletionItemKind.Field */);\n        }\n        if (!suggestOptions.showVariables) {\n            result.add(4 /* CompletionItemKind.Variable */);\n        }\n        if (!suggestOptions.showClasses) {\n            result.add(5 /* CompletionItemKind.Class */);\n        }\n        if (!suggestOptions.showStructs) {\n            result.add(6 /* CompletionItemKind.Struct */);\n        }\n        if (!suggestOptions.showInterfaces) {\n            result.add(7 /* CompletionItemKind.Interface */);\n        }\n        if (!suggestOptions.showModules) {\n            result.add(8 /* CompletionItemKind.Module */);\n        }\n        if (!suggestOptions.showProperties) {\n            result.add(9 /* CompletionItemKind.Property */);\n        }\n        if (!suggestOptions.showEvents) {\n            result.add(10 /* CompletionItemKind.Event */);\n        }\n        if (!suggestOptions.showOperators) {\n            result.add(11 /* CompletionItemKind.Operator */);\n        }\n        if (!suggestOptions.showUnits) {\n            result.add(12 /* CompletionItemKind.Unit */);\n        }\n        if (!suggestOptions.showValues) {\n            result.add(13 /* CompletionItemKind.Value */);\n        }\n        if (!suggestOptions.showConstants) {\n            result.add(14 /* CompletionItemKind.Constant */);\n        }\n        if (!suggestOptions.showEnums) {\n            result.add(15 /* CompletionItemKind.Enum */);\n        }\n        if (!suggestOptions.showEnumMembers) {\n            result.add(16 /* CompletionItemKind.EnumMember */);\n        }\n        if (!suggestOptions.showKeywords) {\n            result.add(17 /* CompletionItemKind.Keyword */);\n        }\n        if (!suggestOptions.showWords) {\n            result.add(18 /* CompletionItemKind.Text */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(19 /* CompletionItemKind.Color */);\n        }\n        if (!suggestOptions.showFiles) {\n            result.add(20 /* CompletionItemKind.File */);\n        }\n        if (!suggestOptions.showReferences) {\n            result.add(21 /* CompletionItemKind.Reference */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(22 /* CompletionItemKind.Customcolor */);\n        }\n        if (!suggestOptions.showFolders) {\n            result.add(23 /* CompletionItemKind.Folder */);\n        }\n        if (!suggestOptions.showTypeParameters) {\n            result.add(24 /* CompletionItemKind.TypeParameter */);\n        }\n        if (!suggestOptions.showSnippets) {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        if (!suggestOptions.showUsers) {\n            result.add(25 /* CompletionItemKind.User */);\n        }\n        if (!suggestOptions.showIssues) {\n            result.add(26 /* CompletionItemKind.Issue */);\n        }\n        return { itemKind: result, showDeprecated: suggestOptions.showDeprecated };\n    }\n    _onNewContext(ctx) {\n        if (!this._context) {\n            // happens when 24x7 IntelliSense is enabled and still in its delay\n            return;\n        }\n        if (ctx.lineNumber !== this._context.lineNumber) {\n            // e.g. happens when pressing Enter while IntelliSense is computed\n            this.cancel();\n            return;\n        }\n        if (getLeadingWhitespace(ctx.leadingLineContent) !== getLeadingWhitespace(this._context.leadingLineContent)) {\n            // cancel IntelliSense when line start changes\n            // happens when the current word gets outdented\n            this.cancel();\n            return;\n        }\n        if (ctx.column < this._context.column) {\n            // typed -> moved cursor LEFT -> retrigger if still on a word\n            if (ctx.leadingWord.word) {\n                this.trigger({ auto: this._context.triggerOptions.auto, retrigger: true });\n            }\n            else {\n                this.cancel();\n            }\n            return;\n        }\n        if (!this._completionModel) {\n            // happens when IntelliSense is not yet computed\n            return;\n        }\n        if (ctx.leadingWord.word.length !== 0 && ctx.leadingWord.startColumn > this._context.leadingWord.startColumn) {\n            // started a new word while IntelliSense shows -> retrigger but reuse all items that we currently have\n            const shouldAutoTrigger = LineContext.shouldAutoTrigger(this._editor);\n            if (shouldAutoTrigger && this._context) {\n                // shouldAutoTrigger forces tokenization, which can cause pending cursor change events to be emitted, which can cause\n                // suggestions to be cancelled, which causes `this._context` to be undefined\n                const map = this._completionModel.getItemsByProvider();\n                this.trigger({\n                    auto: this._context.triggerOptions.auto,\n                    retrigger: true,\n                    clipboardText: this._completionModel.clipboardText,\n                    completionOptions: { providerItemsToReuse: map }\n                });\n            }\n            return;\n        }\n        if (ctx.column > this._context.column && this._completionModel.getIncompleteProvider().size > 0 && ctx.leadingWord.word.length !== 0) {\n            // typed -> moved cursor RIGHT & incomple model & still on a word -> retrigger\n            const providerItemsToReuse = new Map();\n            const providerFilter = new Set();\n            for (const [provider, items] of this._completionModel.getItemsByProvider()) {\n                if (items.length > 0 && items[0].container.incomplete) {\n                    providerFilter.add(provider);\n                }\n                else {\n                    providerItemsToReuse.set(provider, items);\n                }\n            }\n            this.trigger({\n                auto: this._context.triggerOptions.auto,\n                triggerKind: 2 /* CompletionTriggerKind.TriggerForIncompleteCompletions */,\n                retrigger: true,\n                clipboardText: this._completionModel.clipboardText,\n                completionOptions: { providerFilter, providerItemsToReuse }\n            });\n        }\n        else {\n            // typed -> moved cursor RIGHT -> update UI\n            const oldLineContext = this._completionModel.lineContext;\n            let isFrozen = false;\n            this._completionModel.lineContext = {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            };\n            if (this._completionModel.items.length === 0) {\n                const shouldAutoTrigger = LineContext.shouldAutoTrigger(this._editor);\n                if (!this._context) {\n                    // shouldAutoTrigger forces tokenization, which can cause pending cursor change events to be emitted, which can cause\n                    // suggestions to be cancelled, which causes `this._context` to be undefined\n                    this.cancel();\n                    return;\n                }\n                if (shouldAutoTrigger && this._context.leadingWord.endColumn < ctx.leadingWord.startColumn) {\n                    // retrigger when heading into a new word\n                    this.trigger({ auto: this._context.triggerOptions.auto, retrigger: true });\n                    return;\n                }\n                if (!this._context.triggerOptions.auto) {\n                    // freeze when IntelliSense was manually requested\n                    this._completionModel.lineContext = oldLineContext;\n                    isFrozen = this._completionModel.items.length > 0;\n                    if (isFrozen && ctx.leadingWord.word.length === 0) {\n                        // there were results before but now there aren't\n                        // and also we are not on a word anymore -> cancel\n                        this.cancel();\n                        return;\n                    }\n                }\n                else {\n                    // nothing left\n                    this.cancel();\n                    return;\n                }\n            }\n            this._onDidSuggest.fire({\n                completionModel: this._completionModel,\n                triggerOptions: ctx.triggerOptions,\n                isFrozen,\n            });\n        }\n    }\n};\nSuggestModel = SuggestModel_1 = __decorate([\n    __param(1, IEditorWorkerService),\n    __param(2, IClipboardService),\n    __param(3, ITelemetryService),\n    __param(4, ILogService),\n    __param(5, IContextKeyService),\n    __param(6, IConfigurationService),\n    __param(7, ILanguageFeaturesService),\n    __param(8, IEnvironmentService)\n], SuggestModel);\nexport { SuggestModel };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nexport class OvertypingCapturer {\n    constructor(editor, suggestModel) {\n        this._disposables = new DisposableStore();\n        this._lastOvertyped = [];\n        this._locked = false;\n        this._disposables.add(editor.onWillType(() => {\n            if (this._locked || !editor.hasModel()) {\n                return;\n            }\n            const selections = editor.getSelections();\n            const selectionsLength = selections.length;\n            // Check if it will overtype any selections\n            let willOvertype = false;\n            for (let i = 0; i < selectionsLength; i++) {\n                if (!selections[i].isEmpty()) {\n                    willOvertype = true;\n                    break;\n                }\n            }\n            if (!willOvertype) {\n                if (this._lastOvertyped.length !== 0) {\n                    this._lastOvertyped.length = 0;\n                }\n                return;\n            }\n            this._lastOvertyped = [];\n            const model = editor.getModel();\n            for (let i = 0; i < selectionsLength; i++) {\n                const selection = selections[i];\n                // Check for overtyping capturer restrictions\n                if (model.getValueLengthInRange(selection) > OvertypingCapturer._maxSelectionLength) {\n                    return;\n                }\n                this._lastOvertyped[i] = { value: model.getValueInRange(selection), multiline: selection.startLineNumber !== selection.endLineNumber };\n            }\n        }));\n        this._disposables.add(suggestModel.onDidTrigger(e => {\n            this._locked = true;\n        }));\n        this._disposables.add(suggestModel.onDidCancel(e => {\n            this._locked = false;\n        }));\n    }\n    getLastOvertypedInfo(idx) {\n        if (idx >= 0 && idx < this._lastOvertyped.length) {\n            return this._lastOvertyped[idx];\n        }\n        return undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\nOvertypingCapturer._maxSelectionLength = 51200;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuEntryActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nclass StatusBarViewItem extends MenuEntryActionViewItem {\n    updateLabel() {\n        const kb = this._keybindingService.lookupKeybinding(this._action.id, this._contextKeyService);\n        if (!kb) {\n            return super.updateLabel();\n        }\n        if (this.label) {\n            this.label.textContent = localize({ key: 'content', comment: ['A label', 'A keybinding'] }, '{0} ({1})', this._action.label, StatusBarViewItem.symbolPrintEnter(kb));\n        }\n    }\n    static symbolPrintEnter(kb) {\n        var _a;\n        return (_a = kb.getLabel()) === null || _a === void 0 ? void 0 : _a.replace(/\\benter\\b/gi, '\\u23CE');\n    }\n}\nlet SuggestWidgetStatus = class SuggestWidgetStatus {\n    constructor(container, _menuId, instantiationService, _menuService, _contextKeyService) {\n        this._menuId = _menuId;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._menuDisposables = new DisposableStore();\n        this.element = dom.append(container, dom.$('.suggest-status-bar'));\n        const actionViewItemProvider = (action => {\n            return action instanceof MenuItemAction ? instantiationService.createInstance(StatusBarViewItem, action, undefined) : undefined;\n        });\n        this._leftActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._rightActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._leftActions.domNode.classList.add('left');\n        this._rightActions.domNode.classList.add('right');\n    }\n    dispose() {\n        this._menuDisposables.dispose();\n        this._leftActions.dispose();\n        this._rightActions.dispose();\n        this.element.remove();\n    }\n    show() {\n        const menu = this._menuService.createMenu(this._menuId, this._contextKeyService);\n        const renderMenu = () => {\n            const left = [];\n            const right = [];\n            for (const [group, actions] of menu.getActions()) {\n                if (group === 'left') {\n                    left.push(...actions);\n                }\n                else {\n                    right.push(...actions);\n                }\n            }\n            this._leftActions.clear();\n            this._leftActions.push(left);\n            this._rightActions.clear();\n            this._rightActions.push(right);\n        };\n        this._menuDisposables.add(menu.onDidChange(() => renderMenu()));\n        this._menuDisposables.add(menu);\n    }\n    hide() {\n        this._menuDisposables.clear();\n    }\n};\nSuggestWidgetStatus = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, IMenuService),\n    __param(4, IContextKeyService)\n], SuggestWidgetStatus);\nexport { SuggestWidgetStatus };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { DomScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport * as nls from '../../../../nls.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nexport function canExpandCompletionItem(item) {\n    return !!item && Boolean(item.completion.documentation || item.completion.detail && item.completion.detail !== item.completion.label);\n}\nlet SuggestDetailsWidget = class SuggestDetailsWidget {\n    constructor(_editor, instaService) {\n        this._editor = _editor;\n        this._onDidClose = new Emitter();\n        this.onDidClose = this._onDidClose.event;\n        this._onDidChangeContents = new Emitter();\n        this.onDidChangeContents = this._onDidChangeContents.event;\n        this._disposables = new DisposableStore();\n        this._renderDisposeable = new DisposableStore();\n        this._borderWidth = 1;\n        this._size = new dom.Dimension(330, 0);\n        this.domNode = dom.$('.suggest-details');\n        this.domNode.classList.add('no-docs');\n        this._markdownRenderer = instaService.createInstance(MarkdownRenderer, { editor: _editor });\n        this._body = dom.$('.body');\n        this._scrollbar = new DomScrollableElement(this._body, {\n            alwaysConsumeMouseWheel: true,\n        });\n        dom.append(this.domNode, this._scrollbar.getDomNode());\n        this._disposables.add(this._scrollbar);\n        this._header = dom.append(this._body, dom.$('.header'));\n        this._close = dom.append(this._header, dom.$('span' + ThemeIcon.asCSSSelector(Codicon.close)));\n        this._close.title = nls.localize('details.close', \"Close\");\n        this._type = dom.append(this._header, dom.$('p.type'));\n        this._docs = dom.append(this._body, dom.$('p.docs'));\n        this._configureFont();\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._configureFont();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._renderDisposeable.dispose();\n    }\n    _configureFont() {\n        const options = this._editor.getOptions();\n        const fontInfo = options.get(50 /* EditorOption.fontInfo */);\n        const fontFamily = fontInfo.getMassagedFontFamily();\n        const fontSize = options.get(118 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n        const lineHeight = options.get(119 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n        const fontWeight = fontInfo.fontWeight;\n        const fontSizePx = `${fontSize}px`;\n        const lineHeightPx = `${lineHeight}px`;\n        this.domNode.style.fontSize = fontSizePx;\n        this.domNode.style.lineHeight = `${lineHeight / fontSize}`;\n        this.domNode.style.fontWeight = fontWeight;\n        this.domNode.style.fontFeatureSettings = fontInfo.fontFeatureSettings;\n        this._type.style.fontFamily = fontFamily;\n        this._close.style.height = lineHeightPx;\n        this._close.style.width = lineHeightPx;\n    }\n    getLayoutInfo() {\n        const lineHeight = this._editor.getOption(119 /* EditorOption.suggestLineHeight */) || this._editor.getOption(50 /* EditorOption.fontInfo */).lineHeight;\n        const borderWidth = this._borderWidth;\n        const borderHeight = borderWidth * 2;\n        return {\n            lineHeight,\n            borderWidth,\n            borderHeight,\n            verticalPadding: 22,\n            horizontalPadding: 14\n        };\n    }\n    renderLoading() {\n        this._type.textContent = nls.localize('loading', \"Loading...\");\n        this._docs.textContent = '';\n        this.domNode.classList.remove('no-docs', 'no-type');\n        this.layout(this.size.width, this.getLayoutInfo().lineHeight * 2);\n        this._onDidChangeContents.fire(this);\n    }\n    renderItem(item, explainMode) {\n        var _a, _b;\n        this._renderDisposeable.clear();\n        let { detail, documentation } = item.completion;\n        if (explainMode) {\n            let md = '';\n            md += `score: ${item.score[0]}\\n`;\n            md += `prefix: ${(_a = item.word) !== null && _a !== void 0 ? _a : '(no prefix)'}\\n`;\n            md += `word: ${item.completion.filterText ? item.completion.filterText + ' (filterText)' : item.textLabel}\\n`;\n            md += `distance: ${item.distance} (localityBonus-setting)\\n`;\n            md += `index: ${item.idx}, based on ${item.completion.sortText && `sortText: \"${item.completion.sortText}\"` || 'label'}\\n`;\n            md += `commit_chars: ${(_b = item.completion.commitCharacters) === null || _b === void 0 ? void 0 : _b.join('')}\\n`;\n            documentation = new MarkdownString().appendCodeblock('empty', md);\n            detail = `Provider: ${item.provider._debugDisplayName}`;\n        }\n        if (!explainMode && !canExpandCompletionItem(item)) {\n            this.clearContents();\n            return;\n        }\n        this.domNode.classList.remove('no-docs', 'no-type');\n        // --- details\n        if (detail) {\n            const cappedDetail = detail.length > 100000 ? `${detail.substr(0, 100000)}` : detail;\n            this._type.textContent = cappedDetail;\n            this._type.title = cappedDetail;\n            dom.show(this._type);\n            this._type.classList.toggle('auto-wrap', !/\\r?\\n^\\s+/gmi.test(cappedDetail));\n        }\n        else {\n            dom.clearNode(this._type);\n            this._type.title = '';\n            dom.hide(this._type);\n            this.domNode.classList.add('no-type');\n        }\n        // --- documentation\n        dom.clearNode(this._docs);\n        if (typeof documentation === 'string') {\n            this._docs.classList.remove('markdown-docs');\n            this._docs.textContent = documentation;\n        }\n        else if (documentation) {\n            this._docs.classList.add('markdown-docs');\n            dom.clearNode(this._docs);\n            const renderedContents = this._markdownRenderer.render(documentation);\n            this._docs.appendChild(renderedContents.element);\n            this._renderDisposeable.add(renderedContents);\n            this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(() => {\n                this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n                this._onDidChangeContents.fire(this);\n            }));\n        }\n        this.domNode.style.userSelect = 'text';\n        this.domNode.tabIndex = -1;\n        this._close.onmousedown = e => {\n            e.preventDefault();\n            e.stopPropagation();\n        };\n        this._close.onclick = e => {\n            e.preventDefault();\n            e.stopPropagation();\n            this._onDidClose.fire();\n        };\n        this._body.scrollTop = 0;\n        this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n        this._onDidChangeContents.fire(this);\n    }\n    clearContents() {\n        this.domNode.classList.add('no-docs');\n        this._type.textContent = '';\n        this._docs.textContent = '';\n    }\n    get size() {\n        return this._size;\n    }\n    layout(width, height) {\n        const newSize = new dom.Dimension(width, height);\n        if (!dom.Dimension.equals(newSize, this._size)) {\n            this._size = newSize;\n            dom.size(this.domNode, width, height);\n        }\n        this._scrollbar.scanDomNode();\n    }\n    scrollDown(much = 8) {\n        this._body.scrollTop += much;\n    }\n    scrollUp(much = 8) {\n        this._body.scrollTop -= much;\n    }\n    scrollTop() {\n        this._body.scrollTop = 0;\n    }\n    scrollBottom() {\n        this._body.scrollTop = this._body.scrollHeight;\n    }\n    pageDown() {\n        this.scrollDown(80);\n    }\n    pageUp() {\n        this.scrollUp(80);\n    }\n    set borderWidth(width) {\n        this._borderWidth = width;\n    }\n    get borderWidth() {\n        return this._borderWidth;\n    }\n};\nSuggestDetailsWidget = __decorate([\n    __param(1, IInstantiationService)\n], SuggestDetailsWidget);\nexport { SuggestDetailsWidget };\nexport class SuggestDetailsOverlay {\n    constructor(widget, _editor) {\n        this.widget = widget;\n        this._editor = _editor;\n        this._disposables = new DisposableStore();\n        this._added = false;\n        this._preferAlignAtTop = true;\n        this._resizable = new ResizableHTMLElement();\n        this._resizable.domNode.classList.add('suggest-details-container');\n        this._resizable.domNode.appendChild(widget.domNode);\n        this._resizable.enableSashes(false, true, true, false);\n        let topLeftNow;\n        let sizeNow;\n        let deltaTop = 0;\n        let deltaLeft = 0;\n        this._disposables.add(this._resizable.onDidWillResize(() => {\n            topLeftNow = this._topLeft;\n            sizeNow = this._resizable.size;\n        }));\n        this._disposables.add(this._resizable.onDidResize(e => {\n            if (topLeftNow && sizeNow) {\n                this.widget.layout(e.dimension.width, e.dimension.height);\n                let updateTopLeft = false;\n                if (e.west) {\n                    deltaLeft = sizeNow.width - e.dimension.width;\n                    updateTopLeft = true;\n                }\n                if (e.north) {\n                    deltaTop = sizeNow.height - e.dimension.height;\n                    updateTopLeft = true;\n                }\n                if (updateTopLeft) {\n                    this._applyTopLeft({\n                        top: topLeftNow.top + deltaTop,\n                        left: topLeftNow.left + deltaLeft,\n                    });\n                }\n            }\n            if (e.done) {\n                topLeftNow = undefined;\n                sizeNow = undefined;\n                deltaTop = 0;\n                deltaLeft = 0;\n                this._userSize = e.dimension;\n            }\n        }));\n        this._disposables.add(this.widget.onDidChangeContents(() => {\n            var _a;\n            if (this._anchorBox) {\n                this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size, this._preferAlignAtTop);\n            }\n        }));\n    }\n    dispose() {\n        this._resizable.dispose();\n        this._disposables.dispose();\n        this.hide();\n    }\n    getId() {\n        return 'suggest.details';\n    }\n    getDomNode() {\n        return this._resizable.domNode;\n    }\n    getPosition() {\n        return null;\n    }\n    show() {\n        if (!this._added) {\n            this._editor.addOverlayWidget(this);\n            this.getDomNode().style.position = 'fixed';\n            this._added = true;\n        }\n    }\n    hide(sessionEnded = false) {\n        this._resizable.clearSashHoverState();\n        if (this._added) {\n            this._editor.removeOverlayWidget(this);\n            this._added = false;\n            this._anchorBox = undefined;\n            this._topLeft = undefined;\n        }\n        if (sessionEnded) {\n            this._userSize = undefined;\n            this.widget.clearContents();\n        }\n    }\n    placeAtAnchor(anchor, preferAlignAtTop) {\n        var _a;\n        const anchorBox = anchor.getBoundingClientRect();\n        this._anchorBox = anchorBox;\n        this._preferAlignAtTop = preferAlignAtTop;\n        this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size, preferAlignAtTop);\n    }\n    _placeAtAnchor(anchorBox, size, preferAlignAtTop) {\n        var _a;\n        const bodyBox = dom.getClientArea(this.getDomNode().ownerDocument.body);\n        const info = this.widget.getLayoutInfo();\n        const defaultMinSize = new dom.Dimension(220, 2 * info.lineHeight);\n        const defaultTop = anchorBox.top;\n        // EAST\n        const eastPlacement = (function () {\n            const width = bodyBox.width - (anchorBox.left + anchorBox.width + info.borderWidth + info.horizontalPadding);\n            const left = -info.borderWidth + anchorBox.left + anchorBox.width;\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // WEST\n        const westPlacement = (function () {\n            const width = anchorBox.left - info.borderWidth - info.horizontalPadding;\n            const left = Math.max(info.horizontalPadding, anchorBox.left - size.width - info.borderWidth);\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // SOUTH\n        const southPacement = (function () {\n            const left = anchorBox.left;\n            const top = -info.borderWidth + anchorBox.top + anchorBox.height;\n            const maxSizeBottom = new dom.Dimension(anchorBox.width - info.borderHeight, bodyBox.height - anchorBox.top - anchorBox.height - info.verticalPadding);\n            return { top, left, fit: maxSizeBottom.height - size.height, maxSizeBottom, maxSizeTop: maxSizeBottom, minSize: defaultMinSize.with(maxSizeBottom.width) };\n        })();\n        // take first placement that fits or the first with \"least bad\" fit\n        const placements = [eastPlacement, westPlacement, southPacement];\n        const placement = (_a = placements.find(p => p.fit >= 0)) !== null && _a !== void 0 ? _a : placements.sort((a, b) => b.fit - a.fit)[0];\n        // top/bottom placement\n        const bottom = anchorBox.top + anchorBox.height - info.borderHeight;\n        let alignAtTop;\n        let height = size.height;\n        const maxHeight = Math.max(placement.maxSizeTop.height, placement.maxSizeBottom.height);\n        if (height > maxHeight) {\n            height = maxHeight;\n        }\n        let maxSize;\n        if (preferAlignAtTop) {\n            if (height <= placement.maxSizeTop.height) {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n            else {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n        }\n        else {\n            if (height <= placement.maxSizeBottom.height) {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n            else {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n        }\n        this._applyTopLeft({ left: placement.left, top: alignAtTop ? placement.top : bottom - height });\n        this.getDomNode().style.position = 'fixed';\n        this._resizable.enableSashes(!alignAtTop, placement === eastPlacement, alignAtTop, placement !== eastPlacement);\n        this._resizable.minSize = placement.minSize;\n        this._resizable.maxSize = maxSize;\n        this._resizable.layout(height, Math.min(maxSize.width, size.width));\n        this.widget.layout(this._resizable.size.width, this._resizable.size.height);\n    }\n    _applyTopLeft(topLeft) {\n        this._topLeft = topLeft;\n        this.getDomNode().style.left = `${this._topLeft.left}px`;\n        this.getDomNode().style.top = `${this._topLeft.top}px`;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar _a;\nimport { $, append, hide, show } from '../../../../base/browser/dom.js';\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { createMatches } from '../../../../base/common/filters.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { getIconClasses } from '../../../common/services/getIconClasses.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport * as nls from '../../../../nls.js';\nimport { FileKind } from '../../../../platform/files/common/files.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { canExpandCompletionItem } from './suggestWidgetDetails.js';\nexport function getAriaId(index) {\n    return `suggest-aria-id:${index}`;\n}\nconst suggestMoreInfoIcon = registerIcon('suggest-more-info', Codicon.chevronRight, nls.localize('suggestMoreInfoIcon', 'Icon for more information in the suggest widget.'));\nconst _completionItemColor = new (_a = class ColorExtractor {\n        extract(item, out) {\n            if (item.textLabel.match(_a._regexStrict)) {\n                out[0] = item.textLabel;\n                return true;\n            }\n            if (item.completion.detail && item.completion.detail.match(_a._regexStrict)) {\n                out[0] = item.completion.detail;\n                return true;\n            }\n            if (typeof item.completion.documentation === 'string') {\n                const match = _a._regexRelaxed.exec(item.completion.documentation);\n                if (match && (match.index === 0 || match.index + match[0].length === item.completion.documentation.length)) {\n                    out[0] = match[0];\n                    return true;\n                }\n            }\n            return false;\n        }\n    },\n    _a._regexRelaxed = /(#([\\da-fA-F]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))/,\n    _a._regexStrict = new RegExp(`^${_a._regexRelaxed.source}$`, 'i'),\n    _a);\nlet ItemRenderer = class ItemRenderer {\n    constructor(_editor, _modelService, _languageService, _themeService) {\n        this._editor = _editor;\n        this._modelService = _modelService;\n        this._languageService = _languageService;\n        this._themeService = _themeService;\n        this._onDidToggleDetails = new Emitter();\n        this.onDidToggleDetails = this._onDidToggleDetails.event;\n        this.templateId = 'suggestion';\n    }\n    dispose() {\n        this._onDidToggleDetails.dispose();\n    }\n    renderTemplate(container) {\n        const disposables = new DisposableStore();\n        const root = container;\n        root.classList.add('show-file-icons');\n        const icon = append(container, $('.icon'));\n        const colorspan = append(icon, $('span.colorspan'));\n        const text = append(container, $('.contents'));\n        const main = append(text, $('.main'));\n        const iconContainer = append(main, $('.icon-label.codicon'));\n        const left = append(main, $('span.left'));\n        const right = append(main, $('span.right'));\n        const iconLabel = new IconLabel(left, { supportHighlights: true, supportIcons: true });\n        disposables.add(iconLabel);\n        const parametersLabel = append(left, $('span.signature-label'));\n        const qualifierLabel = append(left, $('span.qualifier-label'));\n        const detailsLabel = append(right, $('span.details-label'));\n        const readMore = append(right, $('span.readMore' + ThemeIcon.asCSSSelector(suggestMoreInfoIcon)));\n        readMore.title = nls.localize('readMore', \"Read More\");\n        const configureFont = () => {\n            const options = this._editor.getOptions();\n            const fontInfo = options.get(50 /* EditorOption.fontInfo */);\n            const fontFamily = fontInfo.getMassagedFontFamily();\n            const fontFeatureSettings = fontInfo.fontFeatureSettings;\n            const fontSize = options.get(118 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n            const lineHeight = options.get(119 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n            const fontWeight = fontInfo.fontWeight;\n            const letterSpacing = fontInfo.letterSpacing;\n            const fontSizePx = `${fontSize}px`;\n            const lineHeightPx = `${lineHeight}px`;\n            const letterSpacingPx = `${letterSpacing}px`;\n            root.style.fontSize = fontSizePx;\n            root.style.fontWeight = fontWeight;\n            root.style.letterSpacing = letterSpacingPx;\n            main.style.fontFamily = fontFamily;\n            main.style.fontFeatureSettings = fontFeatureSettings;\n            main.style.lineHeight = lineHeightPx;\n            icon.style.height = lineHeightPx;\n            icon.style.width = lineHeightPx;\n            readMore.style.height = lineHeightPx;\n            readMore.style.width = lineHeightPx;\n        };\n        configureFont();\n        disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */) || e.hasChanged(118 /* EditorOption.suggestFontSize */) || e.hasChanged(119 /* EditorOption.suggestLineHeight */)) {\n                configureFont();\n            }\n        }));\n        return { root, left, right, icon, colorspan, iconLabel, iconContainer, parametersLabel, qualifierLabel, detailsLabel, readMore, disposables };\n    }\n    renderElement(element, index, data) {\n        const { completion } = element;\n        data.root.id = getAriaId(index);\n        data.colorspan.style.backgroundColor = '';\n        const labelOptions = {\n            labelEscapeNewLines: true,\n            matches: createMatches(element.score)\n        };\n        const color = [];\n        if (completion.kind === 19 /* CompletionItemKind.Color */ && _completionItemColor.extract(element, color)) {\n            // special logic for 'color' completion items\n            data.icon.className = 'icon customcolor';\n            data.iconContainer.className = 'icon hide';\n            data.colorspan.style.backgroundColor = color[0];\n        }\n        else if (completion.kind === 20 /* CompletionItemKind.File */ && this._themeService.getFileIconTheme().hasFileIcons) {\n            // special logic for 'file' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            const labelClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FILE);\n            const detailClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FILE);\n            labelOptions.extraClasses = labelClasses.length > detailClasses.length ? labelClasses : detailClasses;\n        }\n        else if (completion.kind === 23 /* CompletionItemKind.Folder */ && this._themeService.getFileIconTheme().hasFolderIcons) {\n            // special logic for 'folder' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            labelOptions.extraClasses = [\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FOLDER),\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FOLDER)\n            ].flat();\n        }\n        else {\n            // normal icon\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = '';\n            data.iconContainer.classList.add('suggest-icon', ...ThemeIcon.asClassNameArray(CompletionItemKinds.toIcon(completion.kind)));\n        }\n        if (completion.tags && completion.tags.indexOf(1 /* CompletionItemTag.Deprecated */) >= 0) {\n            labelOptions.extraClasses = (labelOptions.extraClasses || []).concat(['deprecated']);\n            labelOptions.matches = [];\n        }\n        data.iconLabel.setLabel(element.textLabel, undefined, labelOptions);\n        if (typeof completion.label === 'string') {\n            data.parametersLabel.textContent = '';\n            data.detailsLabel.textContent = stripNewLines(completion.detail || '');\n            data.root.classList.add('string-label');\n        }\n        else {\n            data.parametersLabel.textContent = stripNewLines(completion.label.detail || '');\n            data.detailsLabel.textContent = stripNewLines(completion.label.description || '');\n            data.root.classList.remove('string-label');\n        }\n        if (this._editor.getOption(117 /* EditorOption.suggest */).showInlineDetails) {\n            show(data.detailsLabel);\n        }\n        else {\n            hide(data.detailsLabel);\n        }\n        if (canExpandCompletionItem(element)) {\n            data.right.classList.add('can-expand-details');\n            show(data.readMore);\n            data.readMore.onmousedown = e => {\n                e.stopPropagation();\n                e.preventDefault();\n            };\n            data.readMore.onclick = e => {\n                e.stopPropagation();\n                e.preventDefault();\n                this._onDidToggleDetails.fire();\n            };\n        }\n        else {\n            data.right.classList.remove('can-expand-details');\n            hide(data.readMore);\n            data.readMore.onmousedown = null;\n            data.readMore.onclick = null;\n        }\n    }\n    disposeTemplate(templateData) {\n        templateData.disposables.dispose();\n    }\n};\nItemRenderer = __decorate([\n    __param(1, IModelService),\n    __param(2, ILanguageService),\n    __param(3, IThemeService)\n], ItemRenderer);\nexport { ItemRenderer };\nfunction stripNewLines(str) {\n    return str.replace(/\\r\\n|\\r|\\n/g, '');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar SuggestWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport { createCancelablePromise, disposableTimeout, TimeoutTimer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter, PauseableEmitter } from '../../../../base/common/event.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { clamp } from '../../../../base/common/numbers.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './media/suggest.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\nimport '../../symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { activeContrastBorder, editorForeground, editorWidgetBackground, editorWidgetBorder, listFocusHighlightForeground, listHighlightForeground, quickInputListFocusBackground, quickInputListFocusForeground, quickInputListFocusIconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\nimport { canExpandCompletionItem, SuggestDetailsOverlay, SuggestDetailsWidget } from './suggestWidgetDetails.js';\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\nimport { getListStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\n/**\n * Suggest widget colors\n */\nregisterColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hcDark: editorWidgetBackground, hcLight: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nregisterColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hcDark: editorWidgetBorder, hcLight: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nconst editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hcDark: editorForeground, hcLight: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nregisterColor('editorSuggestWidget.selectedForeground', { dark: quickInputListFocusForeground, light: quickInputListFocusForeground, hcDark: quickInputListFocusForeground, hcLight: quickInputListFocusForeground }, nls.localize('editorSuggestWidgetSelectedForeground', 'Foreground color of the selected entry in the suggest widget.'));\nregisterColor('editorSuggestWidget.selectedIconForeground', { dark: quickInputListFocusIconForeground, light: quickInputListFocusIconForeground, hcDark: quickInputListFocusIconForeground, hcLight: quickInputListFocusIconForeground }, nls.localize('editorSuggestWidgetSelectedIconForeground', 'Icon foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: quickInputListFocusBackground, light: quickInputListFocusBackground, hcDark: quickInputListFocusBackground, hcLight: quickInputListFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nregisterColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hcDark: listHighlightForeground, hcLight: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\nregisterColor('editorSuggestWidget.focusHighlightForeground', { dark: listFocusHighlightForeground, light: listFocusHighlightForeground, hcDark: listFocusHighlightForeground, hcLight: listFocusHighlightForeground }, nls.localize('editorSuggestWidgetFocusHighlightForeground', 'Color of the match highlights in the suggest widget when an item is focused.'));\nregisterColor('editorSuggestWidgetStatus.foreground', { dark: transparent(editorSuggestWidgetForeground, .5), light: transparent(editorSuggestWidgetForeground, .5), hcDark: transparent(editorSuggestWidgetForeground, .5), hcLight: transparent(editorSuggestWidgetForeground, .5) }, nls.localize('editorSuggestWidgetStatusForeground', 'Foreground color of the suggest widget status.'));\nclass PersistedWidgetSize {\n    constructor(_service, editor) {\n        this._service = _service;\n        this._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\n    }\n    restore() {\n        var _a;\n        const raw = (_a = this._service.get(this._key, 0 /* StorageScope.PROFILE */)) !== null && _a !== void 0 ? _a : '';\n        try {\n            const obj = JSON.parse(raw);\n            if (dom.Dimension.is(obj)) {\n                return dom.Dimension.lift(obj);\n            }\n        }\n        catch (_b) {\n            // ignore\n        }\n        return undefined;\n    }\n    store(size) {\n        this._service.store(this._key, JSON.stringify(size), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n    }\n    reset() {\n        this._service.remove(this._key, 0 /* StorageScope.PROFILE */);\n    }\n}\nlet SuggestWidget = SuggestWidget_1 = class SuggestWidget {\n    constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\n        this.editor = editor;\n        this._storageService = _storageService;\n        this._state = 0 /* State.Hidden */;\n        this._isAuto = false;\n        this._pendingLayout = new MutableDisposable();\n        this._pendingShowDetails = new MutableDisposable();\n        this._ignoreFocusEvents = false;\n        this._forceRenderingAbove = false;\n        this._explainMode = false;\n        this._showTimeout = new TimeoutTimer();\n        this._disposables = new DisposableStore();\n        this._onDidSelect = new PauseableEmitter();\n        this._onDidFocus = new PauseableEmitter();\n        this._onDidHide = new Emitter();\n        this._onDidShow = new Emitter();\n        this.onDidSelect = this._onDidSelect.event;\n        this.onDidFocus = this._onDidFocus.event;\n        this.onDidHide = this._onDidHide.event;\n        this.onDidShow = this._onDidShow.event;\n        this._onDetailsKeydown = new Emitter();\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\n        this.element = new ResizableHTMLElement();\n        this.element.domNode.classList.add('editor-widget', 'suggest-widget');\n        this._contentWidget = new SuggestContentWidget(this, editor);\n        this._persistedSize = new PersistedWidgetSize(_storageService, editor);\n        class ResizeState {\n            constructor(persistedSize, currentSize, persistHeight = false, persistWidth = false) {\n                this.persistedSize = persistedSize;\n                this.currentSize = currentSize;\n                this.persistHeight = persistHeight;\n                this.persistWidth = persistWidth;\n            }\n        }\n        let state;\n        this._disposables.add(this.element.onDidWillResize(() => {\n            this._contentWidget.lockPreference();\n            state = new ResizeState(this._persistedSize.restore(), this.element.size);\n        }));\n        this._disposables.add(this.element.onDidResize(e => {\n            var _a, _b, _c, _d;\n            this._resize(e.dimension.width, e.dimension.height);\n            if (state) {\n                state.persistHeight = state.persistHeight || !!e.north || !!e.south;\n                state.persistWidth = state.persistWidth || !!e.east || !!e.west;\n            }\n            if (!e.done) {\n                return;\n            }\n            if (state) {\n                // only store width or height value that have changed and also\n                // only store changes that are above a certain threshold\n                const { itemHeight, defaultSize } = this.getLayoutInfo();\n                const threshold = Math.round(itemHeight / 2);\n                let { width, height } = this.element.size;\n                if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\n                    height = (_b = (_a = state.persistedSize) === null || _a === void 0 ? void 0 : _a.height) !== null && _b !== void 0 ? _b : defaultSize.height;\n                }\n                if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\n                    width = (_d = (_c = state.persistedSize) === null || _c === void 0 ? void 0 : _c.width) !== null && _d !== void 0 ? _d : defaultSize.width;\n                }\n                this._persistedSize.store(new dom.Dimension(width, height));\n            }\n            // reset working state\n            this._contentWidget.unlockPreference();\n            state = undefined;\n        }));\n        this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\n        this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\n        const details = this._disposables.add(instantiationService.createInstance(SuggestDetailsWidget, this.editor));\n        details.onDidClose(this.toggleDetails, this, this._disposables);\n        this._details = new SuggestDetailsOverlay(details, this.editor);\n        const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(117 /* EditorOption.suggest */).showIcons);\n        applyIconStyle();\n        const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\n        this._disposables.add(renderer);\n        this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\n        this._list = new List('SuggestWidget', this._listElement, {\n            getHeight: (_element) => this.getLayoutInfo().itemHeight,\n            getTemplateId: (_element) => 'suggestion'\n        }, [renderer], {\n            alwaysConsumeMouseWheel: true,\n            useShadows: false,\n            mouseSupport: false,\n            multipleSelectionSupport: false,\n            accessibilityProvider: {\n                getRole: () => 'option',\n                getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\n                getWidgetRole: () => 'listbox',\n                getAriaLabel: (item) => {\n                    let label = item.textLabel;\n                    if (typeof item.completion.label !== 'string') {\n                        const { detail, description } = item.completion.label;\n                        if (detail && description) {\n                            label = nls.localize('label.full', '{0} {1}, {2}', label, detail, description);\n                        }\n                        else if (detail) {\n                            label = nls.localize('label.detail', '{0} {1}', label, detail);\n                        }\n                        else if (description) {\n                            label = nls.localize('label.desc', '{0}, {1}', label, description);\n                        }\n                    }\n                    if (!item.isResolved || !this._isDetailsVisible()) {\n                        return label;\n                    }\n                    const { documentation, detail } = item.completion;\n                    const docs = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\n                    return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", label, docs);\n                },\n            }\n        });\n        this._list.style(getListStyles({\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n            listInactiveFocusOutline: activeContrastBorder\n        }));\n        this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode, suggestWidgetStatusbarMenu);\n        const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(117 /* EditorOption.suggest */).showStatusBar);\n        applyStatusBarStyle();\n        this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\n        this._onThemeChange(_themeService.getColorTheme());\n        this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\n        this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\n        this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\n        this._disposables.add(this.editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(117 /* EditorOption.suggest */)) {\n                applyStatusBarStyle();\n                applyIconStyle();\n            }\n        }));\n        this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetHasFocusedSuggestion = SuggestContext.HasFocusedSuggestion.bindTo(_contextKeyService);\n        this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\n            this._onDetailsKeydown.fire(e);\n        }));\n        this._disposables.add(this.editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n    }\n    dispose() {\n        var _a;\n        this._details.widget.dispose();\n        this._details.dispose();\n        this._list.dispose();\n        this._status.dispose();\n        this._disposables.dispose();\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._pendingLayout.dispose();\n        this._pendingShowDetails.dispose();\n        this._showTimeout.dispose();\n        this._contentWidget.dispose();\n        this.element.dispose();\n    }\n    _onEditorMouseDown(mouseEvent) {\n        if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\n            // Clicking inside details\n            this._details.widget.domNode.focus();\n        }\n        else {\n            // Clicking outside details and inside suggest\n            if (this.element.domNode.contains(mouseEvent.target.element)) {\n                this.editor.focus();\n            }\n        }\n    }\n    _onCursorSelectionChanged() {\n        if (this._state !== 0 /* State.Hidden */) {\n            this._contentWidget.layout();\n        }\n    }\n    _onListMouseDownOrTap(e) {\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n            return;\n        }\n        // prevent stealing browser focus from the editor\n        e.browserEvent.preventDefault();\n        e.browserEvent.stopPropagation();\n        this._select(e.element, e.index);\n    }\n    _onListSelection(e) {\n        if (e.elements.length) {\n            this._select(e.elements[0], e.indexes[0]);\n        }\n    }\n    _select(item, index) {\n        const completionModel = this._completionModel;\n        if (completionModel) {\n            this._onDidSelect.fire({ item, index, model: completionModel });\n            this.editor.focus();\n        }\n    }\n    _onThemeChange(theme) {\n        this._details.widget.borderWidth = isHighContrast(theme.type) ? 2 : 1;\n    }\n    _onListFocus(e) {\n        var _a;\n        if (this._ignoreFocusEvents) {\n            return;\n        }\n        if (!e.elements.length) {\n            if (this._currentSuggestionDetails) {\n                this._currentSuggestionDetails.cancel();\n                this._currentSuggestionDetails = undefined;\n                this._focusedItem = undefined;\n            }\n            this.editor.setAriaOptions({ activeDescendant: undefined });\n            this._ctxSuggestWidgetHasFocusedSuggestion.set(false);\n            return;\n        }\n        if (!this._completionModel) {\n            return;\n        }\n        this._ctxSuggestWidgetHasFocusedSuggestion.set(true);\n        const item = e.elements[0];\n        const index = e.indexes[0];\n        if (item !== this._focusedItem) {\n            (_a = this._currentSuggestionDetails) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._currentSuggestionDetails = undefined;\n            this._focusedItem = item;\n            this._list.reveal(index);\n            this._currentSuggestionDetails = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n                const loading = disposableTimeout(() => {\n                    if (this._isDetailsVisible()) {\n                        this.showDetails(true);\n                    }\n                }, 250);\n                const sub = token.onCancellationRequested(() => loading.dispose());\n                try {\n                    return yield item.resolve(token);\n                }\n                finally {\n                    loading.dispose();\n                    sub.dispose();\n                }\n            }));\n            this._currentSuggestionDetails.then(() => {\n                if (index >= this._list.length || item !== this._list.element(index)) {\n                    return;\n                }\n                // item can have extra information, so re-render\n                this._ignoreFocusEvents = true;\n                this._list.splice(index, 1, [item]);\n                this._list.setFocus([index]);\n                this._ignoreFocusEvents = false;\n                if (this._isDetailsVisible()) {\n                    this.showDetails(false);\n                }\n                else {\n                    this.element.domNode.classList.remove('docs-side');\n                }\n                this.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\n            }).catch(onUnexpectedError);\n        }\n        // emit an event\n        this._onDidFocus.fire({ item, index, model: this._completionModel });\n    }\n    _setState(state) {\n        if (this._state === state) {\n            return;\n        }\n        this._state = state;\n        this.element.domNode.classList.toggle('frozen', state === 4 /* State.Frozen */);\n        this.element.domNode.classList.remove('message');\n        switch (state) {\n            case 0 /* State.Hidden */:\n                dom.hide(this._messageElement, this._listElement, this._status.element);\n                this._details.hide(true);\n                this._status.hide();\n                this._contentWidget.hide();\n                this._ctxSuggestWidgetVisible.reset();\n                this._ctxSuggestWidgetMultipleSuggestions.reset();\n                this._ctxSuggestWidgetHasFocusedSuggestion.reset();\n                this._showTimeout.cancel();\n                this.element.domNode.classList.remove('visible');\n                this._list.splice(0, this._list.length);\n                this._focusedItem = undefined;\n                this._cappedHeight = undefined;\n                this._explainMode = false;\n                break;\n            case 1 /* State.Loading */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget_1.LOADING_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                status(SuggestWidget_1.LOADING_MESSAGE);\n                break;\n            case 2 /* State.Empty */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget_1.NO_SUGGESTIONS_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                status(SuggestWidget_1.NO_SUGGESTIONS_MESSAGE);\n                break;\n            case 3 /* State.Open */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 4 /* State.Frozen */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 5 /* State.Details */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._details.show();\n                this._show();\n                break;\n        }\n    }\n    _show() {\n        this._status.show();\n        this._contentWidget.show();\n        this._layout(this._persistedSize.restore());\n        this._ctxSuggestWidgetVisible.set(true);\n        this._showTimeout.cancelAndSet(() => {\n            this.element.domNode.classList.add('visible');\n            this._onDidShow.fire(this);\n        }, 100);\n    }\n    showTriggered(auto, delay) {\n        if (this._state !== 0 /* State.Hidden */) {\n            return;\n        }\n        this._contentWidget.setPosition(this.editor.getPosition());\n        this._isAuto = !!auto;\n        if (!this._isAuto) {\n            this._loadingTimeout = disposableTimeout(() => this._setState(1 /* State.Loading */), delay);\n        }\n    }\n    showSuggestions(completionModel, selectionIndex, isFrozen, isAuto, noFocus) {\n        var _a, _b;\n        this._contentWidget.setPosition(this.editor.getPosition());\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentSuggestionDetails) === null || _b === void 0 ? void 0 : _b.cancel();\n        this._currentSuggestionDetails = undefined;\n        if (this._completionModel !== completionModel) {\n            this._completionModel = completionModel;\n        }\n        if (isFrozen && this._state !== 2 /* State.Empty */ && this._state !== 0 /* State.Hidden */) {\n            this._setState(4 /* State.Frozen */);\n            return;\n        }\n        const visibleCount = this._completionModel.items.length;\n        const isEmpty = visibleCount === 0;\n        this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\n        if (isEmpty) {\n            this._setState(isAuto ? 0 /* State.Hidden */ : 2 /* State.Empty */);\n            this._completionModel = undefined;\n            return;\n        }\n        this._focusedItem = undefined;\n        // calling list.splice triggers focus event which this widget forwards. That can lead to\n        // suggestions being cancelled and the widget being cleared (and hidden). All this happens\n        // before revealing and focusing is done which means revealing and focusing will fail when\n        // they get run.\n        this._onDidFocus.pause();\n        this._onDidSelect.pause();\n        try {\n            this._list.splice(0, this._list.length, this._completionModel.items);\n            this._setState(isFrozen ? 4 /* State.Frozen */ : 3 /* State.Open */);\n            this._list.reveal(selectionIndex, 0);\n            this._list.setFocus(noFocus ? [] : [selectionIndex]);\n        }\n        finally {\n            this._onDidFocus.resume();\n            this._onDidSelect.resume();\n        }\n        this._pendingLayout.value = dom.runAtThisOrScheduleAtNextAnimationFrame(() => {\n            this._pendingLayout.clear();\n            this._layout(this.element.size);\n            // Reset focus border\n            this._details.widget.domNode.classList.remove('focused');\n        });\n    }\n    focusSelected() {\n        if (this._list.length > 0) {\n            this._list.setFocus([0]);\n        }\n    }\n    selectNextPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageDown();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNextPage();\n                return true;\n        }\n    }\n    selectNext() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNext(1, true);\n                return true;\n        }\n    }\n    selectLast() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollBottom();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusLast();\n                return true;\n        }\n    }\n    selectPreviousPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageUp();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPreviousPage();\n                return true;\n        }\n    }\n    selectPrevious() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPrevious(1, true);\n                return false;\n        }\n    }\n    selectFirst() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollTop();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusFirst();\n                return true;\n        }\n    }\n    getFocusedItem() {\n        if (this._state !== 0 /* State.Hidden */\n            && this._state !== 2 /* State.Empty */\n            && this._state !== 1 /* State.Loading */\n            && this._completionModel\n            && this._list.getFocus().length > 0) {\n            return {\n                item: this._list.getFocusedElements()[0],\n                index: this._list.getFocus()[0],\n                model: this._completionModel\n            };\n        }\n        return undefined;\n    }\n    toggleDetailsFocus() {\n        if (this._state === 5 /* State.Details */) {\n            this._setState(3 /* State.Open */);\n            this._details.widget.domNode.classList.remove('focused');\n        }\n        else if (this._state === 3 /* State.Open */ && this._isDetailsVisible()) {\n            this._setState(5 /* State.Details */);\n            this._details.widget.domNode.classList.add('focused');\n        }\n    }\n    toggleDetails() {\n        if (this._isDetailsVisible()) {\n            // hide details widget\n            this._pendingShowDetails.clear();\n            this._ctxSuggestWidgetDetailsVisible.set(false);\n            this._setDetailsVisible(false);\n            this._details.hide();\n            this.element.domNode.classList.remove('shows-details');\n        }\n        else if ((canExpandCompletionItem(this._list.getFocusedElements()[0]) || this._explainMode) && (this._state === 3 /* State.Open */ || this._state === 5 /* State.Details */ || this._state === 4 /* State.Frozen */)) {\n            // show details widget (iff possible)\n            this._ctxSuggestWidgetDetailsVisible.set(true);\n            this._setDetailsVisible(true);\n            this.showDetails(false);\n        }\n    }\n    showDetails(loading) {\n        this._pendingShowDetails.value = dom.runAtThisOrScheduleAtNextAnimationFrame(() => {\n            this._pendingShowDetails.clear();\n            this._details.show();\n            if (loading) {\n                this._details.widget.renderLoading();\n            }\n            else {\n                this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\n            }\n            this._positionDetails();\n            this.editor.focus();\n            this.element.domNode.classList.add('shows-details');\n        });\n    }\n    toggleExplainMode() {\n        if (this._list.getFocusedElements()[0]) {\n            this._explainMode = !this._explainMode;\n            if (!this._isDetailsVisible()) {\n                this.toggleDetails();\n            }\n            else {\n                this.showDetails(false);\n            }\n        }\n    }\n    resetPersistedSize() {\n        this._persistedSize.reset();\n    }\n    hideWidget() {\n        var _a;\n        this._pendingLayout.clear();\n        this._pendingShowDetails.clear();\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._setState(0 /* State.Hidden */);\n        this._onDidHide.fire(this);\n        this.element.clearSashHoverState();\n        // ensure that a reasonable widget height is persisted so that\n        // accidential \"resize-to-single-items\" cases aren't happening\n        const dim = this._persistedSize.restore();\n        const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\n        if (dim && dim.height < minPersistedHeight) {\n            this._persistedSize.store(dim.with(undefined, minPersistedHeight));\n        }\n    }\n    isFrozen() {\n        return this._state === 4 /* State.Frozen */;\n    }\n    _afterRender(position) {\n        if (position === null) {\n            if (this._isDetailsVisible()) {\n                this._details.hide(); //todo@jrieken soft-hide\n            }\n            return;\n        }\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // no special positioning when widget isn't showing list\n            return;\n        }\n        if (this._isDetailsVisible()) {\n            this._details.show();\n        }\n        this._positionDetails();\n    }\n    _layout(size) {\n        var _a, _b, _c;\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (!this.editor.getDomNode()) {\n            // happens when running tests\n            return;\n        }\n        const bodyBox = dom.getClientArea(this.element.domNode.ownerDocument.body);\n        const info = this.getLayoutInfo();\n        if (!size) {\n            size = info.defaultSize;\n        }\n        let height = size.height;\n        let width = size.width;\n        // status bar\n        this._status.element.style.height = `${info.itemHeight}px`;\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // showing a message only\n            height = info.itemHeight + info.borderHeight;\n            width = info.defaultSize.width / 2;\n            this.element.enableSashes(false, false, false, false);\n            this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\n            this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n        else {\n            // showing items\n            // width math\n            const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\n            if (width > maxWidth) {\n                width = maxWidth;\n            }\n            const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\n            // height math\n            const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\n            const minHeight = info.itemHeight + info.statusBarHeight;\n            const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\n            const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n            const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\n            const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\n            const availableSpaceAbove = editorBox.top + cursorBox.top - info.verticalPadding;\n            const maxHeightAbove = Math.min(availableSpaceAbove, fullHeight);\n            let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\n            if (height === ((_a = this._cappedHeight) === null || _a === void 0 ? void 0 : _a.capped)) {\n                // Restore the old (wanted) height when the current\n                // height is capped to fit\n                height = this._cappedHeight.wanted;\n            }\n            if (height < minHeight) {\n                height = minHeight;\n            }\n            if (height > maxHeight) {\n                height = maxHeight;\n            }\n            const forceRenderingAboveRequiredSpace = 150;\n            if (height > maxHeightBelow || (this._forceRenderingAbove && availableSpaceAbove > forceRenderingAboveRequiredSpace)) {\n                this._contentWidget.setPreference(1 /* ContentWidgetPositionPreference.ABOVE */);\n                this.element.enableSashes(true, true, false, false);\n                maxHeight = maxHeightAbove;\n            }\n            else {\n                this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n                this.element.enableSashes(false, true, true, false);\n                maxHeight = maxHeightBelow;\n            }\n            this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\n            this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\n            this.element.minSize = new dom.Dimension(220, minHeight);\n            // Know when the height was capped to fit and remember\n            // the wanted height for later. This is required when going\n            // left to widen suggestions.\n            this._cappedHeight = height === fullHeight\n                ? { wanted: (_c = (_b = this._cappedHeight) === null || _b === void 0 ? void 0 : _b.wanted) !== null && _c !== void 0 ? _c : size.height, capped: height }\n                : undefined;\n        }\n        this._resize(width, height);\n    }\n    _resize(width, height) {\n        const { width: maxWidth, height: maxHeight } = this.element.maxSize;\n        width = Math.min(maxWidth, width);\n        height = Math.min(maxHeight, height);\n        const { statusBarHeight } = this.getLayoutInfo();\n        this._list.layout(height - statusBarHeight, width);\n        this._listElement.style.height = `${height - statusBarHeight}px`;\n        this.element.layout(height, width);\n        this._contentWidget.layout();\n        this._positionDetails();\n    }\n    _positionDetails() {\n        var _a;\n        if (this._isDetailsVisible()) {\n            this._details.placeAtAnchor(this.element.domNode, ((_a = this._contentWidget.getPosition()) === null || _a === void 0 ? void 0 : _a.preference[0]) === 2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n    }\n    getLayoutInfo() {\n        const fontInfo = this.editor.getOption(50 /* EditorOption.fontInfo */);\n        const itemHeight = clamp(this.editor.getOption(119 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight, 8, 1000);\n        const statusBarHeight = !this.editor.getOption(117 /* EditorOption.suggest */).showStatusBar || this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */ ? 0 : itemHeight;\n        const borderWidth = this._details.widget.borderWidth;\n        const borderHeight = 2 * borderWidth;\n        return {\n            itemHeight,\n            statusBarHeight,\n            borderWidth,\n            borderHeight,\n            typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\n            verticalPadding: 22,\n            horizontalPadding: 14,\n            defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\n        };\n    }\n    _isDetailsVisible() {\n        return this._storageService.getBoolean('expandSuggestionDocs', 0 /* StorageScope.PROFILE */, false);\n    }\n    _setDetailsVisible(value) {\n        this._storageService.store('expandSuggestionDocs', value, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n    }\n    forceRenderingAbove() {\n        if (!this._forceRenderingAbove) {\n            this._forceRenderingAbove = true;\n            this._layout(this._persistedSize.restore());\n        }\n    }\n    stopForceRenderingAbove() {\n        this._forceRenderingAbove = false;\n    }\n};\nSuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\nSuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\nSuggestWidget = SuggestWidget_1 = __decorate([\n    __param(1, IStorageService),\n    __param(2, IContextKeyService),\n    __param(3, IThemeService),\n    __param(4, IInstantiationService)\n], SuggestWidget);\nexport { SuggestWidget };\nexport class SuggestContentWidget {\n    constructor(_widget, _editor) {\n        this._widget = _widget;\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._preferenceLocked = false;\n        this._added = false;\n        this._hidden = false;\n    }\n    dispose() {\n        if (this._added) {\n            this._added = false;\n            this._editor.removeContentWidget(this);\n        }\n    }\n    getId() {\n        return 'editor.widget.suggestWidget';\n    }\n    getDomNode() {\n        return this._widget.element.domNode;\n    }\n    show() {\n        this._hidden = false;\n        if (!this._added) {\n            this._added = true;\n            this._editor.addContentWidget(this);\n        }\n    }\n    hide() {\n        if (!this._hidden) {\n            this._hidden = true;\n            this.layout();\n        }\n    }\n    layout() {\n        this._editor.layoutContentWidget(this);\n    }\n    getPosition() {\n        if (this._hidden || !this._position || !this._preference) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [this._preference]\n        };\n    }\n    beforeRender() {\n        const { height, width } = this._widget.element.size;\n        const { borderWidth, horizontalPadding } = this._widget.getLayoutInfo();\n        return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\n    }\n    afterRender(position) {\n        this._widget._afterRender(position);\n    }\n    setPreference(preference) {\n        if (!this._preferenceLocked) {\n            this._preference = preference;\n        }\n    }\n    lockPreference() {\n        this._preferenceLocked = true;\n    }\n    unlockPreference() {\n        this._preferenceLocked = false;\n    }\n    setPosition(position) {\n        this._position = position;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestController_1;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { IdleValue } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { KeyCodeChord } from '../../../../base/common/keybindings.js';\nimport { DisposableStore, dispose, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType, isObject } from '../../../../base/common/types.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { WordContextKey } from './wordContextKey.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\nimport { SuggestAlternatives } from './suggestAlternatives.js';\nimport { CommitCharacterController } from './suggestCommitCharacters.js';\nimport { SuggestModel } from './suggestModel.js';\nimport { OvertypingCapturer } from './suggestOvertypingCapturer.js';\nimport { SuggestWidget } from './suggestWidget.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { basename, extname } from '../../../../base/common/resources.js';\nimport { hash } from '../../../../base/common/hash.js';\n// sticky suggest widget which doesn't disappear on focus out and such\nconst _sticky = false;\nclass LineSuffix {\n    constructor(_model, _position) {\n        this._model = _model;\n        this._position = _position;\n        // spy on what's happening right of the cursor. two cases:\n        // 1. end of line -> check that it's still end of line\n        // 2. mid of line -> add a marker and compute the delta\n        const maxColumn = _model.getLineMaxColumn(_position.lineNumber);\n        if (maxColumn !== _position.column) {\n            const offset = _model.getOffsetAt(_position);\n            const end = _model.getPositionAt(offset + 1);\n            this._marker = _model.deltaDecorations([], [{\n                    range: Range.fromPositions(_position, end),\n                    options: { description: 'suggest-line-suffix', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */ }\n                }]);\n        }\n    }\n    dispose() {\n        if (this._marker && !this._model.isDisposed()) {\n            this._model.deltaDecorations(this._marker, []);\n        }\n    }\n    delta(position) {\n        if (this._model.isDisposed() || this._position.lineNumber !== position.lineNumber) {\n            // bail out early if things seems fishy\n            return 0;\n        }\n        // read the marker (in case suggest was triggered at line end) or compare\n        // the cursor to the line end.\n        if (this._marker) {\n            const range = this._model.getDecorationRange(this._marker[0]);\n            const end = this._model.getOffsetAt(range.getStartPosition());\n            return end - this._model.getOffsetAt(position);\n        }\n        else {\n            return this._model.getLineMaxColumn(position.lineNumber) - position.column;\n        }\n    }\n}\nlet SuggestController = SuggestController_1 = class SuggestController {\n    static get(editor) {\n        return editor.getContribution(SuggestController_1.ID);\n    }\n    constructor(editor, _memoryService, _commandService, _contextKeyService, _instantiationService, _logService, _telemetryService) {\n        this._memoryService = _memoryService;\n        this._commandService = _commandService;\n        this._contextKeyService = _contextKeyService;\n        this._instantiationService = _instantiationService;\n        this._logService = _logService;\n        this._telemetryService = _telemetryService;\n        this._lineSuffix = new MutableDisposable();\n        this._toDispose = new DisposableStore();\n        this._selectors = new PriorityRegistry(s => s.priority);\n        this._onWillInsertSuggestItem = new Emitter();\n        this.onWillInsertSuggestItem = this._onWillInsertSuggestItem.event;\n        this.editor = editor;\n        this.model = _instantiationService.createInstance(SuggestModel, this.editor);\n        // default selector\n        this._selectors.register({\n            priority: 0,\n            select: (model, pos, items) => this._memoryService.select(model, pos, items)\n        });\n        // context key: update insert/replace mode\n        const ctxInsertMode = SuggestContext.InsertMode.bindTo(_contextKeyService);\n        ctxInsertMode.set(editor.getOption(117 /* EditorOption.suggest */).insertMode);\n        this._toDispose.add(this.model.onDidTrigger(() => ctxInsertMode.set(editor.getOption(117 /* EditorOption.suggest */).insertMode)));\n        this.widget = this._toDispose.add(new IdleValue(() => {\n            const widget = this._instantiationService.createInstance(SuggestWidget, this.editor);\n            this._toDispose.add(widget);\n            this._toDispose.add(widget.onDidSelect(item => this._insertSuggestion(item, 0 /* InsertFlags.None */), this));\n            // Wire up logic to accept a suggestion on certain characters\n            const commitCharacterController = new CommitCharacterController(this.editor, widget, this.model, item => this._insertSuggestion(item, 2 /* InsertFlags.NoAfterUndoStop */));\n            this._toDispose.add(commitCharacterController);\n            // Wire up makes text edit context key\n            const ctxMakesTextEdit = SuggestContext.MakesTextEdit.bindTo(this._contextKeyService);\n            const ctxHasInsertAndReplace = SuggestContext.HasInsertAndReplaceRange.bindTo(this._contextKeyService);\n            const ctxCanResolve = SuggestContext.CanResolve.bindTo(this._contextKeyService);\n            this._toDispose.add(toDisposable(() => {\n                ctxMakesTextEdit.reset();\n                ctxHasInsertAndReplace.reset();\n                ctxCanResolve.reset();\n            }));\n            this._toDispose.add(widget.onDidFocus(({ item }) => {\n                // (ctx: makesTextEdit)\n                const position = this.editor.getPosition();\n                const startColumn = item.editStart.column;\n                const endColumn = position.column;\n                let value = true;\n                if (this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */) === 'smart'\n                    && this.model.state === 2 /* State.Auto */\n                    && !item.completion.additionalTextEdits\n                    && !(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)\n                    && endColumn - startColumn === item.completion.insertText.length) {\n                    const oldText = this.editor.getModel().getValueInRange({\n                        startLineNumber: position.lineNumber,\n                        startColumn,\n                        endLineNumber: position.lineNumber,\n                        endColumn\n                    });\n                    value = oldText !== item.completion.insertText;\n                }\n                ctxMakesTextEdit.set(value);\n                // (ctx: hasInsertAndReplaceRange)\n                ctxHasInsertAndReplace.set(!Position.equals(item.editInsertEnd, item.editReplaceEnd));\n                // (ctx: canResolve)\n                ctxCanResolve.set(Boolean(item.provider.resolveCompletionItem) || Boolean(item.completion.documentation) || item.completion.detail !== item.completion.label);\n            }));\n            this._toDispose.add(widget.onDetailsKeyDown(e => {\n                // cmd + c on macOS, ctrl + c on Win / Linux\n                if (e.toKeyCodeChord().equals(new KeyCodeChord(true, false, false, false, 33 /* KeyCode.KeyC */)) ||\n                    (platform.isMacintosh && e.toKeyCodeChord().equals(new KeyCodeChord(false, false, false, true, 33 /* KeyCode.KeyC */)))) {\n                    e.stopPropagation();\n                    return;\n                }\n                if (!e.toKeyCodeChord().isModifierKey()) {\n                    this.editor.focus();\n                }\n            }));\n            return widget;\n        }));\n        // Wire up text overtyping capture\n        this._overtypingCapturer = this._toDispose.add(new IdleValue(() => {\n            return this._toDispose.add(new OvertypingCapturer(this.editor, this.model));\n        }));\n        this._alternatives = this._toDispose.add(new IdleValue(() => {\n            return this._toDispose.add(new SuggestAlternatives(this.editor, this._contextKeyService));\n        }));\n        this._toDispose.add(_instantiationService.createInstance(WordContextKey, editor));\n        this._toDispose.add(this.model.onDidTrigger(e => {\n            this.widget.value.showTriggered(e.auto, e.shy ? 250 : 50);\n            this._lineSuffix.value = new LineSuffix(this.editor.getModel(), e.position);\n        }));\n        this._toDispose.add(this.model.onDidSuggest(e => {\n            if (e.triggerOptions.shy) {\n                return;\n            }\n            let index = -1;\n            for (const selector of this._selectors.itemsOrderedByPriorityDesc) {\n                index = selector.select(this.editor.getModel(), this.editor.getPosition(), e.completionModel.items);\n                if (index !== -1) {\n                    break;\n                }\n            }\n            if (index === -1) {\n                index = 0;\n            }\n            let noFocus = false;\n            if (e.triggerOptions.auto) {\n                // don't \"focus\" item when configured to do\n                const options = this.editor.getOption(117 /* EditorOption.suggest */);\n                if (options.selectionMode === 'never' || options.selectionMode === 'always') {\n                    // simple: always or never\n                    noFocus = options.selectionMode === 'never';\n                }\n                else if (options.selectionMode === 'whenTriggerCharacter') {\n                    // on with trigger character\n                    noFocus = e.triggerOptions.triggerKind !== 1 /* CompletionTriggerKind.TriggerCharacter */;\n                }\n                else if (options.selectionMode === 'whenQuickSuggestion') {\n                    // without trigger character or when refiltering\n                    noFocus = e.triggerOptions.triggerKind === 1 /* CompletionTriggerKind.TriggerCharacter */ && !e.triggerOptions.refilter;\n                }\n            }\n            this.widget.value.showSuggestions(e.completionModel, index, e.isFrozen, e.triggerOptions.auto, noFocus);\n        }));\n        this._toDispose.add(this.model.onDidCancel(e => {\n            if (!e.retrigger) {\n                this.widget.value.hideWidget();\n            }\n        }));\n        this._toDispose.add(this.editor.onDidBlurEditorWidget(() => {\n            if (!_sticky) {\n                this.model.cancel();\n                this.model.clear();\n            }\n        }));\n        // Manage the acceptSuggestionsOnEnter context key\n        const acceptSuggestionsOnEnter = SuggestContext.AcceptSuggestionsOnEnter.bindTo(_contextKeyService);\n        const updateFromConfig = () => {\n            const acceptSuggestionOnEnter = this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */);\n            acceptSuggestionsOnEnter.set(acceptSuggestionOnEnter === 'on' || acceptSuggestionOnEnter === 'smart');\n        };\n        this._toDispose.add(this.editor.onDidChangeConfiguration(() => updateFromConfig()));\n        updateFromConfig();\n    }\n    dispose() {\n        this._alternatives.dispose();\n        this._toDispose.dispose();\n        this.widget.dispose();\n        this.model.dispose();\n        this._lineSuffix.dispose();\n        this._onWillInsertSuggestItem.dispose();\n    }\n    _insertSuggestion(event, flags) {\n        if (!event || !event.item) {\n            this._alternatives.value.reset();\n            this.model.cancel();\n            this.model.clear();\n            return;\n        }\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const snippetController = SnippetController2.get(this.editor);\n        if (!snippetController) {\n            return;\n        }\n        this._onWillInsertSuggestItem.fire({ item: event.item });\n        const model = this.editor.getModel();\n        const modelVersionNow = model.getAlternativeVersionId();\n        const { item } = event;\n        //\n        const tasks = [];\n        const cts = new CancellationTokenSource();\n        // pushing undo stops *before* additional text edits and\n        // *after* the main edit\n        if (!(flags & 1 /* InsertFlags.NoBeforeUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        // compute overwrite[Before|After] deltas BEFORE applying extra edits\n        const info = this.getOverwriteInfo(item, Boolean(flags & 8 /* InsertFlags.AlternativeOverwriteConfig */));\n        // keep item in memory\n        this._memoryService.memorize(model, this.editor.getPosition(), item);\n        const isResolved = item.isResolved;\n        // telemetry data points: duration of command execution, info about async additional edits (-1=n/a, -2=none, 1=success, 0=failed)\n        let _commandExectionDuration = -1;\n        let _additionalEditsAppliedAsync = -1;\n        if (Array.isArray(item.completion.additionalTextEdits)) {\n            // cancel -> stops all listening and closes widget\n            this.model.cancel();\n            // sync additional edits\n            const scrollState = StableEditorScrollState.capture(this.editor);\n            this.editor.executeEdits('suggestController.additionalTextEdits.sync', item.completion.additionalTextEdits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n            scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n        }\n        else if (!isResolved) {\n            // async additional edits\n            const sw = new StopWatch();\n            let position;\n            const docListener = model.onDidChangeContent(e => {\n                if (e.isFlush) {\n                    cts.cancel();\n                    docListener.dispose();\n                    return;\n                }\n                for (const change of e.changes) {\n                    const thisPosition = Range.getEndPosition(change.range);\n                    if (!position || Position.isBefore(thisPosition, position)) {\n                        position = thisPosition;\n                    }\n                }\n            });\n            const oldFlags = flags;\n            flags |= 2 /* InsertFlags.NoAfterUndoStop */;\n            let didType = false;\n            const typeListener = this.editor.onWillType(() => {\n                typeListener.dispose();\n                didType = true;\n                if (!(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n            });\n            tasks.push(item.resolve(cts.token).then(() => {\n                if (!item.completion.additionalTextEdits || cts.token.isCancellationRequested) {\n                    return undefined;\n                }\n                if (position && item.completion.additionalTextEdits.some(edit => Position.isBefore(position, Range.getStartPosition(edit.range)))) {\n                    return false;\n                }\n                if (didType) {\n                    this.editor.pushUndoStop();\n                }\n                const scrollState = StableEditorScrollState.capture(this.editor);\n                this.editor.executeEdits('suggestController.additionalTextEdits.async', item.completion.additionalTextEdits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n                scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n                if (didType || !(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n                return true;\n            }).then(applied => {\n                this._logService.trace('[suggest] async resolving of edits DONE (ms, applied?)', sw.elapsed(), applied);\n                _additionalEditsAppliedAsync = applied === true ? 1 : applied === false ? 0 : -2;\n            }).finally(() => {\n                docListener.dispose();\n                typeListener.dispose();\n            }));\n        }\n        let { insertText } = item.completion;\n        if (!(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)) {\n            insertText = SnippetParser.escape(insertText);\n        }\n        // cancel -> stops all listening and closes widget\n        this.model.cancel();\n        snippetController.insert(insertText, {\n            overwriteBefore: info.overwriteBefore,\n            overwriteAfter: info.overwriteAfter,\n            undoStopBefore: false,\n            undoStopAfter: false,\n            adjustWhitespace: !(item.completion.insertTextRules & 1 /* CompletionItemInsertTextRule.KeepWhitespace */),\n            clipboardText: event.model.clipboardText,\n            overtypingCapturer: this._overtypingCapturer.value\n        });\n        if (!(flags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        if (item.completion.command) {\n            if (item.completion.command.id === TriggerSuggestAction.id) {\n                // retigger\n                this.model.trigger({ auto: true, retrigger: true });\n            }\n            else {\n                // exec command, done\n                const sw = new StopWatch();\n                tasks.push(this._commandService.executeCommand(item.completion.command.id, ...(item.completion.command.arguments ? [...item.completion.command.arguments] : [])).catch(e => {\n                    if (item.completion.extensionId) {\n                        onUnexpectedExternalError(e);\n                    }\n                    else {\n                        onUnexpectedError(e);\n                    }\n                }).finally(() => {\n                    _commandExectionDuration = sw.elapsed();\n                }));\n            }\n        }\n        if (flags & 4 /* InsertFlags.KeepAlternativeSuggestions */) {\n            this._alternatives.value.set(event, next => {\n                // cancel resolving of additional edits\n                cts.cancel();\n                // this is not so pretty. when inserting the 'next'\n                // suggestion we undo until we are at the state at\n                // which we were before inserting the previous suggestion...\n                while (model.canUndo()) {\n                    if (modelVersionNow !== model.getAlternativeVersionId()) {\n                        model.undo();\n                    }\n                    this._insertSuggestion(next, 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */ | (flags & 8 /* InsertFlags.AlternativeOverwriteConfig */ ? 8 /* InsertFlags.AlternativeOverwriteConfig */ : 0));\n                    break;\n                }\n            });\n        }\n        this._alertCompletionItem(item);\n        // clear only now - after all tasks are done\n        Promise.all(tasks).finally(() => {\n            this._reportSuggestionAcceptedTelemetry(item, model, isResolved, _commandExectionDuration, _additionalEditsAppliedAsync);\n            this.model.clear();\n            cts.dispose();\n        });\n    }\n    _reportSuggestionAcceptedTelemetry(item, model, itemResolved, commandExectionDuration, additionalEditsAppliedAsync) {\n        var _a, _b, _c;\n        if (Math.floor(Math.random() * 100) === 0) {\n            // throttle telemetry event because accepting completions happens a lot\n            return;\n        }\n        this._telemetryService.publicLog2('suggest.acceptedSuggestion', {\n            extensionId: (_b = (_a = item.extensionId) === null || _a === void 0 ? void 0 : _a.value) !== null && _b !== void 0 ? _b : 'unknown',\n            providerId: (_c = item.provider._debugDisplayName) !== null && _c !== void 0 ? _c : 'unknown',\n            kind: item.completion.kind,\n            basenameHash: hash(basename(model.uri)).toString(16),\n            languageId: model.getLanguageId(),\n            fileExtension: extname(model.uri),\n            resolveInfo: !item.provider.resolveCompletionItem ? -1 : itemResolved ? 1 : 0,\n            resolveDuration: item.resolveDuration,\n            commandDuration: commandExectionDuration,\n            additionalEditsAsync: additionalEditsAppliedAsync\n        });\n    }\n    getOverwriteInfo(item, toggleMode) {\n        assertType(this.editor.hasModel());\n        let replace = this.editor.getOption(117 /* EditorOption.suggest */).insertMode === 'replace';\n        if (toggleMode) {\n            replace = !replace;\n        }\n        const overwriteBefore = item.position.column - item.editStart.column;\n        const overwriteAfter = (replace ? item.editReplaceEnd.column : item.editInsertEnd.column) - item.position.column;\n        const columnDelta = this.editor.getPosition().column - item.position.column;\n        const suffixDelta = this._lineSuffix.value ? this._lineSuffix.value.delta(this.editor.getPosition()) : 0;\n        return {\n            overwriteBefore: overwriteBefore + columnDelta,\n            overwriteAfter: overwriteAfter + suffixDelta\n        };\n    }\n    _alertCompletionItem(item) {\n        if (isNonEmptyArray(item.completion.additionalTextEdits)) {\n            const msg = nls.localize('aria.alert.snippet', \"Accepting '{0}' made {1} additional edits\", item.textLabel, item.completion.additionalTextEdits.length);\n            alert(msg);\n        }\n    }\n    triggerSuggest(onlyFrom, auto, noFilter) {\n        if (this.editor.hasModel()) {\n            this.model.trigger({\n                auto: auto !== null && auto !== void 0 ? auto : false,\n                completionOptions: { providerFilter: onlyFrom, kindFilter: noFilter ? new Set() : undefined }\n            });\n            this.editor.revealPosition(this.editor.getPosition(), 0 /* ScrollType.Smooth */);\n            this.editor.focus();\n        }\n    }\n    triggerSuggestAndAcceptBest(arg) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const positionNow = this.editor.getPosition();\n        const fallback = () => {\n            if (positionNow.equals(this.editor.getPosition())) {\n                this._commandService.executeCommand(arg.fallback);\n            }\n        };\n        const makesTextEdit = (item) => {\n            if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */ || item.completion.additionalTextEdits) {\n                // snippet, other editor -> makes edit\n                return true;\n            }\n            const position = this.editor.getPosition();\n            const startColumn = item.editStart.column;\n            const endColumn = position.column;\n            if (endColumn - startColumn !== item.completion.insertText.length) {\n                // unequal lengths -> makes edit\n                return true;\n            }\n            const textNow = this.editor.getModel().getValueInRange({\n                startLineNumber: position.lineNumber,\n                startColumn,\n                endLineNumber: position.lineNumber,\n                endColumn\n            });\n            // unequal text -> makes edit\n            return textNow !== item.completion.insertText;\n        };\n        Event.once(this.model.onDidTrigger)(_ => {\n            // wait for trigger because only then the cancel-event is trustworthy\n            const listener = [];\n            Event.any(this.model.onDidTrigger, this.model.onDidCancel)(() => {\n                // retrigger or cancel -> try to type default text\n                dispose(listener);\n                fallback();\n            }, undefined, listener);\n            this.model.onDidSuggest(({ completionModel }) => {\n                dispose(listener);\n                if (completionModel.items.length === 0) {\n                    fallback();\n                    return;\n                }\n                const index = this._memoryService.select(this.editor.getModel(), this.editor.getPosition(), completionModel.items);\n                const item = completionModel.items[index];\n                if (!makesTextEdit(item)) {\n                    fallback();\n                    return;\n                }\n                this.editor.pushUndoStop();\n                this._insertSuggestion({ index, item, model: completionModel }, 4 /* InsertFlags.KeepAlternativeSuggestions */ | 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */);\n            }, undefined, listener);\n        });\n        this.model.trigger({ auto: false, shy: true });\n        this.editor.revealPosition(positionNow, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    acceptSelectedSuggestion(keepAlternativeSuggestions, alternativeOverwriteConfig) {\n        const item = this.widget.value.getFocusedItem();\n        let flags = 0;\n        if (keepAlternativeSuggestions) {\n            flags |= 4 /* InsertFlags.KeepAlternativeSuggestions */;\n        }\n        if (alternativeOverwriteConfig) {\n            flags |= 8 /* InsertFlags.AlternativeOverwriteConfig */;\n        }\n        this._insertSuggestion(item, flags);\n    }\n    acceptNextSuggestion() {\n        this._alternatives.value.next();\n    }\n    acceptPrevSuggestion() {\n        this._alternatives.value.prev();\n    }\n    cancelSuggestWidget() {\n        this.model.cancel();\n        this.model.clear();\n        this.widget.value.hideWidget();\n    }\n    focusSuggestion() {\n        this.widget.value.focusSelected();\n    }\n    selectNextSuggestion() {\n        this.widget.value.selectNext();\n    }\n    selectNextPageSuggestion() {\n        this.widget.value.selectNextPage();\n    }\n    selectLastSuggestion() {\n        this.widget.value.selectLast();\n    }\n    selectPrevSuggestion() {\n        this.widget.value.selectPrevious();\n    }\n    selectPrevPageSuggestion() {\n        this.widget.value.selectPreviousPage();\n    }\n    selectFirstSuggestion() {\n        this.widget.value.selectFirst();\n    }\n    toggleSuggestionDetails() {\n        this.widget.value.toggleDetails();\n    }\n    toggleExplainMode() {\n        this.widget.value.toggleExplainMode();\n    }\n    toggleSuggestionFocus() {\n        this.widget.value.toggleDetailsFocus();\n    }\n    resetWidgetSize() {\n        this.widget.value.resetPersistedSize();\n    }\n    forceRenderingAbove() {\n        this.widget.value.forceRenderingAbove();\n    }\n    stopForceRenderingAbove() {\n        if (!this.widget.isInitialized) {\n            // This method has no effect if the widget is not initialized yet.\n            return;\n        }\n        this.widget.value.stopForceRenderingAbove();\n    }\n    registerSelector(selector) {\n        return this._selectors.register(selector);\n    }\n};\nSuggestController.ID = 'editor.contrib.suggestController';\nSuggestController = SuggestController_1 = __decorate([\n    __param(1, ISuggestMemoryService),\n    __param(2, ICommandService),\n    __param(3, IContextKeyService),\n    __param(4, IInstantiationService),\n    __param(5, ILogService),\n    __param(6, ITelemetryService)\n], SuggestController);\nexport { SuggestController };\nclass PriorityRegistry {\n    constructor(prioritySelector) {\n        this.prioritySelector = prioritySelector;\n        this._items = new Array();\n    }\n    register(value) {\n        if (this._items.indexOf(value) !== -1) {\n            throw new Error('Value is already registered');\n        }\n        this._items.push(value);\n        this._items.sort((s1, s2) => this.prioritySelector(s2) - this.prioritySelector(s1));\n        return {\n            dispose: () => {\n                const idx = this._items.indexOf(value);\n                if (idx >= 0) {\n                    this._items.splice(idx, 1);\n                }\n            }\n        };\n    }\n    get itemsOrderedByPriorityDesc() {\n        return this._items;\n    }\n}\nexport class TriggerSuggestAction extends EditorAction {\n    constructor() {\n        super({\n            id: TriggerSuggestAction.id,\n            label: nls.localize('suggest.trigger.label', \"Trigger Suggest\"),\n            alias: 'Trigger Suggest',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCompletionItemProvider, SuggestContext.Visible.toNegated()),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [512 /* KeyMod.Alt */ | 9 /* KeyCode.Escape */, 2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        const controller = SuggestController.get(editor);\n        if (!controller) {\n            return;\n        }\n        let auto;\n        if (args && typeof args === 'object') {\n            if (args.auto === true) {\n                auto = true;\n            }\n        }\n        controller.triggerSuggest(undefined, auto, undefined);\n    }\n}\nTriggerSuggestAction.id = 'editor.action.triggerSuggest';\nregisterEditorContribution(SuggestController.ID, SuggestController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(TriggerSuggestAction);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 90;\nconst SuggestCommand = EditorCommand.bindToContribution(SuggestController.get);\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion),\n    handler(x) {\n        x.acceptSelectedSuggestion(true, false);\n    },\n    kbOpts: [{\n            // normal tab\n            primary: 2 /* KeyCode.Tab */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\n            weight,\n        }, {\n            // accept on enter has special rules\n            primary: 3 /* KeyCode.Enter */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.AcceptSuggestionsOnEnter, SuggestContext.MakesTextEdit),\n            weight,\n        }],\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: SuggestContext.HasInsertAndReplaceRange.toNegated()\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert'))\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.replace', \"Replace\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace'))\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptAlternativeSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.HasFocusedSuggestion),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n        secondary: [1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */],\n    },\n    handler(x) {\n        x.acceptSelectedSuggestion(false, true);\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert')),\n            title: nls.localize('accept.replace', \"Replace\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace')),\n            title: nls.localize('accept.insert', \"Insert\")\n        }]\n}));\n// continue to support the old command\nCommandsRegistry.registerCommandAlias('acceptSelectedSuggestionOnEnter', 'acceptSelectedSuggestion');\nregisterEditorCommand(new SuggestCommand({\n    id: 'hideSuggestWidget',\n    precondition: SuggestContext.Visible,\n    handler: x => x.cancelSuggestWidget(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 18 /* KeyCode.DownArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n        mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */, 256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectNextPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 12 /* KeyCode.PageDown */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 12 /* KeyCode.PageDown */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectLastSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectLastSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 16 /* KeyCode.UpArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n        mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */, 256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectPrevPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 11 /* KeyCode.PageUp */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 11 /* KeyCode.PageUp */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectFirstSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectFirstSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'focusSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion.negate()),\n    handler: x => x.focusSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] }\n    },\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'focusAndAcceptSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion.negate()),\n    handler: c => {\n        c.focusSuggestion();\n        c.acceptSelectedSuggestion(true, false);\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionDetails',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion),\n    handler: x => x.toggleSuggestionDetails(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] }\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible, SuggestContext.CanResolve),\n            title: nls.localize('detail.more', \"show less\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible.toNegated(), SuggestContext.CanResolve),\n            title: nls.localize('detail.less', \"show more\")\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleExplainMode',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleExplainMode(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */,\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionFocus',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleSuggestionFocus(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */,\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */ }\n    }\n}));\n//#region tab completions\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertBestCompletion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), WordContextKey.AtEnd, SuggestContext.Visible.toNegated(), SuggestAlternatives.OtherSuggestions.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: (x, arg) => {\n        x.triggerSuggestAndAcceptBest(isObject(arg) ? Object.assign({ fallback: 'tab' }, arg) : { fallback: 'tab' });\n    },\n    kbOpts: {\n        weight,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertNextSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertPrevSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorAction(class extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.resetSuggestSize',\n            label: nls.localize('suggest.reset.label', \"Reset Suggest Widget Size\"),\n            alias: 'Reset Suggest Widget Size',\n            precondition: undefined\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        (_a = SuggestController.get(editor)) === null || _a === void 0 ? void 0 : _a.resetWidgetSize();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar EditorContribution_1;\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { RefCountedDisposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CompletionModel, LineContext } from './completionModel.js';\nimport { CompletionOptions, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nclass SuggestInlineCompletion {\n    constructor(range, insertText, filterText, additionalTextEdits, command, completion) {\n        this.range = range;\n        this.insertText = insertText;\n        this.filterText = filterText;\n        this.additionalTextEdits = additionalTextEdits;\n        this.command = command;\n        this.completion = completion;\n    }\n}\nlet InlineCompletionResults = class InlineCompletionResults extends RefCountedDisposable {\n    constructor(model, line, word, completionModel, completions, _suggestMemoryService) {\n        super(completions.disposable);\n        this.model = model;\n        this.line = line;\n        this.word = word;\n        this.completionModel = completionModel;\n        this._suggestMemoryService = _suggestMemoryService;\n    }\n    canBeReused(model, line, word) {\n        return this.model === model // same model\n            && this.line === line\n            && this.word.word.length > 0\n            && this.word.startColumn === word.startColumn && this.word.endColumn < word.endColumn // same word\n            && this.completionModel.getIncompleteProvider().size === 0; // no incomplete results\n    }\n    get items() {\n        var _a;\n        const result = [];\n        // Split items by preselected index. This ensures the memory-selected item shows first and that better/worst\n        // ranked items are before/after\n        const { items } = this.completionModel;\n        const selectedIndex = this._suggestMemoryService.select(this.model, { lineNumber: this.line, column: this.word.endColumn + this.completionModel.lineContext.characterCountDelta }, items);\n        const first = Iterable.slice(items, selectedIndex);\n        const second = Iterable.slice(items, 0, selectedIndex);\n        let resolveCount = 5;\n        for (const item of Iterable.concat(first, second)) {\n            if (item.score === FuzzyScore.Default) {\n                // skip items that have no overlap\n                continue;\n            }\n            const range = new Range(item.editStart.lineNumber, item.editStart.column, item.editInsertEnd.lineNumber, item.editInsertEnd.column + this.completionModel.lineContext.characterCountDelta // end PLUS character delta\n            );\n            const insertText = item.completion.insertTextRules && (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)\n                ? { snippet: item.completion.insertText }\n                : item.completion.insertText;\n            result.push(new SuggestInlineCompletion(range, insertText, (_a = item.filterTextLow) !== null && _a !== void 0 ? _a : item.labelLow, item.completion.additionalTextEdits, item.completion.command, item));\n            // resolve the first N suggestions eagerly\n            if (resolveCount-- >= 0) {\n                item.resolve(CancellationToken.None);\n            }\n        }\n        return result;\n    }\n};\nInlineCompletionResults = __decorate([\n    __param(5, ISuggestMemoryService)\n], InlineCompletionResults);\nlet SuggestInlineCompletions = class SuggestInlineCompletions {\n    constructor(_getEditorOption, _languageFeatureService, _clipboardService, _suggestMemoryService) {\n        this._getEditorOption = _getEditorOption;\n        this._languageFeatureService = _languageFeatureService;\n        this._clipboardService = _clipboardService;\n        this._suggestMemoryService = _suggestMemoryService;\n    }\n    provideInlineCompletions(model, position, context, token) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (context.selectedSuggestionInfo) {\n                return;\n            }\n            const config = this._getEditorOption(88 /* EditorOption.quickSuggestions */, model);\n            if (QuickSuggestionsOptions.isAllOff(config)) {\n                // quick suggest is off (for this model/language)\n                return;\n            }\n            model.tokenization.tokenizeIfCheap(position.lineNumber);\n            const lineTokens = model.tokenization.getLineTokens(position.lineNumber);\n            const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(position.column - 1 - 1, 0)));\n            if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'inline') {\n                // quick suggest is off (for this token)\n                return undefined;\n            }\n            // We consider non-empty leading words and trigger characters. The latter only\n            // when no word is being typed (word characters superseed trigger characters)\n            let wordInfo = model.getWordAtPosition(position);\n            let triggerCharacterInfo;\n            if (!(wordInfo === null || wordInfo === void 0 ? void 0 : wordInfo.word)) {\n                triggerCharacterInfo = this._getTriggerCharacterInfo(model, position);\n            }\n            if (!(wordInfo === null || wordInfo === void 0 ? void 0 : wordInfo.word) && !triggerCharacterInfo) {\n                // not at word, not a trigger character\n                return;\n            }\n            // ensure that we have word information and that we are at the end of a word\n            // otherwise we stop because we don't want to do quick suggestions inside words\n            if (!wordInfo) {\n                wordInfo = model.getWordUntilPosition(position);\n            }\n            if (wordInfo.endColumn !== position.column) {\n                return;\n            }\n            let result;\n            const leadingLineContents = model.getValueInRange(new Range(position.lineNumber, 1, position.lineNumber, position.column));\n            if (!triggerCharacterInfo && ((_a = this._lastResult) === null || _a === void 0 ? void 0 : _a.canBeReused(model, position.lineNumber, wordInfo))) {\n                // reuse a previous result iff possible, only a refilter is needed\n                // TODO@jrieken this can be improved further and only incomplete results can be updated\n                // console.log(`REUSE with ${wordInfo.word}`);\n                const newLineContext = new LineContext(leadingLineContents, position.column - this._lastResult.word.endColumn);\n                this._lastResult.completionModel.lineContext = newLineContext;\n                this._lastResult.acquire();\n                result = this._lastResult;\n            }\n            else {\n                // refesh model is required\n                const completions = yield provideSuggestionItems(this._languageFeatureService.completionProvider, model, position, new CompletionOptions(undefined, undefined, triggerCharacterInfo === null || triggerCharacterInfo === void 0 ? void 0 : triggerCharacterInfo.providers), triggerCharacterInfo && { triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */, triggerCharacter: triggerCharacterInfo.ch }, token);\n                let clipboardText;\n                if (completions.needsClipboard) {\n                    clipboardText = yield this._clipboardService.readText();\n                }\n                const completionModel = new CompletionModel(completions.items, position.column, new LineContext(leadingLineContents, 0), WordDistance.None, this._getEditorOption(117 /* EditorOption.suggest */, model), this._getEditorOption(111 /* EditorOption.snippetSuggestions */, model), { boostFullMatch: false, firstMatchCanBeWeak: false }, clipboardText);\n                result = new InlineCompletionResults(model, position.lineNumber, wordInfo, completionModel, completions, this._suggestMemoryService);\n            }\n            this._lastResult = result;\n            return result;\n        });\n    }\n    handleItemDidShow(_completions, item) {\n        item.completion.resolve(CancellationToken.None);\n    }\n    freeInlineCompletions(result) {\n        result.release();\n    }\n    _getTriggerCharacterInfo(model, position) {\n        var _a;\n        const ch = model.getValueInRange(Range.fromPositions({ lineNumber: position.lineNumber, column: position.column - 1 }, position));\n        const providers = new Set();\n        for (const provider of this._languageFeatureService.completionProvider.all(model)) {\n            if ((_a = provider.triggerCharacters) === null || _a === void 0 ? void 0 : _a.includes(ch)) {\n                providers.add(provider);\n            }\n        }\n        if (providers.size === 0) {\n            return undefined;\n        }\n        return { providers, ch };\n    }\n};\nSuggestInlineCompletions = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IClipboardService),\n    __param(3, ISuggestMemoryService)\n], SuggestInlineCompletions);\nexport { SuggestInlineCompletions };\nlet EditorContribution = EditorContribution_1 = class EditorContribution {\n    constructor(_editor, languageFeatureService, editorService, instaService) {\n        // HACK - way to contribute something only once\n        if (++EditorContribution_1._counter === 1) {\n            const provider = instaService.createInstance(SuggestInlineCompletions, (id, model) => {\n                var _a;\n                // HACK - reuse the editor options world outside from a \"normal\" contribution\n                const editor = (_a = editorService.listCodeEditors().find(editor => editor.getModel() === model)) !== null && _a !== void 0 ? _a : _editor;\n                return editor.getOption(id);\n            });\n            EditorContribution_1._disposable = languageFeatureService.inlineCompletionsProvider.register('*', provider);\n        }\n    }\n    dispose() {\n        var _a;\n        if (--EditorContribution_1._counter === 0) {\n            (_a = EditorContribution_1._disposable) === null || _a === void 0 ? void 0 : _a.dispose();\n            EditorContribution_1._disposable = undefined;\n        }\n    }\n};\nEditorContribution._counter = 0;\nEditorContribution = EditorContribution_1 = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ICodeEditorService),\n    __param(3, IInstantiationService)\n], EditorContribution);\nregisterEditorContribution('suggest.inlineCompletionsProvider', EditorContribution, 0 /* EditorContributionInstantiation.Eager */); // eager because the contribution is used as a way to ONCE access a service to which a provider is registered\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestMemoryService_1;\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { TernarySearchTree } from '../../../../base/common/ternarySearchTree.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, WillSaveStateReason } from '../../../../platform/storage/common/storage.js';\nexport class Memory {\n    constructor(name) {\n        this.name = name;\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const topScore = items[0].score[0];\n        for (let i = 0; i < items.length; i++) {\n            const { score, completion: suggestion } = items[i];\n            if (score[0] !== topScore) {\n                // stop when leaving the group of top matches\n                break;\n            }\n            if (suggestion.preselect) {\n                // stop when seeing an auto-select-item\n                return i;\n            }\n        }\n        return 0;\n    }\n}\nexport class NoMemory extends Memory {\n    constructor() {\n        super('first');\n    }\n    memorize(model, pos, item) {\n        // no-op\n    }\n    toJSON() {\n        return undefined;\n    }\n    fromJSON() {\n        //\n    }\n}\nexport class LRUMemory extends Memory {\n    constructor() {\n        super('recentlyUsed');\n        this._cache = new LRUCache(300, 0.66);\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const key = `${model.getLanguageId()}/${item.textLabel}`;\n        this._cache.set(key, {\n            touch: this._seq++,\n            type: item.completion.kind,\n            insertText: item.completion.insertText\n        });\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const lineSuffix = model.getLineContent(pos.lineNumber).substr(pos.column - 10, pos.column - 1);\n        if (/\\s$/.test(lineSuffix)) {\n            return super.select(model, pos, items);\n        }\n        const topScore = items[0].score[0];\n        let indexPreselect = -1;\n        let indexRecency = -1;\n        let seq = -1;\n        for (let i = 0; i < items.length; i++) {\n            if (items[i].score[0] !== topScore) {\n                // consider only top items\n                break;\n            }\n            const key = `${model.getLanguageId()}/${items[i].textLabel}`;\n            const item = this._cache.peek(key);\n            if (item && item.touch > seq && item.type === items[i].completion.kind && item.insertText === items[i].completion.insertText) {\n                seq = item.touch;\n                indexRecency = i;\n            }\n            if (items[i].completion.preselect && indexPreselect === -1) {\n                // stop when seeing an auto-select-item\n                return indexPreselect = i;\n            }\n        }\n        if (indexRecency !== -1) {\n            return indexRecency;\n        }\n        else if (indexPreselect !== -1) {\n            return indexPreselect;\n        }\n        else {\n            return 0;\n        }\n    }\n    toJSON() {\n        return this._cache.toJSON();\n    }\n    fromJSON(data) {\n        this._cache.clear();\n        const seq = 0;\n        for (const [key, value] of data) {\n            value.touch = seq;\n            value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n            this._cache.set(key, value);\n        }\n        this._seq = this._cache.size;\n    }\n}\nexport class PrefixMemory extends Memory {\n    constructor() {\n        super('recentlyUsedByPrefix');\n        this._trie = TernarySearchTree.forStrings();\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const { word } = model.getWordUntilPosition(pos);\n        const key = `${model.getLanguageId()}/${word}`;\n        this._trie.set(key, {\n            type: item.completion.kind,\n            insertText: item.completion.insertText,\n            touch: this._seq++\n        });\n    }\n    select(model, pos, items) {\n        const { word } = model.getWordUntilPosition(pos);\n        if (!word) {\n            return super.select(model, pos, items);\n        }\n        const key = `${model.getLanguageId()}/${word}`;\n        let item = this._trie.get(key);\n        if (!item) {\n            item = this._trie.findSubstr(key);\n        }\n        if (item) {\n            for (let i = 0; i < items.length; i++) {\n                const { kind, insertText } = items[i].completion;\n                if (kind === item.type && insertText === item.insertText) {\n                    return i;\n                }\n            }\n        }\n        return super.select(model, pos, items);\n    }\n    toJSON() {\n        const entries = [];\n        this._trie.forEach((value, key) => entries.push([key, value]));\n        // sort by last recently used (touch), then\n        // take the top 200 item and normalize their\n        // touch\n        entries\n            .sort((a, b) => -(a[1].touch - b[1].touch))\n            .forEach((value, i) => value[1].touch = i);\n        return entries.slice(0, 200);\n    }\n    fromJSON(data) {\n        this._trie.clear();\n        if (data.length > 0) {\n            this._seq = data[0][1].touch + 1;\n            for (const [key, value] of data) {\n                value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n                this._trie.set(key, value);\n            }\n        }\n    }\n}\nlet SuggestMemoryService = SuggestMemoryService_1 = class SuggestMemoryService {\n    constructor(_storageService, _configService) {\n        this._storageService = _storageService;\n        this._configService = _configService;\n        this._disposables = new DisposableStore();\n        this._persistSoon = new RunOnceScheduler(() => this._saveState(), 500);\n        this._disposables.add(_storageService.onWillSaveState(e => {\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\n                this._saveState();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._persistSoon.dispose();\n    }\n    memorize(model, pos, item) {\n        this._withStrategy(model, pos).memorize(model, pos, item);\n        this._persistSoon.schedule();\n    }\n    select(model, pos, items) {\n        return this._withStrategy(model, pos).select(model, pos, items);\n    }\n    _withStrategy(model, pos) {\n        var _a;\n        const mode = this._configService.getValue('editor.suggestSelection', {\n            overrideIdentifier: model.getLanguageIdAtPosition(pos.lineNumber, pos.column),\n            resource: model.uri\n        });\n        if (((_a = this._strategy) === null || _a === void 0 ? void 0 : _a.name) !== mode) {\n            this._saveState();\n            const ctor = SuggestMemoryService_1._strategyCtors.get(mode) || NoMemory;\n            this._strategy = new ctor();\n            try {\n                const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n                const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n                const raw = this._storageService.get(`${SuggestMemoryService_1._storagePrefix}/${mode}`, scope);\n                if (raw) {\n                    this._strategy.fromJSON(JSON.parse(raw));\n                }\n            }\n            catch (e) {\n                // things can go wrong with JSON...\n            }\n        }\n        return this._strategy;\n    }\n    _saveState() {\n        if (this._strategy) {\n            const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n            const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n            const raw = JSON.stringify(this._strategy);\n            this._storageService.store(`${SuggestMemoryService_1._storagePrefix}/${this._strategy.name}`, raw, scope, 1 /* StorageTarget.MACHINE */);\n        }\n    }\n};\nSuggestMemoryService._strategyCtors = new Map([\n    ['recentlyUsedByPrefix', PrefixMemory],\n    ['recentlyUsed', LRUMemory],\n    ['first', NoMemory]\n]);\nSuggestMemoryService._storagePrefix = 'suggest/memories';\nSuggestMemoryService = SuggestMemoryService_1 = __decorate([\n    __param(0, IStorageService),\n    __param(1, IConfigurationService)\n], SuggestMemoryService);\nexport { SuggestMemoryService };\nexport const ISuggestMemoryService = createDecorator('ISuggestMemories');\nregisterSingleton(ISuggestMemoryService, SuggestMemoryService, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { binarySearch, isFalsyOrEmpty } from '../../../../base/common/arrays.js';\nimport { Range } from '../../../common/core/range.js';\nimport { BracketSelectionRangeProvider } from '../../smartSelect/browser/bracketSelections.js';\nexport class WordDistance {\n    static create(service, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!editor.getOption(117 /* EditorOption.suggest */).localityBonus) {\n                return WordDistance.None;\n            }\n            if (!editor.hasModel()) {\n                return WordDistance.None;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!service.canComputeWordRanges(model.uri)) {\n                return WordDistance.None;\n            }\n            const [ranges] = yield new BracketSelectionRangeProvider().provideSelectionRanges(model, [position]);\n            if (ranges.length === 0) {\n                return WordDistance.None;\n            }\n            const wordRanges = yield service.computeWordRanges(model.uri, ranges[0].range);\n            if (!wordRanges) {\n                return WordDistance.None;\n            }\n            // remove current word\n            const wordUntilPos = model.getWordUntilPosition(position);\n            delete wordRanges[wordUntilPos.word];\n            return new class extends WordDistance {\n                distance(anchor, item) {\n                    if (!position.equals(editor.getPosition())) {\n                        return 0;\n                    }\n                    if (item.kind === 17 /* CompletionItemKind.Keyword */) {\n                        return 2 << 20;\n                    }\n                    const word = typeof item.label === 'string' ? item.label : item.label.label;\n                    const wordLines = wordRanges[word];\n                    if (isFalsyOrEmpty(wordLines)) {\n                        return 2 << 20;\n                    }\n                    const idx = binarySearch(wordLines, Range.fromPositions(anchor), Range.compareRangesUsingStarts);\n                    const bestWordRange = idx >= 0 ? wordLines[idx] : wordLines[Math.max(0, ~idx - 1)];\n                    let blockDistance = ranges.length;\n                    for (const range of ranges) {\n                        if (!Range.containsRange(range.range, bestWordRange)) {\n                            break;\n                        }\n                        blockDistance -= 1;\n                    }\n                    return blockDistance;\n                }\n            };\n        });\n    }\n}\nWordDistance.None = new class extends WordDistance {\n    distance() { return 0; }\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './symbolIcons.css';\nimport { localize } from '../../../../nls.js';\nimport { foreground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nexport const SYMBOL_ICON_ARRAY_FOREGROUND = registerColor('symbolIcon.arrayForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.arrayForeground', 'The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_BOOLEAN_FOREGROUND = registerColor('symbolIcon.booleanForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.booleanForeground', 'The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CLASS_FOREGROUND = registerColor('symbolIcon.classForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.classForeground', 'The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_COLOR_FOREGROUND = registerColor('symbolIcon.colorForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.colorForeground', 'The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTANT_FOREGROUND = registerColor('symbolIcon.constantForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.constantForeground', 'The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTRUCTOR_FOREGROUND = registerColor('symbolIcon.constructorForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.constructorForeground', 'The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_FOREGROUND = registerColor('symbolIcon.enumeratorForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.enumeratorForeground', 'The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND = registerColor('symbolIcon.enumeratorMemberForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.enumeratorMemberForeground', 'The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_EVENT_FOREGROUND = registerColor('symbolIcon.eventForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.eventForeground', 'The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FIELD_FOREGROUND = registerColor('symbolIcon.fieldForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.fieldForeground', 'The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FILE_FOREGROUND = registerColor('symbolIcon.fileForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.fileForeground', 'The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FOLDER_FOREGROUND = registerColor('symbolIcon.folderForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.folderForeground', 'The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FUNCTION_FOREGROUND = registerColor('symbolIcon.functionForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.functionForeground', 'The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_INTERFACE_FOREGROUND = registerColor('symbolIcon.interfaceForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.interfaceForeground', 'The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEY_FOREGROUND = registerColor('symbolIcon.keyForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.keyForeground', 'The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEYWORD_FOREGROUND = registerColor('symbolIcon.keywordForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.keywordForeground', 'The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_METHOD_FOREGROUND = registerColor('symbolIcon.methodForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.methodForeground', 'The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_MODULE_FOREGROUND = registerColor('symbolIcon.moduleForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.moduleForeground', 'The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NAMESPACE_FOREGROUND = registerColor('symbolIcon.namespaceForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.namespaceForeground', 'The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NULL_FOREGROUND = registerColor('symbolIcon.nullForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.nullForeground', 'The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NUMBER_FOREGROUND = registerColor('symbolIcon.numberForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.numberForeground', 'The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OBJECT_FOREGROUND = registerColor('symbolIcon.objectForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.objectForeground', 'The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OPERATOR_FOREGROUND = registerColor('symbolIcon.operatorForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.operatorForeground', 'The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PACKAGE_FOREGROUND = registerColor('symbolIcon.packageForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.packageForeground', 'The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PROPERTY_FOREGROUND = registerColor('symbolIcon.propertyForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.propertyForeground', 'The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_REFERENCE_FOREGROUND = registerColor('symbolIcon.referenceForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.referenceForeground', 'The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_SNIPPET_FOREGROUND = registerColor('symbolIcon.snippetForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.snippetForeground', 'The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRING_FOREGROUND = registerColor('symbolIcon.stringForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.stringForeground', 'The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRUCT_FOREGROUND = registerColor('symbolIcon.structForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.structForeground', 'The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TEXT_FOREGROUND = registerColor('symbolIcon.textForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.textForeground', 'The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TYPEPARAMETER_FOREGROUND = registerColor('symbolIcon.typeParameterForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.typeParameterForeground', 'The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_UNIT_FOREGROUND = registerColor('symbolIcon.unitForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.unitForeground', 'The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_VARIABLE_FOREGROUND = registerColor('symbolIcon.variableForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC',\n}, localize('symbolIcon.variableForeground', 'The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\n"],"names":["AbstractEditorCommandsQuickAccessProvider","AbstractCommandsQuickAccessProvider","constructor","options","instantiationService","keybindingService","commandService","telemetryService","dialogService","super","getCodeEditorCommandPicks","activeTextEditorControl","this","editorCommandPicks","editorAction","getSupportedActions","push","commandId","id","commandAlias","alias","label","stripIcons","AbstractEditorNavigationQuickAccessProvider","rangeHighlightDecorationId","undefined","provide","picker","token","_a","disposables","DisposableStore","canAcceptInBackground","matchOnLabel","matchOnDescription","matchOnDetail","sortByLabel","pickerDisposable","add","MutableDisposable","value","doProvide","onDidActiveTextEditorControlChange","editor","canProvideWithTextEditor","context","codeEditor","getCodeEditor","lastKnownEditorViewState","saveViewState","onDidChangeCursorPosition","restoreViewState","createSingleCallFunction","onCancellationRequested","call","toDisposable","clearDecorations","provideWithTextEditor","provideWithoutTextEditor","gotoLocation","_ref","setSelection","range","revealRangeInCenter","preserveFocus","focus","model","getModel","status","concat","getLineContent","startLineNumber","isDiffEditor","modified","addDecorations","changeDecorations","changeAccessor","deleteDecorations","overviewRulerDecorationId","rangeHighlightId","newDecorations","description","className","isWholeLine","overviewRuler","color","themeColorFromId","overviewRulerRangeHighlight","position","OverviewRulerLane","Full","deltaDecorations","AbstractGotoLineQuickAccessProvider","localize","items","ariaLabel","Disposable","None","onDidAccept","event","item","selectedItems","isValidLineNumber","lineNumber","toRange","column","keyMods","inBackground","hide","updatePickerAndEditor","parsePosition","trim","substr","PREFIX","length","getPickLabel","onDidChangeValue","getOptions","get","renderType","updateOptions","lineNumbers","arguments","startColumn","endLineNumber","endColumn","numbers","split","map","part","parseInt","filter","isNaN","endLine","lineCount","isValidColumn","getPosition","positionCandidate","validatePosition","equals","_b","getLineCount","AbstractGotoSymbolQuickAccessProvider_1","__decorate","decorators","target","key","desc","d","c","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","AbstractGotoSymbolQuickAccessProvider","_languageFeaturesService","_outlineModelService","create","provideLabelPick","documentSymbolProvider","has","doProvideWithEditorSymbols","doProvideWithoutEditorSymbols","waitForLanguageSymbolRegistry","isCancellationRequested","index","kind","symbolProviderRegistryPromise","DeferredPromise","symbolProviderListener","onDidChange","dispose","complete","p","selection","onDidTriggerItemButton","forceSideBySide","symbolsPromise","getDocumentSymbols","picksCts","updatePickerItems","positionToEnclose","busy","CancellationTokenSource","query","prepareQuery","doGetSymbolPicks","original","candidate","findLast","Boolean","type","Range","containsPosition","decoration","activeItems","getSelection","onDidChangeActive","symbols","filterBySymbolKind","indexOf","SCOPE_PREFIX","filterPos","symbolQuery","containerQuery","buttons","values","pieceToQuery","slice","openSideBySideDirection","iconClass","ThemeIcon","asClassName","Codicon","splitHorizontal","splitVertical","tooltip","filteredSymbolPicks","symbol","symbolLabel","name","symbolLabelWithIcon","SymbolKinds","toIcon","symbolLabelIconOffset","symbolScore","symbolMatches","containerScore","containerMatches","containerLabel","containerName","extraContainerLabel","skipContainerQuery","scoreFuzzy2","assign","deprecated","tags","score","getAriaLabelForSymbol","highlights","collapseToStart","selectionRange","strikethrough","sortedFilteredSymbolPicks","sort","symbolA","symbolB","compareByKindAndScore","compareByScore","symbolPicks","lastSymbolKind","lastSeparator","lastSymbolKindCounter","updateLastSeparatorLabel","format","NLS_SYMBOL_KIND_CACHE","FALLBACK_NLS_SYMBOL_KIND","symbolPick","kindA","kindB","localeCompare","document","getOrCreate","asListOfDocumentSymbols","PREFIX_BY_CATEGORY","ILanguageFeaturesService","IOutlineModelService","ReadOnlyMessageController","_register","onDidAttemptReadOnlyEdit","_onDidAttemptReadOnlyEdit","messageController","MessageController","hasModel","message","isSimpleWidget","MarkdownString","nls","showMessage","ID","registerEditorContribution","CONTEXT_RENAME_INPUT_VISIBLE","RawContextKey","RenameInputField","_editor","_acceptKeybindings","_themeService","_keybindingService","contextKeyService","_disposables","allowEditorOverflow","_visibleContextKey","bindTo","addContentWidget","onDidChangeConfiguration","hasChanged","_updateFont","onDidColorThemeChange","_updateStyles","removeContentWidget","getId","getDomNode","_domNode","createElement","_input","setAttribute","appendChild","_label","getColorTheme","theme","_c","_d","widgetShadowColor","getColor","widgetShadow","widgetBorderColor","widgetBorder","style","backgroundColor","String","editorWidgetBackground","boxShadow","border","inputForeground","inputBackground","inputBorder","borderWidth","borderStyle","borderColor","toString","fontInfo","getOption","fontFamily","fontWeight","fontSize","_visible","_position","preference","beforeRender","accept","preview","innerText","comment","lookupKeybinding","getLabel","afterRender","cancelInput","acceptInput","wantsPreview","_currentAcceptInput","focusEditor","_currentCancelInput","getInput","where","selectionStart","selectionEnd","supportPreview","classList","toggle","Position","size","Math","max","disposeOnDone","newName","onDidBlurEditorWidget","ownerDocument","hasFocus","_show","finally","_hide","revealLineInCenterIfOutsideViewport","set","layoutContentWidget","setTimeout","setSelectionRange","getAttribute","reset","IThemeService","IKeybindingService","IContextKeyService","RenameController_1","RenameSkeleton","registry","_providerRenameIdx","_providers","ordered","hasProvider","resolveRenameLocation","rejects","provider","res","rejectReason","word","getWordAtPosition","text","join","fromPositions","provideRenameEdits","_provideRenameEdits","edits","rename","skeleton","loc","CancellationToken","RenameController","getContribution","_instaService","_notificationService","_bulkEditService","_progressService","_logService","_configService","_disposableStore","_cts","_renameInputField","createInstance","run","renameProvider","cts1","EditorStateCancellationTokenSource","resolveLocationOperation","showWhile","cts2","isEmpty","spansMultipleLines","containsRange","min","hasPreviewHandler","getValue","uri","inputFieldResult","renameOperation","raceCancellation","renameResult","info","showPreview","code","quotableLabel","respectAutoSaveConfig","ariaSummary","alert","catch","err","error","acceptRenameInput","cancelRenameInput","IInstantiationService","INotificationService","IBulkEditService","IEditorProgressService","ILogService","ITextResourceConfigurationService","RenameAction","EditorAction","precondition","ContextKeyExpr","and","EditorContextKeys","writable","hasRenameProvider","kbOpts","kbExpr","editorTextFocus","primary","weight","contextMenuOpts","group","order","runCommand","accessor","args","editorService","ICodeEditorService","pos","Array","isArray","URI","isUri","isIPosition","openCodeEditor","resource","getActiveCodeEditor","setPosition","invokeWithinContext","reportTelemetry","onUnexpectedError","controller","registerEditorAction","RenameCommand","EditorCommand","bindToContribution","registerEditorCommand","handler","x","not","secondary","registerModelAndPositionCommand","_len","_key","assertType","Error","Registry","as","Extensions","Configuration","registerConfiguration","properties","scope","default","ModelSemanticColoring_1","DocumentSemanticTokensFeature","semanticTokensStylingService","modelService","themeService","configurationService","languageFeatureDebounceService","languageFeaturesService","_watchers","register","ModelSemanticColoring","deregister","modelSemanticColoring","handleSettingOrThemeChange","getModels","curr","isSemanticColoringEnabled","onModelAdded","onModelRemoved","affectsConfiguration","SEMANTIC_HIGHLIGHTING_SETTING_ID","watcher","ISemanticTokensStylingService","IModelService","IConfigurationService","ILanguageFeatureDebounceService","_semanticTokensStylingService","_isDisposed","_model","_provider","documentSemanticTokensProvider","_debounceInformation","for","REQUEST_MIN_DELAY","REQUEST_MAX_DELAY","_fetchDocumentSemanticTokens","RunOnceScheduler","_fetchDocumentSemanticTokensNow","_currentDocumentResponse","_currentDocumentRequestCancellationTokenSource","_documentProvidersChangeListeners","_providersChangedDuringRequest","onDidChangeContent","isScheduled","schedule","onDidChangeAttached","onDidChangeLanguage","cancel","_setDocumentSemanticTokens","bindDocumentChangeListeners","all","_","hasDocumentSemanticTokensProvider","tokenization","setSemanticTokens","isAttachedToEditor","cancellationTokenSource","lastProvider","lastResultId","resultId","request","getDocumentSemanticTokens","pendingChanges","contentChangeListener","sw","StopWatch","update","elapsed","tokens","styling","getStyling","errors","_copy","src","srcOffset","dest","destOffset","currentResponse","rescheduleIfNeeded","releaseDocumentSemanticTokens","isSemanticTokensEdits","data","deltaLength","edit","deleteCount","srcData","destData","Uint32Array","srcLastStart","destLastStart","start","warnInvalidEditStart","copyCount","isSemanticTokens","SemanticTokensResponse","toMultilineTokens2","getLanguageId","change","area","singleChange","changes","applyEdit","registerEditorFeature","ViewportSemanticTokensContribution","_configurationService","documentRangeSemanticTokensProvider","_tokenizeViewport","_tokenizeViewportNow","_outstandingRequests","scheduleTokenizeViewport","onDidScrollChange","onDidChangeModel","_cancelAll","onDidChangeModelContent","_removeOutstandingRequest","req","len","splice","hasCompleteSemanticTokens","hasSomeSemanticTokens","hasDocumentRangeSemanticTokensProvider","visibleRanges","getVisibleRangesPlusViewportAboveBelow","_requestRange","requestVersionId","getVersionId","createCancelablePromise","getDocumentRangeSemanticTokens","isDisposed","setPartialSemanticTokens","v","DocumentSemanticTokensResult","providers","groups","orderedGroups","getDocumentSemanticTokensProviders","results","provideDocumentSemanticTokens","DocumentRangeSemanticTokensResult","getDocumentRangeSemanticTokensProviders","provideDocumentRangeSemanticTokens","onUnexpectedExternalError","CommandsRegistry","registerCommand","_getDocumentSemanticTokensProviderHighestGroup","getLegend","ICommandService","executeCommand","_len2","_key2","getFullModelRange","buff","encodeSemanticTokensDto","_len3","_key3","isIRange","console","warn","lift","_len4","_key4","setting","overrideIdentifier","enabled","semanticHighlighting","BracketSelectionRangeProvider","provideSelectionRanges","positions","bucket","ranges","Map","_bracketsRightYield","_bracketsLeftYield","round","counts","t1","Date","now","_maxRounds","bracket","bracketPairs","findNextBracket","_maxDuration","bracketInfo","isOpeningBracket","bracketText","val","getOpeningBrackets","list","LinkedList","getEndPosition","findPrevBracket","closing","shift","delete","innerBracket","getStartPosition","outerBracket","_addBracketLeading","startLine","getLineFirstNonWhitespaceColumn","aboveLine","getLineLastNonWhitespaceColumn","WordSelectionRangeProvider","selectSubwords","_addInWordRanges","_addWordRanges","_addWhitespaceLine","obj","offset","end","lastCh","ch","charCodeAt","isLowerAsciiLetter","isUpperAsciiLetter","getLineLength","getLineMaxColumn","SmartSelectController_1","SelectionRanges","mov","fwd","equalsRange","SmartSelectController","_ignoreSelection","_selectionListener","forward","selections","getSelections","_state","selectionRangeProvider","s","arrays","a","b","equalsSelection","unshift","state","newSelections","Selection","setSelections","AbstractSmartSelect","opts","_forward","_accessor","registerCommandAlias","work","allRawRanges","allProviderRanges","oneProviderRanges","oneRawRanges","isBefore","oneRanges","last","selectLeadingAndTrailingWhitespace","oneRangesWithTrivia","prev","cur","rangeNoWhitespace","rangeFull","mac","menuOpts","menuId","MenuId","MenubarSelectionMenu","title","reference","ITextModelService","createModelReference","object","textEditorModel","SnippetController2_1","_defaultOptions","overwriteBefore","overwriteAfter","undoStopBefore","undoStopAfter","adjustWhitespace","clipboardText","overtypingCapturer","SnippetController2","_languageConfigurationService","_snippetListener","_modelVersionId","_inSnippet","InSnippetMode","_hasNextTabstop","HasNextTabstop","_hasPrevTabstop","HasPrevTabstop","_session","insert","template","_doInsert","_logInfo","clear","pushStackElement","merge","getAlternativeVersionId","SnippetSession","hasChoice","_debugDisplayName","provideCompletionItems","activeChoice","choice","getValueInRange","isAnyOfOptions","find","o","suggestions","option","insertText","sortText","repeat","filterText","command","registration","isRegistered","disable","enable","completionProvider","language","pattern","fsPath","scheme","exclusive","_choiceCompletions","_updateState","isFlush","onDidChangeCursorSelection","hasPlaceholder","isAtLastPlaceholder","isSelectionWithinPlaceholders","isAtFirstPlaceholder","_handleChoice","_currentChoice","queueMicrotask","showSimpleSuggestions","finish","resetSelection","isInSnippet","ILanguageConfigurationService","CommandCtor","ctrl","Scanner","isDigitCharacter","isVariableCharacter","tokenText","_table","Marker","_children","child","Text","parent","replace","others","idx","children","newChildren","_fixParent","rightMostDescendant","snippet","TextmateSnippet","reduce","clone","TransformableMarker","Placeholder","compareByIndex","isFinalTabstop","Choice","ret","transform","marker","forEach","Transform","regexp","RegExp","_this","didMatch","_replace","prototype","some","FormatString","elseValue","source","ignoreCase","global","shorthandName","ifValue","toLocaleUpperCase","toLocaleLowerCase","_toPascalCase","_toCamelCase","match","charAt","toUpperCase","toLowerCase","Variable","resolver","walk","visitor","stack","placeholderInfo","_placeholders","placeholders","found","fullLen","enclosingPlaceholders","placeholder","resolveVariables","SnippetParser","_scanner","_token","escape","guessNeedsClipboard","test","parse","insertFinalTabstop","enforceFinalTabstop","parseFragment","ensureFinalTabstop","_parse","placeholderDefaultValues","incompletePlaceholders","fillInIncompletePlaceholder","defaultValues","newChild","Set","_accept","_backTo","_until","nextToken","substring","_parseEscaped","_parseTabstopOrVariableName","_parseComplexPlaceholder","_parseComplexVariable","_parseAnything","Number","_parseTransform","_parseChoiceElement","variable","regexValue","regexOptions","escaped","_parseFormatString","complex","shorthand","freeze","CompositeSnippetVariableResolver","_delegates","delegate","SelectionBasedVariableResolver","_selection","_selectionIdx","_overtypingCapturer","isMultiline","getLastOvertypedInfo","multiline","line","lineLeadingWhitespace","getLeadingWhitespace","varLeadingWhitespace","splitLines","pop","whitespaceCommonLength","commonPrefixLength","m","newline","rest","positionLineNumber","positionColumn","ModelBasedVariableResolver","_labelService","path","lastIndexOf","getUriLabel","dirname","relative","noPrefix","ClipboardBasedVariableResolver","_readClipboardText","_selectionCount","_spread","lines","isFalsyOrWhitespace","CommentBasedVariableResolver","langId","getLanguageIdAtPosition","selectionStartLineNumber","selectionStartColumn","config","getLanguageConfiguration","comments","lineCommentToken","blockCommentStartToken","blockCommentEndToken","TimeBasedVariableResolver","_date","getFullYear","getMonth","valueOf","padStart","getDate","getHours","getMinutes","getSeconds","dayNames","getDay","dayNamesShort","monthNames","monthNamesShort","floor","getTime","rawTimeOffset","getTimezoneOffset","sign","hours","trunc","abs","hoursString","minutes","WorkspaceBasedVariableResolver","_workspaceService","workspaceIdentifier","toWorkspaceIdentifier","getWorkspace","isEmptyWorkspaceIdentifier","_resolveWorkspaceName","_resoveWorkspacePath","isSingleFolderWorkspaceIdentifier","filename","configPath","endsWith","WORKSPACE_EXTENSION","normalizeDriveLetter","folderpath","RandomBasedVariableResolver","random","generateUuid","SnippetSession_1","OneSnippet","_snippet","_snippetLineLeadingWhitespace","_offset","_nestingLevel","_placeholderGroups","groupBy","_placeholderGroupsIdx","initialize","textChange","newPosition","_placeholderDecorations","removeDecorations","_initDecorations","placeholderOffset","placeholderLen","getPositionAt","_decor","inactiveFinal","inactive","handle","addDecoration","move","operations","getDecorationRange","currentValue","transformedValueLines","normalizeIndentation","EditOperation","getEOL","executeEdits","couldSkipThisPlaceholder","activePlaceholders","_hasPlaceholderBeenCollapsed","changeDecorationOptions","activeFinal","active","enclosingPlaceholder","isTrivialSnippet","computePossibleSelections","placeholdersWithEqualIndex","nested","assert","indexLastPlaceholder","nestedPlaceholder","removeDecoration","ModelDecorationOptions","stickiness","adjustIndentation","snippetTextString","prevChar","newValue","adjustSelection","positionColumnBefore","positionColumnAfter","validateRange","createWithDirection","getDirection","createEditsAndSnippetsFromSelections","languageConfigurationService","snippets","workspaceService","IWorkspaceContextService","modelBasedVariableResolver","ILabelService","readClipboardText","firstBeforeText","firstAfterText","firstLineFirstNonWhitespace","indexedSelections","compareRangesUsingStarts","extensionBefore","extensionAfter","snippetSelection","setStartPosition","setEndPosition","snippetLineLeadingWhitespace","identifier","major","minor","_isTracked","createEditsAndSnippetsFromEdits","snippetEdits","parser","lastRange","textRange","textNode","newNodes","snippetText","snippetFragmentText","_template","_options","_templateMerges","_snippets","_undoEdits","undoEdits","_move","revealRange","revealPositionInCenterIfOutsideViewport","oneSelection","allPossibleSelections","possibleSelections","array","StickyScrollWidgetState","startLineNumbers","endLineNumbers","lastLineRelativePosition","showEndForLine","other","_ttPolicy","createTrustedTypesPolicy","createHTML","STICKY_INDEX_ATTR","STICKY_IS_LINE_ATTR","STICKY_IS_FOLDING_ICON_ATTR","StickyScrollWidget","_foldingIconStore","_rootDomNode","_lineNumbersDomNode","_linesDomNodeScrollable","_linesDomNode","_lineHeight","_stickyLines","_lineNumbers","_lastLineRelativePosition","_minContentWidthInPx","_isOnGlyphMargin","EmbeddedCodeEditorWidget","updateScrollLeftPosition","left","scrollWithEditor","getScrollLeft","scrollLeftChanged","scrollWidthChanged","_updateWidgetWidth","onDidLayoutChange","lineNumberCount","getStickyLineForLine","stickyLine","getCurrentLines","setState","foldingModel","rebuildFromLine","Infinity","_previousState","previousStickyLines","_clearStickyWidget","_getViewModel","_renderRootNode","layoutInfo","getLayoutInfo","lineNumbersWidth","contentLeft","width","setProperty","getScrollWidth","verticalScrollbarWidth","dom","display","_useFoldingOpacityTransition","requireTransitions","_setFoldingIconsVisibility","allVisible","foldingIcon","setVisible","isCollapsed","entries","previousStickyLine","_renderChildNode","_updateTopAndZIndexOfStickyLine","lineDomNode","lineNumberDomNode","_setFoldingHoverListeners","widgetHeight","height","marginLeft","_updateMinContentWidth","layoutOverlayWidget","MOUSE_ENTER","MOUSE_LEAVE","viewModel","viewLineNumber","coordinatesConverter","convertModelPositionToViewPosition","lineRenderingData","getViewLineRenderingData","lineNumberOption","actualInlineDecorations","LineDecoration","inlineDecorations","minColumn","maxColumn","renderLineInput","RenderLineInput","content","continuesWithWrappedLine","isBasicASCII","containsRTL","tabSize","startVisibleColumn","sb","StringBuilder","renderOutput","renderViewLine","newLine","build","lineHTMLNode","tabIndex","lineHeight","innerHTML","lineNumberHTMLNode","innerLineNumberHTML","paddingLeft","lineNumbersLeft","_renderFoldingIconForLine","domNode","applyFontInfo","renderedLine","RenderedStickyLine","characterMapping","isLastLine","zIndex","lastLineTop","intermediateLineTop","top","showFoldingControls","foldingRegions","regions","indexOfFoldingRegion","findRange","getStartLineNumber","StickyFoldingIcon","getEndLineNumber","scrollWidth","getMinContentWidthInPx","focusLineWithIndex","getEditorPositionFromNode","spanDomNode","renderedStickyLine","_getRenderedStickyLineFromChildDomNode","getColumnOfNodeOffset","getLineNumberFromChildDomNode","getLineIndexFromChildDomNode","lineIndex","_getAttributeValue","isInStickyLine","isInFoldingIconDomNode","attribute","parentElement","foldingStartLine","foldingEndLine","dimension","foldingCollapsedIcon","foldingExpandedIcon","visible","cursor","opacity","StickyRange","StickyElement","StickyModel","version","element","outlineProviderId","ModelProvider","Status","StickyModelProvider","defaultModel","_modelProviders","_modelPromise","_updateScheduler","Delayer","_updateOperation","stickyModelFromCandidateOutlineProvider","StickyModelFromCandidateOutlineProvider","stickyModelFromSyntaxFoldingProvider","StickyModelFromCandidateSyntaxFoldingProvider","stickyModelFromIndentationFoldingProvider","StickyModelFromCandidateIndentationFoldingProvider","OUTLINE_MODEL","FOLDING_PROVIDER_MODEL","INDENTATION_MODEL","_cancelModelPromise","textModel","textModelVersionId","trigger","modelProvider","statusPromise","modelPromise","computeStickyModel","CANCELED","VALID","stickyModel","StickyModelCandidateProvider","_stickyModel","_invalid","INVALID","modelVersionId","isProviderValid","providerModelPromise","createModelFromProvider","providerModel","isModelValid","createStickyModel","OutlineModel","stickyOutlineElement","providerID","_stickyModelFromOutlineModel","outlineModel","preferredProvider","outlineElements","Iterable","first","OutlineGroup","outlineGroupOfModel","optimalOutlineGroup","tempID","maxTotalSumOfRanges","outlineGroup","totalSumRanges","_findSumOfRangesOfGroup","stickyChildren","outlineElementsArray","from","element1","element2","range1","range2","_comparator","outlineElement","_stickyModelFromOutlineElement","previousStartLine","subchild","child1","child2","outline","OutlineElement","StickyModelFromCandidateFoldingProvider","_foldingLimitReporter","RangesLimitReporter","foldingElement","_fromFoldingRegions","orderedStickyElements","parentIndex","getParentIndex","parentNode","IndentRangeProvider","compute","FoldingController","getFoldingRangeProviders","selectedProviders","SyntaxRangeProvider","StickyLineCandidate","nestingDepth","StickyLineCandidateProvider","_onDidChangeStickyScroll","Emitter","onDidChangeStickyScroll","_stickyModelProvider","_sessionStore","_updateSoon","readConfiguration","fire","onDidChangeHiddenAreas","updateStickyModel","isTooLargeForTokenization","updateIndex","getCandidateStickyLinesIntersectingFromStickyModel","depth","lastStartLineNumber","lastLine","childrenStartLines","lowerBound","binarySearch","upperBound","childStartLine","childEndLine","getCandidateStickyLinesIntersecting","stickyLineCandidates","hiddenRanges","getHiddenAreas","hiddenRange","StickyScrollController_1","StickyScrollController","_contextMenuService","_languageFeatureDebounceService","_contextKeyService","_foldingModel","_maxStickyLines","MAX_SAFE_INTEGER","_candidateDefinitionsLength","_focusedStickyElementIndex","_enabled","_focused","_positionRevealed","_onMouseDown","_endLineNumbers","_showEndForLine","_stickyScrollWidget","_stickyLineCandidateProvider","_widgetState","_readConfiguration","stickyScrollDomNode","CONTEXT_MENU","_onContextMenu","_stickyScrollFocusedContextKey","stickyScrollFocused","_stickyScrollVisibleContextKey","stickyScrollVisible","focusTracker","onDidBlur","clientHeight","_disposeFocusStickyScrollStore","onDidFocus","_registerMouseListeners","MOUSE_DOWN","_focusDisposableStore","focusNext","_focusNav","focusPrevious","selectEditor","direction","goToFocused","_revealPosition","_reveaInEditor","revealPosition","_revealLineInCenterIfOutsideViewport","revealFunction","sessionStore","gesture","ClickLinkGesture","extractLineNumberFromMouseEvent","getMouseEventTarget","mouseEvent","detail","mouseTargetElement","textElement","stickyScrollWidgetDomNode","CLICK","ctrlKey","altKey","metaKey","leftButton","shiftKey","_toggleFoldingRegionForLine","MOUSE_MOVE","currentEndForLineIndex","_renderStickyScroll","onMouseMoveOrRelevantKeyDown","_keyboardEvent","mouseTarget","hasTriggerModifier","_stickyRangeProjectedOnEditor","textDecoration","cancellationToken","currentHTMLChild","getDefinitionsAtPosition","definitionProvider","candidateDefinitions","childHTML","onCancel","onExecute","invokeFunction","goToDefinitionWithLocation","StandardMouseEvent","showContextMenu","StickyScrollContext","getAnchor","toggleCollapseState","MAX_VALUE","scrollTop","getTopForLineNumber","setScrollTop","removeOverlayWidget","addOverlayWidget","scrollTopChanged","_onDidResize","onDidChangeModelTokens","_onTokensChange","_needsUpdate","stickyLineNumbers","stickyLineNumber","fromLineNumber","toLineNumber","theoreticalLines","stickyLineVersion","getFoldingModel","findScrollWidgetState","focusedStickyElementLineNumber","includes","maxNumberStickyLines","maxLineCount","getScrollTop","arrayVisibleRanges","getVisibleRanges","fullVisibleRange","candidateRanges","topOfElementAtDepth","bottomOfElementAtDepth","bottomOfBeginningLine","getBottomForLineNumber","topOfEndLine","bottomOfEndLine","IContextMenuService","ToggleStickyScroll","Action2","mnemonicTitle","category","Categories","View","toggled","condition","menu","CommandPalette","MenubarAppearanceMenu","updateValue","FocusStickyScroll","EditorAction2","runEditorCommand","SelectNextStickyScrollLine","isEqualTo","keybinding","SelectPreviousStickyScrollLine","GoToStickyScrollLine","SelectEditor","registerAction2","LineContext","leadingLineContent","characterCountDelta","CompletionModel","lineContext","wordDistance","snippetSuggestions","fuzzyScoreOptions","FuzzyScoreOptions","_snippetCompareFn","_compareCompletionItems","_items","_column","_wordDistance","_refilterKind","_lineContext","_fuzzyScoreOptions","_compareCompletionItemsSnippetsUp","_compareCompletionItemsSnippetsDown","_filteredItems","_ensureCachedState","getItemsByProvider","_itemsByProvider","getIncompleteProvider","container","incomplete","stats","_stats","_createCachedState","labelLengths","wordLow","scoreFn","filterGraceful","fuzzyScore","fuzzyScoreGracefulAggressive","isInvalid","arr","editStart","wordLen","FuzzyScore","Default","wordPos","completion","filterTextLow","compareIgnoreCase","textLabel","anyScore","labelLow","distance","pLabelLen","quickSelect","Context","Visible","historyNavigationVisible","HasFocusedSuggestion","DetailsVisible","MultipleSuggestions","MakesTextEdit","AcceptSuggestionsOnEnter","HasInsertAndReplaceRange","InsertMode","CanResolve","suggestWidgetStatusbarMenu","CompletionItem","sortTextLow","extensionId","editInsertEnd","editReplaceEnd","resolveCompletionItem","_resolveCache","_resolveDuration","isResolved","resolveDuration","sub","isCancellationError","CompletionOptions","snippetSortOrder","kindFilter","providerFilter","providerItemsToReuse","showDeprecated","_snippetSuggestSupport","getSnippetSuggestSupport","CompletionItemModel","needsClipboard","durations","disposable","provideSuggestionItems","triggerKind","defaultReplaceRange","defaultRange","onCompletionList","didAddResult","suggestion","insertTextRules","isDisposable","providerName","elapsedProvider","duration","elapsedOverall","snippetCompletions","reuseItems","providerGroup","CancellationError","snippetConfig","_snippetComparators","defaultComparator","triggerSuggest","triggerCharacter","maxItemsToResolve","ref","resolving","actualPosition","completions","QuickSuggestionsOptions","isAllOff","strings","isAllOn","valueFor","tokenType","WordContextKey_1","WordContextKey","_ckAtEnd","AtEnd","_configListener","_update","checkForWordEnd","SuggestAlternatives_1","SuggestAlternatives","_index","_ckOtherSuggestions","OtherSuggestions","_listener","_acceptNext","_ignore","acceptNext","_moveIndex","newIndex","rounds","additionalTextEdits","CommitCharacterController","widget","onDidSuggest","completionModel","onDidCancel","onDidShow","_onItem","getFocusedItem","onDidHide","onWillType","_active","isFrozen","acceptCharacters","selected","isNonEmptyArray","commitCharacters","CharacterSet","SuggestModel_1","shouldAutoTrigger","tokenizeIfCheap","triggerOptions","leadingWord","getWordUntilPosition","SuggestModel","_editorWorkerService","_clipboardService","_telemetryService","_envService","_toDispose","_triggerCharacterListener","_triggerQuickSuggest","TimeoutTimer","_triggerState","_completionDisposables","_onDidCancel","_onDidTrigger","_onDidSuggest","onDidTrigger","_telemetryGate","_currentSelection","_updateTriggerCharacters","onDidChangeModelLanguage","_updateActiveSuggestSession","editorIsComposing","onDidCompositionStart","onDidCompositionEnd","_onCompositionEnd","_onCursorChange","_refilterCompletionItems","supportsByTriggerCharacter","support","triggerCharacters","checkTriggerCharacter","getContextKeyValue","suppressSuggestions","InlineCompletionContextKeys","canShowSuggestOnTriggerCharacters","lastChar","isLowSurrogate","isHighSurrogate","supports","_completionModel","auto","retrigger","completionOptions","onDidType","_requestToken","_context","prevSelection","reason","isBeforeOrEqual","_doTriggerQuickSuggest","snippetsPreventQuickSuggestions","cancelAndSet","hasWidgetFocus","lineTokens","getLineTokens","getStandardTokenType","findTokenIndexAtOffset","inlineSuggestionVisible","canShowQuickSuggest","ctx","refilter","_onNewContext","_e","_f","shy","suggestCtx","itemKind","itemKindFilter","_createSuggestFilter","WordDistance","_g","readText","fuzzySearchOptions","firstMatchCanBeWeak","matchOnWordStartOnly","_reportDurationsTelemetry","isBuilt","isExtensionDevelopment","publicLog2","JSON","stringify","debug","suggestOptions","showMethods","showFunctions","showConstructors","showFields","showVariables","showClasses","showStructs","showInterfaces","showModules","showProperties","showEvents","showOperators","showUnits","showValues","showConstants","showEnums","showEnumMembers","showKeywords","showWords","showColors","showFiles","showReferences","showFolders","showTypeParameters","showSnippets","showUsers","showIssues","oldLineContext","IEditorWorkerService","IClipboardService","ITelemetryService","IEnvironmentService","OvertypingCapturer","suggestModel","_lastOvertyped","_locked","selectionsLength","willOvertype","getValueLengthInRange","_maxSelectionLength","StatusBarViewItem","MenuEntryActionViewItem","updateLabel","kb","_action","textContent","symbolPrintEnter","SuggestWidgetStatus","_menuId","_menuService","_menuDisposables","$","actionViewItemProvider","action","MenuItemAction","_leftActions","ActionBar","_rightActions","remove","show","createMenu","renderMenu","right","actions","getActions","IMenuService","canExpandCompletionItem","documentation","SuggestDetailsWidget","instaService","_onDidClose","onDidClose","_onDidChangeContents","onDidChangeContents","_renderDisposeable","_borderWidth","_size","_markdownRenderer","MarkdownRenderer","_body","_scrollbar","DomScrollableElement","alwaysConsumeMouseWheel","_header","_close","asCSSSelector","close","_type","_docs","_configureFont","getMassagedFontFamily","fontSizePx","lineHeightPx","fontFeatureSettings","borderHeight","verticalPadding","horizontalPadding","renderLoading","layout","renderItem","explainMode","md","appendCodeblock","cappedDetail","renderedContents","render","onDidRenderAsync","userSelect","onmousedown","preventDefault","stopPropagation","onclick","clearContents","newSize","scanDomNode","scrollDown","much","scrollUp","scrollBottom","scrollHeight","pageDown","pageUp","SuggestDetailsOverlay","topLeftNow","sizeNow","_added","_preferAlignAtTop","_resizable","ResizableHTMLElement","enableSashes","deltaTop","deltaLeft","onDidWillResize","_topLeft","onDidResize","updateTopLeft","west","north","_applyTopLeft","_userSize","_anchorBox","_placeAtAnchor","sessionEnded","clearSashHoverState","placeAtAnchor","anchor","preferAlignAtTop","anchorBox","getBoundingClientRect","bodyBox","body","defaultMinSize","defaultTop","eastPlacement","maxSizeTop","maxSizeBottom","with","fit","minSize","placements","placement","bottom","alignAtTop","maxHeight","maxSize","topLeft","getAriaId","suggestMoreInfoIcon","registerIcon","chevronRight","_completionItemColor","extract","out","_regexStrict","_regexRelaxed","exec","ItemRenderer","_modelService","_languageService","_onDidToggleDetails","onDidToggleDetails","templateId","renderTemplate","root","icon","append","colorspan","main","iconContainer","iconLabel","IconLabel","supportHighlights","supportIcons","parametersLabel","qualifierLabel","detailsLabel","readMore","configureFont","letterSpacing","letterSpacingPx","renderElement","labelOptions","labelEscapeNewLines","matches","createMatches","getFileIconTheme","hasFileIcons","labelClasses","getIconClasses","FileKind","FILE","detailClasses","extraClasses","hasFolderIcons","FOLDER","flat","asClassNameArray","CompletionItemKinds","setLabel","stripNewLines","showInlineDetails","disposeTemplate","templateData","str","ILanguageService","SuggestWidget_1","registerColor","dark","light","hcDark","hcLight","editorWidgetBorder","editorSuggestWidgetForeground","editorForeground","quickInputListFocusForeground","quickInputListFocusIconForeground","editorSuggestWidgetSelectedBackground","quickInputListFocusBackground","listHighlightForeground","listFocusHighlightForeground","transparent","PersistedWidgetSize","_service","getEditorType","restore","raw","is","store","SuggestWidget","_storageService","_isAuto","_pendingLayout","_pendingShowDetails","_ignoreFocusEvents","_forceRenderingAbove","_explainMode","_showTimeout","_onDidSelect","PauseableEmitter","_onDidFocus","_onDidHide","_onDidShow","onDidSelect","_onDetailsKeydown","onDetailsKeyDown","_contentWidget","SuggestContentWidget","_persistedSize","ResizeState","persistedSize","currentSize","persistHeight","persistWidth","lockPreference","_resize","south","east","itemHeight","defaultSize","threshold","unlockPreference","_messageElement","_listElement","details","toggleDetails","_details","applyIconStyle","showIcons","renderer","_list","List","getHeight","_element","getTemplateId","useShadows","mouseSupport","multipleSelectionSupport","accessibilityProvider","getRole","getWidgetAriaLabel","getWidgetRole","getAriaLabel","_isDetailsVisible","docs","getListStyles","listInactiveFocusBackground","listInactiveFocusOutline","activeContrastBorder","_status","applyStatusBarStyle","showStatusBar","t","_onThemeChange","onMouseDown","_onListMouseDownOrTap","onTap","onDidChangeSelection","_onListSelection","onDidChangeFocus","_onListFocus","_onCursorSelectionChanged","_ctxSuggestWidgetVisible","SuggestContext","_ctxSuggestWidgetDetailsVisible","_ctxSuggestWidgetMultipleSuggestions","_ctxSuggestWidgetHasFocusedSuggestion","_onEditorMouseDown","_loadingTimeout","contains","browserEvent","_select","elements","indexes","isHighContrast","_currentSuggestionDetails","_focusedItem","setAriaOptions","activeDescendant","reveal","loading","disposableTimeout","showDetails","setFocus","_setState","_cappedHeight","LOADING_MESSAGE","NO_SUGGESTIONS_MESSAGE","_layout","showTriggered","delay","showSuggestions","selectionIndex","isAuto","noFocus","visibleCount","pause","resume","focusSelected","selectNextPage","focusNextPage","selectNext","selectLast","focusLast","selectPreviousPage","focusPreviousPage","selectPrevious","selectFirst","focusFirst","getFocus","getFocusedElements","toggleDetailsFocus","_setDetailsVisible","_positionDetails","toggleExplainMode","resetPersistedSize","hideWidget","dim","minPersistedHeight","ceil","_afterRender","setPreference","maxWidth","preferredWidth","typicalHalfwidthCharacterWidth","fullHeight","statusBarHeight","contentHeight","minHeight","editorBox","cursorBox","getScrolledVisiblePosition","cursorBottom","maxHeightBelow","availableSpaceAbove","maxHeightAbove","capped","wanted","forceRenderingAboveRequiredSpace","preferredSize","clamp","getBoolean","forceRenderingAbove","stopForceRenderingAbove","IStorageService","_widget","suppressMouseDown","_preferenceLocked","_hidden","_preference","SuggestController_1","LineSuffix","getOffsetAt","_marker","delta","SuggestController","_memoryService","_commandService","_instantiationService","_lineSuffix","_selectors","PriorityRegistry","priority","_onWillInsertSuggestItem","onWillInsertSuggestItem","select","ctxInsertMode","insertMode","IdleValue","_insertSuggestion","commitCharacterController","ctxMakesTextEdit","ctxHasInsertAndReplace","ctxCanResolve","toKeyCodeChord","KeyCodeChord","platform","isModifierKey","_alternatives","selector","itemsOrderedByPriorityDesc","selectionMode","acceptSuggestionsOnEnter","updateFromConfig","acceptSuggestionOnEnter","flags","snippetController","modelVersionNow","tasks","cts","pushUndoStop","getOverwriteInfo","memorize","_commandExectionDuration","_additionalEditsAppliedAsync","scrollState","StableEditorScrollState","capture","replaceMove","restoreRelativeVerticalPositionOfCursor","docListener","thisPosition","oldFlags","didType","typeListener","applied","trace","TriggerSuggestAction","canUndo","undo","_alertCompletionItem","_reportSuggestionAcceptedTelemetry","itemResolved","commandExectionDuration","additionalEditsAppliedAsync","providerId","basenameHash","hash","basename","languageId","fileExtension","extname","resolveInfo","commandDuration","additionalEditsAsync","toggleMode","msg","onlyFrom","noFilter","triggerSuggestAndAcceptBest","arg","positionNow","fallback","makesTextEdit","Event","once","listener","any","_ref2","acceptSelectedSuggestion","keepAlternativeSuggestions","alternativeOverwriteConfig","acceptNextSuggestion","acceptPrevSuggestion","cancelSuggestWidget","focusSuggestion","selectNextSuggestion","selectNextPageSuggestion","selectLastSuggestion","selectPrevSuggestion","selectPrevPageSuggestion","selectFirstSuggestion","toggleSuggestionDetails","toggleSuggestionFocus","resetWidgetSize","isInitialized","registerSelector","ISuggestMemoryService","prioritySelector","s1","s2","hasCompletionItemProvider","toNegated","textInputFocus","SuggestCommand","when","or","negate","isObject","EditorContribution_1","SuggestInlineCompletion","InlineCompletionResults","RefCountedDisposable","_suggestMemoryService","canBeReused","selectedIndex","second","resolveCount","SuggestInlineCompletions","_getEditorOption","_languageFeatureService","provideInlineCompletions","selectedSuggestionInfo","triggerCharacterInfo","wordInfo","_getTriggerCharacterInfo","leadingLineContents","_lastResult","newLineContext","acquire","boostFullMatch","handleItemDidShow","_completions","freeInlineCompletions","release","EditorContribution","languageFeatureService","_counter","listCodeEditors","_disposable","inlineCompletionsProvider","SuggestMemoryService_1","Memory","topScore","preselect","NoMemory","toJSON","fromJSON","SuggestMemoryService","_persistSoon","_saveState","onWillSaveState","WillSaveStateReason","SHUTDOWN","_withStrategy","mode","_strategy","ctor","_strategyCtors","_storagePrefix","_trie","TernarySearchTree","forStrings","_seq","touch","findSubstr","fromString","_cache","LRUCache","lineSuffix","indexPreselect","indexRecency","seq","peek","createDecorator","registerSingleton","service","localityBonus","canComputeWordRanges","wordRanges","computeWordRanges","wordUntilPos","wordLines","isFalsyOrEmpty","bestWordRange","blockDistance","foreground"],"sourceRoot":""}