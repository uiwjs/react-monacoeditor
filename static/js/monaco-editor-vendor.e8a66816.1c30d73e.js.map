{"version":3,"file":"static/js/monaco-editor-vendor.e8a66816.1c30d73e.js","mappings":"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","sources":["../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/commandsQuickAccess.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/editorNavigationQuickAccess.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoLineQuickAccess.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoSymbolQuickAccess.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/readOnlyMessage/browser/contribution.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/renameInputField.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/rename.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/browser/documentSemanticTokens.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/browser/viewportSemanticTokens.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/common/getSemanticTokens.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/common/semanticTokensConfig.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/bracketSelections.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/wordSelections.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/smartSelect.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetController2.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetParser.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetVariables.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetSession.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollElement.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollModelProvider.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollProvider.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollActions.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollContribution.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/completionModel.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggest.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordContextKey.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestAlternatives.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestCommitCharacters.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestModel.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestOvertypingCapturer.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetStatus.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetDetails.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetRenderer.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestInlineCompletions.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestMemory.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordDistance.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/symbolIcons/browser/symbolIcons.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { stripIcons } from '../../../../base/common/iconLabels.js';\nimport { AbstractCommandsQuickAccessProvider } from '../../../../platform/quickinput/browser/commandsQuickAccess.js';\nexport class AbstractEditorCommandsQuickAccessProvider extends AbstractCommandsQuickAccessProvider {\n    constructor(options, instantiationService, keybindingService, commandService, telemetryService, dialogService) {\n        super(options, instantiationService, keybindingService, commandService, telemetryService, dialogService);\n    }\n    getCodeEditorCommandPicks() {\n        const activeTextEditorControl = this.activeTextEditorControl;\n        if (!activeTextEditorControl) {\n            return [];\n        }\n        const editorCommandPicks = [];\n        for (const editorAction of activeTextEditorControl.getSupportedActions()) {\n            editorCommandPicks.push({\n                commandId: editorAction.id,\n                commandAlias: editorAction.alias,\n                label: stripIcons(editorAction.label) || editorAction.id,\n            });\n        }\n        return editorCommandPicks;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { once } from '../../../../base/common/functional.js';\nimport { DisposableStore, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { withNullAsUndefined } from '../../../../base/common/types.js';\nimport { getCodeEditor, isDiffEditor } from '../../../browser/editorBrowser.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { overviewRulerRangeHighlight } from '../../../common/core/editorColorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\n/**\n * A reusable quick access provider for the editor with support\n * for adding decorations for navigating in the currently active file\n * (for example \"Go to line\", \"Go to symbol\").\n */\nexport class AbstractEditorNavigationQuickAccessProvider {\n    constructor(options) {\n        this.options = options;\n        //#endregion\n        //#region Decorations Utils\n        this.rangeHighlightDecorationId = undefined;\n    }\n    //#region Provider methods\n    provide(picker, token) {\n        var _a;\n        const disposables = new DisposableStore();\n        // Apply options if any\n        picker.canAcceptInBackground = !!((_a = this.options) === null || _a === void 0 ? void 0 : _a.canAcceptInBackground);\n        // Disable filtering & sorting, we control the results\n        picker.matchOnLabel = picker.matchOnDescription = picker.matchOnDetail = picker.sortByLabel = false;\n        // Provide based on current active editor\n        const pickerDisposable = disposables.add(new MutableDisposable());\n        pickerDisposable.value = this.doProvide(picker, token);\n        // Re-create whenever the active editor changes\n        disposables.add(this.onDidActiveTextEditorControlChange(() => {\n            // Clear old\n            pickerDisposable.value = undefined;\n            // Add new\n            pickerDisposable.value = this.doProvide(picker, token);\n        }));\n        return disposables;\n    }\n    doProvide(picker, token) {\n        const disposables = new DisposableStore();\n        // With text control\n        const editor = this.activeTextEditorControl;\n        if (editor && this.canProvideWithTextEditor(editor)) {\n            const context = { editor };\n            // Restore any view state if this picker was closed\n            // without actually going to a line\n            const codeEditor = getCodeEditor(editor);\n            if (codeEditor) {\n                // Remember view state and update it when the cursor position\n                // changes even later because it could be that the user has\n                // configured quick access to remain open when focus is lost and\n                // we always want to restore the current location.\n                let lastKnownEditorViewState = withNullAsUndefined(editor.saveViewState());\n                disposables.add(codeEditor.onDidChangeCursorPosition(() => {\n                    lastKnownEditorViewState = withNullAsUndefined(editor.saveViewState());\n                }));\n                context.restoreViewState = () => {\n                    if (lastKnownEditorViewState && editor === this.activeTextEditorControl) {\n                        editor.restoreViewState(lastKnownEditorViewState);\n                    }\n                };\n                disposables.add(once(token.onCancellationRequested)(() => { var _a; return (_a = context.restoreViewState) === null || _a === void 0 ? void 0 : _a.call(context); }));\n            }\n            // Clean up decorations on dispose\n            disposables.add(toDisposable(() => this.clearDecorations(editor)));\n            // Ask subclass for entries\n            disposables.add(this.provideWithTextEditor(context, picker, token));\n        }\n        // Without text control\n        else {\n            disposables.add(this.provideWithoutTextEditor(picker, token));\n        }\n        return disposables;\n    }\n    /**\n     * Subclasses to implement if they can operate on the text editor.\n     */\n    canProvideWithTextEditor(editor) {\n        return true;\n    }\n    gotoLocation({ editor }, options) {\n        editor.setSelection(options.range);\n        editor.revealRangeInCenter(options.range, 0 /* ScrollType.Smooth */);\n        if (!options.preserveFocus) {\n            editor.focus();\n        }\n        const model = editor.getModel();\n        if (model && 'getLineContent' in model) {\n            alert(`${model.getLineContent(options.range.startLineNumber)}`);\n        }\n    }\n    getModel(editor) {\n        var _a;\n        return isDiffEditor(editor) ?\n            (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.modified :\n            editor.getModel();\n    }\n    addDecorations(editor, range) {\n        editor.changeDecorations(changeAccessor => {\n            // Reset old decorations if any\n            const deleteDecorations = [];\n            if (this.rangeHighlightDecorationId) {\n                deleteDecorations.push(this.rangeHighlightDecorationId.overviewRulerDecorationId);\n                deleteDecorations.push(this.rangeHighlightDecorationId.rangeHighlightId);\n                this.rangeHighlightDecorationId = undefined;\n            }\n            // Add new decorations for the range\n            const newDecorations = [\n                // highlight the entire line on the range\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight',\n                        className: 'rangeHighlight',\n                        isWholeLine: true\n                    }\n                },\n                // also add overview ruler highlight\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight-overview',\n                        overviewRuler: {\n                            color: themeColorFromId(overviewRulerRangeHighlight),\n                            position: OverviewRulerLane.Full\n                        }\n                    }\n                }\n            ];\n            const [rangeHighlightId, overviewRulerDecorationId] = changeAccessor.deltaDecorations(deleteDecorations, newDecorations);\n            this.rangeHighlightDecorationId = { rangeHighlightId, overviewRulerDecorationId };\n        });\n    }\n    clearDecorations(editor) {\n        const rangeHighlightDecorationId = this.rangeHighlightDecorationId;\n        if (rangeHighlightDecorationId) {\n            editor.changeDecorations(changeAccessor => {\n                changeAccessor.deltaDecorations([\n                    rangeHighlightDecorationId.overviewRulerDecorationId,\n                    rangeHighlightDecorationId.rangeHighlightId\n                ], []);\n            });\n            this.rangeHighlightDecorationId = undefined;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { getCodeEditor } from '../../../browser/editorBrowser.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nexport class AbstractGotoLineQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    constructor() {\n        super({ canAcceptInBackground: true });\n    }\n    provideWithoutTextEditor(picker) {\n        const label = localize('cannotRunGotoLine', \"Open a text editor first to go to a line.\");\n        picker.items = [{ label }];\n        picker.ariaLabel = label;\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token) {\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto line once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item) {\n                if (!this.isValidLineNumber(editor, item.lineNumber)) {\n                    return;\n                }\n                this.gotoLocation(context, { range: this.toRange(item.lineNumber, item.column), keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // React to picker changes\n        const updatePickerAndEditor = () => {\n            const position = this.parsePosition(editor, picker.value.trim().substr(AbstractGotoLineQuickAccessProvider.PREFIX.length));\n            const label = this.getPickLabel(editor, position.lineNumber, position.column);\n            // Picker\n            picker.items = [{\n                    lineNumber: position.lineNumber,\n                    column: position.column,\n                    label\n                }];\n            // ARIA Label\n            picker.ariaLabel = label;\n            // Clear decorations for invalid range\n            if (!this.isValidLineNumber(editor, position.lineNumber)) {\n                this.clearDecorations(editor);\n                return;\n            }\n            // Reveal\n            const range = this.toRange(position.lineNumber, position.column);\n            editor.revealRangeInCenter(range, 0 /* ScrollType.Smooth */);\n            // Decorate\n            this.addDecorations(editor, range);\n        };\n        updatePickerAndEditor();\n        disposables.add(picker.onDidChangeValue(() => updatePickerAndEditor()));\n        // Adjust line number visibility as needed\n        const codeEditor = getCodeEditor(editor);\n        if (codeEditor) {\n            const options = codeEditor.getOptions();\n            const lineNumbers = options.get(65 /* EditorOption.lineNumbers */);\n            if (lineNumbers.renderType === 2 /* RenderLineNumbersType.Relative */) {\n                codeEditor.updateOptions({ lineNumbers: 'on' });\n                disposables.add(toDisposable(() => codeEditor.updateOptions({ lineNumbers: 'relative' })));\n            }\n        }\n        return disposables;\n    }\n    toRange(lineNumber = 1, column = 1) {\n        return {\n            startLineNumber: lineNumber,\n            startColumn: column,\n            endLineNumber: lineNumber,\n            endColumn: column\n        };\n    }\n    parsePosition(editor, value) {\n        // Support line-col formats of `line,col`, `line:col`, `line#col`\n        const numbers = value.split(/,|:|#/).map(part => parseInt(part, 10)).filter(part => !isNaN(part));\n        const endLine = this.lineCount(editor) + 1;\n        return {\n            lineNumber: numbers[0] > 0 ? numbers[0] : endLine + numbers[0],\n            column: numbers[1]\n        };\n    }\n    getPickLabel(editor, lineNumber, column) {\n        // Location valid: indicate this as picker label\n        if (this.isValidLineNumber(editor, lineNumber)) {\n            if (this.isValidColumn(editor, lineNumber, column)) {\n                return localize('gotoLineColumnLabel', \"Go to line {0} and character {1}.\", lineNumber, column);\n            }\n            return localize('gotoLineLabel', \"Go to line {0}.\", lineNumber);\n        }\n        // Location invalid: show generic label\n        const position = editor.getPosition() || { lineNumber: 1, column: 1 };\n        const lineCount = this.lineCount(editor);\n        if (lineCount > 1) {\n            return localize('gotoLineLabelEmptyWithLimit', \"Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.\", position.lineNumber, position.column, lineCount);\n        }\n        return localize('gotoLineLabelEmpty', \"Current Line: {0}, Character: {1}. Type a line number to navigate to.\", position.lineNumber, position.column);\n    }\n    isValidLineNumber(editor, lineNumber) {\n        if (!lineNumber || typeof lineNumber !== 'number') {\n            return false;\n        }\n        return lineNumber > 0 && lineNumber <= this.lineCount(editor);\n    }\n    isValidColumn(editor, lineNumber, column) {\n        if (!column || typeof column !== 'number') {\n            return false;\n        }\n        const model = this.getModel(editor);\n        if (!model) {\n            return false;\n        }\n        const positionCandidate = { lineNumber, column };\n        return model.validatePosition(positionCandidate).equals(positionCandidate);\n    }\n    lineCount(editor) {\n        var _a, _b;\n        return (_b = (_a = this.getModel(editor)) === null || _a === void 0 ? void 0 : _a.getLineCount()) !== null && _b !== void 0 ? _b : 0;\n    }\n}\nAbstractGotoLineQuickAccessProvider.PREFIX = ':';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { DeferredPromise } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { pieceToQuery, prepareQuery, scoreFuzzy2 } from '../../../../base/common/fuzzyScorer.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { format, trim } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { SymbolKinds } from '../../../common/languages.js';\nimport { IOutlineModelService } from '../../documentSymbols/browser/outlineModel.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { findLast } from '../../../../base/common/arrays.js';\nexport let AbstractGotoSymbolQuickAccessProvider = class AbstractGotoSymbolQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    constructor(_languageFeaturesService, _outlineModelService, options = Object.create(null)) {\n        super(options);\n        this._languageFeaturesService = _languageFeaturesService;\n        this._outlineModelService = _outlineModelService;\n        this.options = options;\n        this.options.canAcceptInBackground = true;\n    }\n    provideWithoutTextEditor(picker) {\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutEditor', \"To go to a symbol, first open a text editor with symbol information.\"));\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token) {\n        const editor = context.editor;\n        const model = this.getModel(editor);\n        if (!model) {\n            return Disposable.None;\n        }\n        // Provide symbols from model if available in registry\n        if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n            return this.doProvideWithEditorSymbols(context, model, picker, token);\n        }\n        // Otherwise show an entry for a model without registry\n        // But give a chance to resolve the symbols at a later\n        // point if possible\n        return this.doProvideWithoutEditorSymbols(context, model, picker, token);\n    }\n    doProvideWithoutEditorSymbols(context, model, picker, token) {\n        const disposables = new DisposableStore();\n        // Generic pick for not having any symbol information\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutSymbolProvider', \"The active text editor does not provide symbol information.\"));\n        // Wait for changes to the registry and see if eventually\n        // we do get symbols. This can happen if the picker is opened\n        // very early after the model has loaded but before the\n        // language registry is ready.\n        // https://github.com/microsoft/vscode/issues/70607\n        (() => __awaiter(this, void 0, void 0, function* () {\n            const result = yield this.waitForLanguageSymbolRegistry(model, disposables);\n            if (!result || token.isCancellationRequested) {\n                return;\n            }\n            disposables.add(this.doProvideWithEditorSymbols(context, model, picker, token));\n        }))();\n        return disposables;\n    }\n    provideLabelPick(picker, label) {\n        picker.items = [{ label, index: 0, kind: 14 /* SymbolKind.String */ }];\n        picker.ariaLabel = label;\n    }\n    waitForLanguageSymbolRegistry(model, disposables) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n                return true;\n            }\n            const symbolProviderRegistryPromise = new DeferredPromise();\n            // Resolve promise when registry knows model\n            const symbolProviderListener = disposables.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => {\n                if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n                    symbolProviderListener.dispose();\n                    symbolProviderRegistryPromise.complete(true);\n                }\n            }));\n            // Resolve promise when we get disposed too\n            disposables.add(toDisposable(() => symbolProviderRegistryPromise.complete(false)));\n            return symbolProviderRegistryPromise.p;\n        });\n    }\n    doProvideWithEditorSymbols(context, model, picker, token) {\n        var _a;\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto symbol once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // Goto symbol side by side if enabled\n        disposables.add(picker.onDidTriggerItemButton(({ item }) => {\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, forceSideBySide: true });\n                picker.hide();\n            }\n        }));\n        // Resolve symbols from document once and reuse this\n        // request for all filtering and typing then on\n        const symbolsPromise = this.getDocumentSymbols(model, token);\n        // Set initial picks and update on type\n        let picksCts = undefined;\n        const updatePickerItems = (positionToEnclose) => __awaiter(this, void 0, void 0, function* () {\n            // Cancel any previous ask for picks and busy\n            picksCts === null || picksCts === void 0 ? void 0 : picksCts.dispose(true);\n            picker.busy = false;\n            // Create new cancellation source for this run\n            picksCts = new CancellationTokenSource(token);\n            // Collect symbol picks\n            picker.busy = true;\n            try {\n                const query = prepareQuery(picker.value.substr(AbstractGotoSymbolQuickAccessProvider.PREFIX.length).trim());\n                const items = yield this.doGetSymbolPicks(symbolsPromise, query, undefined, picksCts.token);\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                if (items.length > 0) {\n                    picker.items = items;\n                    if (positionToEnclose && query.original.length === 0) {\n                        const candidate = findLast(items, item => Boolean(item.type !== 'separator' && item.range && Range.containsPosition(item.range.decoration, positionToEnclose)));\n                        if (candidate) {\n                            picker.activeItems = [candidate];\n                        }\n                    }\n                }\n                else {\n                    if (query.original.length > 0) {\n                        this.provideLabelPick(picker, localize('noMatchingSymbolResults', \"No matching editor symbols\"));\n                    }\n                    else {\n                        this.provideLabelPick(picker, localize('noSymbolResults', \"No editor symbols\"));\n                    }\n                }\n            }\n            finally {\n                if (!token.isCancellationRequested) {\n                    picker.busy = false;\n                }\n            }\n        });\n        disposables.add(picker.onDidChangeValue(() => updatePickerItems(undefined)));\n        updatePickerItems((_a = editor.getSelection()) === null || _a === void 0 ? void 0 : _a.getPosition());\n        // Reveal and decorate when active item changes\n        disposables.add(picker.onDidChangeActive(() => {\n            const [item] = picker.activeItems;\n            if (item && item.range) {\n                // Reveal\n                editor.revealRangeInCenter(item.range.selection, 0 /* ScrollType.Smooth */);\n                // Decorate\n                this.addDecorations(editor, item.range.decoration);\n            }\n        }));\n        return disposables;\n    }\n    doGetSymbolPicks(symbolsPromise, query, options, token) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            const symbols = yield symbolsPromise;\n            if (token.isCancellationRequested) {\n                return [];\n            }\n            const filterBySymbolKind = query.original.indexOf(AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX) === 0;\n            const filterPos = filterBySymbolKind ? 1 : 0;\n            // Split between symbol and container query\n            let symbolQuery;\n            let containerQuery;\n            if (query.values && query.values.length > 1) {\n                symbolQuery = pieceToQuery(query.values[0]); // symbol: only match on first part\n                containerQuery = pieceToQuery(query.values.slice(1)); // container: match on all but first parts\n            }\n            else {\n                symbolQuery = query;\n            }\n            // Convert to symbol picks and apply filtering\n            let buttons;\n            const openSideBySideDirection = (_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.openSideBySideDirection) === null || _b === void 0 ? void 0 : _b.call(_a);\n            if (openSideBySideDirection) {\n                buttons = [{\n                        iconClass: openSideBySideDirection === 'right' ? ThemeIcon.asClassName(Codicon.splitHorizontal) : ThemeIcon.asClassName(Codicon.splitVertical),\n                        tooltip: openSideBySideDirection === 'right' ? localize('openToSide', \"Open to the Side\") : localize('openToBottom', \"Open to the Bottom\")\n                    }];\n            }\n            const filteredSymbolPicks = [];\n            for (let index = 0; index < symbols.length; index++) {\n                const symbol = symbols[index];\n                const symbolLabel = trim(symbol.name);\n                const symbolLabelWithIcon = `$(${SymbolKinds.toIcon(symbol.kind).id}) ${symbolLabel}`;\n                const symbolLabelIconOffset = symbolLabelWithIcon.length - symbolLabel.length;\n                let containerLabel = symbol.containerName;\n                if (options === null || options === void 0 ? void 0 : options.extraContainerLabel) {\n                    if (containerLabel) {\n                        containerLabel = `${options.extraContainerLabel}  ${containerLabel}`;\n                    }\n                    else {\n                        containerLabel = options.extraContainerLabel;\n                    }\n                }\n                let symbolScore = undefined;\n                let symbolMatches = undefined;\n                let containerScore = undefined;\n                let containerMatches = undefined;\n                if (query.original.length > filterPos) {\n                    // First: try to score on the entire query, it is possible that\n                    // the symbol matches perfectly (e.g. searching for \"change log\"\n                    // can be a match on a markdown symbol \"change log\"). In that\n                    // case we want to skip the container query altogether.\n                    let skipContainerQuery = false;\n                    if (symbolQuery !== query) {\n                        [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, Object.assign(Object.assign({}, query), { values: undefined /* disable multi-query support */ }), filterPos, symbolLabelIconOffset);\n                        if (typeof symbolScore === 'number') {\n                            skipContainerQuery = true; // since we consumed the query, skip any container matching\n                        }\n                    }\n                    // Otherwise: score on the symbol query and match on the container later\n                    if (typeof symbolScore !== 'number') {\n                        [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, symbolQuery, filterPos, symbolLabelIconOffset);\n                        if (typeof symbolScore !== 'number') {\n                            continue;\n                        }\n                    }\n                    // Score by container if specified\n                    if (!skipContainerQuery && containerQuery) {\n                        if (containerLabel && containerQuery.original.length > 0) {\n                            [containerScore, containerMatches] = scoreFuzzy2(containerLabel, containerQuery);\n                        }\n                        if (typeof containerScore !== 'number') {\n                            continue;\n                        }\n                        if (typeof symbolScore === 'number') {\n                            symbolScore += containerScore; // boost symbolScore by containerScore\n                        }\n                    }\n                }\n                const deprecated = symbol.tags && symbol.tags.indexOf(1 /* SymbolTag.Deprecated */) >= 0;\n                filteredSymbolPicks.push({\n                    index,\n                    kind: symbol.kind,\n                    score: symbolScore,\n                    label: symbolLabelWithIcon,\n                    ariaLabel: symbolLabel,\n                    description: containerLabel,\n                    highlights: deprecated ? undefined : {\n                        label: symbolMatches,\n                        description: containerMatches\n                    },\n                    range: {\n                        selection: Range.collapseToStart(symbol.selectionRange),\n                        decoration: symbol.range\n                    },\n                    strikethrough: deprecated,\n                    buttons\n                });\n            }\n            // Sort by score\n            const sortedFilteredSymbolPicks = filteredSymbolPicks.sort((symbolA, symbolB) => filterBySymbolKind ?\n                this.compareByKindAndScore(symbolA, symbolB) :\n                this.compareByScore(symbolA, symbolB));\n            // Add separator for types\n            // - @  only total number of symbols\n            // - @: grouped by symbol kind\n            let symbolPicks = [];\n            if (filterBySymbolKind) {\n                let lastSymbolKind = undefined;\n                let lastSeparator = undefined;\n                let lastSymbolKindCounter = 0;\n                function updateLastSeparatorLabel() {\n                    if (lastSeparator && typeof lastSymbolKind === 'number' && lastSymbolKindCounter > 0) {\n                        lastSeparator.label = format(NLS_SYMBOL_KIND_CACHE[lastSymbolKind] || FALLBACK_NLS_SYMBOL_KIND, lastSymbolKindCounter);\n                    }\n                }\n                for (const symbolPick of sortedFilteredSymbolPicks) {\n                    // Found new kind\n                    if (lastSymbolKind !== symbolPick.kind) {\n                        // Update last separator with number of symbols we found for kind\n                        updateLastSeparatorLabel();\n                        lastSymbolKind = symbolPick.kind;\n                        lastSymbolKindCounter = 1;\n                        // Add new separator for new kind\n                        lastSeparator = { type: 'separator' };\n                        symbolPicks.push(lastSeparator);\n                    }\n                    // Existing kind, keep counting\n                    else {\n                        lastSymbolKindCounter++;\n                    }\n                    // Add to final result\n                    symbolPicks.push(symbolPick);\n                }\n                // Update last separator with number of symbols we found for kind\n                updateLastSeparatorLabel();\n            }\n            else if (sortedFilteredSymbolPicks.length > 0) {\n                symbolPicks = [\n                    { label: localize('symbols', \"symbols ({0})\", filteredSymbolPicks.length), type: 'separator' },\n                    ...sortedFilteredSymbolPicks\n                ];\n            }\n            return symbolPicks;\n        });\n    }\n    compareByScore(symbolA, symbolB) {\n        if (typeof symbolA.score !== 'number' && typeof symbolB.score === 'number') {\n            return 1;\n        }\n        else if (typeof symbolA.score === 'number' && typeof symbolB.score !== 'number') {\n            return -1;\n        }\n        if (typeof symbolA.score === 'number' && typeof symbolB.score === 'number') {\n            if (symbolA.score > symbolB.score) {\n                return -1;\n            }\n            else if (symbolA.score < symbolB.score) {\n                return 1;\n            }\n        }\n        if (symbolA.index < symbolB.index) {\n            return -1;\n        }\n        else if (symbolA.index > symbolB.index) {\n            return 1;\n        }\n        return 0;\n    }\n    compareByKindAndScore(symbolA, symbolB) {\n        const kindA = NLS_SYMBOL_KIND_CACHE[symbolA.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        const kindB = NLS_SYMBOL_KIND_CACHE[symbolB.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        // Sort by type first if scoped search\n        const result = kindA.localeCompare(kindB);\n        if (result === 0) {\n            return this.compareByScore(symbolA, symbolB);\n        }\n        return result;\n    }\n    getDocumentSymbols(document, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = yield this._outlineModelService.getOrCreate(document, token);\n            return token.isCancellationRequested ? [] : model.asListOfDocumentSymbols();\n        });\n    }\n};\nAbstractGotoSymbolQuickAccessProvider.PREFIX = '@';\nAbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX = ':';\nAbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY = `${AbstractGotoSymbolQuickAccessProvider.PREFIX}${AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX}`;\nAbstractGotoSymbolQuickAccessProvider = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IOutlineModelService)\n], AbstractGotoSymbolQuickAccessProvider);\n// #region NLS Helpers\nconst FALLBACK_NLS_SYMBOL_KIND = localize('property', \"properties ({0})\");\nconst NLS_SYMBOL_KIND_CACHE = {\n    [5 /* SymbolKind.Method */]: localize('method', \"methods ({0})\"),\n    [11 /* SymbolKind.Function */]: localize('function', \"functions ({0})\"),\n    [8 /* SymbolKind.Constructor */]: localize('_constructor', \"constructors ({0})\"),\n    [12 /* SymbolKind.Variable */]: localize('variable', \"variables ({0})\"),\n    [4 /* SymbolKind.Class */]: localize('class', \"classes ({0})\"),\n    [22 /* SymbolKind.Struct */]: localize('struct', \"structs ({0})\"),\n    [23 /* SymbolKind.Event */]: localize('event', \"events ({0})\"),\n    [24 /* SymbolKind.Operator */]: localize('operator', \"operators ({0})\"),\n    [10 /* SymbolKind.Interface */]: localize('interface', \"interfaces ({0})\"),\n    [2 /* SymbolKind.Namespace */]: localize('namespace', \"namespaces ({0})\"),\n    [3 /* SymbolKind.Package */]: localize('package', \"packages ({0})\"),\n    [25 /* SymbolKind.TypeParameter */]: localize('typeParameter', \"type parameters ({0})\"),\n    [1 /* SymbolKind.Module */]: localize('modules', \"modules ({0})\"),\n    [6 /* SymbolKind.Property */]: localize('property', \"properties ({0})\"),\n    [9 /* SymbolKind.Enum */]: localize('enum', \"enumerations ({0})\"),\n    [21 /* SymbolKind.EnumMember */]: localize('enumMember', \"enumeration members ({0})\"),\n    [14 /* SymbolKind.String */]: localize('string', \"strings ({0})\"),\n    [0 /* SymbolKind.File */]: localize('file', \"files ({0})\"),\n    [17 /* SymbolKind.Array */]: localize('array', \"arrays ({0})\"),\n    [15 /* SymbolKind.Number */]: localize('number', \"numbers ({0})\"),\n    [16 /* SymbolKind.Boolean */]: localize('boolean', \"booleans ({0})\"),\n    [18 /* SymbolKind.Object */]: localize('object', \"objects ({0})\"),\n    [19 /* SymbolKind.Key */]: localize('key', \"keys ({0})\"),\n    [7 /* SymbolKind.Field */]: localize('field', \"fields ({0})\"),\n    [13 /* SymbolKind.Constant */]: localize('constant', \"constants ({0})\")\n};\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nexport class ReadOnlyMessageController extends Disposable {\n    constructor(editor) {\n        super();\n        this.editor = editor;\n        this._register(this.editor.onDidAttemptReadOnlyEdit(() => this._onDidAttemptReadOnlyEdit()));\n    }\n    _onDidAttemptReadOnlyEdit() {\n        const messageController = MessageController.get(this.editor);\n        if (messageController && this.editor.hasModel()) {\n            if (this.editor.isSimpleWidget) {\n                messageController.showMessage(nls.localize('editor.simple.readonly', \"Cannot edit in read-only input\"), this.editor.getPosition());\n            }\n            else {\n                messageController.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this.editor.getPosition());\n            }\n        }\n    }\n}\nReadOnlyMessageController.ID = 'editor.contrib.readOnlyMessageController';\nregisterEditorContribution(ReadOnlyMessageController.ID, ReadOnlyMessageController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport './renameInputField.css';\nimport { Position } from '../../../common/core/position.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { editorWidgetBackground, inputBackground, inputBorder, inputForeground, widgetBorder, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false, localize('renameInputVisible', \"Whether the rename input widget is visible\"));\nexport let RenameInputField = class RenameInputField {\n    constructor(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService) {\n        this._editor = _editor;\n        this._acceptKeybindings = _acceptKeybindings;\n        this._themeService = _themeService;\n        this._keybindingService = _keybindingService;\n        this._disposables = new DisposableStore();\n        this.allowEditorOverflow = true;\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._editor.addContentWidget(this);\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(48 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return '__renameInputWidget';\n    }\n    getDomNode() {\n        if (!this._domNode) {\n            this._domNode = document.createElement('div');\n            this._domNode.className = 'monaco-editor rename-box';\n            this._input = document.createElement('input');\n            this._input.className = 'rename-input';\n            this._input.type = 'text';\n            this._input.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n            this._domNode.appendChild(this._input);\n            this._label = document.createElement('div');\n            this._label.className = 'rename-label';\n            this._domNode.appendChild(this._label);\n            this._updateFont();\n            this._updateStyles(this._themeService.getColorTheme());\n        }\n        return this._domNode;\n    }\n    _updateStyles(theme) {\n        var _a, _b, _c, _d;\n        if (!this._input || !this._domNode) {\n            return;\n        }\n        const widgetShadowColor = theme.getColor(widgetShadow);\n        const widgetBorderColor = theme.getColor(widgetBorder);\n        this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\n        this._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\n        this._domNode.style.border = widgetBorderColor ? `1px solid ${widgetBorderColor}` : '';\n        this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\n        this._input.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\n        // this._input.style.color = String(theme.getColor(inputForeground) ?? '');\n        const border = theme.getColor(inputBorder);\n        this._input.style.borderWidth = border ? '1px' : '0px';\n        this._input.style.borderStyle = border ? 'solid' : 'none';\n        this._input.style.borderColor = (_d = border === null || border === void 0 ? void 0 : border.toString()) !== null && _d !== void 0 ? _d : 'none';\n    }\n    _updateFont() {\n        if (!this._input || !this._label) {\n            return;\n        }\n        const fontInfo = this._editor.getOption(48 /* EditorOption.fontInfo */);\n        this._input.style.fontFamily = fontInfo.fontFamily;\n        this._input.style.fontWeight = fontInfo.fontWeight;\n        this._input.style.fontSize = `${fontInfo.fontSize}px`;\n        this._label.style.fontSize = `${fontInfo.fontSize * 0.8}px`;\n    }\n    getPosition() {\n        if (!this._visible) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    beforeRender() {\n        var _a, _b;\n        const [accept, preview] = this._acceptKeybindings;\n        this._label.innerText = localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"'] }, \"{0} to Rename, {1} to Preview\", (_a = this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\n        return null;\n    }\n    afterRender(position) {\n        if (!position) {\n            // cancel rename when input widget isn't rendered anymore\n            this.cancelInput(true);\n        }\n    }\n    acceptInput(wantsPreview) {\n        var _a;\n        (_a = this._currentAcceptInput) === null || _a === void 0 ? void 0 : _a.call(this, wantsPreview);\n    }\n    cancelInput(focusEditor) {\n        var _a;\n        (_a = this._currentCancelInput) === null || _a === void 0 ? void 0 : _a.call(this, focusEditor);\n    }\n    getInput(where, value, selectionStart, selectionEnd, supportPreview, token) {\n        this._domNode.classList.toggle('preview', supportPreview);\n        this._position = new Position(where.startLineNumber, where.startColumn);\n        this._input.value = value;\n        this._input.setAttribute('selectionStart', selectionStart.toString());\n        this._input.setAttribute('selectionEnd', selectionEnd.toString());\n        this._input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\n        const disposeOnDone = new DisposableStore();\n        return new Promise(resolve => {\n            this._currentCancelInput = (focusEditor) => {\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                resolve(focusEditor);\n                return true;\n            };\n            this._currentAcceptInput = (wantsPreview) => {\n                if (this._input.value.trim().length === 0 || this._input.value === value) {\n                    // empty or whitespace only or not changed\n                    this.cancelInput(true);\n                    return;\n                }\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                resolve({\n                    newName: this._input.value,\n                    wantsPreview: supportPreview && wantsPreview\n                });\n            };\n            disposeOnDone.add(token.onCancellationRequested(() => this.cancelInput(true)));\n            disposeOnDone.add(this._editor.onDidBlurEditorWidget(() => this.cancelInput(!document.hasFocus())));\n            this._show();\n        }).finally(() => {\n            disposeOnDone.dispose();\n            this._hide();\n        });\n    }\n    _show() {\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* ScrollType.Smooth */);\n        this._visible = true;\n        this._visibleContextKey.set(true);\n        this._editor.layoutContentWidget(this);\n        setTimeout(() => {\n            this._input.focus();\n            this._input.setSelectionRange(parseInt(this._input.getAttribute('selectionStart')), parseInt(this._input.getAttribute('selectionEnd')));\n        }, 100);\n    }\n    _hide() {\n        this._visible = false;\n        this._visibleContextKey.reset();\n        this._editor.layoutContentWidget(this);\n    }\n};\nRenameInputField = __decorate([\n    __param(2, IThemeService),\n    __param(3, IKeybindingService),\n    __param(4, IContextKeyService)\n], RenameInputField);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ITextResourceConfigurationService } from '../../../common/services/textResourceConfiguration.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { CONTEXT_RENAME_INPUT_VISIBLE, RenameInputField } from './renameInputField.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nclass RenameSkeleton {\n    constructor(model, position, registry) {\n        this.model = model;\n        this.position = position;\n        this._providerRenameIdx = 0;\n        this._providers = registry.ordered(model);\n    }\n    hasProvider() {\n        return this._providers.length > 0;\n    }\n    resolveRenameLocation(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const rejects = [];\n            for (this._providerRenameIdx = 0; this._providerRenameIdx < this._providers.length; this._providerRenameIdx++) {\n                const provider = this._providers[this._providerRenameIdx];\n                if (!provider.resolveRenameLocation) {\n                    break;\n                }\n                const res = yield provider.resolveRenameLocation(this.model, this.position, token);\n                if (!res) {\n                    continue;\n                }\n                if (res.rejectReason) {\n                    rejects.push(res.rejectReason);\n                    continue;\n                }\n                return res;\n            }\n            const word = this.model.getWordAtPosition(this.position);\n            if (!word) {\n                return {\n                    range: Range.fromPositions(this.position),\n                    text: '',\n                    rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n                };\n            }\n            return {\n                range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\n                text: word.word,\n                rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n            };\n        });\n    }\n    provideRenameEdits(newName, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this._provideRenameEdits(newName, this._providerRenameIdx, [], token);\n        });\n    }\n    _provideRenameEdits(newName, i, rejects, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const provider = this._providers[i];\n            if (!provider) {\n                return {\n                    edits: [],\n                    rejectReason: rejects.join('\\n')\n                };\n            }\n            const result = yield provider.provideRenameEdits(this.model, this.position, newName, token);\n            if (!result) {\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token);\n            }\n            else if (result.rejectReason) {\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token);\n            }\n            return result;\n        });\n    }\n}\nexport function rename(registry, model, position, newName) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const skeleton = new RenameSkeleton(model, position, registry);\n        const loc = yield skeleton.resolveRenameLocation(CancellationToken.None);\n        if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n            return { edits: [], rejectReason: loc.rejectReason };\n        }\n        return skeleton.provideRenameEdits(newName, CancellationToken.None);\n    });\n}\n// ---  register actions and commands\nlet RenameController = class RenameController {\n    static get(editor) {\n        return editor.getContribution(RenameController.ID);\n    }\n    constructor(editor, _instaService, _notificationService, _bulkEditService, _progressService, _logService, _configService, _languageFeaturesService) {\n        this.editor = editor;\n        this._instaService = _instaService;\n        this._notificationService = _notificationService;\n        this._bulkEditService = _bulkEditService;\n        this._progressService = _progressService;\n        this._logService = _logService;\n        this._configService = _configService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._disposableStore = new DisposableStore();\n        this._cts = new CancellationTokenSource();\n        this._renameInputField = this._disposableStore.add(this._instaService.createInstance(RenameInputField, this.editor, ['acceptRenameInput', 'acceptRenameInputWithPreview']));\n    }\n    dispose() {\n        this._disposableStore.dispose();\n        this._cts.dispose(true);\n    }\n    run() {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            // set up cancellation token to prevent reentrant rename, this\n            // is the parent to the resolve- and rename-tokens\n            this._cts.dispose(true);\n            this._cts = new CancellationTokenSource();\n            if (!this.editor.hasModel()) {\n                return undefined;\n            }\n            const position = this.editor.getPosition();\n            const skeleton = new RenameSkeleton(this.editor.getModel(), position, this._languageFeaturesService.renameProvider);\n            if (!skeleton.hasProvider()) {\n                return undefined;\n            }\n            // part 1 - resolve rename location\n            const cts1 = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, undefined, this._cts.token);\n            let loc;\n            try {\n                const resolveLocationOperation = skeleton.resolveRenameLocation(cts1.token);\n                this._progressService.showWhile(resolveLocationOperation, 250);\n                loc = yield resolveLocationOperation;\n            }\n            catch (e) {\n                (_a = MessageController.get(this.editor)) === null || _a === void 0 ? void 0 : _a.showMessage(e || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\n                return undefined;\n            }\n            finally {\n                cts1.dispose();\n            }\n            if (!loc) {\n                return undefined;\n            }\n            if (loc.rejectReason) {\n                (_b = MessageController.get(this.editor)) === null || _b === void 0 ? void 0 : _b.showMessage(loc.rejectReason, position);\n                return undefined;\n            }\n            if (cts1.token.isCancellationRequested) {\n                return undefined;\n            }\n            // part 2 - do rename at location\n            const cts2 = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, loc.range, this._cts.token);\n            const selection = this.editor.getSelection();\n            let selectionStart = 0;\n            let selectionEnd = loc.text.length;\n            if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(loc.range, selection)) {\n                selectionStart = Math.max(0, selection.startColumn - loc.range.startColumn);\n                selectionEnd = Math.min(loc.range.endColumn, selection.endColumn) - loc.range.startColumn;\n            }\n            const supportPreview = this._bulkEditService.hasPreviewHandler() && this._configService.getValue(this.editor.getModel().uri, 'editor.rename.enablePreview');\n            const inputFieldResult = yield this._renameInputField.getInput(loc.range, loc.text, selectionStart, selectionEnd, supportPreview, cts2.token);\n            // no result, only hint to focus the editor or not\n            if (typeof inputFieldResult === 'boolean') {\n                if (inputFieldResult) {\n                    this.editor.focus();\n                }\n                cts2.dispose();\n                return undefined;\n            }\n            this.editor.focus();\n            const renameOperation = raceCancellation(skeleton.provideRenameEdits(inputFieldResult.newName, cts2.token), cts2.token).then((renameResult) => __awaiter(this, void 0, void 0, function* () {\n                if (!renameResult || !this.editor.hasModel()) {\n                    return;\n                }\n                if (renameResult.rejectReason) {\n                    this._notificationService.info(renameResult.rejectReason);\n                    return;\n                }\n                // collapse selection to active end\n                this.editor.setSelection(Range.fromPositions(this.editor.getSelection().getPosition()));\n                this._bulkEditService.apply(renameResult, {\n                    editor: this.editor,\n                    showPreview: inputFieldResult.wantsPreview,\n                    label: nls.localize('label', \"Renaming '{0}' to '{1}'\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                    code: 'undoredo.rename',\n                    quotableLabel: nls.localize('quotableLabel', \"Renaming {0} to {1}\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                    respectAutoSaveConfig: true\n                }).then(result => {\n                    if (result.ariaSummary) {\n                        alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, inputFieldResult.newName, result.ariaSummary));\n                    }\n                }).catch(err => {\n                    this._notificationService.error(nls.localize('rename.failedApply', \"Rename failed to apply edits\"));\n                    this._logService.error(err);\n                });\n            }), err => {\n                this._notificationService.error(nls.localize('rename.failed', \"Rename failed to compute edits\"));\n                this._logService.error(err);\n            }).finally(() => {\n                cts2.dispose();\n            });\n            this._progressService.showWhile(renameOperation, 250);\n            return renameOperation;\n        });\n    }\n    acceptRenameInput(wantsPreview) {\n        this._renameInputField.acceptInput(wantsPreview);\n    }\n    cancelRenameInput() {\n        this._renameInputField.cancelInput(true);\n    }\n};\nRenameController.ID = 'editor.contrib.renameController';\nRenameController = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, INotificationService),\n    __param(3, IBulkEditService),\n    __param(4, IEditorProgressService),\n    __param(5, ILogService),\n    __param(6, ITextResourceConfigurationService),\n    __param(7, ILanguageFeaturesService)\n], RenameController);\n// ---- action implementation\nexport class RenameAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.rename',\n            label: nls.localize('rename.label', \"Rename Symbol\"),\n            alias: 'Rename Symbol',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.1\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(accessor, editor) {\n        const controller = RenameController.get(editor);\n        if (controller) {\n            return controller.run();\n        }\n        return Promise.resolve();\n    }\n}\nregisterEditorContribution(RenameController.ID, RenameController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(RenameAction);\nconst RenameCommand = EditorCommand.bindToContribution(RenameController.get);\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.acceptRenameInput(false),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInputWithPreview',\n    precondition: ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE, ContextKeyExpr.has('config.editor.rename.enablePreview')),\n    handler: x => x.acceptRenameInput(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 1024 /* KeyMod.Shift */ + 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'cancelRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.cancelRenameInput(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n// ---- api bridge command\nregisterModelAndPositionCommand('_executeDocumentRenameProvider', function (accessor, model, position, ...args) {\n    const [newName] = args;\n    assertType(typeof newName === 'string');\n    const { renameProvider } = accessor.get(ILanguageFeaturesService);\n    return rename(renameProvider, model, position, newName);\n});\nregisterModelAndPositionCommand('_executePrepareRename', function (accessor, model, position) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const { renameProvider } = accessor.get(ILanguageFeaturesService);\n        const skeleton = new RenameSkeleton(model, position, renameProvider);\n        const loc = yield skeleton.resolveRenameLocation(CancellationToken.None);\n        if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n            throw new Error(loc.rejectReason);\n        }\n        return loc;\n    });\n});\n//todo@jrieken use editor options world\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    id: 'editor',\n    properties: {\n        'editor.rename.enablePreview': {\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('enablePreview', \"Enable/disable the ability to preview changes before renaming\"),\n            default: true,\n            type: 'boolean'\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable, dispose } from '../../../../base/common/lifecycle.js';\nimport * as errors from '../../../../base/common/errors.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { toMultilineTokens2 } from '../../../common/services/semanticTokensProviderStyling.js';\nimport { getDocumentSemanticTokens, hasDocumentSemanticTokensProvider, isSemanticTokens, isSemanticTokensEdits } from '../common/getSemanticTokens.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ISemanticTokensStylingService } from '../../../common/services/semanticTokensStyling.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { SEMANTIC_HIGHLIGHTING_SETTING_ID, isSemanticColoringEnabled } from '../common/semanticTokensConfig.js';\nexport let DocumentSemanticTokensFeature = class DocumentSemanticTokensFeature extends Disposable {\n    constructor(semanticTokensStylingService, modelService, themeService, configurationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._watchers = Object.create(null);\n        const register = (model) => {\n            this._watchers[model.uri.toString()] = new ModelSemanticColoring(model, semanticTokensStylingService, themeService, languageFeatureDebounceService, languageFeaturesService);\n        };\n        const deregister = (model, modelSemanticColoring) => {\n            modelSemanticColoring.dispose();\n            delete this._watchers[model.uri.toString()];\n        };\n        const handleSettingOrThemeChange = () => {\n            for (const model of modelService.getModels()) {\n                const curr = this._watchers[model.uri.toString()];\n                if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                    if (!curr) {\n                        register(model);\n                    }\n                }\n                else {\n                    if (curr) {\n                        deregister(model, curr);\n                    }\n                }\n            }\n        };\n        this._register(modelService.onModelAdded((model) => {\n            if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                register(model);\n            }\n        }));\n        this._register(modelService.onModelRemoved((model) => {\n            const curr = this._watchers[model.uri.toString()];\n            if (curr) {\n                deregister(model, curr);\n            }\n        }));\n        this._register(configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\n                handleSettingOrThemeChange();\n            }\n        }));\n        this._register(themeService.onDidColorThemeChange(handleSettingOrThemeChange));\n    }\n    dispose() {\n        // Dispose all watchers\n        for (const watcher of Object.values(this._watchers)) {\n            watcher.dispose();\n        }\n        super.dispose();\n    }\n};\nDocumentSemanticTokensFeature = __decorate([\n    __param(0, ISemanticTokensStylingService),\n    __param(1, IModelService),\n    __param(2, IThemeService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], DocumentSemanticTokensFeature);\nlet ModelSemanticColoring = class ModelSemanticColoring extends Disposable {\n    constructor(model, _semanticTokensStylingService, themeService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._semanticTokensStylingService = _semanticTokensStylingService;\n        this._isDisposed = false;\n        this._model = model;\n        this._provider = languageFeaturesService.documentSemanticTokensProvider;\n        this._debounceInformation = languageFeatureDebounceService.for(this._provider, 'DocumentSemanticTokens', { min: ModelSemanticColoring.REQUEST_MIN_DELAY, max: ModelSemanticColoring.REQUEST_MAX_DELAY });\n        this._fetchDocumentSemanticTokens = this._register(new RunOnceScheduler(() => this._fetchDocumentSemanticTokensNow(), ModelSemanticColoring.REQUEST_MIN_DELAY));\n        this._currentDocumentResponse = null;\n        this._currentDocumentRequestCancellationTokenSource = null;\n        this._documentProvidersChangeListeners = [];\n        this._providersChangedDuringRequest = false;\n        this._register(this._model.onDidChangeContent(() => {\n            if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        }));\n        this._register(this._model.onDidChangeAttached(() => {\n            if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        }));\n        this._register(this._model.onDidChangeLanguage(() => {\n            // clear any outstanding state\n            if (this._currentDocumentResponse) {\n                this._currentDocumentResponse.dispose();\n                this._currentDocumentResponse = null;\n            }\n            if (this._currentDocumentRequestCancellationTokenSource) {\n                this._currentDocumentRequestCancellationTokenSource.cancel();\n                this._currentDocumentRequestCancellationTokenSource = null;\n            }\n            this._setDocumentSemanticTokens(null, null, null, []);\n            this._fetchDocumentSemanticTokens.schedule(0);\n        }));\n        const bindDocumentChangeListeners = () => {\n            dispose(this._documentProvidersChangeListeners);\n            this._documentProvidersChangeListeners = [];\n            for (const provider of this._provider.all(model)) {\n                if (typeof provider.onDidChange === 'function') {\n                    this._documentProvidersChangeListeners.push(provider.onDidChange(() => {\n                        if (this._currentDocumentRequestCancellationTokenSource) {\n                            // there is already a request running,\n                            this._providersChangedDuringRequest = true;\n                            return;\n                        }\n                        this._fetchDocumentSemanticTokens.schedule(0);\n                    }));\n                }\n            }\n        };\n        bindDocumentChangeListeners();\n        this._register(this._provider.onDidChange(() => {\n            bindDocumentChangeListeners();\n            this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n        }));\n        this._register(themeService.onDidColorThemeChange(_ => {\n            // clear out existing tokens\n            this._setDocumentSemanticTokens(null, null, null, []);\n            this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n        }));\n        this._fetchDocumentSemanticTokens.schedule(0);\n    }\n    dispose() {\n        if (this._currentDocumentResponse) {\n            this._currentDocumentResponse.dispose();\n            this._currentDocumentResponse = null;\n        }\n        if (this._currentDocumentRequestCancellationTokenSource) {\n            this._currentDocumentRequestCancellationTokenSource.cancel();\n            this._currentDocumentRequestCancellationTokenSource = null;\n        }\n        this._setDocumentSemanticTokens(null, null, null, []);\n        this._isDisposed = true;\n        super.dispose();\n    }\n    _fetchDocumentSemanticTokensNow() {\n        if (this._currentDocumentRequestCancellationTokenSource) {\n            // there is already a request running, let it finish...\n            return;\n        }\n        if (!hasDocumentSemanticTokensProvider(this._provider, this._model)) {\n            // there is no provider\n            if (this._currentDocumentResponse) {\n                // there are semantic tokens set\n                this._model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        if (!this._model.isAttachedToEditor()) {\n            // this document is not visible, there is no need to fetch semantic tokens for it\n            return;\n        }\n        const cancellationTokenSource = new CancellationTokenSource();\n        const lastProvider = this._currentDocumentResponse ? this._currentDocumentResponse.provider : null;\n        const lastResultId = this._currentDocumentResponse ? this._currentDocumentResponse.resultId || null : null;\n        const request = getDocumentSemanticTokens(this._provider, this._model, lastProvider, lastResultId, cancellationTokenSource.token);\n        this._currentDocumentRequestCancellationTokenSource = cancellationTokenSource;\n        this._providersChangedDuringRequest = false;\n        const pendingChanges = [];\n        const contentChangeListener = this._model.onDidChangeContent((e) => {\n            pendingChanges.push(e);\n        });\n        const sw = new StopWatch(false);\n        request.then((res) => {\n            this._debounceInformation.update(this._model, sw.elapsed());\n            this._currentDocumentRequestCancellationTokenSource = null;\n            contentChangeListener.dispose();\n            if (!res) {\n                this._setDocumentSemanticTokens(null, null, null, pendingChanges);\n            }\n            else {\n                const { provider, tokens } = res;\n                const styling = this._semanticTokensStylingService.getStyling(provider);\n                this._setDocumentSemanticTokens(provider, tokens || null, styling, pendingChanges);\n            }\n        }, (err) => {\n            const isExpectedError = err && (errors.isCancellationError(err) || (typeof err.message === 'string' && err.message.indexOf('busy') !== -1));\n            if (!isExpectedError) {\n                errors.onUnexpectedError(err);\n            }\n            // Semantic tokens eats up all errors and considers errors to mean that the result is temporarily not available\n            // The API does not have a special error kind to express this...\n            this._currentDocumentRequestCancellationTokenSource = null;\n            contentChangeListener.dispose();\n            if (pendingChanges.length > 0 || this._providersChangedDuringRequest) {\n                // More changes occurred while the request was running\n                if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                    this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n                }\n            }\n        });\n    }\n    static _copy(src, srcOffset, dest, destOffset, length) {\n        // protect against overflows\n        length = Math.min(length, dest.length - destOffset, src.length - srcOffset);\n        for (let i = 0; i < length; i++) {\n            dest[destOffset + i] = src[srcOffset + i];\n        }\n    }\n    _setDocumentSemanticTokens(provider, tokens, styling, pendingChanges) {\n        const currentResponse = this._currentDocumentResponse;\n        const rescheduleIfNeeded = () => {\n            if ((pendingChanges.length > 0 || this._providersChangedDuringRequest) && !this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        };\n        if (this._currentDocumentResponse) {\n            this._currentDocumentResponse.dispose();\n            this._currentDocumentResponse = null;\n        }\n        if (this._isDisposed) {\n            // disposed!\n            if (provider && tokens) {\n                provider.releaseDocumentSemanticTokens(tokens.resultId);\n            }\n            return;\n        }\n        if (!provider || !styling) {\n            this._model.tokenization.setSemanticTokens(null, false);\n            return;\n        }\n        if (!tokens) {\n            this._model.tokenization.setSemanticTokens(null, true);\n            rescheduleIfNeeded();\n            return;\n        }\n        if (isSemanticTokensEdits(tokens)) {\n            if (!currentResponse) {\n                // not possible!\n                this._model.tokenization.setSemanticTokens(null, true);\n                return;\n            }\n            if (tokens.edits.length === 0) {\n                // nothing to do!\n                tokens = {\n                    resultId: tokens.resultId,\n                    data: currentResponse.data\n                };\n            }\n            else {\n                let deltaLength = 0;\n                for (const edit of tokens.edits) {\n                    deltaLength += (edit.data ? edit.data.length : 0) - edit.deleteCount;\n                }\n                const srcData = currentResponse.data;\n                const destData = new Uint32Array(srcData.length + deltaLength);\n                let srcLastStart = srcData.length;\n                let destLastStart = destData.length;\n                for (let i = tokens.edits.length - 1; i >= 0; i--) {\n                    const edit = tokens.edits[i];\n                    if (edit.start > srcData.length) {\n                        styling.warnInvalidEditStart(currentResponse.resultId, tokens.resultId, i, edit.start, srcData.length);\n                        // The edits are invalid and there's no way to recover\n                        this._model.tokenization.setSemanticTokens(null, true);\n                        return;\n                    }\n                    const copyCount = srcLastStart - (edit.start + edit.deleteCount);\n                    if (copyCount > 0) {\n                        ModelSemanticColoring._copy(srcData, srcLastStart - copyCount, destData, destLastStart - copyCount, copyCount);\n                        destLastStart -= copyCount;\n                    }\n                    if (edit.data) {\n                        ModelSemanticColoring._copy(edit.data, 0, destData, destLastStart - edit.data.length, edit.data.length);\n                        destLastStart -= edit.data.length;\n                    }\n                    srcLastStart = edit.start;\n                }\n                if (srcLastStart > 0) {\n                    ModelSemanticColoring._copy(srcData, 0, destData, 0, srcLastStart);\n                }\n                tokens = {\n                    resultId: tokens.resultId,\n                    data: destData\n                };\n            }\n        }\n        if (isSemanticTokens(tokens)) {\n            this._currentDocumentResponse = new SemanticTokensResponse(provider, tokens.resultId, tokens.data);\n            const result = toMultilineTokens2(tokens, styling, this._model.getLanguageId());\n            // Adjust incoming semantic tokens\n            if (pendingChanges.length > 0) {\n                // More changes occurred while the request was running\n                // We need to:\n                // 1. Adjust incoming semantic tokens\n                // 2. Request them again\n                for (const change of pendingChanges) {\n                    for (const area of result) {\n                        for (const singleChange of change.changes) {\n                            area.applyEdit(singleChange.range, singleChange.text);\n                        }\n                    }\n                }\n            }\n            this._model.tokenization.setSemanticTokens(result, true);\n        }\n        else {\n            this._model.tokenization.setSemanticTokens(null, true);\n        }\n        rescheduleIfNeeded();\n    }\n};\nModelSemanticColoring.REQUEST_MIN_DELAY = 300;\nModelSemanticColoring.REQUEST_MAX_DELAY = 2000;\nModelSemanticColoring = __decorate([\n    __param(1, ISemanticTokensStylingService),\n    __param(2, IThemeService),\n    __param(3, ILanguageFeatureDebounceService),\n    __param(4, ILanguageFeaturesService)\n], ModelSemanticColoring);\nclass SemanticTokensResponse {\n    constructor(provider, resultId, data) {\n        this.provider = provider;\n        this.resultId = resultId;\n        this.data = data;\n    }\n    dispose() {\n        this.provider.releaseDocumentSemanticTokens(this.resultId);\n    }\n}\nregisterEditorFeature(DocumentSemanticTokensFeature);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { getDocumentRangeSemanticTokens, hasDocumentRangeSemanticTokensProvider } from '../common/getSemanticTokens.js';\nimport { isSemanticColoringEnabled, SEMANTIC_HIGHLIGHTING_SETTING_ID } from '../common/semanticTokensConfig.js';\nimport { toMultilineTokens2 } from '../../../common/services/semanticTokensProviderStyling.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ISemanticTokensStylingService } from '../../../common/services/semanticTokensStyling.js';\nexport let ViewportSemanticTokensContribution = class ViewportSemanticTokensContribution extends Disposable {\n    constructor(editor, _semanticTokensStylingService, _themeService, _configurationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._semanticTokensStylingService = _semanticTokensStylingService;\n        this._themeService = _themeService;\n        this._configurationService = _configurationService;\n        this._editor = editor;\n        this._provider = languageFeaturesService.documentRangeSemanticTokensProvider;\n        this._debounceInformation = languageFeatureDebounceService.for(this._provider, 'DocumentRangeSemanticTokens', { min: 100, max: 500 });\n        this._tokenizeViewport = this._register(new RunOnceScheduler(() => this._tokenizeViewportNow(), 100));\n        this._outstandingRequests = [];\n        const scheduleTokenizeViewport = () => {\n            if (this._editor.hasModel()) {\n                this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()));\n            }\n        };\n        this._register(this._editor.onDidScrollChange(() => {\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModelContent((e) => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._provider.onDidChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\n                this._cancelAll();\n                scheduleTokenizeViewport();\n            }\n        }));\n        this._register(this._themeService.onDidColorThemeChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        scheduleTokenizeViewport();\n    }\n    _cancelAll() {\n        for (const request of this._outstandingRequests) {\n            request.cancel();\n        }\n        this._outstandingRequests = [];\n    }\n    _removeOutstandingRequest(req) {\n        for (let i = 0, len = this._outstandingRequests.length; i < len; i++) {\n            if (this._outstandingRequests[i] === req) {\n                this._outstandingRequests.splice(i, 1);\n                return;\n            }\n        }\n    }\n    _tokenizeViewportNow() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (model.tokenization.hasCompleteSemanticTokens()) {\n            return;\n        }\n        if (!isSemanticColoringEnabled(model, this._themeService, this._configurationService)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        if (!hasDocumentRangeSemanticTokensProvider(this._provider, model)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        this._outstandingRequests = this._outstandingRequests.concat(visibleRanges.map(range => this._requestRange(model, range)));\n    }\n    _requestRange(model, range) {\n        const requestVersionId = model.getVersionId();\n        const request = createCancelablePromise(token => Promise.resolve(getDocumentRangeSemanticTokens(this._provider, model, range, token)));\n        const sw = new StopWatch(false);\n        request.then((r) => {\n            this._debounceInformation.update(model, sw.elapsed());\n            if (!r || !r.tokens || model.isDisposed() || model.getVersionId() !== requestVersionId) {\n                return;\n            }\n            const { provider, tokens: result } = r;\n            const styling = this._semanticTokensStylingService.getStyling(provider);\n            model.tokenization.setPartialSemanticTokens(range, toMultilineTokens2(result, styling, model.getLanguageId()));\n        }).then(() => this._removeOutstandingRequest(request), () => this._removeOutstandingRequest(request));\n        return request;\n    }\n};\nViewportSemanticTokensContribution.ID = 'editor.contrib.viewportSemanticTokens';\nViewportSemanticTokensContribution = __decorate([\n    __param(1, ISemanticTokensStylingService),\n    __param(2, IThemeService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], ViewportSemanticTokensContribution);\nregisterEditorContribution(ViewportSemanticTokensContribution.ID, ViewportSemanticTokensContribution, 1 /* EditorContributionInstantiation.AfterFirstRender */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { encodeSemanticTokensDto } from '../../../common/services/semanticTokensDto.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport function isSemanticTokens(v) {\n    return v && !!(v.data);\n}\nexport function isSemanticTokensEdits(v) {\n    return v && Array.isArray(v.edits);\n}\nexport class DocumentSemanticTokensResult {\n    constructor(provider, tokens, error) {\n        this.provider = provider;\n        this.tokens = tokens;\n        this.error = error;\n    }\n}\nexport function hasDocumentSemanticTokensProvider(registry, model) {\n    return registry.has(model);\n}\nfunction getDocumentSemanticTokensProviders(registry, model) {\n    const groups = registry.orderedGroups(model);\n    return (groups.length > 0 ? groups[0] : []);\n}\nexport function getDocumentSemanticTokens(registry, model, lastProvider, lastResultId, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = getDocumentSemanticTokensProviders(registry, model);\n        // Get tokens from all providers at the same time.\n        const results = yield Promise.all(providers.map((provider) => __awaiter(this, void 0, void 0, function* () {\n            let result;\n            let error = null;\n            try {\n                result = yield provider.provideDocumentSemanticTokens(model, (provider === lastProvider ? lastResultId : null), token);\n            }\n            catch (err) {\n                error = err;\n                result = null;\n            }\n            if (!result || (!isSemanticTokens(result) && !isSemanticTokensEdits(result))) {\n                result = null;\n            }\n            return new DocumentSemanticTokensResult(provider, result, error);\n        })));\n        // Try to return the first result with actual tokens or\n        // the first result which threw an error (!!)\n        for (const result of results) {\n            if (result.error) {\n                throw result.error;\n            }\n            if (result.tokens) {\n                return result;\n            }\n        }\n        // Return the first result, even if it doesn't have tokens\n        if (results.length > 0) {\n            return results[0];\n        }\n        return null;\n    });\n}\nfunction _getDocumentSemanticTokensProviderHighestGroup(registry, model) {\n    const result = registry.orderedGroups(model);\n    return (result.length > 0 ? result[0] : null);\n}\nclass DocumentRangeSemanticTokensResult {\n    constructor(provider, tokens) {\n        this.provider = provider;\n        this.tokens = tokens;\n    }\n}\nexport function hasDocumentRangeSemanticTokensProvider(providers, model) {\n    return providers.has(model);\n}\nfunction getDocumentRangeSemanticTokensProviders(providers, model) {\n    const groups = providers.orderedGroups(model);\n    return (groups.length > 0 ? groups[0] : []);\n}\nexport function getDocumentRangeSemanticTokens(registry, model, range, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = getDocumentRangeSemanticTokensProviders(registry, model);\n        // Get tokens from all providers at the same time.\n        const results = yield Promise.all(providers.map((provider) => __awaiter(this, void 0, void 0, function* () {\n            let result;\n            try {\n                result = yield provider.provideDocumentRangeSemanticTokens(model, range, token);\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n                result = null;\n            }\n            if (!result || !isSemanticTokens(result)) {\n                result = null;\n            }\n            return new DocumentRangeSemanticTokensResult(provider, result);\n        })));\n        // Try to return the first result with actual tokens\n        for (const result of results) {\n            if (result.tokens) {\n                return result;\n            }\n        }\n        // Return the first result, even if it doesn't have tokens\n        if (results.length > 0) {\n            return results[0];\n        }\n        return null;\n    });\n}\nCommandsRegistry.registerCommand('_provideDocumentSemanticTokensLegend', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const providers = _getDocumentSemanticTokensProviderHighestGroup(documentSemanticTokensProvider, model);\n    if (!providers) {\n        // there is no provider => fall back to a document range semantic tokens provider\n        return accessor.get(ICommandService).executeCommand('_provideDocumentRangeSemanticTokensLegend', uri);\n    }\n    return providers[0].getLegend();\n}));\nCommandsRegistry.registerCommand('_provideDocumentSemanticTokens', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    if (!hasDocumentSemanticTokensProvider(documentSemanticTokensProvider, model)) {\n        // there is no provider => fall back to a document range semantic tokens provider\n        return accessor.get(ICommandService).executeCommand('_provideDocumentRangeSemanticTokens', uri, model.getFullModelRange());\n    }\n    const r = yield getDocumentSemanticTokens(documentSemanticTokensProvider, model, null, null, CancellationToken.None);\n    if (!r) {\n        return undefined;\n    }\n    const { provider, tokens } = r;\n    if (!tokens || !isSemanticTokens(tokens)) {\n        return undefined;\n    }\n    const buff = encodeSemanticTokensDto({\n        id: 0,\n        type: 'full',\n        data: tokens.data\n    });\n    if (tokens.resultId) {\n        provider.releaseDocumentSemanticTokens(tokens.resultId);\n    }\n    return buff;\n}));\nCommandsRegistry.registerCommand('_provideDocumentRangeSemanticTokensLegend', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, range] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentRangeSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const providers = getDocumentRangeSemanticTokensProviders(documentRangeSemanticTokensProvider, model);\n    if (providers.length === 0) {\n        // no providers\n        return undefined;\n    }\n    if (providers.length === 1) {\n        // straight forward case, just a single provider\n        return providers[0].getLegend();\n    }\n    if (!range || !Range.isIRange(range)) {\n        // if no range is provided, we cannot support multiple providers\n        // as we cannot fall back to the one which would give results\n        // => return the first legend for backwards compatibility and print a warning\n        console.warn(`provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in`);\n        return providers[0].getLegend();\n    }\n    const result = yield getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider, model, Range.lift(range), CancellationToken.None);\n    if (!result) {\n        return undefined;\n    }\n    return result.provider.getLegend();\n}));\nCommandsRegistry.registerCommand('_provideDocumentRangeSemanticTokens', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, range] = args;\n    assertType(uri instanceof URI);\n    assertType(Range.isIRange(range));\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentRangeSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const result = yield getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider, model, Range.lift(range), CancellationToken.None);\n    if (!result || !result.tokens) {\n        // there is no provider or it didn't return tokens\n        return undefined;\n    }\n    return encodeSemanticTokensDto({\n        id: 0,\n        type: 'full',\n        data: result.tokens.data\n    });\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const SEMANTIC_HIGHLIGHTING_SETTING_ID = 'editor.semanticHighlighting';\nexport function isSemanticColoringEnabled(model, themeService, configurationService) {\n    var _a;\n    const setting = (_a = configurationService.getValue(SEMANTIC_HIGHLIGHTING_SETTING_ID, { overrideIdentifier: model.getLanguageId(), resource: model.uri })) === null || _a === void 0 ? void 0 : _a.enabled;\n    if (typeof setting === 'boolean') {\n        return setting;\n    }\n    return themeService.getColorTheme().semanticHighlighting;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nexport class BracketSelectionRangeProvider {\n    provideSelectionRanges(model, positions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = [];\n            for (const position of positions) {\n                const bucket = [];\n                result.push(bucket);\n                const ranges = new Map();\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsRightYield(resolve, 0, model, position, ranges));\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsLeftYield(resolve, 0, model, position, ranges, bucket));\n            }\n            return result;\n        });\n    }\n    static _bracketsRightYield(resolve, round, model, pos, ranges) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findNextBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsRightYield(resolve, round + 1, model, pos, ranges));\n                break;\n            }\n            if (bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.bracketText;\n                // wait for closing\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.getOpeningBrackets()[0].bracketText;\n                // process closing\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    let list = ranges.get(key);\n                    if (!list) {\n                        list = new LinkedList();\n                        ranges.set(key, list);\n                    }\n                    list.push(bracket.range);\n                }\n            }\n            pos = bracket.range.getEndPosition();\n        }\n    }\n    static _bracketsLeftYield(resolve, round, model, pos, ranges, bucket) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds && ranges.size === 0) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findPrevBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsLeftYield(resolve, round + 1, model, pos, ranges, bucket));\n                break;\n            }\n            if (!bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.getOpeningBrackets()[0].bracketText;\n                // wait for opening\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.bracketText;\n                // opening\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    const list = ranges.get(key);\n                    if (list) {\n                        const closing = list.shift();\n                        if (list.size === 0) {\n                            ranges.delete(key);\n                        }\n                        const innerBracket = Range.fromPositions(bracket.range.getEndPosition(), closing.getStartPosition());\n                        const outerBracket = Range.fromPositions(bracket.range.getStartPosition(), closing.getEndPosition());\n                        bucket.push({ range: innerBracket });\n                        bucket.push({ range: outerBracket });\n                        BracketSelectionRangeProvider._addBracketLeading(model, outerBracket, bucket);\n                    }\n                }\n            }\n            pos = bracket.range.getStartPosition();\n        }\n    }\n    static _addBracketLeading(model, bracket, bucket) {\n        if (bracket.startLineNumber === bracket.endLineNumber) {\n            return;\n        }\n        // xxxxxxxx {\n        //\n        // }\n        const startLine = bracket.startLineNumber;\n        const column = model.getLineFirstNonWhitespaceColumn(startLine);\n        if (column !== 0 && column !== bracket.startColumn) {\n            bucket.push({ range: Range.fromPositions(new Position(startLine, column), bracket.getEndPosition()) });\n            bucket.push({ range: Range.fromPositions(new Position(startLine, 1), bracket.getEndPosition()) });\n        }\n        // xxxxxxxx\n        // {\n        //\n        // }\n        const aboveLine = startLine - 1;\n        if (aboveLine > 0) {\n            const column = model.getLineFirstNonWhitespaceColumn(aboveLine);\n            if (column === bracket.startColumn && column !== model.getLineLastNonWhitespaceColumn(aboveLine)) {\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, column), bracket.getEndPosition()) });\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, 1), bracket.getEndPosition()) });\n            }\n        }\n    }\n}\nBracketSelectionRangeProvider._maxDuration = 30;\nBracketSelectionRangeProvider._maxRounds = 2;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isLowerAsciiLetter, isUpperAsciiLetter } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nexport class WordSelectionRangeProvider {\n    provideSelectionRanges(model, positions) {\n        const result = [];\n        for (const position of positions) {\n            const bucket = [];\n            result.push(bucket);\n            this._addInWordRanges(bucket, model, position);\n            this._addWordRanges(bucket, model, position);\n            this._addWhitespaceLine(bucket, model, position);\n            bucket.push({ range: model.getFullModelRange() });\n        }\n        return result;\n    }\n    _addInWordRanges(bucket, model, pos) {\n        const obj = model.getWordAtPosition(pos);\n        if (!obj) {\n            return;\n        }\n        const { word, startColumn } = obj;\n        const offset = pos.column - startColumn;\n        let start = offset;\n        let end = offset;\n        let lastCh = 0;\n        // LEFT anchor (start)\n        for (; start >= 0; start--) {\n            const ch = word.charCodeAt(start);\n            if ((start !== offset) && (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */)) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            else if (isLowerAsciiLetter(ch) && isUpperAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            lastCh = ch;\n        }\n        start += 1;\n        // RIGHT anchor (end)\n        for (; end < word.length; end++) {\n            const ch = word.charCodeAt(end);\n            if (isUpperAsciiLetter(ch) && isLowerAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            else if (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            lastCh = ch;\n        }\n        if (start < end) {\n            bucket.push({ range: new Range(pos.lineNumber, startColumn + start, pos.lineNumber, startColumn + end) });\n        }\n    }\n    _addWordRanges(bucket, model, pos) {\n        const word = model.getWordAtPosition(pos);\n        if (word) {\n            bucket.push({ range: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn) });\n        }\n    }\n    _addWhitespaceLine(bucket, model, pos) {\n        if (model.getLineLength(pos.lineNumber) > 0\n            && model.getLineFirstNonWhitespaceColumn(pos.lineNumber) === 0\n            && model.getLineLastNonWhitespaceColumn(pos.lineNumber) === 0) {\n            bucket.push({ range: new Range(pos.lineNumber, 1, pos.lineNumber, model.getLineMaxColumn(pos.lineNumber)) });\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { BracketSelectionRangeProvider } from './bracketSelections.js';\nimport { WordSelectionRangeProvider } from './wordSelections.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nclass SelectionRanges {\n    constructor(index, ranges) {\n        this.index = index;\n        this.ranges = ranges;\n    }\n    mov(fwd) {\n        const index = this.index + (fwd ? 1 : -1);\n        if (index < 0 || index >= this.ranges.length) {\n            return this;\n        }\n        const res = new SelectionRanges(index, this.ranges);\n        if (res.ranges[index].equalsRange(this.ranges[this.index])) {\n            // next range equals this range, retry with next-next\n            return res.mov(fwd);\n        }\n        return res;\n    }\n}\nexport let SmartSelectController = class SmartSelectController {\n    static get(editor) {\n        return editor.getContribution(SmartSelectController.ID);\n    }\n    constructor(_editor, _languageFeaturesService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._ignoreSelection = false;\n    }\n    dispose() {\n        var _a;\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n    }\n    run(forward) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            const selections = this._editor.getSelections();\n            const model = this._editor.getModel();\n            if (!this._state) {\n                yield provideSelectionRanges(this._languageFeaturesService.selectionRangeProvider, model, selections.map(s => s.getPosition()), this._editor.getOption(109 /* EditorOption.smartSelect */), CancellationToken.None).then(ranges => {\n                    var _a;\n                    if (!arrays.isNonEmptyArray(ranges) || ranges.length !== selections.length) {\n                        // invalid result\n                        return;\n                    }\n                    if (!this._editor.hasModel() || !arrays.equals(this._editor.getSelections(), selections, (a, b) => a.equalsSelection(b))) {\n                        // invalid editor state\n                        return;\n                    }\n                    for (let i = 0; i < ranges.length; i++) {\n                        ranges[i] = ranges[i].filter(range => {\n                            // filter ranges inside the selection\n                            return range.containsPosition(selections[i].getStartPosition()) && range.containsPosition(selections[i].getEndPosition());\n                        });\n                        // prepend current selection\n                        ranges[i].unshift(selections[i]);\n                    }\n                    this._state = ranges.map(ranges => new SelectionRanges(0, ranges));\n                    // listen to caret move and forget about state\n                    (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                    this._selectionListener = this._editor.onDidChangeCursorPosition(() => {\n                        var _a;\n                        if (!this._ignoreSelection) {\n                            (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                            this._state = undefined;\n                        }\n                    });\n                });\n            }\n            if (!this._state) {\n                // no state\n                return;\n            }\n            this._state = this._state.map(state => state.mov(forward));\n            const newSelections = this._state.map(state => Selection.fromPositions(state.ranges[state.index].getStartPosition(), state.ranges[state.index].getEndPosition()));\n            this._ignoreSelection = true;\n            try {\n                this._editor.setSelections(newSelections);\n            }\n            finally {\n                this._ignoreSelection = false;\n            }\n        });\n    }\n};\nSmartSelectController.ID = 'editor.contrib.smartSelectController';\nSmartSelectController = __decorate([\n    __param(1, ILanguageFeaturesService)\n], SmartSelectController);\nclass AbstractSmartSelect extends EditorAction {\n    constructor(forward, opts) {\n        super(opts);\n        this._forward = forward;\n    }\n    run(_accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = SmartSelectController.get(editor);\n            if (controller) {\n                yield controller.run(this._forward);\n            }\n        });\n    }\n}\nclass GrowSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(true, {\n            id: 'editor.action.smartSelect.expand',\n            label: nls.localize('smartSelect.expand', \"Expand Selection\"),\n            alias: 'Expand Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectGrow', comment: ['&& denotes a mnemonic'] }, \"&&Expand Selection\"),\n                order: 2\n            }\n        });\n    }\n}\n// renamed command id\nCommandsRegistry.registerCommandAlias('editor.action.smartSelect.grow', 'editor.action.smartSelect.expand');\nclass ShrinkSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(false, {\n            id: 'editor.action.smartSelect.shrink',\n            label: nls.localize('smartSelect.shrink', \"Shrink Selection\"),\n            alias: 'Shrink Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectShrink', comment: ['&& denotes a mnemonic'] }, \"&&Shrink Selection\"),\n                order: 3\n            }\n        });\n    }\n}\nregisterEditorContribution(SmartSelectController.ID, SmartSelectController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(GrowSelectionAction);\nregisterEditorAction(ShrinkSelectionAction);\nexport function provideSelectionRanges(registry, model, positions, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = registry.all(model)\n            .concat(new WordSelectionRangeProvider()); // ALWAYS have word based selection range\n        if (providers.length === 1) {\n            // add word selection and bracket selection when no provider exists\n            providers.unshift(new BracketSelectionRangeProvider());\n        }\n        const work = [];\n        const allRawRanges = [];\n        for (const provider of providers) {\n            work.push(Promise.resolve(provider.provideSelectionRanges(model, positions, token)).then(allProviderRanges => {\n                if (arrays.isNonEmptyArray(allProviderRanges) && allProviderRanges.length === positions.length) {\n                    for (let i = 0; i < positions.length; i++) {\n                        if (!allRawRanges[i]) {\n                            allRawRanges[i] = [];\n                        }\n                        for (const oneProviderRanges of allProviderRanges[i]) {\n                            if (Range.isIRange(oneProviderRanges.range) && Range.containsPosition(oneProviderRanges.range, positions[i])) {\n                                allRawRanges[i].push(Range.lift(oneProviderRanges.range));\n                            }\n                        }\n                    }\n                }\n            }, onUnexpectedExternalError));\n        }\n        yield Promise.all(work);\n        return allRawRanges.map(oneRawRanges => {\n            if (oneRawRanges.length === 0) {\n                return [];\n            }\n            // sort all by start/end position\n            oneRawRanges.sort((a, b) => {\n                if (Position.isBefore(a.getStartPosition(), b.getStartPosition())) {\n                    return 1;\n                }\n                else if (Position.isBefore(b.getStartPosition(), a.getStartPosition())) {\n                    return -1;\n                }\n                else if (Position.isBefore(a.getEndPosition(), b.getEndPosition())) {\n                    return -1;\n                }\n                else if (Position.isBefore(b.getEndPosition(), a.getEndPosition())) {\n                    return 1;\n                }\n                else {\n                    return 0;\n                }\n            });\n            // remove ranges that don't contain the former range or that are equal to the\n            // former range\n            const oneRanges = [];\n            let last;\n            for (const range of oneRawRanges) {\n                if (!last || (Range.containsRange(range, last) && !Range.equalsRange(range, last))) {\n                    oneRanges.push(range);\n                    last = range;\n                }\n            }\n            if (!options.selectLeadingAndTrailingWhitespace) {\n                return oneRanges;\n            }\n            // add ranges that expand trivia at line starts and ends whenever a range\n            // wraps onto the a new line\n            const oneRangesWithTrivia = [oneRanges[0]];\n            for (let i = 1; i < oneRanges.length; i++) {\n                const prev = oneRanges[i - 1];\n                const cur = oneRanges[i];\n                if (cur.startLineNumber !== prev.startLineNumber || cur.endLineNumber !== prev.endLineNumber) {\n                    // add line/block range without leading/failing whitespace\n                    const rangeNoWhitespace = new Range(prev.startLineNumber, model.getLineFirstNonWhitespaceColumn(prev.startLineNumber), prev.endLineNumber, model.getLineLastNonWhitespaceColumn(prev.endLineNumber));\n                    if (rangeNoWhitespace.containsRange(prev) && !rangeNoWhitespace.equalsRange(prev) && cur.containsRange(rangeNoWhitespace) && !cur.equalsRange(rangeNoWhitespace)) {\n                        oneRangesWithTrivia.push(rangeNoWhitespace);\n                    }\n                    // add line/block range\n                    const rangeFull = new Range(prev.startLineNumber, 1, prev.endLineNumber, model.getLineMaxColumn(prev.endLineNumber));\n                    if (rangeFull.containsRange(prev) && !rangeFull.equalsRange(rangeNoWhitespace) && cur.containsRange(rangeFull) && !cur.equalsRange(rangeFull)) {\n                        oneRangesWithTrivia.push(rangeFull);\n                    }\n                }\n                oneRangesWithTrivia.push(cur);\n            }\n            return oneRangesWithTrivia;\n        });\n    });\n}\nCommandsRegistry.registerCommand('_executeSelectionRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, positions] = args;\n        assertType(URI.isUri(resource));\n        const registry = accessor.get(ILanguageFeaturesService).selectionRangeProvider;\n        const reference = yield accessor.get(ITextModelService).createModelReference(resource);\n        try {\n            return provideSelectionRanges(registry, reference.object.textEditorModel, positions, { selectLeadingAndTrailingWhitespace: true }, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { showSimpleSuggestions } from '../../suggest/browser/suggest.js';\nimport { localize } from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { SnippetSession } from './snippetSession.js';\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    undoStopBefore: true,\n    undoStopAfter: true,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nexport let SnippetController2 = class SnippetController2 {\n    static get(editor) {\n        return editor.getContribution(SnippetController2.ID);\n    }\n    constructor(_editor, _logService, _languageFeaturesService, contextKeyService, _languageConfigurationService) {\n        this._editor = _editor;\n        this._logService = _logService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._snippetListener = new DisposableStore();\n        this._modelVersionId = -1;\n        this._inSnippet = SnippetController2.InSnippetMode.bindTo(contextKeyService);\n        this._hasNextTabstop = SnippetController2.HasNextTabstop.bindTo(contextKeyService);\n        this._hasPrevTabstop = SnippetController2.HasPrevTabstop.bindTo(contextKeyService);\n    }\n    dispose() {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._snippetListener.dispose();\n    }\n    insert(template, opts) {\n        // this is here to find out more about the yet-not-understood\n        // error that sometimes happens when we fail to inserted a nested\n        // snippet\n        try {\n            this._doInsert(template, typeof opts === 'undefined' ? _defaultOptions : Object.assign(Object.assign({}, _defaultOptions), opts));\n        }\n        catch (e) {\n            this.cancel();\n            this._logService.error(e);\n            this._logService.error('snippet_error');\n            this._logService.error('insert_template=', template);\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\n        }\n    }\n    _doInsert(template, opts) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // don't listen while inserting the snippet\n        // as that is the inflight state causing cancelation\n        this._snippetListener.clear();\n        if (opts.undoStopBefore) {\n            this._editor.getModel().pushStackElement();\n        }\n        // don't merge\n        if (this._session && typeof template !== 'string') {\n            this.cancel();\n        }\n        if (!this._session) {\n            this._modelVersionId = this._editor.getModel().getAlternativeVersionId();\n            this._session = new SnippetSession(this._editor, template, opts, this._languageConfigurationService);\n            this._session.insert();\n        }\n        else {\n            assertType(typeof template === 'string');\n            this._session.merge(template, opts);\n        }\n        if (opts.undoStopAfter) {\n            this._editor.getModel().pushStackElement();\n        }\n        // regster completion item provider when there is any choice element\n        if ((_a = this._session) === null || _a === void 0 ? void 0 : _a.hasChoice) {\n            this._choiceCompletionItemProvider = {\n                provideCompletionItems: (model, position) => {\n                    if (!this._session || model !== this._editor.getModel() || !Position.equals(this._editor.getPosition(), position)) {\n                        return undefined;\n                    }\n                    const { activeChoice } = this._session;\n                    if (!activeChoice || activeChoice.choice.options.length === 0) {\n                        return undefined;\n                    }\n                    const word = model.getValueInRange(activeChoice.range);\n                    const isAnyOfOptions = Boolean(activeChoice.choice.options.find(o => o.value === word));\n                    const suggestions = [];\n                    for (let i = 0; i < activeChoice.choice.options.length; i++) {\n                        const option = activeChoice.choice.options[i];\n                        suggestions.push({\n                            kind: 13 /* CompletionItemKind.Value */,\n                            label: option.value,\n                            insertText: option.value,\n                            sortText: 'a'.repeat(i + 1),\n                            range: activeChoice.range,\n                            filterText: isAnyOfOptions ? `${word}_${option.value}` : undefined,\n                            command: { id: 'jumpToNextSnippetPlaceholder', title: localize('next', 'Go to next placeholder...') }\n                        });\n                    }\n                    return { suggestions };\n                }\n            };\n            const registration = this._languageFeaturesService.completionProvider.register({\n                language: this._editor.getModel().getLanguageId(),\n                pattern: this._editor.getModel().uri.fsPath,\n                scheme: this._editor.getModel().uri.scheme,\n                exclusive: true\n            }, this._choiceCompletionItemProvider);\n            this._snippetListener.add(registration);\n        }\n        this._updateState();\n        this._snippetListener.add(this._editor.onDidChangeModelContent(e => e.isFlush && this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeModel(() => this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeCursorSelection(() => this._updateState()));\n    }\n    _updateState() {\n        if (!this._session || !this._editor.hasModel()) {\n            // canceled in the meanwhile\n            return;\n        }\n        if (this._modelVersionId === this._editor.getModel().getAlternativeVersionId()) {\n            // undo until the 'before' state happened\n            // and makes use cancel snippet mode\n            return this.cancel();\n        }\n        if (!this._session.hasPlaceholder) {\n            // don't listen for selection changes and don't\n            // update context keys when the snippet is plain text\n            return this.cancel();\n        }\n        if (this._session.isAtLastPlaceholder || !this._session.isSelectionWithinPlaceholders()) {\n            this._editor.getModel().pushStackElement();\n            return this.cancel();\n        }\n        this._inSnippet.set(true);\n        this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder);\n        this._hasNextTabstop.set(!this._session.isAtLastPlaceholder);\n        this._handleChoice();\n    }\n    _handleChoice() {\n        if (!this._session || !this._editor.hasModel()) {\n            this._currentChoice = undefined;\n            return;\n        }\n        const { activeChoice } = this._session;\n        if (!activeChoice || !this._choiceCompletionItemProvider) {\n            this._currentChoice = undefined;\n            return;\n        }\n        if (this._currentChoice !== activeChoice.choice) {\n            this._currentChoice = activeChoice.choice;\n            // trigger suggest with the special choice completion provider\n            queueMicrotask(() => {\n                showSimpleSuggestions(this._editor, this._choiceCompletionItemProvider);\n            });\n        }\n    }\n    finish() {\n        while (this._inSnippet.get()) {\n            this.next();\n        }\n    }\n    cancel(resetSelection = false) {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        this._snippetListener.clear();\n        this._currentChoice = undefined;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._session = undefined;\n        this._modelVersionId = -1;\n        if (resetSelection) {\n            // reset selection to the primary cursor when being asked\n            // for. this happens when explicitly cancelling snippet mode,\n            // e.g. when pressing ESC\n            this._editor.setSelections([this._editor.getSelection()]);\n        }\n    }\n    prev() {\n        var _a;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.prev();\n        this._updateState();\n    }\n    next() {\n        var _a;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.next();\n        this._updateState();\n    }\n    isInSnippet() {\n        return Boolean(this._inSnippet.get());\n    }\n};\nSnippetController2.ID = 'snippetController2';\nSnippetController2.InSnippetMode = new RawContextKey('inSnippetMode', false, localize('inSnippetMode', \"Whether the editor in current in snippet mode\"));\nSnippetController2.HasNextTabstop = new RawContextKey('hasNextTabstop', false, localize('hasNextTabstop', \"Whether there is a next tab stop when in snippet mode\"));\nSnippetController2.HasPrevTabstop = new RawContextKey('hasPrevTabstop', false, localize('hasPrevTabstop', \"Whether there is a previous tab stop when in snippet mode\"));\nSnippetController2 = __decorate([\n    __param(1, ILogService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IContextKeyService),\n    __param(4, ILanguageConfigurationService)\n], SnippetController2);\nregisterEditorContribution(SnippetController2.ID, SnippetController2, 4 /* EditorContributionInstantiation.Lazy */);\nconst CommandCtor = EditorCommand.bindToContribution(SnippetController2.get);\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToNextSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasNextTabstop),\n    handler: ctrl => ctrl.next(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToPrevSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasPrevTabstop),\n    handler: ctrl => ctrl.prev(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'leaveSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.cancel(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'acceptSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.finish(),\n    // kbOpts: {\n    // \tweight: KeybindingWeight.EditorContrib + 30,\n    // \tkbExpr: EditorContextKeys.textFocus,\n    // \tprimary: KeyCode.Enter,\n    // }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class Scanner {\n    constructor() {\n        this.value = '';\n        this.pos = 0;\n    }\n    static isDigitCharacter(ch) {\n        return ch >= 48 /* CharCode.Digit0 */ && ch <= 57 /* CharCode.Digit9 */;\n    }\n    static isVariableCharacter(ch) {\n        return ch === 95 /* CharCode.Underline */\n            || (ch >= 97 /* CharCode.a */ && ch <= 122 /* CharCode.z */)\n            || (ch >= 65 /* CharCode.A */ && ch <= 90 /* CharCode.Z */);\n    }\n    text(value) {\n        this.value = value;\n        this.pos = 0;\n    }\n    tokenText(token) {\n        return this.value.substr(token.pos, token.len);\n    }\n    next() {\n        if (this.pos >= this.value.length) {\n            return { type: 14 /* TokenType.EOF */, pos: this.pos, len: 0 };\n        }\n        const pos = this.pos;\n        let len = 0;\n        let ch = this.value.charCodeAt(pos);\n        let type;\n        // static types\n        type = Scanner._table[ch];\n        if (typeof type === 'number') {\n            this.pos += 1;\n            return { type, pos, len: 1 };\n        }\n        // number\n        if (Scanner.isDigitCharacter(ch)) {\n            type = 8 /* TokenType.Int */;\n            do {\n                len += 1;\n                ch = this.value.charCodeAt(pos + len);\n            } while (Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // variable name\n        if (Scanner.isVariableCharacter(ch)) {\n            type = 9 /* TokenType.VariableName */;\n            do {\n                ch = this.value.charCodeAt(pos + (++len));\n            } while (Scanner.isVariableCharacter(ch) || Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // format\n        type = 10 /* TokenType.Format */;\n        do {\n            len += 1;\n            ch = this.value.charCodeAt(pos + len);\n        } while (!isNaN(ch)\n            && typeof Scanner._table[ch] === 'undefined' // not static token\n            && !Scanner.isDigitCharacter(ch) // not number\n            && !Scanner.isVariableCharacter(ch) // not variable\n        );\n        this.pos += len;\n        return { type, pos, len };\n    }\n}\nScanner._table = {\n    [36 /* CharCode.DollarSign */]: 0 /* TokenType.Dollar */,\n    [58 /* CharCode.Colon */]: 1 /* TokenType.Colon */,\n    [44 /* CharCode.Comma */]: 2 /* TokenType.Comma */,\n    [123 /* CharCode.OpenCurlyBrace */]: 3 /* TokenType.CurlyOpen */,\n    [125 /* CharCode.CloseCurlyBrace */]: 4 /* TokenType.CurlyClose */,\n    [92 /* CharCode.Backslash */]: 5 /* TokenType.Backslash */,\n    [47 /* CharCode.Slash */]: 6 /* TokenType.Forwardslash */,\n    [124 /* CharCode.Pipe */]: 7 /* TokenType.Pipe */,\n    [43 /* CharCode.Plus */]: 11 /* TokenType.Plus */,\n    [45 /* CharCode.Dash */]: 12 /* TokenType.Dash */,\n    [63 /* CharCode.QuestionMark */]: 13 /* TokenType.QuestionMark */,\n};\nexport class Marker {\n    constructor() {\n        this._children = [];\n    }\n    appendChild(child) {\n        if (child instanceof Text && this._children[this._children.length - 1] instanceof Text) {\n            // this and previous child are text -> merge them\n            this._children[this._children.length - 1].value += child.value;\n        }\n        else {\n            // normal adoption of child\n            child.parent = this;\n            this._children.push(child);\n        }\n        return this;\n    }\n    replace(child, others) {\n        const { parent } = child;\n        const idx = parent.children.indexOf(child);\n        const newChildren = parent.children.slice(0);\n        newChildren.splice(idx, 1, ...others);\n        parent._children = newChildren;\n        (function _fixParent(children, parent) {\n            for (const child of children) {\n                child.parent = parent;\n                _fixParent(child.children, child);\n            }\n        })(others, parent);\n    }\n    get children() {\n        return this._children;\n    }\n    get rightMostDescendant() {\n        if (this._children.length > 0) {\n            return this._children[this._children.length - 1].rightMostDescendant;\n        }\n        return this;\n    }\n    get snippet() {\n        let candidate = this;\n        while (true) {\n            if (!candidate) {\n                return undefined;\n            }\n            if (candidate instanceof TextmateSnippet) {\n                return candidate;\n            }\n            candidate = candidate.parent;\n        }\n    }\n    toString() {\n        return this.children.reduce((prev, cur) => prev + cur.toString(), '');\n    }\n    len() {\n        return 0;\n    }\n}\nexport class Text extends Marker {\n    constructor(value) {\n        super();\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n    len() {\n        return this.value.length;\n    }\n    clone() {\n        return new Text(this.value);\n    }\n}\nexport class TransformableMarker extends Marker {\n}\nexport class Placeholder extends TransformableMarker {\n    static compareByIndex(a, b) {\n        if (a.index === b.index) {\n            return 0;\n        }\n        else if (a.isFinalTabstop) {\n            return 1;\n        }\n        else if (b.isFinalTabstop) {\n            return -1;\n        }\n        else if (a.index < b.index) {\n            return -1;\n        }\n        else if (a.index > b.index) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    constructor(index) {\n        super();\n        this.index = index;\n    }\n    get isFinalTabstop() {\n        return this.index === 0;\n    }\n    get choice() {\n        return this._children.length === 1 && this._children[0] instanceof Choice\n            ? this._children[0]\n            : undefined;\n    }\n    clone() {\n        const ret = new Placeholder(this.index);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class Choice extends Marker {\n    constructor() {\n        super(...arguments);\n        this.options = [];\n    }\n    appendChild(marker) {\n        if (marker instanceof Text) {\n            marker.parent = this;\n            this.options.push(marker);\n        }\n        return this;\n    }\n    toString() {\n        return this.options[0].value;\n    }\n    len() {\n        return this.options[0].len();\n    }\n    clone() {\n        const ret = new Choice();\n        this.options.forEach(ret.appendChild, ret);\n        return ret;\n    }\n}\nexport class Transform extends Marker {\n    constructor() {\n        super(...arguments);\n        this.regexp = new RegExp('');\n    }\n    resolve(value) {\n        const _this = this;\n        let didMatch = false;\n        let ret = value.replace(this.regexp, function () {\n            didMatch = true;\n            return _this._replace(Array.prototype.slice.call(arguments, 0, -2));\n        });\n        // when the regex didn't match and when the transform has\n        // else branches, then run those\n        if (!didMatch && this._children.some(child => child instanceof FormatString && Boolean(child.elseValue))) {\n            ret = this._replace([]);\n        }\n        return ret;\n    }\n    _replace(groups) {\n        let ret = '';\n        for (const marker of this._children) {\n            if (marker instanceof FormatString) {\n                let value = groups[marker.index] || '';\n                value = marker.resolve(value);\n                ret += value;\n            }\n            else {\n                ret += marker.toString();\n            }\n        }\n        return ret;\n    }\n    toString() {\n        return '';\n    }\n    clone() {\n        const ret = new Transform();\n        ret.regexp = new RegExp(this.regexp.source, '' + (this.regexp.ignoreCase ? 'i' : '') + (this.regexp.global ? 'g' : ''));\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class FormatString extends Marker {\n    constructor(index, shorthandName, ifValue, elseValue) {\n        super();\n        this.index = index;\n        this.shorthandName = shorthandName;\n        this.ifValue = ifValue;\n        this.elseValue = elseValue;\n    }\n    resolve(value) {\n        if (this.shorthandName === 'upcase') {\n            return !value ? '' : value.toLocaleUpperCase();\n        }\n        else if (this.shorthandName === 'downcase') {\n            return !value ? '' : value.toLocaleLowerCase();\n        }\n        else if (this.shorthandName === 'capitalize') {\n            return !value ? '' : (value[0].toLocaleUpperCase() + value.substr(1));\n        }\n        else if (this.shorthandName === 'pascalcase') {\n            return !value ? '' : this._toPascalCase(value);\n        }\n        else if (this.shorthandName === 'camelcase') {\n            return !value ? '' : this._toCamelCase(value);\n        }\n        else if (Boolean(value) && typeof this.ifValue === 'string') {\n            return this.ifValue;\n        }\n        else if (!Boolean(value) && typeof this.elseValue === 'string') {\n            return this.elseValue;\n        }\n        else {\n            return value || '';\n        }\n    }\n    _toPascalCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map(word => {\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    _toCamelCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map((word, index) => {\n            if (index === 0) {\n                return word.charAt(0).toLowerCase() + word.substr(1);\n            }\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    clone() {\n        const ret = new FormatString(this.index, this.shorthandName, this.ifValue, this.elseValue);\n        return ret;\n    }\n}\nexport class Variable extends TransformableMarker {\n    constructor(name) {\n        super();\n        this.name = name;\n    }\n    resolve(resolver) {\n        let value = resolver.resolve(this);\n        if (this.transform) {\n            value = this.transform.resolve(value || '');\n        }\n        if (value !== undefined) {\n            this._children = [new Text(value)];\n            return true;\n        }\n        return false;\n    }\n    clone() {\n        const ret = new Variable(this.name);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nfunction walk(marker, visitor) {\n    const stack = [...marker];\n    while (stack.length > 0) {\n        const marker = stack.shift();\n        const recurse = visitor(marker);\n        if (!recurse) {\n            break;\n        }\n        stack.unshift(...marker.children);\n    }\n}\nexport class TextmateSnippet extends Marker {\n    get placeholderInfo() {\n        if (!this._placeholders) {\n            // fill in placeholders\n            const all = [];\n            let last;\n            this.walk(function (candidate) {\n                if (candidate instanceof Placeholder) {\n                    all.push(candidate);\n                    last = !last || last.index < candidate.index ? candidate : last;\n                }\n                return true;\n            });\n            this._placeholders = { all, last };\n        }\n        return this._placeholders;\n    }\n    get placeholders() {\n        const { all } = this.placeholderInfo;\n        return all;\n    }\n    offset(marker) {\n        let pos = 0;\n        let found = false;\n        this.walk(candidate => {\n            if (candidate === marker) {\n                found = true;\n                return false;\n            }\n            pos += candidate.len();\n            return true;\n        });\n        if (!found) {\n            return -1;\n        }\n        return pos;\n    }\n    fullLen(marker) {\n        let ret = 0;\n        walk([marker], marker => {\n            ret += marker.len();\n            return true;\n        });\n        return ret;\n    }\n    enclosingPlaceholders(placeholder) {\n        const ret = [];\n        let { parent } = placeholder;\n        while (parent) {\n            if (parent instanceof Placeholder) {\n                ret.push(parent);\n            }\n            parent = parent.parent;\n        }\n        return ret;\n    }\n    resolveVariables(resolver) {\n        this.walk(candidate => {\n            if (candidate instanceof Variable) {\n                if (candidate.resolve(resolver)) {\n                    this._placeholders = undefined;\n                }\n            }\n            return true;\n        });\n        return this;\n    }\n    appendChild(child) {\n        this._placeholders = undefined;\n        return super.appendChild(child);\n    }\n    replace(child, others) {\n        this._placeholders = undefined;\n        return super.replace(child, others);\n    }\n    clone() {\n        const ret = new TextmateSnippet();\n        this._children = this.children.map(child => child.clone());\n        return ret;\n    }\n    walk(visitor) {\n        walk(this.children, visitor);\n    }\n}\nexport class SnippetParser {\n    constructor() {\n        this._scanner = new Scanner();\n        this._token = { type: 14 /* TokenType.EOF */, pos: 0, len: 0 };\n    }\n    static escape(value) {\n        return value.replace(/\\$|}|\\\\/g, '\\\\$&');\n    }\n    static guessNeedsClipboard(template) {\n        return /\\${?CLIPBOARD/.test(template);\n    }\n    parse(value, insertFinalTabstop, enforceFinalTabstop) {\n        const snippet = new TextmateSnippet();\n        this.parseFragment(value, snippet);\n        this.ensureFinalTabstop(snippet, enforceFinalTabstop !== null && enforceFinalTabstop !== void 0 ? enforceFinalTabstop : false, insertFinalTabstop !== null && insertFinalTabstop !== void 0 ? insertFinalTabstop : false);\n        return snippet;\n    }\n    parseFragment(value, snippet) {\n        const offset = snippet.children.length;\n        this._scanner.text(value);\n        this._token = this._scanner.next();\n        while (this._parse(snippet)) {\n            // nothing\n        }\n        // fill in values for placeholders. the first placeholder of an index\n        // that has a value defines the value for all placeholders with that index\n        const placeholderDefaultValues = new Map();\n        const incompletePlaceholders = [];\n        snippet.walk(marker => {\n            if (marker instanceof Placeholder) {\n                if (marker.isFinalTabstop) {\n                    placeholderDefaultValues.set(0, undefined);\n                }\n                else if (!placeholderDefaultValues.has(marker.index) && marker.children.length > 0) {\n                    placeholderDefaultValues.set(marker.index, marker.children);\n                }\n                else {\n                    incompletePlaceholders.push(marker);\n                }\n            }\n            return true;\n        });\n        const fillInIncompletePlaceholder = (placeholder, stack) => {\n            const defaultValues = placeholderDefaultValues.get(placeholder.index);\n            if (!defaultValues) {\n                return;\n            }\n            const clone = new Placeholder(placeholder.index);\n            clone.transform = placeholder.transform;\n            for (const child of defaultValues) {\n                const newChild = child.clone();\n                clone.appendChild(newChild);\n                // \"recurse\" on children that are again placeholders\n                if (newChild instanceof Placeholder && placeholderDefaultValues.has(newChild.index) && !stack.has(newChild.index)) {\n                    stack.add(newChild.index);\n                    fillInIncompletePlaceholder(newChild, stack);\n                    stack.delete(newChild.index);\n                }\n            }\n            snippet.replace(placeholder, [clone]);\n        };\n        const stack = new Set();\n        for (const placeholder of incompletePlaceholders) {\n            fillInIncompletePlaceholder(placeholder, stack);\n        }\n        return snippet.children.slice(offset);\n    }\n    ensureFinalTabstop(snippet, enforceFinalTabstop, insertFinalTabstop) {\n        if (enforceFinalTabstop || insertFinalTabstop && snippet.placeholders.length > 0) {\n            const finalTabstop = snippet.placeholders.find(p => p.index === 0);\n            if (!finalTabstop) {\n                // the snippet uses placeholders but has no\n                // final tabstop defined -> insert at the end\n                snippet.appendChild(new Placeholder(0));\n            }\n        }\n    }\n    _accept(type, value) {\n        if (type === undefined || this._token.type === type) {\n            const ret = !value ? true : this._scanner.tokenText(this._token);\n            this._token = this._scanner.next();\n            return ret;\n        }\n        return false;\n    }\n    _backTo(token) {\n        this._scanner.pos = token.pos + token.len;\n        this._token = token;\n        return false;\n    }\n    _until(type) {\n        const start = this._token;\n        while (this._token.type !== type) {\n            if (this._token.type === 14 /* TokenType.EOF */) {\n                return false;\n            }\n            else if (this._token.type === 5 /* TokenType.Backslash */) {\n                const nextToken = this._scanner.next();\n                if (nextToken.type !== 0 /* TokenType.Dollar */\n                    && nextToken.type !== 4 /* TokenType.CurlyClose */\n                    && nextToken.type !== 5 /* TokenType.Backslash */) {\n                    return false;\n                }\n            }\n            this._token = this._scanner.next();\n        }\n        const value = this._scanner.value.substring(start.pos, this._token.pos).replace(/\\\\(\\$|}|\\\\)/g, '$1');\n        this._token = this._scanner.next();\n        return value;\n    }\n    _parse(marker) {\n        return this._parseEscaped(marker)\n            || this._parseTabstopOrVariableName(marker)\n            || this._parseComplexPlaceholder(marker)\n            || this._parseComplexVariable(marker)\n            || this._parseAnything(marker);\n    }\n    // \\$, \\\\, \\} -> just text\n    _parseEscaped(marker) {\n        let value;\n        if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n            // saw a backslash, append escaped token or that backslash\n            value = this._accept(0 /* TokenType.Dollar */, true)\n                || this._accept(4 /* TokenType.CurlyClose */, true)\n                || this._accept(5 /* TokenType.Backslash */, true)\n                || value;\n            marker.appendChild(new Text(value));\n            return true;\n        }\n        return false;\n    }\n    // $foo -> variable, $1 -> tabstop\n    _parseTabstopOrVariableName(parent) {\n        let value;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && (value = this._accept(9 /* TokenType.VariableName */, true) || this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        parent.appendChild(/^\\d+$/.test(value)\n            ? new Placeholder(Number(value))\n            : new Variable(value));\n        return true;\n    }\n    // ${1:<children>}, ${1} -> placeholder\n    _parseComplexPlaceholder(parent) {\n        let index;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (index = this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const placeholder = new Placeholder(Number(index));\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${1:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(placeholder);\n                    return true;\n                }\n                if (this._parse(placeholder)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + index + ':'));\n                placeholder.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (placeholder.index > 0 && this._accept(7 /* TokenType.Pipe */)) {\n            // ${1|one,two,three|}\n            const choice = new Choice();\n            while (true) {\n                if (this._parseChoiceElement(choice)) {\n                    if (this._accept(2 /* TokenType.Comma */)) {\n                        // opt, -> more\n                        continue;\n                    }\n                    if (this._accept(7 /* TokenType.Pipe */)) {\n                        placeholder.appendChild(choice);\n                        if (this._accept(4 /* TokenType.CurlyClose */)) {\n                            // ..|} -> done\n                            parent.appendChild(placeholder);\n                            return true;\n                        }\n                    }\n                }\n                this._backTo(token);\n                return false;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1/<regex>/<format>/<options>}\n            if (this._parseTransform(placeholder)) {\n                parent.appendChild(placeholder);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(placeholder);\n            return true;\n        }\n        else {\n            // ${1 <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseChoiceElement(parent) {\n        const token = this._token;\n        const values = [];\n        while (true) {\n            if (this._token.type === 2 /* TokenType.Comma */ || this._token.type === 7 /* TokenType.Pipe */) {\n                break;\n            }\n            let value;\n            if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n                // \\, \\|, or \\\\\n                value = this._accept(2 /* TokenType.Comma */, true)\n                    || this._accept(7 /* TokenType.Pipe */, true)\n                    || this._accept(5 /* TokenType.Backslash */, true)\n                    || value;\n            }\n            else {\n                value = this._accept(undefined, true);\n            }\n            if (!value) {\n                // EOF\n                this._backTo(token);\n                return false;\n            }\n            values.push(value);\n        }\n        if (values.length === 0) {\n            this._backTo(token);\n            return false;\n        }\n        parent.appendChild(new Text(values.join('')));\n        return true;\n    }\n    // ${foo:<children>}, ${foo} -> variable\n    _parseComplexVariable(parent) {\n        let name;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (name = this._accept(9 /* TokenType.VariableName */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const variable = new Variable(name);\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${foo:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(variable);\n                    return true;\n                }\n                if (this._parse(variable)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + name + ':'));\n                variable.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${foo/<regex>/<format>/<options>}\n            if (this._parseTransform(variable)) {\n                parent.appendChild(variable);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${foo}\n            parent.appendChild(variable);\n            return true;\n        }\n        else {\n            // ${foo <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseTransform(parent) {\n        // ...<regex>/<format>/<options>}\n        const transform = new Transform();\n        let regexValue = '';\n        let regexOptions = '';\n        // (1) /regex\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                regexValue += escaped;\n                continue;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexValue += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        // (2) /format\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(5 /* TokenType.Backslash */, true) || this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                transform.appendChild(new Text(escaped));\n                continue;\n            }\n            if (this._parseFormatString(transform) || this._parseAnything(transform)) {\n                continue;\n            }\n            return false;\n        }\n        // (3) /option\n        while (true) {\n            if (this._accept(4 /* TokenType.CurlyClose */)) {\n                break;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexOptions += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        try {\n            transform.regexp = new RegExp(regexValue, regexOptions);\n        }\n        catch (e) {\n            // invalid regexp\n            return false;\n        }\n        parent.transform = transform;\n        return true;\n    }\n    _parseFormatString(parent) {\n        const token = this._token;\n        if (!this._accept(0 /* TokenType.Dollar */)) {\n            return false;\n        }\n        let complex = false;\n        if (this._accept(3 /* TokenType.CurlyOpen */)) {\n            complex = true;\n        }\n        const index = this._accept(8 /* TokenType.Int */, true);\n        if (!index) {\n            this._backTo(token);\n            return false;\n        }\n        else if (!complex) {\n            // $1\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (!this._accept(1 /* TokenType.Colon */)) {\n            this._backTo(token);\n            return false;\n        }\n        if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1:/upcase}\n            const shorthand = this._accept(9 /* TokenType.VariableName */, true);\n            if (!shorthand || !this._accept(4 /* TokenType.CurlyClose */)) {\n                this._backTo(token);\n                return false;\n            }\n            else {\n                parent.appendChild(new FormatString(Number(index), shorthand));\n                return true;\n            }\n        }\n        else if (this._accept(11 /* TokenType.Plus */)) {\n            // ${1:+<if>}\n            const ifValue = this._until(4 /* TokenType.CurlyClose */);\n            if (ifValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, ifValue, undefined));\n                return true;\n            }\n        }\n        else if (this._accept(12 /* TokenType.Dash */)) {\n            // ${2:-<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        else if (this._accept(13 /* TokenType.QuestionMark */)) {\n            // ${2:?<if>:<else>}\n            const ifValue = this._until(1 /* TokenType.Colon */);\n            if (ifValue) {\n                const elseValue = this._until(4 /* TokenType.CurlyClose */);\n                if (elseValue) {\n                    parent.appendChild(new FormatString(Number(index), undefined, ifValue, elseValue));\n                    return true;\n                }\n            }\n        }\n        else {\n            // ${1:<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        this._backTo(token);\n        return false;\n    }\n    _parseAnything(marker) {\n        if (this._token.type !== 14 /* TokenType.EOF */) {\n            marker.appendChild(new Text(this._scanner.tokenText(this._token)));\n            this._accept(undefined);\n            return true;\n        }\n        return false;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { normalizeDriveLetter } from '../../../../base/common/labels.js';\nimport * as path from '../../../../base/common/path.js';\nimport { dirname } from '../../../../base/common/resources.js';\nimport { commonPrefixLength, getLeadingWhitespace, isFalsyOrWhitespace, splitLines } from '../../../../base/common/strings.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { Text } from './snippetParser.js';\nimport * as nls from '../../../../nls.js';\nimport { WORKSPACE_EXTENSION, isSingleFolderWorkspaceIdentifier, toWorkspaceIdentifier, isEmptyWorkspaceIdentifier } from '../../../../platform/workspace/common/workspace.js';\nexport const KnownSnippetVariableNames = Object.freeze({\n    'CURRENT_YEAR': true,\n    'CURRENT_YEAR_SHORT': true,\n    'CURRENT_MONTH': true,\n    'CURRENT_DATE': true,\n    'CURRENT_HOUR': true,\n    'CURRENT_MINUTE': true,\n    'CURRENT_SECOND': true,\n    'CURRENT_DAY_NAME': true,\n    'CURRENT_DAY_NAME_SHORT': true,\n    'CURRENT_MONTH_NAME': true,\n    'CURRENT_MONTH_NAME_SHORT': true,\n    'CURRENT_SECONDS_UNIX': true,\n    'CURRENT_TIMEZONE_OFFSET': true,\n    'SELECTION': true,\n    'CLIPBOARD': true,\n    'TM_SELECTED_TEXT': true,\n    'TM_CURRENT_LINE': true,\n    'TM_CURRENT_WORD': true,\n    'TM_LINE_INDEX': true,\n    'TM_LINE_NUMBER': true,\n    'TM_FILENAME': true,\n    'TM_FILENAME_BASE': true,\n    'TM_DIRECTORY': true,\n    'TM_FILEPATH': true,\n    'CURSOR_INDEX': true,\n    'CURSOR_NUMBER': true,\n    'RELATIVE_FILEPATH': true,\n    'BLOCK_COMMENT_START': true,\n    'BLOCK_COMMENT_END': true,\n    'LINE_COMMENT': true,\n    'WORKSPACE_NAME': true,\n    'WORKSPACE_FOLDER': true,\n    'RANDOM': true,\n    'RANDOM_HEX': true,\n    'UUID': true\n});\nexport class CompositeSnippetVariableResolver {\n    constructor(_delegates) {\n        this._delegates = _delegates;\n        //\n    }\n    resolve(variable) {\n        for (const delegate of this._delegates) {\n            const value = delegate.resolve(variable);\n            if (value !== undefined) {\n                return value;\n            }\n        }\n        return undefined;\n    }\n}\nexport class SelectionBasedVariableResolver {\n    constructor(_model, _selection, _selectionIdx, _overtypingCapturer) {\n        this._model = _model;\n        this._selection = _selection;\n        this._selectionIdx = _selectionIdx;\n        this._overtypingCapturer = _overtypingCapturer;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'SELECTION' || name === 'TM_SELECTED_TEXT') {\n            let value = this._model.getValueInRange(this._selection) || undefined;\n            let isMultiline = this._selection.startLineNumber !== this._selection.endLineNumber;\n            // If there was no selected text, try to get last overtyped text\n            if (!value && this._overtypingCapturer) {\n                const info = this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);\n                if (info) {\n                    value = info.value;\n                    isMultiline = info.multiline;\n                }\n            }\n            if (value && isMultiline && variable.snippet) {\n                // Selection is a multiline string which we indentation we now\n                // need to adjust. We compare the indentation of this variable\n                // with the indentation at the editor position and add potential\n                // extra indentation to the value\n                const line = this._model.getLineContent(this._selection.startLineNumber);\n                const lineLeadingWhitespace = getLeadingWhitespace(line, 0, this._selection.startColumn - 1);\n                let varLeadingWhitespace = lineLeadingWhitespace;\n                variable.snippet.walk(marker => {\n                    if (marker === variable) {\n                        return false;\n                    }\n                    if (marker instanceof Text) {\n                        varLeadingWhitespace = getLeadingWhitespace(splitLines(marker.value).pop());\n                    }\n                    return true;\n                });\n                const whitespaceCommonLength = commonPrefixLength(varLeadingWhitespace, lineLeadingWhitespace);\n                value = value.replace(/(\\r\\n|\\r|\\n)(.*)/g, (m, newline, rest) => `${newline}${varLeadingWhitespace.substr(whitespaceCommonLength)}${rest}`);\n            }\n            return value;\n        }\n        else if (name === 'TM_CURRENT_LINE') {\n            return this._model.getLineContent(this._selection.positionLineNumber);\n        }\n        else if (name === 'TM_CURRENT_WORD') {\n            const info = this._model.getWordAtPosition({\n                lineNumber: this._selection.positionLineNumber,\n                column: this._selection.positionColumn\n            });\n            return info && info.word || undefined;\n        }\n        else if (name === 'TM_LINE_INDEX') {\n            return String(this._selection.positionLineNumber - 1);\n        }\n        else if (name === 'TM_LINE_NUMBER') {\n            return String(this._selection.positionLineNumber);\n        }\n        else if (name === 'CURSOR_INDEX') {\n            return String(this._selectionIdx);\n        }\n        else if (name === 'CURSOR_NUMBER') {\n            return String(this._selectionIdx + 1);\n        }\n        return undefined;\n    }\n}\nexport class ModelBasedVariableResolver {\n    constructor(_labelService, _model) {\n        this._labelService = _labelService;\n        this._model = _model;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'TM_FILENAME') {\n            return path.basename(this._model.uri.fsPath);\n        }\n        else if (name === 'TM_FILENAME_BASE') {\n            const name = path.basename(this._model.uri.fsPath);\n            const idx = name.lastIndexOf('.');\n            if (idx <= 0) {\n                return name;\n            }\n            else {\n                return name.slice(0, idx);\n            }\n        }\n        else if (name === 'TM_DIRECTORY') {\n            if (path.dirname(this._model.uri.fsPath) === '.') {\n                return '';\n            }\n            return this._labelService.getUriLabel(dirname(this._model.uri));\n        }\n        else if (name === 'TM_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri);\n        }\n        else if (name === 'RELATIVE_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri, { relative: true, noPrefix: true });\n        }\n        return undefined;\n    }\n}\nexport class ClipboardBasedVariableResolver {\n    constructor(_readClipboardText, _selectionIdx, _selectionCount, _spread) {\n        this._readClipboardText = _readClipboardText;\n        this._selectionIdx = _selectionIdx;\n        this._selectionCount = _selectionCount;\n        this._spread = _spread;\n        //\n    }\n    resolve(variable) {\n        if (variable.name !== 'CLIPBOARD') {\n            return undefined;\n        }\n        const clipboardText = this._readClipboardText();\n        if (!clipboardText) {\n            return undefined;\n        }\n        // `spread` is assigning each cursor a line of the clipboard\n        // text whenever there the line count equals the cursor count\n        // and when enabled\n        if (this._spread) {\n            const lines = clipboardText.split(/\\r\\n|\\n|\\r/).filter(s => !isFalsyOrWhitespace(s));\n            if (lines.length === this._selectionCount) {\n                return lines[this._selectionIdx];\n            }\n        }\n        return clipboardText;\n    }\n}\nexport let CommentBasedVariableResolver = class CommentBasedVariableResolver {\n    constructor(_model, _selection, _languageConfigurationService) {\n        this._model = _model;\n        this._selection = _selection;\n        this._languageConfigurationService = _languageConfigurationService;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        const langId = this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber, this._selection.selectionStartColumn);\n        const config = this._languageConfigurationService.getLanguageConfiguration(langId).comments;\n        if (!config) {\n            return undefined;\n        }\n        if (name === 'LINE_COMMENT') {\n            return config.lineCommentToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_START') {\n            return config.blockCommentStartToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_END') {\n            return config.blockCommentEndToken || undefined;\n        }\n        return undefined;\n    }\n};\nCommentBasedVariableResolver = __decorate([\n    __param(2, ILanguageConfigurationService)\n], CommentBasedVariableResolver);\nexport class TimeBasedVariableResolver {\n    constructor() {\n        this._date = new Date();\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'CURRENT_YEAR') {\n            return String(this._date.getFullYear());\n        }\n        else if (name === 'CURRENT_YEAR_SHORT') {\n            return String(this._date.getFullYear()).slice(-2);\n        }\n        else if (name === 'CURRENT_MONTH') {\n            return String(this._date.getMonth().valueOf() + 1).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DATE') {\n            return String(this._date.getDate().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_HOUR') {\n            return String(this._date.getHours().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_MINUTE') {\n            return String(this._date.getMinutes().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_SECOND') {\n            return String(this._date.getSeconds().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DAY_NAME') {\n            return TimeBasedVariableResolver.dayNames[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_DAY_NAME_SHORT') {\n            return TimeBasedVariableResolver.dayNamesShort[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME') {\n            return TimeBasedVariableResolver.monthNames[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME_SHORT') {\n            return TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_SECONDS_UNIX') {\n            return String(Math.floor(this._date.getTime() / 1000));\n        }\n        else if (name === 'CURRENT_TIMEZONE_OFFSET') {\n            const rawTimeOffset = this._date.getTimezoneOffset();\n            const sign = rawTimeOffset > 0 ? '-' : '+';\n            const hours = Math.trunc(Math.abs(rawTimeOffset / 60));\n            const hoursString = (hours < 10 ? '0' + hours : hours);\n            const minutes = Math.abs(rawTimeOffset) - hours * 60;\n            const minutesString = (minutes < 10 ? '0' + minutes : minutes);\n            return sign + hoursString + ':' + minutesString;\n        }\n        return undefined;\n    }\n}\nTimeBasedVariableResolver.dayNames = [nls.localize('Sunday', \"Sunday\"), nls.localize('Monday', \"Monday\"), nls.localize('Tuesday', \"Tuesday\"), nls.localize('Wednesday', \"Wednesday\"), nls.localize('Thursday', \"Thursday\"), nls.localize('Friday', \"Friday\"), nls.localize('Saturday', \"Saturday\")];\nTimeBasedVariableResolver.dayNamesShort = [nls.localize('SundayShort', \"Sun\"), nls.localize('MondayShort', \"Mon\"), nls.localize('TuesdayShort', \"Tue\"), nls.localize('WednesdayShort', \"Wed\"), nls.localize('ThursdayShort', \"Thu\"), nls.localize('FridayShort', \"Fri\"), nls.localize('SaturdayShort', \"Sat\")];\nTimeBasedVariableResolver.monthNames = [nls.localize('January', \"January\"), nls.localize('February', \"February\"), nls.localize('March', \"March\"), nls.localize('April', \"April\"), nls.localize('May', \"May\"), nls.localize('June', \"June\"), nls.localize('July', \"July\"), nls.localize('August', \"August\"), nls.localize('September', \"September\"), nls.localize('October', \"October\"), nls.localize('November', \"November\"), nls.localize('December', \"December\")];\nTimeBasedVariableResolver.monthNamesShort = [nls.localize('JanuaryShort', \"Jan\"), nls.localize('FebruaryShort', \"Feb\"), nls.localize('MarchShort', \"Mar\"), nls.localize('AprilShort', \"Apr\"), nls.localize('MayShort', \"May\"), nls.localize('JuneShort', \"Jun\"), nls.localize('JulyShort', \"Jul\"), nls.localize('AugustShort', \"Aug\"), nls.localize('SeptemberShort', \"Sep\"), nls.localize('OctoberShort', \"Oct\"), nls.localize('NovemberShort', \"Nov\"), nls.localize('DecemberShort', \"Dec\")];\nexport class WorkspaceBasedVariableResolver {\n    constructor(_workspaceService) {\n        this._workspaceService = _workspaceService;\n        //\n    }\n    resolve(variable) {\n        if (!this._workspaceService) {\n            return undefined;\n        }\n        const workspaceIdentifier = toWorkspaceIdentifier(this._workspaceService.getWorkspace());\n        if (isEmptyWorkspaceIdentifier(workspaceIdentifier)) {\n            return undefined;\n        }\n        if (variable.name === 'WORKSPACE_NAME') {\n            return this._resolveWorkspaceName(workspaceIdentifier);\n        }\n        else if (variable.name === 'WORKSPACE_FOLDER') {\n            return this._resoveWorkspacePath(workspaceIdentifier);\n        }\n        return undefined;\n    }\n    _resolveWorkspaceName(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return path.basename(workspaceIdentifier.uri.path);\n        }\n        let filename = path.basename(workspaceIdentifier.configPath.path);\n        if (filename.endsWith(WORKSPACE_EXTENSION)) {\n            filename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\n        }\n        return filename;\n    }\n    _resoveWorkspacePath(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return normalizeDriveLetter(workspaceIdentifier.uri.fsPath);\n        }\n        const filename = path.basename(workspaceIdentifier.configPath.path);\n        let folderpath = workspaceIdentifier.configPath.fsPath;\n        if (folderpath.endsWith(filename)) {\n            folderpath = folderpath.substr(0, folderpath.length - filename.length - 1);\n        }\n        return (folderpath ? normalizeDriveLetter(folderpath) : '/');\n    }\n}\nexport class RandomBasedVariableResolver {\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'RANDOM') {\n            return Math.random().toString().slice(-6);\n        }\n        else if (name === 'RANDOM_HEX') {\n            return Math.random().toString(16).slice(-6);\n        }\n        else if (name === 'UUID') {\n            return generateUuid();\n        }\n        return undefined;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { groupBy } from '../../../../base/common/arrays.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace } from '../../../../base/common/strings.js';\nimport './snippetSession.css';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { Choice, Placeholder, SnippetParser, Text, TextmateSnippet } from './snippetParser.js';\nimport { ClipboardBasedVariableResolver, CommentBasedVariableResolver, CompositeSnippetVariableResolver, ModelBasedVariableResolver, RandomBasedVariableResolver, SelectionBasedVariableResolver, TimeBasedVariableResolver, WorkspaceBasedVariableResolver } from './snippetVariables.js';\nexport class OneSnippet {\n    constructor(_editor, _snippet, _snippetLineLeadingWhitespace) {\n        this._editor = _editor;\n        this._snippet = _snippet;\n        this._snippetLineLeadingWhitespace = _snippetLineLeadingWhitespace;\n        this._offset = -1;\n        this._nestingLevel = 1;\n        this._placeholderGroups = groupBy(_snippet.placeholders, Placeholder.compareByIndex);\n        this._placeholderGroupsIdx = -1;\n    }\n    initialize(textChange) {\n        this._offset = textChange.newPosition;\n    }\n    dispose() {\n        if (this._placeholderDecorations) {\n            this._editor.removeDecorations([...this._placeholderDecorations.values()]);\n        }\n        this._placeholderGroups.length = 0;\n    }\n    _initDecorations() {\n        if (this._offset === -1) {\n            throw new Error(`Snippet not initialized!`);\n        }\n        if (this._placeholderDecorations) {\n            // already initialized\n            return;\n        }\n        this._placeholderDecorations = new Map();\n        const model = this._editor.getModel();\n        this._editor.changeDecorations(accessor => {\n            // create a decoration for each placeholder\n            for (const placeholder of this._snippet.placeholders) {\n                const placeholderOffset = this._snippet.offset(placeholder);\n                const placeholderLen = this._snippet.fullLen(placeholder);\n                const range = Range.fromPositions(model.getPositionAt(this._offset + placeholderOffset), model.getPositionAt(this._offset + placeholderOffset + placeholderLen));\n                const options = placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive;\n                const handle = accessor.addDecoration(range, options);\n                this._placeholderDecorations.set(placeholder, handle);\n            }\n        });\n    }\n    move(fwd) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        this._initDecorations();\n        // Transform placeholder text if necessary\n        if (this._placeholderGroupsIdx >= 0) {\n            const operations = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                // Check if the placeholder has a transformation\n                if (placeholder.transform) {\n                    const id = this._placeholderDecorations.get(placeholder);\n                    const range = this._editor.getModel().getDecorationRange(id);\n                    const currentValue = this._editor.getModel().getValueInRange(range);\n                    const transformedValueLines = placeholder.transform.resolve(currentValue).split(/\\r\\n|\\r|\\n/);\n                    // fix indentation for transformed lines\n                    for (let i = 1; i < transformedValueLines.length; i++) {\n                        transformedValueLines[i] = this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace + transformedValueLines[i]);\n                    }\n                    operations.push(EditOperation.replace(range, transformedValueLines.join(this._editor.getModel().getEOL())));\n                }\n            }\n            if (operations.length > 0) {\n                this._editor.executeEdits('snippet.placeholderTransform', operations);\n            }\n        }\n        let couldSkipThisPlaceholder = false;\n        if (fwd === true && this._placeholderGroupsIdx < this._placeholderGroups.length - 1) {\n            this._placeholderGroupsIdx += 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else if (fwd === false && this._placeholderGroupsIdx > 0) {\n            this._placeholderGroupsIdx -= 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else {\n            // the selection of the current placeholder might\n            // not acurate any more -> simply restore it\n        }\n        const newSelections = this._editor.getModel().changeDecorations(accessor => {\n            const activePlaceholders = new Set();\n            // change stickiness to always grow when typing at its edges\n            // because these decorations represent the currently active\n            // tabstop.\n            // Special case #1: reaching the final tabstop\n            // Special case #2: placeholders enclosing active placeholders\n            const selections = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                selections.push(new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn));\n                // consider to skip this placeholder index when the decoration\n                // range is empty but when the placeholder wasn't. that's a strong\n                // hint that the placeholder has been deleted. (all placeholder must match this)\n                couldSkipThisPlaceholder = couldSkipThisPlaceholder && this._hasPlaceholderBeenCollapsed(placeholder);\n                accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                activePlaceholders.add(placeholder);\n                for (const enclosingPlaceholder of this._snippet.enclosingPlaceholders(placeholder)) {\n                    const id = this._placeholderDecorations.get(enclosingPlaceholder);\n                    accessor.changeDecorationOptions(id, enclosingPlaceholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                    activePlaceholders.add(enclosingPlaceholder);\n                }\n            }\n            // change stickness to never grow when typing at its edges\n            // so that in-active tabstops never grow\n            for (const [placeholder, id] of this._placeholderDecorations) {\n                if (!activePlaceholders.has(placeholder)) {\n                    accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive);\n                }\n            }\n            return selections;\n        });\n        return !couldSkipThisPlaceholder ? newSelections !== null && newSelections !== void 0 ? newSelections : [] : this.move(fwd);\n    }\n    _hasPlaceholderBeenCollapsed(placeholder) {\n        // A placeholder is empty when it wasn't empty when authored but\n        // when its tracking decoration is empty. This also applies to all\n        // potential parent placeholders\n        let marker = placeholder;\n        while (marker) {\n            if (marker instanceof Placeholder) {\n                const id = this._placeholderDecorations.get(marker);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (range.isEmpty() && marker.toString().length > 0) {\n                    return true;\n                }\n            }\n            marker = marker.parent;\n        }\n        return false;\n    }\n    get isAtFirstPlaceholder() {\n        return this._placeholderGroupsIdx <= 0 || this._placeholderGroups.length === 0;\n    }\n    get isAtLastPlaceholder() {\n        return this._placeholderGroupsIdx === this._placeholderGroups.length - 1;\n    }\n    get hasPlaceholder() {\n        return this._snippet.placeholders.length > 0;\n    }\n    /**\n     * A snippet is trivial when it has no placeholder or only a final placeholder at\n     * its very end\n     */\n    get isTrivialSnippet() {\n        if (this._snippet.placeholders.length === 0) {\n            return true;\n        }\n        if (this._snippet.placeholders.length === 1) {\n            const [placeholder] = this._snippet.placeholders;\n            if (placeholder.isFinalTabstop) {\n                if (this._snippet.rightMostDescendant === placeholder) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    computePossibleSelections() {\n        const result = new Map();\n        for (const placeholdersWithEqualIndex of this._placeholderGroups) {\n            let ranges;\n            for (const placeholder of placeholdersWithEqualIndex) {\n                if (placeholder.isFinalTabstop) {\n                    // ignore those\n                    break;\n                }\n                if (!ranges) {\n                    ranges = [];\n                    result.set(placeholder.index, ranges);\n                }\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (!range) {\n                    // one of the placeholder lost its decoration and\n                    // therefore we bail out and pretend the placeholder\n                    // (with its mirrors) doesn't exist anymore.\n                    result.delete(placeholder.index);\n                    break;\n                }\n                ranges.push(range);\n            }\n        }\n        return result;\n    }\n    get activeChoice() {\n        if (!this._placeholderDecorations) {\n            return undefined;\n        }\n        const placeholder = this._placeholderGroups[this._placeholderGroupsIdx][0];\n        if (!(placeholder === null || placeholder === void 0 ? void 0 : placeholder.choice)) {\n            return undefined;\n        }\n        const id = this._placeholderDecorations.get(placeholder);\n        if (!id) {\n            return undefined;\n        }\n        const range = this._editor.getModel().getDecorationRange(id);\n        if (!range) {\n            return undefined;\n        }\n        return { range, choice: placeholder.choice };\n    }\n    get hasChoice() {\n        let result = false;\n        this._snippet.walk(marker => {\n            result = marker instanceof Choice;\n            return !result;\n        });\n        return result;\n    }\n    merge(others) {\n        const model = this._editor.getModel();\n        this._nestingLevel *= 10;\n        this._editor.changeDecorations(accessor => {\n            // For each active placeholder take one snippet and merge it\n            // in that the placeholder (can be many for `$1foo$1foo`). Because\n            // everything is sorted by editor selection we can simply remove\n            // elements from the beginning of the array\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const nested = others.shift();\n                console.assert(nested._offset !== -1);\n                console.assert(!nested._placeholderDecorations);\n                // Massage placeholder-indicies of the nested snippet to be\n                // sorted right after the insertion point. This ensures we move\n                // through the placeholders in the correct order\n                const indexLastPlaceholder = nested._snippet.placeholderInfo.last.index;\n                for (const nestedPlaceholder of nested._snippet.placeholderInfo.all) {\n                    if (nestedPlaceholder.isFinalTabstop) {\n                        nestedPlaceholder.index = placeholder.index + ((indexLastPlaceholder + 1) / this._nestingLevel);\n                    }\n                    else {\n                        nestedPlaceholder.index = placeholder.index + (nestedPlaceholder.index / this._nestingLevel);\n                    }\n                }\n                this._snippet.replace(placeholder, nested._snippet.children);\n                // Remove the placeholder at which position are inserting\n                // the snippet and also remove its decoration.\n                const id = this._placeholderDecorations.get(placeholder);\n                accessor.removeDecoration(id);\n                this._placeholderDecorations.delete(placeholder);\n                // For each *new* placeholder we create decoration to monitor\n                // how and if it grows/shrinks.\n                for (const placeholder of nested._snippet.placeholders) {\n                    const placeholderOffset = nested._snippet.offset(placeholder);\n                    const placeholderLen = nested._snippet.fullLen(placeholder);\n                    const range = Range.fromPositions(model.getPositionAt(nested._offset + placeholderOffset), model.getPositionAt(nested._offset + placeholderOffset + placeholderLen));\n                    const handle = accessor.addDecoration(range, OneSnippet._decor.inactive);\n                    this._placeholderDecorations.set(placeholder, handle);\n                }\n            }\n            // Last, re-create the placeholder groups by sorting placeholders by their index.\n            this._placeholderGroups = groupBy(this._snippet.placeholders, Placeholder.compareByIndex);\n        });\n    }\n}\nOneSnippet._decor = {\n    active: ModelDecorationOptions.register({ description: 'snippet-placeholder-1', stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    inactive: ModelDecorationOptions.register({ description: 'snippet-placeholder-2', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    activeFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-3', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n    inactiveFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-4', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n};\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nexport let SnippetSession = class SnippetSession {\n    static adjustWhitespace(model, position, adjustIndentation, snippet, filter) {\n        const line = model.getLineContent(position.lineNumber);\n        const lineLeadingWhitespace = getLeadingWhitespace(line, 0, position.column - 1);\n        // the snippet as inserted\n        let snippetTextString;\n        snippet.walk(marker => {\n            // all text elements that are not inside choice\n            if (!(marker instanceof Text) || marker.parent instanceof Choice) {\n                return true;\n            }\n            // check with filter (iff provided)\n            if (filter && !filter.has(marker)) {\n                return true;\n            }\n            const lines = marker.value.split(/\\r\\n|\\r|\\n/);\n            if (adjustIndentation) {\n                // adjust indentation of snippet test\n                // -the snippet-start doesn't get extra-indented (lineLeadingWhitespace), only normalized\n                // -all N+1 lines get extra-indented and normalized\n                // -the text start get extra-indented and normalized when following a linebreak\n                const offset = snippet.offset(marker);\n                if (offset === 0) {\n                    // snippet start\n                    lines[0] = model.normalizeIndentation(lines[0]);\n                }\n                else {\n                    // check if text start is after a linebreak\n                    snippetTextString = snippetTextString !== null && snippetTextString !== void 0 ? snippetTextString : snippet.toString();\n                    const prevChar = snippetTextString.charCodeAt(offset - 1);\n                    if (prevChar === 10 /* CharCode.LineFeed */ || prevChar === 13 /* CharCode.CarriageReturn */) {\n                        lines[0] = model.normalizeIndentation(lineLeadingWhitespace + lines[0]);\n                    }\n                }\n                for (let i = 1; i < lines.length; i++) {\n                    lines[i] = model.normalizeIndentation(lineLeadingWhitespace + lines[i]);\n                }\n            }\n            const newValue = lines.join(model.getEOL());\n            if (newValue !== marker.value) {\n                marker.parent.replace(marker, [new Text(newValue)]);\n                snippetTextString = undefined;\n            }\n            return true;\n        });\n        return lineLeadingWhitespace;\n    }\n    static adjustSelection(model, selection, overwriteBefore, overwriteAfter) {\n        if (overwriteBefore !== 0 || overwriteAfter !== 0) {\n            // overwrite[Before|After] is compute using the position, not the whole\n            // selection. therefore we adjust the selection around that position\n            const { positionLineNumber, positionColumn } = selection;\n            const positionColumnBefore = positionColumn - overwriteBefore;\n            const positionColumnAfter = positionColumn + overwriteAfter;\n            const range = model.validateRange({\n                startLineNumber: positionLineNumber,\n                startColumn: positionColumnBefore,\n                endLineNumber: positionLineNumber,\n                endColumn: positionColumnAfter\n            });\n            selection = Selection.createWithDirection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn, selection.getDirection());\n        }\n        return selection;\n    }\n    static createEditsAndSnippetsFromSelections(editor, template, overwriteBefore, overwriteAfter, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        const edits = [];\n        const snippets = [];\n        if (!editor.hasModel()) {\n            return { edits, snippets };\n        }\n        const model = editor.getModel();\n        const workspaceService = editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService));\n        const modelBasedVariableResolver = editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model));\n        const readClipboardText = () => clipboardText;\n        // know what text the overwrite[Before|After] extensions\n        // of the primary curser have selected because only when\n        // secondary selections extend to the same text we can grow them\n        const firstBeforeText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), overwriteBefore, 0));\n        const firstAfterText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), 0, overwriteAfter));\n        // remember the first non-whitespace column to decide if\n        // `keepWhitespace` should be overruled for secondary selections\n        const firstLineFirstNonWhitespace = model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);\n        // sort selections by their start position but remeber\n        // the original index. that allows you to create correct\n        // offset-based selection logic without changing the\n        // primary selection\n        const indexedSelections = editor.getSelections()\n            .map((selection, idx) => ({ selection, idx }))\n            .sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        for (const { selection, idx } of indexedSelections) {\n            // extend selection with the `overwriteBefore` and `overwriteAfter` and then\n            // compare if this matches the extensions of the primary selection\n            let extensionBefore = SnippetSession.adjustSelection(model, selection, overwriteBefore, 0);\n            let extensionAfter = SnippetSession.adjustSelection(model, selection, 0, overwriteAfter);\n            if (firstBeforeText !== model.getValueInRange(extensionBefore)) {\n                extensionBefore = selection;\n            }\n            if (firstAfterText !== model.getValueInRange(extensionAfter)) {\n                extensionAfter = selection;\n            }\n            // merge the before and after selection into one\n            const snippetSelection = selection\n                .setStartPosition(extensionBefore.startLineNumber, extensionBefore.startColumn)\n                .setEndPosition(extensionAfter.endLineNumber, extensionAfter.endColumn);\n            const snippet = new SnippetParser().parse(template, true, enforceFinalTabstop);\n            // adjust the template string to match the indentation and\n            // whitespace rules of this insert location (can be different for each cursor)\n            // happens when being asked for (default) or when this is a secondary\n            // cursor and the leading whitespace is different\n            const start = snippetSelection.getStartPosition();\n            const snippetLineLeadingWhitespace = SnippetSession.adjustWhitespace(model, start, adjustWhitespace || (idx > 0 && firstLineFirstNonWhitespace !== model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber)), snippet);\n            snippet.resolveVariables(new CompositeSnippetVariableResolver([\n                modelBasedVariableResolver,\n                new ClipboardBasedVariableResolver(readClipboardText, idx, indexedSelections.length, editor.getOption(76 /* EditorOption.multiCursorPaste */) === 'spread'),\n                new SelectionBasedVariableResolver(model, selection, idx, overtypingCapturer),\n                new CommentBasedVariableResolver(model, selection, languageConfigurationService),\n                new TimeBasedVariableResolver,\n                new WorkspaceBasedVariableResolver(workspaceService),\n                new RandomBasedVariableResolver,\n            ]));\n            // store snippets with the index of their originating selection.\n            // that ensures the primiary cursor stays primary despite not being\n            // the one with lowest start position\n            edits[idx] = EditOperation.replace(snippetSelection, snippet.toString());\n            edits[idx].identifier = { major: idx, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edits[idx]._isTracked = true;\n            snippets[idx] = new OneSnippet(editor, snippet, snippetLineLeadingWhitespace);\n        }\n        return { edits, snippets };\n    }\n    static createEditsAndSnippetsFromEdits(editor, snippetEdits, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        if (!editor.hasModel() || snippetEdits.length === 0) {\n            return { edits: [], snippets: [] };\n        }\n        const edits = [];\n        const model = editor.getModel();\n        const parser = new SnippetParser();\n        const snippet = new TextmateSnippet();\n        // snippet variables resolver\n        const resolver = new CompositeSnippetVariableResolver([\n            editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model)),\n            new ClipboardBasedVariableResolver(() => clipboardText, 0, editor.getSelections().length, editor.getOption(76 /* EditorOption.multiCursorPaste */) === 'spread'),\n            new SelectionBasedVariableResolver(model, editor.getSelection(), 0, overtypingCapturer),\n            new CommentBasedVariableResolver(model, editor.getSelection(), languageConfigurationService),\n            new TimeBasedVariableResolver,\n            new WorkspaceBasedVariableResolver(editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService))),\n            new RandomBasedVariableResolver,\n        ]);\n        //\n        snippetEdits = snippetEdits.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n        let offset = 0;\n        for (let i = 0; i < snippetEdits.length; i++) {\n            const { range, template } = snippetEdits[i];\n            // gaps between snippet edits are appended as text nodes. this\n            // ensures placeholder-offsets are later correct\n            if (i > 0) {\n                const lastRange = snippetEdits[i - 1].range;\n                const textRange = Range.fromPositions(lastRange.getEndPosition(), range.getStartPosition());\n                const textNode = new Text(model.getValueInRange(textRange));\n                snippet.appendChild(textNode);\n                offset += textNode.value.length;\n            }\n            const newNodes = parser.parseFragment(template, snippet);\n            SnippetSession.adjustWhitespace(model, range.getStartPosition(), true, snippet, new Set(newNodes));\n            snippet.resolveVariables(resolver);\n            const snippetText = snippet.toString();\n            const snippetFragmentText = snippetText.slice(offset);\n            offset = snippetText.length;\n            // make edit\n            const edit = EditOperation.replace(range, snippetFragmentText);\n            edit.identifier = { major: i, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edit._isTracked = true;\n            edits.push(edit);\n        }\n        //\n        parser.ensureFinalTabstop(snippet, enforceFinalTabstop, true);\n        return {\n            edits,\n            snippets: [new OneSnippet(editor, snippet, '')]\n        };\n    }\n    constructor(_editor, _template, _options = _defaultOptions, _languageConfigurationService) {\n        this._editor = _editor;\n        this._template = _template;\n        this._options = _options;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._templateMerges = [];\n        this._snippets = [];\n    }\n    dispose() {\n        dispose(this._snippets);\n    }\n    _logInfo() {\n        return `template=\"${this._template}\", merged_templates=\"${this._templateMerges.join(' -> ')}\"`;\n    }\n    insert() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // make insert edit and start with first selections\n        const { edits, snippets } = typeof this._template === 'string'\n            ? SnippetSession.createEditsAndSnippetsFromSelections(this._editor, this._template, this._options.overwriteBefore, this._options.overwriteAfter, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService)\n            : SnippetSession.createEditsAndSnippetsFromEdits(this._editor, this._template, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService);\n        this._snippets = snippets;\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            if (this._snippets[0].hasPlaceholder) {\n                return this._move(true);\n            }\n            else {\n                return undoEdits\n                    .map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n        this._editor.revealRange(this._editor.getSelections()[0]);\n    }\n    merge(template, options = _defaultOptions) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._templateMerges.push([this._snippets[0]._nestingLevel, this._snippets[0]._placeholderGroupsIdx, template]);\n        const { edits, snippets } = SnippetSession.createEditsAndSnippetsFromSelections(this._editor, template, options.overwriteBefore, options.overwriteAfter, true, options.adjustWhitespace, options.clipboardText, options.overtypingCapturer, this._languageConfigurationService);\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            // Trivial snippets have no placeholder or are just the final placeholder. That means they\n            // are just text insertions and we don't need to merge the nested snippet into the existing\n            // snippet\n            const isTrivialSnippet = snippets[0].isTrivialSnippet;\n            if (!isTrivialSnippet) {\n                for (const snippet of this._snippets) {\n                    snippet.merge(snippets);\n                }\n                console.assert(snippets.length === 0);\n            }\n            if (this._snippets[0].hasPlaceholder && !isTrivialSnippet) {\n                return this._move(undefined);\n            }\n            else {\n                return undoEdits.map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n    }\n    next() {\n        const newSelections = this._move(true);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    prev() {\n        const newSelections = this._move(false);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    _move(fwd) {\n        const selections = [];\n        for (const snippet of this._snippets) {\n            const oneSelection = snippet.move(fwd);\n            selections.push(...oneSelection);\n        }\n        return selections;\n    }\n    get isAtFirstPlaceholder() {\n        return this._snippets[0].isAtFirstPlaceholder;\n    }\n    get isAtLastPlaceholder() {\n        return this._snippets[0].isAtLastPlaceholder;\n    }\n    get hasPlaceholder() {\n        return this._snippets[0].hasPlaceholder;\n    }\n    get hasChoice() {\n        return this._snippets[0].hasChoice;\n    }\n    get activeChoice() {\n        return this._snippets[0].activeChoice;\n    }\n    isSelectionWithinPlaceholders() {\n        if (!this.hasPlaceholder) {\n            return false;\n        }\n        const selections = this._editor.getSelections();\n        if (selections.length < this._snippets.length) {\n            // this means we started snippet mode with N\n            // selections and have M (N > M) selections.\n            // So one snippet is without selection -> cancel\n            return false;\n        }\n        const allPossibleSelections = new Map();\n        for (const snippet of this._snippets) {\n            const possibleSelections = snippet.computePossibleSelections();\n            // for the first snippet find the placeholder (and its ranges)\n            // that contain at least one selection. for all remaining snippets\n            // the same placeholder (and their ranges) must be used.\n            if (allPossibleSelections.size === 0) {\n                for (const [index, ranges] of possibleSelections) {\n                    ranges.sort(Range.compareRangesUsingStarts);\n                    for (const selection of selections) {\n                        if (ranges[0].containsRange(selection)) {\n                            allPossibleSelections.set(index, []);\n                            break;\n                        }\n                    }\n                }\n            }\n            if (allPossibleSelections.size === 0) {\n                // return false if we couldn't associate a selection to\n                // this (the first) snippet\n                return false;\n            }\n            // add selections from 'this' snippet so that we know all\n            // selections for this placeholder\n            allPossibleSelections.forEach((array, index) => {\n                array.push(...possibleSelections.get(index));\n            });\n        }\n        // sort selections (and later placeholder-ranges). then walk both\n        // arrays and make sure the placeholder-ranges contain the corresponding\n        // selection\n        selections.sort(Range.compareRangesUsingStarts);\n        for (const [index, ranges] of allPossibleSelections) {\n            if (ranges.length !== selections.length) {\n                allPossibleSelections.delete(index);\n                continue;\n            }\n            ranges.sort(Range.compareRangesUsingStarts);\n            for (let i = 0; i < ranges.length; i++) {\n                if (!ranges[i].containsRange(selections[i])) {\n                    allPossibleSelections.delete(index);\n                    continue;\n                }\n            }\n        }\n        // from all possible selections we have deleted those\n        // that don't match with the current selection. if we don't\n        // have any left, we don't have a selection anymore\n        return allPossibleSelections.size > 0;\n    }\n};\nSnippetSession = __decorate([\n    __param(3, ILanguageConfigurationService)\n], SnippetSession);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport './stickyScroll.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Position } from '../../../common/core/position.js';\nimport { StringBuilder } from '../../../common/core/stringBuilder.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nexport class StickyScrollWidgetState {\n    constructor(lineNumbers, lastLineRelativePosition) {\n        this.lineNumbers = lineNumbers;\n        this.lastLineRelativePosition = lastLineRelativePosition;\n    }\n}\nconst _ttPolicy = createTrustedTypesPolicy('stickyScrollViewLayer', { createHTML: value => value });\nexport class StickyScrollWidget extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._rootDomNode = document.createElement('div');\n        this._disposableStore = this._register(new DisposableStore());\n        this._lineNumbers = [];\n        this._lastLineRelativePosition = 0;\n        this._hoverOnLine = -1;\n        this._hoverOnColumn = -1;\n        this._layoutInfo = this._editor.getLayoutInfo();\n        this._rootDomNode = document.createElement('div');\n        this._rootDomNode.className = 'sticky-widget';\n        this._rootDomNode.classList.toggle('peek', _editor instanceof EmbeddedCodeEditorWidget);\n        this._rootDomNode.style.width = `${this._layoutInfo.width - this._layoutInfo.minimap.minimapCanvasOuterWidth - this._layoutInfo.verticalScrollbarWidth}px`;\n    }\n    get hoverOnLine() {\n        return this._hoverOnLine;\n    }\n    get hoverOnColumn() {\n        return this._hoverOnColumn;\n    }\n    get lineNumbers() {\n        return this._lineNumbers;\n    }\n    getCurrentLines() {\n        return this._lineNumbers;\n    }\n    setState(state) {\n        dom.clearNode(this._rootDomNode);\n        this._disposableStore.clear();\n        this._lineNumbers.length = 0;\n        const editorLineHeight = this._editor.getOption(64 /* EditorOption.lineHeight */);\n        const futureWidgetHeight = state.lineNumbers.length * editorLineHeight + state.lastLineRelativePosition;\n        if (futureWidgetHeight > 0) {\n            this._lastLineRelativePosition = state.lastLineRelativePosition;\n            this._lineNumbers = state.lineNumbers;\n        }\n        else {\n            this._lastLineRelativePosition = 0;\n            this._lineNumbers = [];\n        }\n        this._renderRootNode();\n    }\n    _renderRootNode() {\n        if (!this._editor._getViewModel()) {\n            return;\n        }\n        for (const [index, line] of this._lineNumbers.entries()) {\n            const childNode = this._renderChildNode(index, line);\n            this._rootDomNode.appendChild(childNode);\n        }\n        const editorLineHeight = this._editor.getOption(64 /* EditorOption.lineHeight */);\n        const widgetHeight = this._lineNumbers.length * editorLineHeight + this._lastLineRelativePosition;\n        this._rootDomNode.style.display = widgetHeight > 0 ? 'block' : 'none';\n        this._rootDomNode.style.height = widgetHeight.toString() + 'px';\n        this._rootDomNode.setAttribute('role', 'list');\n        const minimapSide = this._editor.getOption(70 /* EditorOption.minimap */).side;\n        if (minimapSide === 'left') {\n            this._rootDomNode.style.marginLeft = this._editor.getLayoutInfo().minimap.minimapCanvasOuterWidth + 'px';\n        }\n    }\n    _renderChildNode(index, line) {\n        const child = document.createElement('div');\n        const viewModel = this._editor._getViewModel();\n        const viewLineNumber = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(line, 1)).lineNumber;\n        const lineRenderingData = viewModel.getViewLineRenderingData(viewLineNumber);\n        const layoutInfo = this._editor.getLayoutInfo();\n        const width = layoutInfo.width - layoutInfo.minimap.minimapCanvasOuterWidth - layoutInfo.verticalScrollbarWidth;\n        const minimapSide = this._editor.getOption(70 /* EditorOption.minimap */).side;\n        const lineHeight = this._editor.getOption(64 /* EditorOption.lineHeight */);\n        const lineNumberOption = this._editor.getOption(65 /* EditorOption.lineNumbers */);\n        let actualInlineDecorations;\n        try {\n            actualInlineDecorations = LineDecoration.filter(lineRenderingData.inlineDecorations, viewLineNumber, lineRenderingData.minColumn, lineRenderingData.maxColumn);\n        }\n        catch (err) {\n            actualInlineDecorations = [];\n        }\n        const renderLineInput = new RenderLineInput(true, true, lineRenderingData.content, lineRenderingData.continuesWithWrappedLine, lineRenderingData.isBasicASCII, lineRenderingData.containsRTL, 0, lineRenderingData.tokens, actualInlineDecorations, lineRenderingData.tabSize, lineRenderingData.startVisibleColumn, 1, 1, 1, 500, 'none', true, true, null);\n        const sb = new StringBuilder(2000);\n        renderViewLine(renderLineInput, sb);\n        let newLine;\n        if (_ttPolicy) {\n            newLine = _ttPolicy.createHTML(sb.build());\n        }\n        else {\n            newLine = sb.build();\n        }\n        const lineHTMLNode = document.createElement('span');\n        lineHTMLNode.className = 'sticky-line';\n        lineHTMLNode.classList.add(`stickyLine${line}`);\n        lineHTMLNode.style.lineHeight = `${lineHeight}px`;\n        lineHTMLNode.innerHTML = newLine;\n        const lineNumberHTMLNode = document.createElement('span');\n        lineNumberHTMLNode.className = 'sticky-line';\n        lineNumberHTMLNode.style.lineHeight = `${lineHeight}px`;\n        if (minimapSide === 'left') {\n            lineNumberHTMLNode.style.width = `${layoutInfo.contentLeft - layoutInfo.minimap.minimapCanvasOuterWidth}px`;\n        }\n        else if (minimapSide === 'right') {\n            lineNumberHTMLNode.style.width = `${layoutInfo.contentLeft}px`;\n        }\n        const innerLineNumberHTML = document.createElement('span');\n        if (lineNumberOption.renderType === 1 /* RenderLineNumbersType.On */ || lineNumberOption.renderType === 3 /* RenderLineNumbersType.Interval */ && line % 10 === 0) {\n            innerLineNumberHTML.innerText = line.toString();\n        }\n        else if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            innerLineNumberHTML.innerText = Math.abs(line - this._editor.getPosition().lineNumber).toString();\n        }\n        innerLineNumberHTML.className = 'sticky-line-number';\n        innerLineNumberHTML.style.lineHeight = `${lineHeight}px`;\n        innerLineNumberHTML.style.width = `${layoutInfo.lineNumbersWidth}px`;\n        if (minimapSide === 'left') {\n            innerLineNumberHTML.style.paddingLeft = `${layoutInfo.lineNumbersLeft - layoutInfo.minimap.minimapCanvasOuterWidth}px`;\n        }\n        else if (minimapSide === 'right') {\n            innerLineNumberHTML.style.paddingLeft = `${layoutInfo.lineNumbersLeft}px`;\n        }\n        lineNumberHTMLNode.appendChild(innerLineNumberHTML);\n        this._editor.applyFontInfo(lineHTMLNode);\n        this._editor.applyFontInfo(innerLineNumberHTML);\n        child.appendChild(lineNumberHTMLNode);\n        child.appendChild(lineHTMLNode);\n        child.className = 'sticky-line-root';\n        child.setAttribute('role', 'listitem');\n        child.tabIndex = 0;\n        child.style.lineHeight = `${lineHeight}px`;\n        child.style.width = `${width}px`;\n        child.style.height = `${lineHeight}px`;\n        child.style.zIndex = '0';\n        // Special case for the last line of sticky scroll\n        if (index === this._lineNumbers.length - 1) {\n            child.style.position = 'relative';\n            child.style.zIndex = '-1';\n            child.style.top = this._lastLineRelativePosition + 'px';\n        }\n        // Each child has a listener which fires when the mouse hovers over the child\n        this._disposableStore.add(dom.addDisposableListener(child, 'mouseover', (e) => {\n            if (this._editor.hasModel()) {\n                const mouseOverEvent = new StandardMouseEvent(e);\n                const text = mouseOverEvent.target.innerText;\n                // Line and column number of the hover needed for the control clicking feature\n                this._hoverOnLine = line;\n                // TODO: workaround to find the column index, perhaps need a more solid solution\n                this._hoverOnColumn = this._editor.getModel().getLineContent(line).indexOf(text) + 1 || -1;\n            }\n        }));\n        return child;\n    }\n    getId() {\n        return 'editor.contrib.stickyScrollWidget';\n    }\n    getDomNode() {\n        return this._rootDomNode;\n    }\n    getPosition() {\n        return {\n            preference: null\n        };\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class StickyRange {\n    constructor(startLineNumber, endLineNumber) {\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n    }\n}\nexport class StickyElement {\n    constructor(\n    /**\n     * Range of line numbers spanned by the current scope\n     */\n    range, \n    /**\n     * Must be sorted by start line number\n    */\n    children, \n    /**\n     * Parent sticky outline element\n     */\n    parent) {\n        this.range = range;\n        this.children = children;\n        this.parent = parent;\n    }\n}\nexport class StickyModel {\n    constructor(uri, version, element, outlineProviderId) {\n        this.uri = uri;\n        this.version = version;\n        this.element = element;\n        this.outlineProviderId = outlineProviderId;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { OutlineElement, OutlineGroup, OutlineModel } from '../../documentSymbols/browser/outlineModel.js';\nimport { createCancelablePromise, Delayer } from '../../../../base/common/async.js';\nimport { FoldingController, RangesLimitReporter } from '../../folding/browser/folding.js';\nimport { SyntaxRangeProvider } from '../../folding/browser/syntaxRangeProvider.js';\nimport { IndentRangeProvider } from '../../folding/browser/indentRangeProvider.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { StickyElement, StickyModel, StickyRange } from './stickyScrollElement.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nvar ModelProvider;\n(function (ModelProvider) {\n    ModelProvider[\"OUTLINE_MODEL\"] = \"outlineModel\";\n    ModelProvider[\"FOLDING_PROVIDER_MODEL\"] = \"foldingProviderModel\";\n    ModelProvider[\"INDENTATION_MODEL\"] = \"indentationModel\";\n})(ModelProvider || (ModelProvider = {}));\nvar Status;\n(function (Status) {\n    Status[Status[\"VALID\"] = 0] = \"VALID\";\n    Status[Status[\"INVALID\"] = 1] = \"INVALID\";\n    Status[Status[\"CANCELED\"] = 2] = \"CANCELED\";\n})(Status || (Status = {}));\nexport let StickyModelProvider = class StickyModelProvider {\n    constructor(_editor, _languageConfigurationService, _languageFeaturesService, defaultModel) {\n        this._editor = _editor;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._modelProviders = [];\n        this._modelPromise = null;\n        this._updateScheduler = new Delayer(300);\n        const stickyModelFromCandidateOutlineProvider = new StickyModelFromCandidateOutlineProvider(_languageFeaturesService);\n        const stickyModelFromSyntaxFoldingProvider = new StickyModelFromCandidateSyntaxFoldingProvider(this._editor, _languageFeaturesService);\n        const stickyModelFromIndentationFoldingProvider = new StickyModelFromCandidateIndentationFoldingProvider(this._editor, _languageConfigurationService);\n        switch (defaultModel) {\n            case ModelProvider.OUTLINE_MODEL:\n                this._modelProviders.push(stickyModelFromCandidateOutlineProvider);\n                this._modelProviders.push(stickyModelFromSyntaxFoldingProvider);\n                this._modelProviders.push(stickyModelFromIndentationFoldingProvider);\n                break;\n            case ModelProvider.FOLDING_PROVIDER_MODEL:\n                this._modelProviders.push(stickyModelFromSyntaxFoldingProvider);\n                this._modelProviders.push(stickyModelFromIndentationFoldingProvider);\n                break;\n            case ModelProvider.INDENTATION_MODEL:\n                this._modelProviders.push(stickyModelFromIndentationFoldingProvider);\n                break;\n        }\n        this._store = new DisposableStore();\n    }\n    _cancelModelPromise() {\n        if (this._modelPromise) {\n            this._modelPromise.cancel();\n            this._modelPromise = null;\n        }\n    }\n    update(textModel, textModelVersionId, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._store.clear();\n            this._store.add({\n                dispose: () => {\n                    var _a;\n                    this._cancelModelPromise();\n                    (_a = this._updateScheduler) === null || _a === void 0 ? void 0 : _a.cancel();\n                }\n            });\n            this._cancelModelPromise();\n            return yield this._updateScheduler.trigger(() => __awaiter(this, void 0, void 0, function* () {\n                for (const modelProvider of this._modelProviders) {\n                    const { statusPromise, modelPromise } = modelProvider.computeStickyModel(textModel, textModelVersionId, token);\n                    this._modelPromise = modelPromise;\n                    const status = yield statusPromise;\n                    if (this._modelPromise !== modelPromise) {\n                        return null;\n                    }\n                    switch (status) {\n                        case Status.CANCELED:\n                            this._store.clear();\n                            return null;\n                        case Status.VALID:\n                            return modelProvider.stickyModel;\n                    }\n                }\n                return null;\n            }));\n        });\n    }\n};\nStickyModelProvider = __decorate([\n    __param(1, ILanguageConfigurationService),\n    __param(2, ILanguageFeaturesService)\n], StickyModelProvider);\nclass StickyModelCandidateProvider {\n    constructor() {\n        this._stickyModel = null;\n    }\n    get stickyModel() {\n        return this._stickyModel;\n    }\n    _invalid() {\n        this._stickyModel = null;\n        return Status.INVALID;\n    }\n    computeStickyModel(textModel, modelVersionId, token) {\n        if (token.isCancellationRequested || !this.isProviderValid(textModel)) {\n            return { statusPromise: this._invalid(), modelPromise: null };\n        }\n        const providerModelPromise = createCancelablePromise(token => this.createModelFromProvider(textModel, modelVersionId, token));\n        return {\n            statusPromise: providerModelPromise.then(providerModel => {\n                if (!this.isModelValid(providerModel)) {\n                    return this._invalid();\n                }\n                if (token.isCancellationRequested) {\n                    return Status.CANCELED;\n                }\n                this._stickyModel = this.createStickyModel(textModel, modelVersionId, token, providerModel);\n                return Status.VALID;\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return Status.CANCELED;\n            }),\n            modelPromise: providerModelPromise\n        };\n    }\n    /**\n     * Method which checks whether the model returned by the provider is valid and can be used to compute a sticky model.\n     * This method by default returns true.\n     * @param model model returned by the provider\n     * @returns boolean indicating whether the model is valid\n     */\n    isModelValid(model) {\n        return true;\n    }\n    /**\n     * Method which checks whether the provider is valid before applying it to find the provider model.\n     * This method by default returns true.\n     * @param textModel text-model of the editor\n     * @returns boolean indicating whether the provider is valid\n     */\n    isProviderValid(textModel) {\n        return true;\n    }\n}\nlet StickyModelFromCandidateOutlineProvider = class StickyModelFromCandidateOutlineProvider extends StickyModelCandidateProvider {\n    constructor(_languageFeaturesService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n    }\n    createModelFromProvider(textModel, modelVersionId, token) {\n        return OutlineModel.create(this._languageFeaturesService.documentSymbolProvider, textModel, token);\n    }\n    createStickyModel(textModel, modelVersionId, token, model) {\n        var _a;\n        const { stickyOutlineElement, providerID } = this._stickyModelFromOutlineModel(model, (_a = this._stickyModel) === null || _a === void 0 ? void 0 : _a.outlineProviderId);\n        return new StickyModel(textModel.uri, modelVersionId, stickyOutlineElement, providerID);\n    }\n    isModelValid(model) {\n        return model && model.children.size > 0;\n    }\n    _stickyModelFromOutlineModel(outlineModel, preferredProvider) {\n        let outlineElements;\n        // When several possible outline providers\n        if (Iterable.first(outlineModel.children.values()) instanceof OutlineGroup) {\n            const provider = Iterable.find(outlineModel.children.values(), outlineGroupOfModel => outlineGroupOfModel.id === preferredProvider);\n            if (provider) {\n                outlineElements = provider.children;\n            }\n            else {\n                let tempID = '';\n                let maxTotalSumOfRanges = -1;\n                let optimalOutlineGroup = undefined;\n                for (const [_key, outlineGroup] of outlineModel.children.entries()) {\n                    const totalSumRanges = this._findSumOfRangesOfGroup(outlineGroup);\n                    if (totalSumRanges > maxTotalSumOfRanges) {\n                        optimalOutlineGroup = outlineGroup;\n                        maxTotalSumOfRanges = totalSumRanges;\n                        tempID = outlineGroup.id;\n                    }\n                }\n                preferredProvider = tempID;\n                outlineElements = optimalOutlineGroup.children;\n            }\n        }\n        else {\n            outlineElements = outlineModel.children;\n        }\n        const stickyChildren = [];\n        const outlineElementsArray = Array.from(outlineElements.values()).sort((element1, element2) => {\n            const range1 = new StickyRange(element1.symbol.range.startLineNumber, element1.symbol.range.endLineNumber);\n            const range2 = new StickyRange(element2.symbol.range.startLineNumber, element2.symbol.range.endLineNumber);\n            return this._comparator(range1, range2);\n        });\n        for (const outlineElement of outlineElementsArray) {\n            stickyChildren.push(this._stickyModelFromOutlineElement(outlineElement, outlineElement.symbol.selectionRange.startLineNumber));\n        }\n        const stickyOutlineElement = new StickyElement(undefined, stickyChildren, undefined);\n        return {\n            stickyOutlineElement: stickyOutlineElement,\n            providerID: preferredProvider\n        };\n    }\n    _stickyModelFromOutlineElement(outlineElement, previousStartLine) {\n        const children = [];\n        for (const child of outlineElement.children.values()) {\n            if (child.symbol.selectionRange.startLineNumber !== child.symbol.range.endLineNumber) {\n                if (child.symbol.selectionRange.startLineNumber !== previousStartLine) {\n                    children.push(this._stickyModelFromOutlineElement(child, child.symbol.selectionRange.startLineNumber));\n                }\n                else {\n                    for (const subchild of child.children.values()) {\n                        children.push(this._stickyModelFromOutlineElement(subchild, child.symbol.selectionRange.startLineNumber));\n                    }\n                }\n            }\n        }\n        children.sort((child1, child2) => this._comparator(child1.range, child2.range));\n        const range = new StickyRange(outlineElement.symbol.selectionRange.startLineNumber, outlineElement.symbol.range.endLineNumber);\n        return new StickyElement(range, children, undefined);\n    }\n    _comparator(range1, range2) {\n        if (range1.startLineNumber !== range2.startLineNumber) {\n            return range1.startLineNumber - range2.startLineNumber;\n        }\n        else {\n            return range2.endLineNumber - range1.endLineNumber;\n        }\n    }\n    _findSumOfRangesOfGroup(outline) {\n        let res = 0;\n        for (const child of outline.children.values()) {\n            res += this._findSumOfRangesOfGroup(child);\n        }\n        if (outline instanceof OutlineElement) {\n            return res + outline.symbol.range.endLineNumber - outline.symbol.selectionRange.startLineNumber;\n        }\n        else {\n            return res;\n        }\n    }\n};\nStickyModelFromCandidateOutlineProvider = __decorate([\n    __param(0, ILanguageFeaturesService)\n], StickyModelFromCandidateOutlineProvider);\nclass StickyModelFromCandidateFoldingProvider extends StickyModelCandidateProvider {\n    constructor(editor) {\n        super();\n        this._foldingLimitReporter = new RangesLimitReporter(editor);\n    }\n    createStickyModel(textModel, modelVersionId, token, model) {\n        const foldingElement = this._fromFoldingRegions(model);\n        return new StickyModel(textModel.uri, modelVersionId, foldingElement, undefined);\n    }\n    isModelValid(model) {\n        return model !== null;\n    }\n    _fromFoldingRegions(foldingRegions) {\n        const length = foldingRegions.length;\n        const orderedStickyElements = [];\n        // The root sticky outline element\n        const stickyOutlineElement = new StickyElement(undefined, [], undefined);\n        for (let i = 0; i < length; i++) {\n            // Finding the parent index of the current range\n            const parentIndex = foldingRegions.getParentIndex(i);\n            let parentNode;\n            if (parentIndex !== -1) {\n                // Access the reference of the parent node\n                parentNode = orderedStickyElements[parentIndex];\n            }\n            else {\n                // In that case the parent node is the root node\n                parentNode = stickyOutlineElement;\n            }\n            const child = new StickyElement(new StickyRange(foldingRegions.getStartLineNumber(i), foldingRegions.getEndLineNumber(i) + 1), [], parentNode);\n            parentNode.children.push(child);\n            orderedStickyElements.push(child);\n        }\n        return stickyOutlineElement;\n    }\n}\nlet StickyModelFromCandidateIndentationFoldingProvider = class StickyModelFromCandidateIndentationFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n    constructor(editor, _languageConfigurationService) {\n        super(editor);\n        this._languageConfigurationService = _languageConfigurationService;\n    }\n    createModelFromProvider(textModel, modelVersionId, token) {\n        const provider = new IndentRangeProvider(textModel, this._languageConfigurationService, this._foldingLimitReporter);\n        return provider.compute(token);\n    }\n};\nStickyModelFromCandidateIndentationFoldingProvider = __decorate([\n    __param(1, ILanguageConfigurationService)\n], StickyModelFromCandidateIndentationFoldingProvider);\nlet StickyModelFromCandidateSyntaxFoldingProvider = class StickyModelFromCandidateSyntaxFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n    constructor(editor, _languageFeaturesService) {\n        super(editor);\n        this._languageFeaturesService = _languageFeaturesService;\n    }\n    isProviderValid(textModel) {\n        const selectedProviders = FoldingController.getFoldingRangeProviders(this._languageFeaturesService, textModel);\n        return selectedProviders.length > 0;\n    }\n    createModelFromProvider(textModel, modelVersionId, token) {\n        const selectedProviders = FoldingController.getFoldingRangeProviders(this._languageFeaturesService, textModel);\n        const provider = new SyntaxRangeProvider(textModel, selectedProviders, () => this.createModelFromProvider(textModel, modelVersionId, token), this._foldingLimitReporter, undefined);\n        return provider.compute(token);\n    }\n};\nStickyModelFromCandidateSyntaxFoldingProvider = __decorate([\n    __param(1, ILanguageFeaturesService)\n], StickyModelFromCandidateSyntaxFoldingProvider);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { StickyModelProvider } from './stickyScrollModelProvider.js';\nimport { StickyModel } from './stickyScrollElement.js';\nexport class StickyLineCandidate {\n    constructor(startLineNumber, endLineNumber, nestingDepth) {\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n        this.nestingDepth = nestingDepth;\n    }\n}\nexport let StickyLineCandidateProvider = class StickyLineCandidateProvider extends Disposable {\n    constructor(editor, _languageFeaturesService, _languageConfigurationService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._onDidChangeStickyScroll = this._store.add(new Emitter());\n        this.onDidChangeStickyScroll = this._onDidChangeStickyScroll.event;\n        this._options = null;\n        this._model = null;\n        this._cts = null;\n        this._stickyModelProvider = null;\n        this._editor = editor;\n        this._sessionStore = new DisposableStore();\n        this._updateSoon = this._register(new RunOnceScheduler(() => this.update(), 50));\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(111 /* EditorOption.stickyScroll */)) {\n                this.readConfiguration();\n            }\n        }));\n        this.readConfiguration();\n    }\n    dispose() {\n        super.dispose();\n        this._sessionStore.dispose();\n    }\n    readConfiguration() {\n        this._options = this._editor.getOption(111 /* EditorOption.stickyScroll */);\n        if (!this._options.enabled) {\n            this._sessionStore.clear();\n            return;\n        }\n        this._stickyModelProvider = new StickyModelProvider(this._editor, this._languageConfigurationService, this._languageFeaturesService, this._options.defaultModel);\n        this._sessionStore.add(this._editor.onDidChangeModel(() => this.update()));\n        this._sessionStore.add(this._editor.onDidChangeHiddenAreas(() => this.update()));\n        this._sessionStore.add(this._editor.onDidChangeModelContent(() => this._updateSoon.schedule()));\n        this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => this.update()));\n        this.update();\n    }\n    getVersionId() {\n        var _a;\n        return (_a = this._model) === null || _a === void 0 ? void 0 : _a.version;\n    }\n    update() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            (_a = this._cts) === null || _a === void 0 ? void 0 : _a.dispose(true);\n            this._cts = new CancellationTokenSource();\n            yield this.updateStickyModel(this._cts.token);\n            this._onDidChangeStickyScroll.fire();\n        });\n    }\n    updateStickyModel(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._stickyModelProvider) {\n                return;\n            }\n            const textModel = this._editor.getModel();\n            const modelVersionId = textModel.getVersionId();\n            const isDifferentModel = this._model ? !isEqual(this._model.uri, textModel.uri) : false;\n            // Clear sticky scroll to not show stale data for too long\n            const resetHandle = isDifferentModel ? setTimeout(() => {\n                if (!token.isCancellationRequested) {\n                    this._model = new StickyModel(textModel.uri, textModel.getVersionId(), undefined, undefined);\n                    this._onDidChangeStickyScroll.fire();\n                }\n            }, 75) : undefined;\n            this._model = yield this._stickyModelProvider.update(textModel, modelVersionId, token);\n            clearTimeout(resetHandle);\n        });\n    }\n    updateIndex(index) {\n        if (index === -1) {\n            index = 0;\n        }\n        else if (index < 0) {\n            index = -index - 2;\n        }\n        return index;\n    }\n    getCandidateStickyLinesIntersectingFromStickyModel(range, outlineModel, result, depth, lastStartLineNumber) {\n        if (outlineModel.children.length === 0) {\n            return;\n        }\n        let lastLine = lastStartLineNumber;\n        const childrenStartLines = [];\n        for (let i = 0; i < outlineModel.children.length; i++) {\n            const child = outlineModel.children[i];\n            if (child.range) {\n                childrenStartLines.push(child.range.startLineNumber);\n            }\n        }\n        const lowerBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber, (a, b) => { return a - b; }));\n        const upperBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber + depth, (a, b) => { return a - b; }));\n        for (let i = lowerBound; i <= upperBound; i++) {\n            const child = outlineModel.children[i];\n            if (!child) {\n                return;\n            }\n            if (child.range) {\n                const childStartLine = child.range.startLineNumber;\n                const childEndLine = child.range.endLineNumber;\n                if (range.startLineNumber <= childEndLine + 1 && childStartLine - 1 <= range.endLineNumber && childStartLine !== lastLine) {\n                    lastLine = childStartLine;\n                    result.push(new StickyLineCandidate(childStartLine, childEndLine - 1, depth + 1));\n                    this.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth + 1, childStartLine);\n                }\n            }\n            else {\n                this.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth, lastStartLineNumber);\n            }\n        }\n    }\n    getCandidateStickyLinesIntersecting(range) {\n        var _a, _b;\n        if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.element)) {\n            return [];\n        }\n        let stickyLineCandidates = [];\n        this.getCandidateStickyLinesIntersectingFromStickyModel(range, this._model.element, stickyLineCandidates, 0, -1);\n        const hiddenRanges = (_b = this._editor._getViewModel()) === null || _b === void 0 ? void 0 : _b.getHiddenAreas();\n        if (hiddenRanges) {\n            for (const hiddenRange of hiddenRanges) {\n                stickyLineCandidates = stickyLineCandidates.filter(stickyLine => !(stickyLine.startLineNumber >= hiddenRange.startLineNumber && stickyLine.endLineNumber <= hiddenRange.endLineNumber + 1));\n            }\n        }\n        return stickyLineCandidates;\n    }\n};\nStickyLineCandidateProvider = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageConfigurationService)\n], StickyLineCandidateProvider);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nexport let StickyScrollController = class StickyScrollController extends Disposable {\n    constructor(_editor, _contextMenuService, _languageFeaturesService, _instaService, _languageConfigurationService, _languageFeatureDebounceService, _contextKeyService) {\n        super();\n        this._editor = _editor;\n        this._contextMenuService = _contextMenuService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instaService = _instaService;\n        this._contextKeyService = _contextKeyService;\n        this._sessionStore = new DisposableStore();\n        this._maxStickyLines = Number.MAX_SAFE_INTEGER;\n        this._candidateDefinitionsLength = -1;\n        this._focusedStickyElementIndex = -1;\n        this._enabled = false;\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n        this._stickyScrollWidget = new StickyScrollWidget(this._editor);\n        this._stickyLineCandidateProvider = new StickyLineCandidateProvider(this._editor, _languageFeaturesService, _languageConfigurationService);\n        this._register(this._stickyScrollWidget);\n        this._register(this._stickyLineCandidateProvider);\n        this._widgetState = new StickyScrollWidgetState([], 0);\n        this._readConfiguration();\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(111 /* EditorOption.stickyScroll */)) {\n                this._readConfiguration();\n            }\n        }));\n        this._register(dom.addDisposableListener(this._stickyScrollWidget.getDomNode(), dom.EventType.CONTEXT_MENU, (event) => __awaiter(this, void 0, void 0, function* () {\n            this._onContextMenu(event);\n        })));\n        this._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService);\n        this._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);\n        const focusTracker = this._register(dom.trackFocus(this._stickyScrollWidget.getDomNode()));\n        this._register(focusTracker.onDidBlur(_ => {\n            const height = this._stickyScrollWidget.getDomNode().clientHeight;\n            // Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n            // This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n            if (this._positionRevealed === false && height === 0) {\n                this._focusedStickyElementIndex = -1;\n                this.focus();\n            }\n            // In all other casees, dispose the focus on the sticky scroll\n            else {\n                this._disposeFocusStickyScrollStore();\n            }\n        }));\n        this._register(focusTracker.onDidFocus(_ => {\n            this.focus();\n        }));\n        this._register(this._createClickLinkGesture());\n        // Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n        this._register(dom.addDisposableListener(this._stickyScrollWidget.getDomNode(), dom.EventType.MOUSE_DOWN, (e) => {\n            this._onMouseDown = true;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(StickyScrollController.ID);\n    }\n    _disposeFocusStickyScrollStore() {\n        var _a;\n        this._stickyScrollFocusedContextKey.set(false);\n        (_a = this._focusDisposableStore) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n    }\n    focus() {\n        // If the mouse is down, do not focus on the sticky scroll\n        if (this._onMouseDown) {\n            this._onMouseDown = false;\n            this._editor.focus();\n            return;\n        }\n        const focusState = this._stickyScrollFocusedContextKey.get();\n        if (focusState === true) {\n            return;\n        }\n        this._focused = true;\n        this._focusDisposableStore = new DisposableStore();\n        this._stickyScrollFocusedContextKey.set(true);\n        const rootNode = this._stickyScrollWidget.getDomNode();\n        rootNode.lastElementChild.focus();\n        this._stickyElements = rootNode.children;\n        this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n    }\n    focusNext() {\n        if (this._focusedStickyElementIndex < this._stickyElements.length - 1) {\n            this._focusNav(true);\n        }\n    }\n    focusPrevious() {\n        if (this._focusedStickyElementIndex > 0) {\n            this._focusNav(false);\n        }\n    }\n    selectEditor() {\n        this._editor.focus();\n    }\n    // True is next, false is previous\n    _focusNav(direction) {\n        this._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n        this._stickyElements.item(this._focusedStickyElementIndex).focus();\n    }\n    goToFocused() {\n        const lineNumbers = this._stickyScrollWidget.lineNumbers;\n        this._disposeFocusStickyScrollStore();\n        this._revealPosition({ lineNumber: lineNumbers[this._focusedStickyElementIndex], column: 1 });\n    }\n    _revealPosition(position) {\n        this._positionRevealed = true;\n        this._editor.revealPosition(position);\n        this._editor.setSelection(Range.fromPositions(position));\n        this._editor.focus();\n    }\n    _createClickLinkGesture() {\n        const linkGestureStore = new DisposableStore();\n        const sessionStore = new DisposableStore();\n        linkGestureStore.add(sessionStore);\n        const gesture = new ClickLinkGesture(this._editor, true);\n        linkGestureStore.add(gesture);\n        linkGestureStore.add(gesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, _keyboardEvent]) => {\n            if (!this._editor.hasModel() || !mouseEvent.hasTriggerModifier) {\n                sessionStore.clear();\n                return;\n            }\n            const targetMouseEvent = mouseEvent.target;\n            if (targetMouseEvent.detail === this._stickyScrollWidget.getId()\n                && targetMouseEvent.element.innerText === targetMouseEvent.element.innerHTML) {\n                const text = targetMouseEvent.element.innerText;\n                if (this._stickyScrollWidget.hoverOnColumn === -1) {\n                    return;\n                }\n                const lineNumber = this._stickyScrollWidget.hoverOnLine;\n                const column = this._stickyScrollWidget.hoverOnColumn;\n                const stickyPositionProjectedOnEditor = new Range(lineNumber, column, lineNumber, column + text.length);\n                if (!stickyPositionProjectedOnEditor.equalsRange(this._stickyRangeProjectedOnEditor)) {\n                    this._stickyRangeProjectedOnEditor = stickyPositionProjectedOnEditor;\n                    sessionStore.clear();\n                }\n                else if (targetMouseEvent.element.style.textDecoration === 'underline') {\n                    return;\n                }\n                const cancellationToken = new CancellationTokenSource();\n                sessionStore.add(toDisposable(() => cancellationToken.dispose(true)));\n                let currentHTMLChild;\n                getDefinitionsAtPosition(this._languageFeaturesService.definitionProvider, this._editor.getModel(), new Position(lineNumber, column + 1), cancellationToken.token).then((candidateDefinitions => {\n                    if (cancellationToken.token.isCancellationRequested) {\n                        return;\n                    }\n                    if (candidateDefinitions.length !== 0) {\n                        this._candidateDefinitionsLength = candidateDefinitions.length;\n                        const childHTML = targetMouseEvent.element;\n                        if (currentHTMLChild !== childHTML) {\n                            sessionStore.clear();\n                            currentHTMLChild = childHTML;\n                            currentHTMLChild.style.textDecoration = 'underline';\n                            sessionStore.add(toDisposable(() => {\n                                currentHTMLChild.style.textDecoration = 'none';\n                            }));\n                        }\n                        else if (!currentHTMLChild) {\n                            currentHTMLChild = childHTML;\n                            currentHTMLChild.style.textDecoration = 'underline';\n                            sessionStore.add(toDisposable(() => {\n                                currentHTMLChild.style.textDecoration = 'none';\n                            }));\n                        }\n                    }\n                    else {\n                        sessionStore.clear();\n                    }\n                }));\n            }\n            else {\n                sessionStore.clear();\n            }\n        }));\n        linkGestureStore.add(gesture.onCancel(() => {\n            sessionStore.clear();\n        }));\n        linkGestureStore.add(gesture.onExecute((e) => __awaiter(this, void 0, void 0, function* () {\n            if (e.target.detail !== this._stickyScrollWidget.getId()) {\n                return;\n            }\n            if (e.hasTriggerModifier) {\n                // Control click\n                if (this._candidateDefinitionsLength > 1) {\n                    if (this._focused) {\n                        this._disposeFocusStickyScrollStore();\n                    }\n                    this._revealPosition({ lineNumber: this._stickyScrollWidget.hoverOnLine, column: 1 });\n                }\n                this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, { uri: this._editor.getModel().uri, range: this._stickyRangeProjectedOnEditor });\n            }\n            else if (!e.isRightClick) {\n                // Normal click\n                if (this._focused) {\n                    this._disposeFocusStickyScrollStore();\n                }\n                this._revealPosition({ lineNumber: this._stickyScrollWidget.hoverOnLine, column: this._stickyScrollWidget.hoverOnColumn });\n            }\n        })));\n        return linkGestureStore;\n    }\n    _onContextMenu(event) {\n        this._contextMenuService.showContextMenu({\n            menuId: MenuId.StickyScrollContext,\n            getAnchor: () => event,\n        });\n    }\n    _readConfiguration() {\n        const options = this._editor.getOption(111 /* EditorOption.stickyScroll */);\n        if (options.enabled === false) {\n            this._editor.removeOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.clear();\n            this._enabled = false;\n            return;\n        }\n        else if (options.enabled && !this._enabled) {\n            // When sticky scroll was just enabled, add the listeners on the sticky scroll\n            this._editor.addOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.add(this._editor.onDidScrollChange(() => this._renderStickyScroll()));\n            this._sessionStore.add(this._editor.onDidLayoutChange(() => this._onDidResize()));\n            this._sessionStore.add(this._editor.onDidChangeModelTokens((e) => this._onTokensChange(e)));\n            this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(() => this._renderStickyScroll()));\n            this._enabled = true;\n        }\n        const lineNumberOption = this._editor.getOption(65 /* EditorOption.lineNumbers */);\n        if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            this._sessionStore.add(this._editor.onDidChangeCursorPosition(() => this._renderStickyScroll()));\n        }\n    }\n    _needsUpdate(event) {\n        const stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n        for (const stickyLineNumber of stickyLineNumbers) {\n            for (const range of event.ranges) {\n                if (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    _onTokensChange(event) {\n        if (this._needsUpdate(event)) {\n            this._renderStickyScroll();\n        }\n    }\n    _onDidResize() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        const width = layoutInfo.width - layoutInfo.minimap.minimapCanvasOuterWidth - layoutInfo.verticalScrollbarWidth;\n        this._stickyScrollWidget.getDomNode().style.width = `${width}px`;\n        // Make sure sticky scroll doesn't take up more than 25% of the editor\n        const theoreticalLines = layoutInfo.height / this._editor.getOption(64 /* EditorOption.lineHeight */);\n        this._maxStickyLines = Math.round(theoreticalLines * .25);\n    }\n    _renderStickyScroll() {\n        if (!(this._editor.hasModel())) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const stickyLineVersion = this._stickyLineCandidateProvider.getVersionId();\n        if (stickyLineVersion === undefined || stickyLineVersion === model.getVersionId()) {\n            this._widgetState = this.findScrollWidgetState();\n            this._stickyScrollVisibleContextKey.set(!(this._widgetState.lineNumbers.length === 0));\n            if (!this._focused) {\n                this._stickyScrollWidget.setState(this._widgetState);\n            }\n            else {\n                this._stickyElements = this._stickyScrollWidget.getDomNode().children;\n                // Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n                if (this._focusedStickyElementIndex === -1) {\n                    this._stickyScrollWidget.setState(this._widgetState);\n                    this._focusedStickyElementIndex = this._stickyElements.length - 1;\n                    if (this._focusedStickyElementIndex !== -1) {\n                        this._stickyElements.item(this._focusedStickyElementIndex).focus();\n                    }\n                }\n                else {\n                    const focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n                    this._stickyScrollWidget.setState(this._widgetState);\n                    // Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n                    if (this._stickyElements.length === 0) {\n                        this._focusedStickyElementIndex = -1;\n                    }\n                    else {\n                        const previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber);\n                        // If the line number is still there, do not change anything\n                        // If the line number is not there, set the new focused line to be the last line\n                        if (!previousFocusedLineNumberExists) {\n                            this._focusedStickyElementIndex = this._stickyElements.length - 1;\n                        }\n                        this._stickyElements.item(this._focusedStickyElementIndex).focus();\n                    }\n                }\n            }\n        }\n    }\n    findScrollWidgetState() {\n        const lineHeight = this._editor.getOption(64 /* EditorOption.lineHeight */);\n        const maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(111 /* EditorOption.stickyScroll */).maxLineCount);\n        const scrollTop = this._editor.getScrollTop();\n        let lastLineRelativePosition = 0;\n        const lineNumbers = [];\n        const arrayVisibleRanges = this._editor.getVisibleRanges();\n        if (arrayVisibleRanges.length !== 0) {\n            const fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n            const candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n            for (const range of candidateRanges) {\n                const start = range.startLineNumber;\n                const end = range.endLineNumber;\n                const depth = range.nestingDepth;\n                if (end - start > 0) {\n                    const topOfElementAtDepth = (depth - 1) * lineHeight;\n                    const bottomOfElementAtDepth = depth * lineHeight;\n                    const bottomOfBeginningLine = this._editor.getBottomForLineNumber(start) - scrollTop;\n                    const topOfEndLine = this._editor.getTopForLineNumber(end) - scrollTop;\n                    const bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n                    if (topOfElementAtDepth > topOfEndLine && topOfElementAtDepth <= bottomOfEndLine) {\n                        lineNumbers.push(start);\n                        lastLineRelativePosition = bottomOfEndLine - bottomOfElementAtDepth;\n                        break;\n                    }\n                    else if (bottomOfElementAtDepth > bottomOfBeginningLine && bottomOfElementAtDepth <= bottomOfEndLine) {\n                        lineNumbers.push(start);\n                    }\n                    if (lineNumbers.length === maxNumberStickyLines) {\n                        break;\n                    }\n                }\n            }\n        }\n        return new StickyScrollWidgetState(lineNumbers, lastLineRelativePosition);\n    }\n    dispose() {\n        super.dispose();\n        this._sessionStore.dispose();\n    }\n};\nStickyScrollController.ID = 'store.contrib.stickyScrollController';\nStickyScrollController = __decorate([\n    __param(1, IContextMenuService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IInstantiationService),\n    __param(4, ILanguageConfigurationService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, IContextKeyService)\n], StickyScrollController);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { localize } from '../../../../nls.js';\nimport { Categories } from '../../../../platform/action/common/actionCommonCategories.js';\nimport { Action2, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nexport class ToggleStickyScroll extends Action2 {\n    constructor() {\n        super({\n            id: 'editor.action.toggleStickyScroll',\n            title: {\n                value: localize('toggleStickyScroll', \"Toggle Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'mitoggleStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Sticky Scroll\"),\n                original: 'Toggle Sticky Scroll',\n            },\n            category: Categories.View,\n            toggled: {\n                condition: ContextKeyExpr.equals('config.editor.stickyScroll.enabled', true),\n                title: localize('stickyScroll', \"Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'miStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Sticky Scroll\"),\n            },\n            menu: [\n                { id: MenuId.CommandPalette },\n                { id: MenuId.MenubarViewMenu, group: '5_editor', order: 2 },\n                { id: MenuId.StickyScrollContext }\n            ]\n        });\n    }\n    run(accessor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const configurationService = accessor.get(IConfigurationService);\n            const newValue = !configurationService.getValue('editor.stickyScroll.enabled');\n            return configurationService.updateValue('editor.stickyScroll.enabled', newValue);\n        });\n    }\n}\nconst weight = 100 /* KeybindingWeight.EditorContrib */;\nexport class FocusStickyScroll extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.focusStickyScroll',\n            title: {\n                value: localize('focusStickyScroll', \"Focus Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'mifocusStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Focus Sticky Scroll\"),\n                original: 'Focus Sticky Scroll',\n            },\n            precondition: ContextKeyExpr.and(ContextKeyExpr.has('config.editor.stickyScroll.enabled'), EditorContextKeys.stickyScrollVisible),\n            menu: [\n                { id: MenuId.CommandPalette },\n            ]\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n}\nexport class SelectNextStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectNextStickyScrollLine',\n            title: {\n                value: localize('selectNextStickyScrollLine.title', \"Select next sticky scroll line\"),\n                original: 'Select next sticky scroll line'\n            },\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 18 /* KeyCode.DownArrow */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.focusNext();\n    }\n}\nexport class SelectPreviousStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectPreviousStickyScrollLine',\n            title: {\n                value: localize('selectPreviousStickyScrollLine.title', \"Select previous sticky scroll line\"),\n                original: 'Select previous sticky scroll line'\n            },\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 16 /* KeyCode.UpArrow */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.focusPrevious();\n    }\n}\nexport class GoToStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.goToFocusedStickyScrollLine',\n            title: {\n                value: localize('goToFocusedStickyScrollLine.title', \"Go to focused sticky scroll line\"),\n                original: 'Go to focused sticky scroll line'\n            },\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 3 /* KeyCode.Enter */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.goToFocused();\n    }\n}\nexport class SelectEditor extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectEditor',\n            title: {\n                value: localize('selectEditor.title', \"Select Editor\"),\n                original: 'Select Editor'\n            },\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 9 /* KeyCode.Escape */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.selectEditor();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ToggleStickyScroll, FocusStickyScroll, SelectEditor, SelectPreviousStickyScrollLine, SelectNextStickyScrollLine, GoToStickyScrollLine } from './stickyScrollActions.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nimport { registerAction2 } from '../../../../platform/actions/common/actions.js';\nregisterEditorContribution(StickyScrollController.ID, StickyScrollController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterAction2(ToggleStickyScroll);\nregisterAction2(FocusStickyScroll);\nregisterAction2(SelectPreviousStickyScrollLine);\nregisterAction2(SelectNextStickyScrollLine);\nregisterAction2(GoToStickyScrollLine);\nregisterAction2(SelectEditor);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { quickSelect } from '../../../../base/common/arrays.js';\nimport { anyScore, fuzzyScore, FuzzyScore, fuzzyScoreGracefulAggressive, FuzzyScoreOptions } from '../../../../base/common/filters.js';\nimport { compareIgnoreCase } from '../../../../base/common/strings.js';\nexport class LineContext {\n    constructor(leadingLineContent, characterCountDelta) {\n        this.leadingLineContent = leadingLineContent;\n        this.characterCountDelta = characterCountDelta;\n    }\n}\n/**\n * Sorted, filtered completion view model\n * */\nexport class CompletionModel {\n    constructor(items, column, lineContext, wordDistance, options, snippetSuggestions, fuzzyScoreOptions = FuzzyScoreOptions.default, clipboardText = undefined) {\n        this.clipboardText = clipboardText;\n        this._snippetCompareFn = CompletionModel._compareCompletionItems;\n        this._items = items;\n        this._column = column;\n        this._wordDistance = wordDistance;\n        this._options = options;\n        this._refilterKind = 1 /* Refilter.All */;\n        this._lineContext = lineContext;\n        this._fuzzyScoreOptions = fuzzyScoreOptions;\n        if (snippetSuggestions === 'top') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsUp;\n        }\n        else if (snippetSuggestions === 'bottom') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsDown;\n        }\n    }\n    get lineContext() {\n        return this._lineContext;\n    }\n    set lineContext(value) {\n        if (this._lineContext.leadingLineContent !== value.leadingLineContent\n            || this._lineContext.characterCountDelta !== value.characterCountDelta) {\n            this._refilterKind = this._lineContext.characterCountDelta < value.characterCountDelta && this._filteredItems ? 2 /* Refilter.Incr */ : 1 /* Refilter.All */;\n            this._lineContext = value;\n        }\n    }\n    get items() {\n        this._ensureCachedState();\n        return this._filteredItems;\n    }\n    getItemsByProvider() {\n        this._ensureCachedState();\n        return this._itemsByProvider;\n    }\n    getIncompleteProvider() {\n        this._ensureCachedState();\n        const result = new Set();\n        for (const [provider, items] of this.getItemsByProvider()) {\n            if (items.length > 0 && items[0].container.incomplete) {\n                result.add(provider);\n            }\n        }\n        return result;\n    }\n    get stats() {\n        this._ensureCachedState();\n        return this._stats;\n    }\n    _ensureCachedState() {\n        if (this._refilterKind !== 0 /* Refilter.Nothing */) {\n            this._createCachedState();\n        }\n    }\n    _createCachedState() {\n        this._itemsByProvider = new Map();\n        const labelLengths = [];\n        const { leadingLineContent, characterCountDelta } = this._lineContext;\n        let word = '';\n        let wordLow = '';\n        // incrementally filter less\n        const source = this._refilterKind === 1 /* Refilter.All */ ? this._items : this._filteredItems;\n        const target = [];\n        // picks a score function based on the number of\n        // items that we have to score/filter and based on the\n        // user-configuration\n        const scoreFn = (!this._options.filterGraceful || source.length > 2000) ? fuzzyScore : fuzzyScoreGracefulAggressive;\n        for (let i = 0; i < source.length; i++) {\n            const item = source[i];\n            if (item.isInvalid) {\n                continue; // SKIP invalid items\n            }\n            // keep all items by their provider\n            const arr = this._itemsByProvider.get(item.provider);\n            if (arr) {\n                arr.push(item);\n            }\n            else {\n                this._itemsByProvider.set(item.provider, [item]);\n            }\n            // 'word' is that remainder of the current line that we\n            // filter and score against. In theory each suggestion uses a\n            // different word, but in practice not - that's why we cache\n            const overwriteBefore = item.position.column - item.editStart.column;\n            const wordLen = overwriteBefore + characterCountDelta - (item.position.column - this._column);\n            if (word.length !== wordLen) {\n                word = wordLen === 0 ? '' : leadingLineContent.slice(-wordLen);\n                wordLow = word.toLowerCase();\n            }\n            // remember the word against which this item was\n            // scored\n            item.word = word;\n            if (wordLen === 0) {\n                // when there is nothing to score against, don't\n                // event try to do. Use a const rank and rely on\n                // the fallback-sort using the initial sort order.\n                // use a score of `-100` because that is out of the\n                // bound of values `fuzzyScore` will return\n                item.score = FuzzyScore.Default;\n            }\n            else {\n                // skip word characters that are whitespace until\n                // we have hit the replace range (overwriteBefore)\n                let wordPos = 0;\n                while (wordPos < overwriteBefore) {\n                    const ch = word.charCodeAt(wordPos);\n                    if (ch === 32 /* CharCode.Space */ || ch === 9 /* CharCode.Tab */) {\n                        wordPos += 1;\n                    }\n                    else {\n                        break;\n                    }\n                }\n                if (wordPos >= wordLen) {\n                    // the wordPos at which scoring starts is the whole word\n                    // and therefore the same rules as not having a word apply\n                    item.score = FuzzyScore.Default;\n                }\n                else if (typeof item.completion.filterText === 'string') {\n                    // when there is a `filterText` it must match the `word`.\n                    // if it matches we check with the label to compute highlights\n                    // and if that doesn't yield a result we have no highlights,\n                    // despite having the match\n                    const match = scoreFn(word, wordLow, wordPos, item.completion.filterText, item.filterTextLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    if (compareIgnoreCase(item.completion.filterText, item.textLabel) === 0) {\n                        // filterText and label are actually the same -> use good highlights\n                        item.score = match;\n                    }\n                    else {\n                        // re-run the scorer on the label in the hope of a result BUT use the rank\n                        // of the filterText-match\n                        item.score = anyScore(word, wordLow, wordPos, item.textLabel, item.labelLow, 0);\n                        item.score[0] = match[0]; // use score from filterText\n                    }\n                }\n                else {\n                    // by default match `word` against the `label`\n                    const match = scoreFn(word, wordLow, wordPos, item.textLabel, item.labelLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    item.score = match;\n                }\n            }\n            item.idx = i;\n            item.distance = this._wordDistance.distance(item.position, item.completion);\n            target.push(item);\n            // update stats\n            labelLengths.push(item.textLabel.length);\n        }\n        this._filteredItems = target.sort(this._snippetCompareFn);\n        this._refilterKind = 0 /* Refilter.Nothing */;\n        this._stats = {\n            pLabelLen: labelLengths.length ?\n                quickSelect(labelLengths.length - .85, labelLengths, (a, b) => a - b)\n                : 0\n        };\n    }\n    static _compareCompletionItems(a, b) {\n        if (a.score[0] > b.score[0]) {\n            return -1;\n        }\n        else if (a.score[0] < b.score[0]) {\n            return 1;\n        }\n        else if (a.distance < b.distance) {\n            return -1;\n        }\n        else if (a.distance > b.distance) {\n            return 1;\n        }\n        else if (a.idx < b.idx) {\n            return -1;\n        }\n        else if (a.idx > b.idx) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    static _compareCompletionItemsSnippetsDown(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n    static _compareCompletionItemsSnippetsUp(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { CancellationError, isCancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { DisposableStore, isDisposable } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { historyNavigationVisible } from '../../../../platform/history/browser/contextScopedHistoryWidget.js';\nexport const Context = {\n    Visible: historyNavigationVisible,\n    HasFocusedSuggestion: new RawContextKey('suggestWidgetHasFocusedSuggestion', false, localize('suggestWidgetHasSelection', \"Whether any suggestion is focused\")),\n    DetailsVisible: new RawContextKey('suggestWidgetDetailsVisible', false, localize('suggestWidgetDetailsVisible', \"Whether suggestion details are visible\")),\n    MultipleSuggestions: new RawContextKey('suggestWidgetMultipleSuggestions', false, localize('suggestWidgetMultipleSuggestions', \"Whether there are multiple suggestions to pick from\")),\n    MakesTextEdit: new RawContextKey('suggestionMakesTextEdit', true, localize('suggestionMakesTextEdit', \"Whether inserting the current suggestion yields in a change or has everything already been typed\")),\n    AcceptSuggestionsOnEnter: new RawContextKey('acceptSuggestionOnEnter', true, localize('acceptSuggestionOnEnter', \"Whether suggestions are inserted when pressing Enter\")),\n    HasInsertAndReplaceRange: new RawContextKey('suggestionHasInsertAndReplaceRange', false, localize('suggestionHasInsertAndReplaceRange', \"Whether the current suggestion has insert and replace behaviour\")),\n    InsertMode: new RawContextKey('suggestionInsertMode', undefined, { type: 'string', description: localize('suggestionInsertMode', \"Whether the default behaviour is to insert or replace\") }),\n    CanResolve: new RawContextKey('suggestionCanResolve', false, localize('suggestionCanResolve', \"Whether the current suggestion supports to resolve further details\")),\n};\nexport const suggestWidgetStatusbarMenu = new MenuId('suggestWidgetStatusBar');\nexport class CompletionItem {\n    constructor(position, completion, container, provider) {\n        var _a;\n        this.position = position;\n        this.completion = completion;\n        this.container = container;\n        this.provider = provider;\n        // validation\n        this.isInvalid = false;\n        // sorting, filtering\n        this.score = FuzzyScore.Default;\n        this.distance = 0;\n        this.textLabel = typeof completion.label === 'string'\n            ? completion.label\n            : (_a = completion.label) === null || _a === void 0 ? void 0 : _a.label;\n        // ensure lower-variants (perf)\n        this.labelLow = this.textLabel.toLowerCase();\n        // validate label\n        this.isInvalid = !this.textLabel;\n        this.sortTextLow = completion.sortText && completion.sortText.toLowerCase();\n        this.filterTextLow = completion.filterText && completion.filterText.toLowerCase();\n        this.extensionId = completion.extensionId;\n        // normalize ranges\n        if (Range.isIRange(completion.range)) {\n            this.editStart = new Position(completion.range.startLineNumber, completion.range.startColumn);\n            this.editInsertEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            this.editReplaceEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            // validate range\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range) || completion.range.startLineNumber !== position.lineNumber;\n        }\n        else {\n            this.editStart = new Position(completion.range.insert.startLineNumber, completion.range.insert.startColumn);\n            this.editInsertEnd = new Position(completion.range.insert.endLineNumber, completion.range.insert.endColumn);\n            this.editReplaceEnd = new Position(completion.range.replace.endLineNumber, completion.range.replace.endColumn);\n            // validate ranges\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range.insert) || Range.spansMultipleLines(completion.range.replace)\n                || completion.range.insert.startLineNumber !== position.lineNumber || completion.range.replace.startLineNumber !== position.lineNumber\n                || completion.range.insert.startColumn !== completion.range.replace.startColumn;\n        }\n        // create the suggestion resolver\n        if (typeof provider.resolveCompletionItem !== 'function') {\n            this._resolveCache = Promise.resolve();\n            this._isResolved = true;\n        }\n    }\n    // ---- resolving\n    get isResolved() {\n        return !!this._isResolved;\n    }\n    resolve(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._resolveCache) {\n                const sub = token.onCancellationRequested(() => {\n                    this._resolveCache = undefined;\n                    this._isResolved = false;\n                });\n                this._resolveCache = Promise.resolve(this.provider.resolveCompletionItem(this.completion, token)).then(value => {\n                    Object.assign(this.completion, value);\n                    this._isResolved = true;\n                    sub.dispose();\n                }, err => {\n                    if (isCancellationError(err)) {\n                        // the IPC queue will reject the request with the\n                        // cancellation error -> reset cached\n                        this._resolveCache = undefined;\n                        this._isResolved = false;\n                    }\n                });\n            }\n            return this._resolveCache;\n        });\n    }\n}\nexport class CompletionOptions {\n    constructor(snippetSortOrder = 2 /* SnippetSortOrder.Bottom */, kindFilter = new Set(), providerFilter = new Set(), providerItemsToReuse = new Map(), showDeprecated = true) {\n        this.snippetSortOrder = snippetSortOrder;\n        this.kindFilter = kindFilter;\n        this.providerFilter = providerFilter;\n        this.providerItemsToReuse = providerItemsToReuse;\n        this.showDeprecated = showDeprecated;\n    }\n}\nCompletionOptions.default = new CompletionOptions();\nlet _snippetSuggestSupport;\nexport function getSnippetSuggestSupport() {\n    return _snippetSuggestSupport;\n}\nexport class CompletionItemModel {\n    constructor(items, needsClipboard, durations, disposable) {\n        this.items = items;\n        this.needsClipboard = needsClipboard;\n        this.durations = durations;\n        this.disposable = disposable;\n    }\n}\nexport function provideSuggestionItems(registry, model, position, options = CompletionOptions.default, context = { triggerKind: 0 /* languages.CompletionTriggerKind.Invoke */ }, token = CancellationToken.None) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const sw = new StopWatch(true);\n        position = position.clone();\n        const word = model.getWordAtPosition(position);\n        const defaultReplaceRange = word ? new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn) : Range.fromPositions(position);\n        const defaultRange = { replace: defaultReplaceRange, insert: defaultReplaceRange.setEndPosition(position.lineNumber, position.column) };\n        const result = [];\n        const disposables = new DisposableStore();\n        const durations = [];\n        let needsClipboard = false;\n        const onCompletionList = (provider, container, sw) => {\n            var _a, _b, _c;\n            let didAddResult = false;\n            if (!container) {\n                return didAddResult;\n            }\n            for (const suggestion of container.suggestions) {\n                if (!options.kindFilter.has(suggestion.kind)) {\n                    // skip if not showing deprecated suggestions\n                    if (!options.showDeprecated && ((_a = suggestion === null || suggestion === void 0 ? void 0 : suggestion.tags) === null || _a === void 0 ? void 0 : _a.includes(1 /* languages.CompletionItemTag.Deprecated */))) {\n                        continue;\n                    }\n                    // fill in default range when missing\n                    if (!suggestion.range) {\n                        suggestion.range = defaultRange;\n                    }\n                    // fill in default sortText when missing\n                    if (!suggestion.sortText) {\n                        suggestion.sortText = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.label;\n                    }\n                    if (!needsClipboard && suggestion.insertTextRules && suggestion.insertTextRules & 4 /* languages.CompletionItemInsertTextRule.InsertAsSnippet */) {\n                        needsClipboard = SnippetParser.guessNeedsClipboard(suggestion.insertText);\n                    }\n                    result.push(new CompletionItem(position, suggestion, container, provider));\n                    didAddResult = true;\n                }\n            }\n            if (isDisposable(container)) {\n                disposables.add(container);\n            }\n            durations.push({\n                providerName: (_b = provider._debugDisplayName) !== null && _b !== void 0 ? _b : 'unknown_provider', elapsedProvider: (_c = container.duration) !== null && _c !== void 0 ? _c : -1, elapsedOverall: sw.elapsed()\n            });\n            return didAddResult;\n        };\n        // ask for snippets in parallel to asking \"real\" providers. Only do something if configured to\n        // do so - no snippet filter, no special-providers-only request\n        const snippetCompletions = (() => __awaiter(this, void 0, void 0, function* () {\n            if (!_snippetSuggestSupport || options.kindFilter.has(27 /* languages.CompletionItemKind.Snippet */)) {\n                return;\n            }\n            // we have items from a previous session that we can reuse\n            const reuseItems = options.providerItemsToReuse.get(_snippetSuggestSupport);\n            if (reuseItems) {\n                reuseItems.forEach(item => result.push(item));\n                return;\n            }\n            if (options.providerFilter.size > 0 && !options.providerFilter.has(_snippetSuggestSupport)) {\n                return;\n            }\n            const sw = new StopWatch(true);\n            const list = yield _snippetSuggestSupport.provideCompletionItems(model, position, context, token);\n            onCompletionList(_snippetSuggestSupport, list, sw);\n        }))();\n        // add suggestions from contributed providers - providers are ordered in groups of\n        // equal score and once a group produces a result the process stops\n        // get provider groups, always add snippet suggestion provider\n        for (const providerGroup of registry.orderedGroups(model)) {\n            // for each support in the group ask for suggestions\n            let didAddResult = false;\n            yield Promise.all(providerGroup.map((provider) => __awaiter(this, void 0, void 0, function* () {\n                // we have items from a previous session that we can reuse\n                if (options.providerItemsToReuse.has(provider)) {\n                    const items = options.providerItemsToReuse.get(provider);\n                    items.forEach(item => result.push(item));\n                    didAddResult = didAddResult || items.length > 0;\n                    return;\n                }\n                // check if this provider is filtered out\n                if (options.providerFilter.size > 0 && !options.providerFilter.has(provider)) {\n                    return;\n                }\n                try {\n                    const sw = new StopWatch(true);\n                    const list = yield provider.provideCompletionItems(model, position, context, token);\n                    didAddResult = onCompletionList(provider, list, sw) || didAddResult;\n                }\n                catch (err) {\n                    onUnexpectedExternalError(err);\n                }\n            })));\n            if (didAddResult || token.isCancellationRequested) {\n                break;\n            }\n        }\n        yield snippetCompletions;\n        if (token.isCancellationRequested) {\n            disposables.dispose();\n            return Promise.reject(new CancellationError());\n        }\n        return new CompletionItemModel(result.sort(getSuggestionComparator(options.snippetSortOrder)), needsClipboard, { entries: durations, elapsed: sw.elapsed() }, disposables);\n    });\n}\nfunction defaultComparator(a, b) {\n    // check with 'sortText'\n    if (a.sortTextLow && b.sortTextLow) {\n        if (a.sortTextLow < b.sortTextLow) {\n            return -1;\n        }\n        else if (a.sortTextLow > b.sortTextLow) {\n            return 1;\n        }\n    }\n    // check with 'label'\n    if (a.textLabel < b.textLabel) {\n        return -1;\n    }\n    else if (a.textLabel > b.textLabel) {\n        return 1;\n    }\n    // check with 'type'\n    return a.completion.kind - b.completion.kind;\n}\nfunction snippetUpComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nfunction snippetDownComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nconst _snippetComparators = new Map();\n_snippetComparators.set(0 /* SnippetSortOrder.Top */, snippetUpComparator);\n_snippetComparators.set(2 /* SnippetSortOrder.Bottom */, snippetDownComparator);\n_snippetComparators.set(1 /* SnippetSortOrder.Inline */, defaultComparator);\nexport function getSuggestionComparator(snippetConfig) {\n    return _snippetComparators.get(snippetConfig);\n}\nCommandsRegistry.registerCommand('_executeCompletionItemProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, position, triggerCharacter, maxItemsToResolve] = args;\n    assertType(URI.isUri(uri));\n    assertType(Position.isIPosition(position));\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\n    assertType(typeof maxItemsToResolve === 'number' || !maxItemsToResolve);\n    const { completionProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = yield accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const result = {\n            incomplete: false,\n            suggestions: []\n        };\n        const resolving = [];\n        const actualPosition = ref.object.textEditorModel.validatePosition(position);\n        const completions = yield provideSuggestionItems(completionProvider, ref.object.textEditorModel, actualPosition, undefined, { triggerCharacter: triggerCharacter !== null && triggerCharacter !== void 0 ? triggerCharacter : undefined, triggerKind: triggerCharacter ? 1 /* languages.CompletionTriggerKind.TriggerCharacter */ : 0 /* languages.CompletionTriggerKind.Invoke */ });\n        for (const item of completions.items) {\n            if (resolving.length < (maxItemsToResolve !== null && maxItemsToResolve !== void 0 ? maxItemsToResolve : 0)) {\n                resolving.push(item.resolve(CancellationToken.None));\n            }\n            result.incomplete = result.incomplete || item.container.incomplete;\n            result.suggestions.push(item.completion);\n        }\n        try {\n            yield Promise.all(resolving);\n            return result;\n        }\n        finally {\n            setTimeout(() => completions.disposable.dispose(), 100);\n        }\n    }\n    finally {\n        ref.dispose();\n    }\n}));\nexport function showSimpleSuggestions(editor, provider) {\n    var _a;\n    (_a = editor.getContribution('editor.contrib.suggestController')) === null || _a === void 0 ? void 0 : _a.triggerSuggest(new Set().add(provider), undefined, true);\n}\nexport class QuickSuggestionsOptions {\n    static isAllOff(config) {\n        return config.other === 'off' && config.comments === 'off' && config.strings === 'off';\n    }\n    static isAllOn(config) {\n        return config.other === 'on' && config.comments === 'on' && config.strings === 'on';\n    }\n    static valueFor(config, tokenType) {\n        switch (tokenType) {\n            case 1 /* StandardTokenType.Comment */: return config.comments;\n            case 2 /* StandardTokenType.String */: return config.strings;\n            default: return config.other;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport let WordContextKey = class WordContextKey {\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._enabled = false;\n        this._ckAtEnd = WordContextKey.AtEnd.bindTo(contextKeyService);\n        this._configListener = this._editor.onDidChangeConfiguration(e => e.hasChanged(119 /* EditorOption.tabCompletion */) && this._update());\n        this._update();\n    }\n    dispose() {\n        var _a;\n        this._configListener.dispose();\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._ckAtEnd.reset();\n    }\n    _update() {\n        // only update this when tab completions are enabled\n        const enabled = this._editor.getOption(119 /* EditorOption.tabCompletion */) === 'on';\n        if (this._enabled === enabled) {\n            return;\n        }\n        this._enabled = enabled;\n        if (this._enabled) {\n            const checkForWordEnd = () => {\n                if (!this._editor.hasModel()) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                const model = this._editor.getModel();\n                const selection = this._editor.getSelection();\n                const word = model.getWordAtPosition(selection.getStartPosition());\n                if (!word) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                this._ckAtEnd.set(word.endColumn === selection.getStartPosition().column);\n            };\n            this._selectionListener = this._editor.onDidChangeCursorSelection(checkForWordEnd);\n            checkForWordEnd();\n        }\n        else if (this._selectionListener) {\n            this._ckAtEnd.reset();\n            this._selectionListener.dispose();\n            this._selectionListener = undefined;\n        }\n    }\n};\nWordContextKey.AtEnd = new RawContextKey('atEndOfWord', false);\nWordContextKey = __decorate([\n    __param(1, IContextKeyService)\n], WordContextKey);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport let SuggestAlternatives = class SuggestAlternatives {\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._index = 0;\n        this._ckOtherSuggestions = SuggestAlternatives.OtherSuggestions.bindTo(contextKeyService);\n    }\n    dispose() {\n        this.reset();\n    }\n    reset() {\n        var _a;\n        this._ckOtherSuggestions.reset();\n        (_a = this._listener) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._model = undefined;\n        this._acceptNext = undefined;\n        this._ignore = false;\n    }\n    set({ model, index }, acceptNext) {\n        // no suggestions -> nothing to do\n        if (model.items.length === 0) {\n            this.reset();\n            return;\n        }\n        // no alternative suggestions -> nothing to do\n        const nextIndex = SuggestAlternatives._moveIndex(true, model, index);\n        if (nextIndex === index) {\n            this.reset();\n            return;\n        }\n        this._acceptNext = acceptNext;\n        this._model = model;\n        this._index = index;\n        this._listener = this._editor.onDidChangeCursorPosition(() => {\n            if (!this._ignore) {\n                this.reset();\n            }\n        });\n        this._ckOtherSuggestions.set(true);\n    }\n    static _moveIndex(fwd, model, index) {\n        let newIndex = index;\n        for (let rounds = model.items.length; rounds > 0; rounds--) {\n            newIndex = (newIndex + model.items.length + (fwd ? +1 : -1)) % model.items.length;\n            if (newIndex === index) {\n                break;\n            }\n            if (!model.items[newIndex].completion.additionalTextEdits) {\n                break;\n            }\n        }\n        return newIndex;\n    }\n    next() {\n        this._move(true);\n    }\n    prev() {\n        this._move(false);\n    }\n    _move(fwd) {\n        if (!this._model) {\n            // nothing to reason about\n            return;\n        }\n        try {\n            this._ignore = true;\n            this._index = SuggestAlternatives._moveIndex(fwd, this._model, this._index);\n            this._acceptNext({ index: this._index, item: this._model.items[this._index], model: this._model });\n        }\n        finally {\n            this._ignore = false;\n        }\n    }\n};\nSuggestAlternatives.OtherSuggestions = new RawContextKey('hasOtherSuggestions', false);\nSuggestAlternatives = __decorate([\n    __param(1, IContextKeyService)\n], SuggestAlternatives);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nexport class CommitCharacterController {\n    constructor(editor, widget, model, accept) {\n        this._disposables = new DisposableStore();\n        this._disposables.add(model.onDidSuggest(e => {\n            if (e.completionModel.items.length === 0) {\n                this.reset();\n            }\n        }));\n        this._disposables.add(model.onDidCancel(e => {\n            this.reset();\n        }));\n        this._disposables.add(widget.onDidShow(() => this._onItem(widget.getFocusedItem())));\n        this._disposables.add(widget.onDidFocus(this._onItem, this));\n        this._disposables.add(widget.onDidHide(this.reset, this));\n        this._disposables.add(editor.onWillType(text => {\n            if (this._active && !widget.isFrozen() && model.state !== 0 /* State.Idle */) {\n                const ch = text.charCodeAt(text.length - 1);\n                if (this._active.acceptCharacters.has(ch) && editor.getOption(0 /* EditorOption.acceptSuggestionOnCommitCharacter */)) {\n                    accept(this._active.item);\n                }\n            }\n        }));\n    }\n    _onItem(selected) {\n        if (!selected || !isNonEmptyArray(selected.item.completion.commitCharacters)) {\n            // no item or no commit characters\n            this.reset();\n            return;\n        }\n        if (this._active && this._active.item.item === selected.item) {\n            // still the same item\n            return;\n        }\n        // keep item and its commit characters\n        const acceptCharacters = new CharacterSet();\n        for (const ch of selected.item.completion.commitCharacters) {\n            if (ch.length > 0) {\n                acceptCharacters.add(ch.charCodeAt(0));\n            }\n        }\n        this._active = { acceptCharacters, item: selected };\n    }\n    reset() {\n        this._active = undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace, isHighSurrogate, isLowSurrogate } from '../../../../base/common/strings.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CompletionModel } from './completionModel.js';\nimport { CompletionOptions, getSnippetSuggestSupport, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { FuzzyScoreOptions } from '../../../../base/common/filters.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { InlineCompletionContextKeys } from '../../inlineCompletions/browser/inlineCompletionContextKeys.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nexport class LineContext {\n    static shouldAutoTrigger(editor) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const pos = editor.getPosition();\n        model.tokenization.tokenizeIfCheap(pos.lineNumber);\n        const word = model.getWordAtPosition(pos);\n        if (!word) {\n            return false;\n        }\n        if (word.endColumn !== pos.column &&\n            word.startColumn + 1 !== pos.column /* after typing a single character before a word */) {\n            return false;\n        }\n        if (!isNaN(Number(word.word))) {\n            return false;\n        }\n        return true;\n    }\n    constructor(model, position, triggerOptions) {\n        this.leadingLineContent = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n        this.leadingWord = model.getWordUntilPosition(position);\n        this.lineNumber = position.lineNumber;\n        this.column = position.column;\n        this.triggerOptions = triggerOptions;\n    }\n}\nfunction canShowQuickSuggest(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue(InlineCompletionContextKeys.inlineSuggestionVisible.key))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const suppressSuggestions = contextKeyService.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);\n    if (suppressSuggestions !== undefined) {\n        return !suppressSuggestions;\n    }\n    return !editor.getOption(60 /* EditorOption.inlineSuggest */).suppressSuggestions;\n}\nfunction canShowSuggestOnTriggerCharacters(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue('inlineSuggestionVisible'))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const suppressSuggestions = contextKeyService.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);\n    if (suppressSuggestions !== undefined) {\n        return !suppressSuggestions;\n    }\n    return !editor.getOption(60 /* EditorOption.inlineSuggest */).suppressSuggestions;\n}\nexport let SuggestModel = class SuggestModel {\n    constructor(_editor, _editorWorkerService, _clipboardService, _telemetryService, _logService, _contextKeyService, _configurationService, _languageFeaturesService) {\n        this._editor = _editor;\n        this._editorWorkerService = _editorWorkerService;\n        this._clipboardService = _clipboardService;\n        this._telemetryService = _telemetryService;\n        this._logService = _logService;\n        this._contextKeyService = _contextKeyService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._toDispose = new DisposableStore();\n        this._triggerCharacterListener = new DisposableStore();\n        this._triggerQuickSuggest = new TimeoutTimer();\n        this._triggerState = undefined;\n        this._completionDisposables = new DisposableStore();\n        this._onDidCancel = new Emitter();\n        this._onDidTrigger = new Emitter();\n        this._onDidSuggest = new Emitter();\n        this.onDidCancel = this._onDidCancel.event;\n        this.onDidTrigger = this._onDidTrigger.event;\n        this.onDidSuggest = this._onDidSuggest.event;\n        this._telemetryGate = 0;\n        this._currentSelection = this._editor.getSelection() || new Selection(1, 1, 1, 1);\n        // wire up various listeners\n        this._toDispose.add(this._editor.onDidChangeModel(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelLanguage(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeConfiguration(() => {\n            this._updateTriggerCharacters();\n        }));\n        this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(() => {\n            this._updateTriggerCharacters();\n            this._updateActiveSuggestSession();\n        }));\n        let editorIsComposing = false;\n        this._toDispose.add(this._editor.onDidCompositionStart(() => {\n            editorIsComposing = true;\n        }));\n        this._toDispose.add(this._editor.onDidCompositionEnd(() => {\n            editorIsComposing = false;\n            this._onCompositionEnd();\n        }));\n        this._toDispose.add(this._editor.onDidChangeCursorSelection(e => {\n            // only trigger suggest when the editor isn't composing a character\n            if (!editorIsComposing) {\n                this._onCursorChange(e);\n            }\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelContent(() => {\n            // only filter completions when the editor isn't composing a character\n            // allow-any-unicode-next-line\n            // e.g.  + u makes  but just  cannot be used for filtering\n            if (!editorIsComposing && this._triggerState !== undefined) {\n                this._refilterCompletionItems();\n            }\n        }));\n        this._updateTriggerCharacters();\n    }\n    dispose() {\n        dispose(this._triggerCharacterListener);\n        dispose([this._onDidCancel, this._onDidSuggest, this._onDidTrigger, this._triggerQuickSuggest]);\n        this._toDispose.dispose();\n        this._completionDisposables.dispose();\n        this.cancel();\n    }\n    _updateTriggerCharacters() {\n        this._triggerCharacterListener.clear();\n        if (this._editor.getOption(88 /* EditorOption.readOnly */)\n            || !this._editor.hasModel()\n            || !this._editor.getOption(117 /* EditorOption.suggestOnTriggerCharacters */)) {\n            return;\n        }\n        const supportsByTriggerCharacter = new Map();\n        for (const support of this._languageFeaturesService.completionProvider.all(this._editor.getModel())) {\n            for (const ch of support.triggerCharacters || []) {\n                let set = supportsByTriggerCharacter.get(ch);\n                if (!set) {\n                    set = new Set();\n                    set.add(getSnippetSuggestSupport());\n                    supportsByTriggerCharacter.set(ch, set);\n                }\n                set.add(support);\n            }\n        }\n        const checkTriggerCharacter = (text) => {\n            var _a;\n            if (!canShowSuggestOnTriggerCharacters(this._editor, this._contextKeyService, this._configurationService)) {\n                return;\n            }\n            if (LineContext.shouldAutoTrigger(this._editor)) {\n                // don't trigger by trigger characters when this is a case for quick suggest\n                return;\n            }\n            if (!text) {\n                // came here from the compositionEnd-event\n                const position = this._editor.getPosition();\n                const model = this._editor.getModel();\n                text = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n            }\n            let lastChar = '';\n            if (isLowSurrogate(text.charCodeAt(text.length - 1))) {\n                if (isHighSurrogate(text.charCodeAt(text.length - 2))) {\n                    lastChar = text.substr(text.length - 2);\n                }\n            }\n            else {\n                lastChar = text.charAt(text.length - 1);\n            }\n            const supports = supportsByTriggerCharacter.get(lastChar);\n            if (supports) {\n                // keep existing items that where not computed by the\n                // supports/providers that want to trigger now\n                const providerItemsToReuse = new Map();\n                if (this._completionModel) {\n                    for (const [provider, items] of this._completionModel.getItemsByProvider()) {\n                        if (!supports.has(provider)) {\n                            providerItemsToReuse.set(provider, items);\n                        }\n                    }\n                }\n                this.trigger({\n                    auto: true,\n                    triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */,\n                    triggerCharacter: lastChar,\n                    retrigger: Boolean(this._completionModel),\n                    clipboardText: (_a = this._completionModel) === null || _a === void 0 ? void 0 : _a.clipboardText,\n                    completionOptions: { providerFilter: supports, providerItemsToReuse }\n                });\n            }\n        };\n        this._triggerCharacterListener.add(this._editor.onDidType(checkTriggerCharacter));\n        this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(() => checkTriggerCharacter()));\n    }\n    // --- trigger/retrigger/cancel suggest\n    get state() {\n        if (!this._triggerState) {\n            return 0 /* State.Idle */;\n        }\n        else if (!this._triggerState.auto) {\n            return 1 /* State.Manual */;\n        }\n        else {\n            return 2 /* State.Auto */;\n        }\n    }\n    cancel(retrigger = false) {\n        var _a;\n        if (this._triggerState !== undefined) {\n            this._triggerQuickSuggest.cancel();\n            (_a = this._requestToken) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._requestToken = undefined;\n            this._triggerState = undefined;\n            this._completionModel = undefined;\n            this._context = undefined;\n            this._onDidCancel.fire({ retrigger });\n        }\n    }\n    clear() {\n        this._completionDisposables.clear();\n    }\n    _updateActiveSuggestSession() {\n        if (this._triggerState !== undefined) {\n            if (!this._editor.hasModel() || !this._languageFeaturesService.completionProvider.has(this._editor.getModel())) {\n                this.cancel();\n            }\n            else {\n                this.trigger({ auto: this._triggerState.auto, retrigger: true });\n            }\n        }\n    }\n    _onCursorChange(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const prevSelection = this._currentSelection;\n        this._currentSelection = this._editor.getSelection();\n        if (!e.selection.isEmpty()\n            || (e.reason !== 0 /* CursorChangeReason.NotSet */ && e.reason !== 3 /* CursorChangeReason.Explicit */)\n            || (e.source !== 'keyboard' && e.source !== 'deleteLeft')) {\n            // Early exit if nothing needs to be done!\n            // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n            this.cancel();\n            return;\n        }\n        if (this._triggerState === undefined && e.reason === 0 /* CursorChangeReason.NotSet */) {\n            if (prevSelection.containsRange(this._currentSelection) || prevSelection.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition())) {\n                // cursor did move RIGHT due to typing -> trigger quick suggest\n                this._doTriggerQuickSuggest();\n            }\n        }\n        else if (this._triggerState !== undefined && e.reason === 3 /* CursorChangeReason.Explicit */) {\n            // suggest is active and something like cursor keys are used to move\n            // the cursor. this means we can refilter at the new position\n            this._refilterCompletionItems();\n        }\n    }\n    _onCompositionEnd() {\n        // trigger or refilter when composition ends\n        if (this._triggerState === undefined) {\n            this._doTriggerQuickSuggest();\n        }\n        else {\n            this._refilterCompletionItems();\n        }\n    }\n    _doTriggerQuickSuggest() {\n        var _a;\n        if (QuickSuggestionsOptions.isAllOff(this._editor.getOption(86 /* EditorOption.quickSuggestions */))) {\n            // not enabled\n            return;\n        }\n        if (this._editor.getOption(114 /* EditorOption.suggest */).snippetsPreventQuickSuggestions && ((_a = SnippetController2.get(this._editor)) === null || _a === void 0 ? void 0 : _a.isInSnippet())) {\n            // no quick suggestion when in snippet mode\n            return;\n        }\n        this.cancel();\n        this._triggerQuickSuggest.cancelAndSet(() => {\n            if (this._triggerState !== undefined) {\n                return;\n            }\n            if (!LineContext.shouldAutoTrigger(this._editor)) {\n                return;\n            }\n            if (!this._editor.hasModel() || !this._editor.hasWidgetFocus()) {\n                return;\n            }\n            const model = this._editor.getModel();\n            const pos = this._editor.getPosition();\n            // validate enabled now\n            const config = this._editor.getOption(86 /* EditorOption.quickSuggestions */);\n            if (QuickSuggestionsOptions.isAllOff(config)) {\n                return;\n            }\n            if (!QuickSuggestionsOptions.isAllOn(config)) {\n                // Check the type of the token that triggered this\n                model.tokenization.tokenizeIfCheap(pos.lineNumber);\n                const lineTokens = model.tokenization.getLineTokens(pos.lineNumber);\n                const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(pos.column - 1 - 1, 0)));\n                if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'on') {\n                    return;\n                }\n            }\n            if (!canShowQuickSuggest(this._editor, this._contextKeyService, this._configurationService)) {\n                // do not trigger quick suggestions if inline suggestions are shown\n                return;\n            }\n            if (!this._languageFeaturesService.completionProvider.has(model)) {\n                return;\n            }\n            // we made it till here -> trigger now\n            this.trigger({ auto: true });\n        }, this._editor.getOption(87 /* EditorOption.quickSuggestionsDelay */));\n    }\n    _refilterCompletionItems() {\n        assertType(this._editor.hasModel());\n        assertType(this._triggerState !== undefined);\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const ctx = new LineContext(model, position, Object.assign(Object.assign({}, this._triggerState), { refilter: true }));\n        this._onNewContext(ctx);\n    }\n    trigger(options) {\n        var _a, _b, _c, _d, _e, _f;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const ctx = new LineContext(model, this._editor.getPosition(), options);\n        // Cancel previous requests, change state & update UI\n        this.cancel(options.retrigger);\n        this._triggerState = options;\n        this._onDidTrigger.fire({ auto: options.auto, shy: (_a = options.shy) !== null && _a !== void 0 ? _a : false, position: this._editor.getPosition() });\n        // Capture context when request was sent\n        this._context = ctx;\n        // Build context for request\n        let suggestCtx = { triggerKind: (_b = options.triggerKind) !== null && _b !== void 0 ? _b : 0 /* CompletionTriggerKind.Invoke */ };\n        if (options.triggerCharacter) {\n            suggestCtx = {\n                triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */,\n                triggerCharacter: options.triggerCharacter\n            };\n        }\n        this._requestToken = new CancellationTokenSource();\n        // kind filter and snippet sort rules\n        const snippetSuggestions = this._editor.getOption(108 /* EditorOption.snippetSuggestions */);\n        let snippetSortOrder = 1 /* SnippetSortOrder.Inline */;\n        switch (snippetSuggestions) {\n            case 'top':\n                snippetSortOrder = 0 /* SnippetSortOrder.Top */;\n                break;\n            // \t that's the default anyways...\n            // case 'inline':\n            // \tsnippetSortOrder = SnippetSortOrder.Inline;\n            // \tbreak;\n            case 'bottom':\n                snippetSortOrder = 2 /* SnippetSortOrder.Bottom */;\n                break;\n        }\n        const { itemKind: itemKindFilter, showDeprecated } = SuggestModel._createSuggestFilter(this._editor);\n        const completionOptions = new CompletionOptions(snippetSortOrder, (_d = (_c = options.completionOptions) === null || _c === void 0 ? void 0 : _c.kindFilter) !== null && _d !== void 0 ? _d : itemKindFilter, (_e = options.completionOptions) === null || _e === void 0 ? void 0 : _e.providerFilter, (_f = options.completionOptions) === null || _f === void 0 ? void 0 : _f.providerItemsToReuse, showDeprecated);\n        const wordDistance = WordDistance.create(this._editorWorkerService, this._editor);\n        const completions = provideSuggestionItems(this._languageFeaturesService.completionProvider, model, this._editor.getPosition(), completionOptions, suggestCtx, this._requestToken.token);\n        Promise.all([completions, wordDistance]).then(([completions, wordDistance]) => __awaiter(this, void 0, void 0, function* () {\n            var _g;\n            (_g = this._requestToken) === null || _g === void 0 ? void 0 : _g.dispose();\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            let clipboardText = options === null || options === void 0 ? void 0 : options.clipboardText;\n            if (!clipboardText && completions.needsClipboard) {\n                clipboardText = yield this._clipboardService.readText();\n            }\n            if (this._triggerState === undefined) {\n                return;\n            }\n            const model = this._editor.getModel();\n            // const items = completions.items;\n            // if (existing) {\n            // \tconst cmpFn = getSuggestionComparator(snippetSortOrder);\n            // \titems = items.concat(existing.items).sort(cmpFn);\n            // }\n            const ctx = new LineContext(model, this._editor.getPosition(), options);\n            const fuzzySearchOptions = Object.assign(Object.assign({}, FuzzyScoreOptions.default), { firstMatchCanBeWeak: !this._editor.getOption(114 /* EditorOption.suggest */).matchOnWordStartOnly });\n            this._completionModel = new CompletionModel(completions.items, this._context.column, {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            }, wordDistance, this._editor.getOption(114 /* EditorOption.suggest */), this._editor.getOption(108 /* EditorOption.snippetSuggestions */), fuzzySearchOptions, clipboardText);\n            // store containers so that they can be disposed later\n            this._completionDisposables.add(completions.disposable);\n            this._onNewContext(ctx);\n            // finally report telemetry about durations\n            this._reportDurationsTelemetry(completions.durations);\n        })).catch(onUnexpectedError);\n    }\n    _reportDurationsTelemetry(durations) {\n        if (this._telemetryGate++ % 230 !== 0) {\n            return;\n        }\n        setTimeout(() => {\n            this._telemetryService.publicLog2('suggest.durations.json', { data: JSON.stringify(durations) });\n            this._logService.debug('suggest.durations.json', durations);\n        });\n    }\n    static _createSuggestFilter(editor) {\n        // kind filter and snippet sort rules\n        const result = new Set();\n        // snippet setting\n        const snippetSuggestions = editor.getOption(108 /* EditorOption.snippetSuggestions */);\n        if (snippetSuggestions === 'none') {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        // type setting\n        const suggestOptions = editor.getOption(114 /* EditorOption.suggest */);\n        if (!suggestOptions.showMethods) {\n            result.add(0 /* CompletionItemKind.Method */);\n        }\n        if (!suggestOptions.showFunctions) {\n            result.add(1 /* CompletionItemKind.Function */);\n        }\n        if (!suggestOptions.showConstructors) {\n            result.add(2 /* CompletionItemKind.Constructor */);\n        }\n        if (!suggestOptions.showFields) {\n            result.add(3 /* CompletionItemKind.Field */);\n        }\n        if (!suggestOptions.showVariables) {\n            result.add(4 /* CompletionItemKind.Variable */);\n        }\n        if (!suggestOptions.showClasses) {\n            result.add(5 /* CompletionItemKind.Class */);\n        }\n        if (!suggestOptions.showStructs) {\n            result.add(6 /* CompletionItemKind.Struct */);\n        }\n        if (!suggestOptions.showInterfaces) {\n            result.add(7 /* CompletionItemKind.Interface */);\n        }\n        if (!suggestOptions.showModules) {\n            result.add(8 /* CompletionItemKind.Module */);\n        }\n        if (!suggestOptions.showProperties) {\n            result.add(9 /* CompletionItemKind.Property */);\n        }\n        if (!suggestOptions.showEvents) {\n            result.add(10 /* CompletionItemKind.Event */);\n        }\n        if (!suggestOptions.showOperators) {\n            result.add(11 /* CompletionItemKind.Operator */);\n        }\n        if (!suggestOptions.showUnits) {\n            result.add(12 /* CompletionItemKind.Unit */);\n        }\n        if (!suggestOptions.showValues) {\n            result.add(13 /* CompletionItemKind.Value */);\n        }\n        if (!suggestOptions.showConstants) {\n            result.add(14 /* CompletionItemKind.Constant */);\n        }\n        if (!suggestOptions.showEnums) {\n            result.add(15 /* CompletionItemKind.Enum */);\n        }\n        if (!suggestOptions.showEnumMembers) {\n            result.add(16 /* CompletionItemKind.EnumMember */);\n        }\n        if (!suggestOptions.showKeywords) {\n            result.add(17 /* CompletionItemKind.Keyword */);\n        }\n        if (!suggestOptions.showWords) {\n            result.add(18 /* CompletionItemKind.Text */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(19 /* CompletionItemKind.Color */);\n        }\n        if (!suggestOptions.showFiles) {\n            result.add(20 /* CompletionItemKind.File */);\n        }\n        if (!suggestOptions.showReferences) {\n            result.add(21 /* CompletionItemKind.Reference */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(22 /* CompletionItemKind.Customcolor */);\n        }\n        if (!suggestOptions.showFolders) {\n            result.add(23 /* CompletionItemKind.Folder */);\n        }\n        if (!suggestOptions.showTypeParameters) {\n            result.add(24 /* CompletionItemKind.TypeParameter */);\n        }\n        if (!suggestOptions.showSnippets) {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        if (!suggestOptions.showUsers) {\n            result.add(25 /* CompletionItemKind.User */);\n        }\n        if (!suggestOptions.showIssues) {\n            result.add(26 /* CompletionItemKind.Issue */);\n        }\n        return { itemKind: result, showDeprecated: suggestOptions.showDeprecated };\n    }\n    _onNewContext(ctx) {\n        if (!this._context) {\n            // happens when 24x7 IntelliSense is enabled and still in its delay\n            return;\n        }\n        if (ctx.lineNumber !== this._context.lineNumber) {\n            // e.g. happens when pressing Enter while IntelliSense is computed\n            this.cancel();\n            return;\n        }\n        if (getLeadingWhitespace(ctx.leadingLineContent) !== getLeadingWhitespace(this._context.leadingLineContent)) {\n            // cancel IntelliSense when line start changes\n            // happens when the current word gets outdented\n            this.cancel();\n            return;\n        }\n        if (ctx.column < this._context.column) {\n            // typed -> moved cursor LEFT -> retrigger if still on a word\n            if (ctx.leadingWord.word) {\n                this.trigger({ auto: this._context.triggerOptions.auto, retrigger: true });\n            }\n            else {\n                this.cancel();\n            }\n            return;\n        }\n        if (!this._completionModel) {\n            // happens when IntelliSense is not yet computed\n            return;\n        }\n        if (ctx.leadingWord.word.length !== 0 && ctx.leadingWord.startColumn > this._context.leadingWord.startColumn) {\n            // started a new word while IntelliSense shows -> retrigger but reuse all items that we currently have\n            const shouldAutoTrigger = LineContext.shouldAutoTrigger(this._editor);\n            if (shouldAutoTrigger && this._context) {\n                // shouldAutoTrigger forces tokenization, which can cause pending cursor change events to be emitted, which can cause\n                // suggestions to be cancelled, which causes `this._context` to be undefined\n                const map = this._completionModel.getItemsByProvider();\n                this.trigger({\n                    auto: this._context.triggerOptions.auto,\n                    retrigger: true,\n                    clipboardText: this._completionModel.clipboardText,\n                    completionOptions: { providerItemsToReuse: map }\n                });\n            }\n            return;\n        }\n        if (ctx.column > this._context.column && this._completionModel.getIncompleteProvider().size > 0 && ctx.leadingWord.word.length !== 0) {\n            // typed -> moved cursor RIGHT & incomple model & still on a word -> retrigger\n            const providerItemsToReuse = new Map();\n            const providerFilter = new Set();\n            for (const [provider, items] of this._completionModel.getItemsByProvider()) {\n                if (items.length > 0 && items[0].container.incomplete) {\n                    providerFilter.add(provider);\n                }\n                else {\n                    providerItemsToReuse.set(provider, items);\n                }\n            }\n            this.trigger({\n                auto: this._context.triggerOptions.auto,\n                triggerKind: 2 /* CompletionTriggerKind.TriggerForIncompleteCompletions */,\n                retrigger: true,\n                clipboardText: this._completionModel.clipboardText,\n                completionOptions: { providerFilter, providerItemsToReuse }\n            });\n        }\n        else {\n            // typed -> moved cursor RIGHT -> update UI\n            const oldLineContext = this._completionModel.lineContext;\n            let isFrozen = false;\n            this._completionModel.lineContext = {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            };\n            if (this._completionModel.items.length === 0) {\n                const shouldAutoTrigger = LineContext.shouldAutoTrigger(this._editor);\n                if (!this._context) {\n                    // shouldAutoTrigger forces tokenization, which can cause pending cursor change events to be emitted, which can cause\n                    // suggestions to be cancelled, which causes `this._context` to be undefined\n                    this.cancel();\n                    return;\n                }\n                if (shouldAutoTrigger && this._context.leadingWord.endColumn < ctx.leadingWord.startColumn) {\n                    // retrigger when heading into a new word\n                    this.trigger({ auto: this._context.triggerOptions.auto, retrigger: true });\n                    return;\n                }\n                if (!this._context.triggerOptions.auto) {\n                    // freeze when IntelliSense was manually requested\n                    this._completionModel.lineContext = oldLineContext;\n                    isFrozen = this._completionModel.items.length > 0;\n                    if (isFrozen && ctx.leadingWord.word.length === 0) {\n                        // there were results before but now there aren't\n                        // and also we are not on a word anymore -> cancel\n                        this.cancel();\n                        return;\n                    }\n                }\n                else {\n                    // nothing left\n                    this.cancel();\n                    return;\n                }\n            }\n            this._onDidSuggest.fire({\n                completionModel: this._completionModel,\n                triggerOptions: ctx.triggerOptions,\n                isFrozen,\n            });\n        }\n    }\n};\nSuggestModel = __decorate([\n    __param(1, IEditorWorkerService),\n    __param(2, IClipboardService),\n    __param(3, ITelemetryService),\n    __param(4, ILogService),\n    __param(5, IContextKeyService),\n    __param(6, IConfigurationService),\n    __param(7, ILanguageFeaturesService)\n], SuggestModel);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nexport class OvertypingCapturer {\n    constructor(editor, suggestModel) {\n        this._disposables = new DisposableStore();\n        this._lastOvertyped = [];\n        this._locked = false;\n        this._disposables.add(editor.onWillType(() => {\n            if (this._locked || !editor.hasModel()) {\n                return;\n            }\n            const selections = editor.getSelections();\n            const selectionsLength = selections.length;\n            // Check if it will overtype any selections\n            let willOvertype = false;\n            for (let i = 0; i < selectionsLength; i++) {\n                if (!selections[i].isEmpty()) {\n                    willOvertype = true;\n                    break;\n                }\n            }\n            if (!willOvertype) {\n                if (this._lastOvertyped.length !== 0) {\n                    this._lastOvertyped.length = 0;\n                }\n                return;\n            }\n            this._lastOvertyped = [];\n            const model = editor.getModel();\n            for (let i = 0; i < selectionsLength; i++) {\n                const selection = selections[i];\n                // Check for overtyping capturer restrictions\n                if (model.getValueLengthInRange(selection) > OvertypingCapturer._maxSelectionLength) {\n                    return;\n                }\n                this._lastOvertyped[i] = { value: model.getValueInRange(selection), multiline: selection.startLineNumber !== selection.endLineNumber };\n            }\n        }));\n        this._disposables.add(suggestModel.onDidTrigger(e => {\n            this._locked = true;\n        }));\n        this._disposables.add(suggestModel.onDidCancel(e => {\n            this._locked = false;\n        }));\n    }\n    getLastOvertypedInfo(idx) {\n        if (idx >= 0 && idx < this._lastOvertyped.length) {\n            return this._lastOvertyped[idx];\n        }\n        return undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\nOvertypingCapturer._maxSelectionLength = 51200;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuEntryActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nclass StatusBarViewItem extends MenuEntryActionViewItem {\n    updateLabel() {\n        const kb = this._keybindingService.lookupKeybinding(this._action.id, this._contextKeyService);\n        if (!kb) {\n            return super.updateLabel();\n        }\n        if (this.label) {\n            this.label.textContent = localize({ key: 'content', comment: ['A label', 'A keybinding'] }, '{0} ({1})', this._action.label, StatusBarViewItem.symbolPrintEnter(kb));\n        }\n    }\n    static symbolPrintEnter(kb) {\n        var _a;\n        return (_a = kb.getLabel()) === null || _a === void 0 ? void 0 : _a.replace(/\\benter\\b/gi, '\\u23CE');\n    }\n}\nexport let SuggestWidgetStatus = class SuggestWidgetStatus {\n    constructor(container, _menuId, instantiationService, _menuService, _contextKeyService) {\n        this._menuId = _menuId;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._menuDisposables = new DisposableStore();\n        this.element = dom.append(container, dom.$('.suggest-status-bar'));\n        const actionViewItemProvider = (action => {\n            return action instanceof MenuItemAction ? instantiationService.createInstance(StatusBarViewItem, action, undefined) : undefined;\n        });\n        this._leftActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._rightActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._leftActions.domNode.classList.add('left');\n        this._rightActions.domNode.classList.add('right');\n    }\n    dispose() {\n        this._menuDisposables.dispose();\n        this.element.remove();\n    }\n    show() {\n        const menu = this._menuService.createMenu(this._menuId, this._contextKeyService);\n        const renderMenu = () => {\n            const left = [];\n            const right = [];\n            for (const [group, actions] of menu.getActions()) {\n                if (group === 'left') {\n                    left.push(...actions);\n                }\n                else {\n                    right.push(...actions);\n                }\n            }\n            this._leftActions.clear();\n            this._leftActions.push(left);\n            this._rightActions.clear();\n            this._rightActions.push(right);\n        };\n        this._menuDisposables.add(menu.onDidChange(() => renderMenu()));\n        this._menuDisposables.add(menu);\n    }\n    hide() {\n        this._menuDisposables.clear();\n    }\n};\nSuggestWidgetStatus = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, IMenuService),\n    __param(4, IContextKeyService)\n], SuggestWidgetStatus);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { DomScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport * as nls from '../../../../nls.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nexport function canExpandCompletionItem(item) {\n    return !!item && Boolean(item.completion.documentation || item.completion.detail && item.completion.detail !== item.completion.label);\n}\nexport let SuggestDetailsWidget = class SuggestDetailsWidget {\n    constructor(_editor, instaService) {\n        this._editor = _editor;\n        this._onDidClose = new Emitter();\n        this.onDidClose = this._onDidClose.event;\n        this._onDidChangeContents = new Emitter();\n        this.onDidChangeContents = this._onDidChangeContents.event;\n        this._disposables = new DisposableStore();\n        this._renderDisposeable = new DisposableStore();\n        this._borderWidth = 1;\n        this._size = new dom.Dimension(330, 0);\n        this.domNode = dom.$('.suggest-details');\n        this.domNode.classList.add('no-docs');\n        this._markdownRenderer = instaService.createInstance(MarkdownRenderer, { editor: _editor });\n        this._body = dom.$('.body');\n        this._scrollbar = new DomScrollableElement(this._body, {\n            alwaysConsumeMouseWheel: true,\n        });\n        dom.append(this.domNode, this._scrollbar.getDomNode());\n        this._disposables.add(this._scrollbar);\n        this._header = dom.append(this._body, dom.$('.header'));\n        this._close = dom.append(this._header, dom.$('span' + ThemeIcon.asCSSSelector(Codicon.close)));\n        this._close.title = nls.localize('details.close', \"Close\");\n        this._type = dom.append(this._header, dom.$('p.type'));\n        this._docs = dom.append(this._body, dom.$('p.docs'));\n        this._configureFont();\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(48 /* EditorOption.fontInfo */)) {\n                this._configureFont();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._renderDisposeable.dispose();\n    }\n    _configureFont() {\n        const options = this._editor.getOptions();\n        const fontInfo = options.get(48 /* EditorOption.fontInfo */);\n        const fontFamily = fontInfo.getMassagedFontFamily();\n        const fontSize = options.get(115 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n        const lineHeight = options.get(116 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n        const fontWeight = fontInfo.fontWeight;\n        const fontSizePx = `${fontSize}px`;\n        const lineHeightPx = `${lineHeight}px`;\n        this.domNode.style.fontSize = fontSizePx;\n        this.domNode.style.lineHeight = `${lineHeight / fontSize}`;\n        this.domNode.style.fontWeight = fontWeight;\n        this.domNode.style.fontFeatureSettings = fontInfo.fontFeatureSettings;\n        this._type.style.fontFamily = fontFamily;\n        this._close.style.height = lineHeightPx;\n        this._close.style.width = lineHeightPx;\n    }\n    getLayoutInfo() {\n        const lineHeight = this._editor.getOption(116 /* EditorOption.suggestLineHeight */) || this._editor.getOption(48 /* EditorOption.fontInfo */).lineHeight;\n        const borderWidth = this._borderWidth;\n        const borderHeight = borderWidth * 2;\n        return {\n            lineHeight,\n            borderWidth,\n            borderHeight,\n            verticalPadding: 22,\n            horizontalPadding: 14\n        };\n    }\n    renderLoading() {\n        this._type.textContent = nls.localize('loading', \"Loading...\");\n        this._docs.textContent = '';\n        this.domNode.classList.remove('no-docs', 'no-type');\n        this.layout(this.size.width, this.getLayoutInfo().lineHeight * 2);\n        this._onDidChangeContents.fire(this);\n    }\n    renderItem(item, explainMode) {\n        var _a, _b;\n        this._renderDisposeable.clear();\n        let { detail, documentation } = item.completion;\n        if (explainMode) {\n            let md = '';\n            md += `score: ${item.score[0]}\\n`;\n            md += `prefix: ${(_a = item.word) !== null && _a !== void 0 ? _a : '(no prefix)'}\\n`;\n            md += `word: ${item.completion.filterText ? item.completion.filterText + ' (filterText)' : item.textLabel}\\n`;\n            md += `distance: ${item.distance} (localityBonus-setting)\\n`;\n            md += `index: ${item.idx}, based on ${item.completion.sortText && `sortText: \"${item.completion.sortText}\"` || 'label'}\\n`;\n            md += `commit_chars: ${(_b = item.completion.commitCharacters) === null || _b === void 0 ? void 0 : _b.join('')}\\n`;\n            documentation = new MarkdownString().appendCodeblock('empty', md);\n            detail = `Provider: ${item.provider._debugDisplayName}`;\n        }\n        if (!explainMode && !canExpandCompletionItem(item)) {\n            this.clearContents();\n            return;\n        }\n        this.domNode.classList.remove('no-docs', 'no-type');\n        // --- details\n        if (detail) {\n            const cappedDetail = detail.length > 100000 ? `${detail.substr(0, 100000)}` : detail;\n            this._type.textContent = cappedDetail;\n            this._type.title = cappedDetail;\n            dom.show(this._type);\n            this._type.classList.toggle('auto-wrap', !/\\r?\\n^\\s+/gmi.test(cappedDetail));\n        }\n        else {\n            dom.clearNode(this._type);\n            this._type.title = '';\n            dom.hide(this._type);\n            this.domNode.classList.add('no-type');\n        }\n        // --- documentation\n        dom.clearNode(this._docs);\n        if (typeof documentation === 'string') {\n            this._docs.classList.remove('markdown-docs');\n            this._docs.textContent = documentation;\n        }\n        else if (documentation) {\n            this._docs.classList.add('markdown-docs');\n            dom.clearNode(this._docs);\n            const renderedContents = this._markdownRenderer.render(documentation);\n            this._docs.appendChild(renderedContents.element);\n            this._renderDisposeable.add(renderedContents);\n            this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(() => {\n                this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n                this._onDidChangeContents.fire(this);\n            }));\n        }\n        this.domNode.style.userSelect = 'text';\n        this.domNode.tabIndex = -1;\n        this._close.onmousedown = e => {\n            e.preventDefault();\n            e.stopPropagation();\n        };\n        this._close.onclick = e => {\n            e.preventDefault();\n            e.stopPropagation();\n            this._onDidClose.fire();\n        };\n        this._body.scrollTop = 0;\n        this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n        this._onDidChangeContents.fire(this);\n    }\n    clearContents() {\n        this.domNode.classList.add('no-docs');\n        this._type.textContent = '';\n        this._docs.textContent = '';\n    }\n    get size() {\n        return this._size;\n    }\n    layout(width, height) {\n        const newSize = new dom.Dimension(width, height);\n        if (!dom.Dimension.equals(newSize, this._size)) {\n            this._size = newSize;\n            dom.size(this.domNode, width, height);\n        }\n        this._scrollbar.scanDomNode();\n    }\n    scrollDown(much = 8) {\n        this._body.scrollTop += much;\n    }\n    scrollUp(much = 8) {\n        this._body.scrollTop -= much;\n    }\n    scrollTop() {\n        this._body.scrollTop = 0;\n    }\n    scrollBottom() {\n        this._body.scrollTop = this._body.scrollHeight;\n    }\n    pageDown() {\n        this.scrollDown(80);\n    }\n    pageUp() {\n        this.scrollUp(80);\n    }\n    set borderWidth(width) {\n        this._borderWidth = width;\n    }\n    get borderWidth() {\n        return this._borderWidth;\n    }\n};\nSuggestDetailsWidget = __decorate([\n    __param(1, IInstantiationService)\n], SuggestDetailsWidget);\nexport class SuggestDetailsOverlay {\n    constructor(widget, _editor) {\n        this.widget = widget;\n        this._editor = _editor;\n        this._disposables = new DisposableStore();\n        this._added = false;\n        this._preferAlignAtTop = true;\n        this._resizable = new ResizableHTMLElement();\n        this._resizable.domNode.classList.add('suggest-details-container');\n        this._resizable.domNode.appendChild(widget.domNode);\n        this._resizable.enableSashes(false, true, true, false);\n        let topLeftNow;\n        let sizeNow;\n        let deltaTop = 0;\n        let deltaLeft = 0;\n        this._disposables.add(this._resizable.onDidWillResize(() => {\n            topLeftNow = this._topLeft;\n            sizeNow = this._resizable.size;\n        }));\n        this._disposables.add(this._resizable.onDidResize(e => {\n            if (topLeftNow && sizeNow) {\n                this.widget.layout(e.dimension.width, e.dimension.height);\n                let updateTopLeft = false;\n                if (e.west) {\n                    deltaLeft = sizeNow.width - e.dimension.width;\n                    updateTopLeft = true;\n                }\n                if (e.north) {\n                    deltaTop = sizeNow.height - e.dimension.height;\n                    updateTopLeft = true;\n                }\n                if (updateTopLeft) {\n                    this._applyTopLeft({\n                        top: topLeftNow.top + deltaTop,\n                        left: topLeftNow.left + deltaLeft,\n                    });\n                }\n            }\n            if (e.done) {\n                topLeftNow = undefined;\n                sizeNow = undefined;\n                deltaTop = 0;\n                deltaLeft = 0;\n                this._userSize = e.dimension;\n            }\n        }));\n        this._disposables.add(this.widget.onDidChangeContents(() => {\n            var _a;\n            if (this._anchorBox) {\n                this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size, this._preferAlignAtTop);\n            }\n        }));\n    }\n    dispose() {\n        this._resizable.dispose();\n        this._disposables.dispose();\n        this.hide();\n    }\n    getId() {\n        return 'suggest.details';\n    }\n    getDomNode() {\n        return this._resizable.domNode;\n    }\n    getPosition() {\n        return null;\n    }\n    show() {\n        if (!this._added) {\n            this._editor.addOverlayWidget(this);\n            this.getDomNode().style.position = 'fixed';\n            this._added = true;\n        }\n    }\n    hide(sessionEnded = false) {\n        this._resizable.clearSashHoverState();\n        if (this._added) {\n            this._editor.removeOverlayWidget(this);\n            this._added = false;\n            this._anchorBox = undefined;\n            this._topLeft = undefined;\n        }\n        if (sessionEnded) {\n            this._userSize = undefined;\n            this.widget.clearContents();\n        }\n    }\n    placeAtAnchor(anchor, preferAlignAtTop) {\n        var _a;\n        const anchorBox = anchor.getBoundingClientRect();\n        this._anchorBox = anchorBox;\n        this._preferAlignAtTop = preferAlignAtTop;\n        this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size, preferAlignAtTop);\n    }\n    _placeAtAnchor(anchorBox, size, preferAlignAtTop) {\n        var _a;\n        const bodyBox = dom.getClientArea(document.body);\n        const info = this.widget.getLayoutInfo();\n        const defaultMinSize = new dom.Dimension(220, 2 * info.lineHeight);\n        const defaultTop = anchorBox.top;\n        // EAST\n        const eastPlacement = (function () {\n            const width = bodyBox.width - (anchorBox.left + anchorBox.width + info.borderWidth + info.horizontalPadding);\n            const left = -info.borderWidth + anchorBox.left + anchorBox.width;\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // WEST\n        const westPlacement = (function () {\n            const width = anchorBox.left - info.borderWidth - info.horizontalPadding;\n            const left = Math.max(info.horizontalPadding, anchorBox.left - size.width - info.borderWidth);\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // SOUTH\n        const southPacement = (function () {\n            const left = anchorBox.left;\n            const top = -info.borderWidth + anchorBox.top + anchorBox.height;\n            const maxSizeBottom = new dom.Dimension(anchorBox.width - info.borderHeight, bodyBox.height - anchorBox.top - anchorBox.height - info.verticalPadding);\n            return { top, left, fit: maxSizeBottom.height - size.height, maxSizeBottom, maxSizeTop: maxSizeBottom, minSize: defaultMinSize.with(maxSizeBottom.width) };\n        })();\n        // take first placement that fits or the first with \"least bad\" fit\n        const placements = [eastPlacement, westPlacement, southPacement];\n        const placement = (_a = placements.find(p => p.fit >= 0)) !== null && _a !== void 0 ? _a : placements.sort((a, b) => b.fit - a.fit)[0];\n        // top/bottom placement\n        const bottom = anchorBox.top + anchorBox.height - info.borderHeight;\n        let alignAtTop;\n        let height = size.height;\n        const maxHeight = Math.max(placement.maxSizeTop.height, placement.maxSizeBottom.height);\n        if (height > maxHeight) {\n            height = maxHeight;\n        }\n        let maxSize;\n        if (preferAlignAtTop) {\n            if (height <= placement.maxSizeTop.height) {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n            else {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n        }\n        else {\n            if (height <= placement.maxSizeBottom.height) {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n            else {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n        }\n        this._applyTopLeft({ left: placement.left, top: alignAtTop ? placement.top : bottom - height });\n        this.getDomNode().style.position = 'fixed';\n        this._resizable.enableSashes(!alignAtTop, placement === eastPlacement, alignAtTop, placement !== eastPlacement);\n        this._resizable.minSize = placement.minSize;\n        this._resizable.maxSize = maxSize;\n        this._resizable.layout(height, Math.min(maxSize.width, size.width));\n        this.widget.layout(this._resizable.size.width, this._resizable.size.height);\n    }\n    _applyTopLeft(topLeft) {\n        this._topLeft = topLeft;\n        this.getDomNode().style.left = `${this._topLeft.left}px`;\n        this.getDomNode().style.top = `${this._topLeft.top}px`;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar _a;\nimport { $, append, hide, show } from '../../../../base/browser/dom.js';\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { createMatches } from '../../../../base/common/filters.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { getIconClasses } from '../../../common/services/getIconClasses.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport * as nls from '../../../../nls.js';\nimport { FileKind } from '../../../../platform/files/common/files.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { canExpandCompletionItem } from './suggestWidgetDetails.js';\nexport function getAriaId(index) {\n    return `suggest-aria-id:${index}`;\n}\nconst suggestMoreInfoIcon = registerIcon('suggest-more-info', Codicon.chevronRight, nls.localize('suggestMoreInfoIcon', 'Icon for more information in the suggest widget.'));\nconst _completionItemColor = new (_a = class ColorExtractor {\n        extract(item, out) {\n            if (item.textLabel.match(ColorExtractor._regexStrict)) {\n                out[0] = item.textLabel;\n                return true;\n            }\n            if (item.completion.detail && item.completion.detail.match(ColorExtractor._regexStrict)) {\n                out[0] = item.completion.detail;\n                return true;\n            }\n            if (typeof item.completion.documentation === 'string') {\n                const match = ColorExtractor._regexRelaxed.exec(item.completion.documentation);\n                if (match && (match.index === 0 || match.index + match[0].length === item.completion.documentation.length)) {\n                    out[0] = match[0];\n                    return true;\n                }\n            }\n            return false;\n        }\n    },\n    _a._regexRelaxed = /(#([\\da-fA-F]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))/,\n    _a._regexStrict = new RegExp(`^${_a._regexRelaxed.source}$`, 'i'),\n    _a);\nexport let ItemRenderer = class ItemRenderer {\n    constructor(_editor, _modelService, _languageService, _themeService) {\n        this._editor = _editor;\n        this._modelService = _modelService;\n        this._languageService = _languageService;\n        this._themeService = _themeService;\n        this._onDidToggleDetails = new Emitter();\n        this.onDidToggleDetails = this._onDidToggleDetails.event;\n        this.templateId = 'suggestion';\n    }\n    dispose() {\n        this._onDidToggleDetails.dispose();\n    }\n    renderTemplate(container) {\n        const disposables = new DisposableStore();\n        const root = container;\n        root.classList.add('show-file-icons');\n        const icon = append(container, $('.icon'));\n        const colorspan = append(icon, $('span.colorspan'));\n        const text = append(container, $('.contents'));\n        const main = append(text, $('.main'));\n        const iconContainer = append(main, $('.icon-label.codicon'));\n        const left = append(main, $('span.left'));\n        const right = append(main, $('span.right'));\n        const iconLabel = new IconLabel(left, { supportHighlights: true, supportIcons: true });\n        disposables.add(iconLabel);\n        const parametersLabel = append(left, $('span.signature-label'));\n        const qualifierLabel = append(left, $('span.qualifier-label'));\n        const detailsLabel = append(right, $('span.details-label'));\n        const readMore = append(right, $('span.readMore' + ThemeIcon.asCSSSelector(suggestMoreInfoIcon)));\n        readMore.title = nls.localize('readMore', \"Read More\");\n        const configureFont = () => {\n            const options = this._editor.getOptions();\n            const fontInfo = options.get(48 /* EditorOption.fontInfo */);\n            const fontFamily = fontInfo.getMassagedFontFamily();\n            const fontFeatureSettings = fontInfo.fontFeatureSettings;\n            const fontSize = options.get(115 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n            const lineHeight = options.get(116 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n            const fontWeight = fontInfo.fontWeight;\n            const letterSpacing = fontInfo.letterSpacing;\n            const fontSizePx = `${fontSize}px`;\n            const lineHeightPx = `${lineHeight}px`;\n            const letterSpacingPx = `${letterSpacing}px`;\n            root.style.fontSize = fontSizePx;\n            root.style.fontWeight = fontWeight;\n            root.style.letterSpacing = letterSpacingPx;\n            main.style.fontFamily = fontFamily;\n            main.style.fontFeatureSettings = fontFeatureSettings;\n            main.style.lineHeight = lineHeightPx;\n            icon.style.height = lineHeightPx;\n            icon.style.width = lineHeightPx;\n            readMore.style.height = lineHeightPx;\n            readMore.style.width = lineHeightPx;\n        };\n        configureFont();\n        disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(48 /* EditorOption.fontInfo */) || e.hasChanged(115 /* EditorOption.suggestFontSize */) || e.hasChanged(116 /* EditorOption.suggestLineHeight */)) {\n                configureFont();\n            }\n        }));\n        return { root, left, right, icon, colorspan, iconLabel, iconContainer, parametersLabel, qualifierLabel, detailsLabel, readMore, disposables };\n    }\n    renderElement(element, index, data) {\n        const { completion } = element;\n        data.root.id = getAriaId(index);\n        data.colorspan.style.backgroundColor = '';\n        const labelOptions = {\n            labelEscapeNewLines: true,\n            matches: createMatches(element.score)\n        };\n        const color = [];\n        if (completion.kind === 19 /* CompletionItemKind.Color */ && _completionItemColor.extract(element, color)) {\n            // special logic for 'color' completion items\n            data.icon.className = 'icon customcolor';\n            data.iconContainer.className = 'icon hide';\n            data.colorspan.style.backgroundColor = color[0];\n        }\n        else if (completion.kind === 20 /* CompletionItemKind.File */ && this._themeService.getFileIconTheme().hasFileIcons) {\n            // special logic for 'file' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            const labelClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FILE);\n            const detailClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FILE);\n            labelOptions.extraClasses = labelClasses.length > detailClasses.length ? labelClasses : detailClasses;\n        }\n        else if (completion.kind === 23 /* CompletionItemKind.Folder */ && this._themeService.getFileIconTheme().hasFolderIcons) {\n            // special logic for 'folder' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            labelOptions.extraClasses = [\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FOLDER),\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FOLDER)\n            ].flat();\n        }\n        else {\n            // normal icon\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = '';\n            data.iconContainer.classList.add('suggest-icon', ...ThemeIcon.asClassNameArray(CompletionItemKinds.toIcon(completion.kind)));\n        }\n        if (completion.tags && completion.tags.indexOf(1 /* CompletionItemTag.Deprecated */) >= 0) {\n            labelOptions.extraClasses = (labelOptions.extraClasses || []).concat(['deprecated']);\n            labelOptions.matches = [];\n        }\n        data.iconLabel.setLabel(element.textLabel, undefined, labelOptions);\n        if (typeof completion.label === 'string') {\n            data.parametersLabel.textContent = '';\n            data.detailsLabel.textContent = stripNewLines(completion.detail || '');\n            data.root.classList.add('string-label');\n        }\n        else {\n            data.parametersLabel.textContent = stripNewLines(completion.label.detail || '');\n            data.detailsLabel.textContent = stripNewLines(completion.label.description || '');\n            data.root.classList.remove('string-label');\n        }\n        if (this._editor.getOption(114 /* EditorOption.suggest */).showInlineDetails) {\n            show(data.detailsLabel);\n        }\n        else {\n            hide(data.detailsLabel);\n        }\n        if (canExpandCompletionItem(element)) {\n            data.right.classList.add('can-expand-details');\n            show(data.readMore);\n            data.readMore.onmousedown = e => {\n                e.stopPropagation();\n                e.preventDefault();\n            };\n            data.readMore.onclick = e => {\n                e.stopPropagation();\n                e.preventDefault();\n                this._onDidToggleDetails.fire();\n            };\n        }\n        else {\n            data.right.classList.remove('can-expand-details');\n            hide(data.readMore);\n            data.readMore.onmousedown = null;\n            data.readMore.onclick = null;\n        }\n    }\n    disposeTemplate(templateData) {\n        templateData.disposables.dispose();\n    }\n};\nItemRenderer = __decorate([\n    __param(1, IModelService),\n    __param(2, ILanguageService),\n    __param(3, IThemeService)\n], ItemRenderer);\nfunction stripNewLines(str) {\n    return str.replace(/\\r\\n|\\r|\\n/g, '');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport { createCancelablePromise, disposableTimeout, TimeoutTimer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter, PauseableEmitter } from '../../../../base/common/event.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { clamp } from '../../../../base/common/numbers.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './media/suggest.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\nimport '../../symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { activeContrastBorder, editorForeground, editorWidgetBackground, editorWidgetBorder, listFocusHighlightForeground, listHighlightForeground, quickInputListFocusBackground, quickInputListFocusForeground, quickInputListFocusIconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\nimport { canExpandCompletionItem, SuggestDetailsOverlay, SuggestDetailsWidget } from './suggestWidgetDetails.js';\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\nimport { getListStyles } from '../../../../platform/theme/browser/defaultStyles.js';\n/**\n * Suggest widget colors\n */\nregisterColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hcDark: editorWidgetBackground, hcLight: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nregisterColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hcDark: editorWidgetBorder, hcLight: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nconst editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hcDark: editorForeground, hcLight: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nregisterColor('editorSuggestWidget.selectedForeground', { dark: quickInputListFocusForeground, light: quickInputListFocusForeground, hcDark: quickInputListFocusForeground, hcLight: quickInputListFocusForeground }, nls.localize('editorSuggestWidgetSelectedForeground', 'Foreground color of the selected entry in the suggest widget.'));\nregisterColor('editorSuggestWidget.selectedIconForeground', { dark: quickInputListFocusIconForeground, light: quickInputListFocusIconForeground, hcDark: quickInputListFocusIconForeground, hcLight: quickInputListFocusIconForeground }, nls.localize('editorSuggestWidgetSelectedIconForeground', 'Icon foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: quickInputListFocusBackground, light: quickInputListFocusBackground, hcDark: quickInputListFocusBackground, hcLight: quickInputListFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nregisterColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hcDark: listHighlightForeground, hcLight: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\nregisterColor('editorSuggestWidget.focusHighlightForeground', { dark: listFocusHighlightForeground, light: listFocusHighlightForeground, hcDark: listFocusHighlightForeground, hcLight: listFocusHighlightForeground }, nls.localize('editorSuggestWidgetFocusHighlightForeground', 'Color of the match highlights in the suggest widget when an item is focused.'));\nregisterColor('editorSuggestWidgetStatus.foreground', { dark: transparent(editorSuggestWidgetForeground, .5), light: transparent(editorSuggestWidgetForeground, .5), hcDark: transparent(editorSuggestWidgetForeground, .5), hcLight: transparent(editorSuggestWidgetForeground, .5) }, nls.localize('editorSuggestWidgetStatusForeground', 'Foreground color of the suggest widget status.'));\nclass PersistedWidgetSize {\n    constructor(_service, editor) {\n        this._service = _service;\n        this._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\n    }\n    restore() {\n        var _a;\n        const raw = (_a = this._service.get(this._key, 0 /* StorageScope.PROFILE */)) !== null && _a !== void 0 ? _a : '';\n        try {\n            const obj = JSON.parse(raw);\n            if (dom.Dimension.is(obj)) {\n                return dom.Dimension.lift(obj);\n            }\n        }\n        catch (_b) {\n            // ignore\n        }\n        return undefined;\n    }\n    store(size) {\n        this._service.store(this._key, JSON.stringify(size), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n    }\n    reset() {\n        this._service.remove(this._key, 0 /* StorageScope.PROFILE */);\n    }\n}\nexport let SuggestWidget = class SuggestWidget {\n    constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\n        this.editor = editor;\n        this._storageService = _storageService;\n        this._state = 0 /* State.Hidden */;\n        this._isAuto = false;\n        this._pendingLayout = new MutableDisposable();\n        this._pendingShowDetails = new MutableDisposable();\n        this._ignoreFocusEvents = false;\n        this._forceRenderingAbove = false;\n        this._explainMode = false;\n        this._showTimeout = new TimeoutTimer();\n        this._disposables = new DisposableStore();\n        this._onDidSelect = new PauseableEmitter();\n        this._onDidFocus = new PauseableEmitter();\n        this._onDidHide = new Emitter();\n        this._onDidShow = new Emitter();\n        this.onDidSelect = this._onDidSelect.event;\n        this.onDidFocus = this._onDidFocus.event;\n        this.onDidHide = this._onDidHide.event;\n        this.onDidShow = this._onDidShow.event;\n        this._onDetailsKeydown = new Emitter();\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\n        this.element = new ResizableHTMLElement();\n        this.element.domNode.classList.add('editor-widget', 'suggest-widget');\n        this._contentWidget = new SuggestContentWidget(this, editor);\n        this._persistedSize = new PersistedWidgetSize(_storageService, editor);\n        class ResizeState {\n            constructor(persistedSize, currentSize, persistHeight = false, persistWidth = false) {\n                this.persistedSize = persistedSize;\n                this.currentSize = currentSize;\n                this.persistHeight = persistHeight;\n                this.persistWidth = persistWidth;\n            }\n        }\n        let state;\n        this._disposables.add(this.element.onDidWillResize(() => {\n            this._contentWidget.lockPreference();\n            state = new ResizeState(this._persistedSize.restore(), this.element.size);\n        }));\n        this._disposables.add(this.element.onDidResize(e => {\n            var _a, _b, _c, _d;\n            this._resize(e.dimension.width, e.dimension.height);\n            if (state) {\n                state.persistHeight = state.persistHeight || !!e.north || !!e.south;\n                state.persistWidth = state.persistWidth || !!e.east || !!e.west;\n            }\n            if (!e.done) {\n                return;\n            }\n            if (state) {\n                // only store width or height value that have changed and also\n                // only store changes that are above a certain threshold\n                const { itemHeight, defaultSize } = this.getLayoutInfo();\n                const threshold = Math.round(itemHeight / 2);\n                let { width, height } = this.element.size;\n                if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\n                    height = (_b = (_a = state.persistedSize) === null || _a === void 0 ? void 0 : _a.height) !== null && _b !== void 0 ? _b : defaultSize.height;\n                }\n                if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\n                    width = (_d = (_c = state.persistedSize) === null || _c === void 0 ? void 0 : _c.width) !== null && _d !== void 0 ? _d : defaultSize.width;\n                }\n                this._persistedSize.store(new dom.Dimension(width, height));\n            }\n            // reset working state\n            this._contentWidget.unlockPreference();\n            state = undefined;\n        }));\n        this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\n        this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\n        const details = instantiationService.createInstance(SuggestDetailsWidget, this.editor);\n        details.onDidClose(this.toggleDetails, this, this._disposables);\n        this._details = new SuggestDetailsOverlay(details, this.editor);\n        const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(114 /* EditorOption.suggest */).showIcons);\n        applyIconStyle();\n        const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\n        this._disposables.add(renderer);\n        this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\n        this._list = new List('SuggestWidget', this._listElement, {\n            getHeight: (_element) => this.getLayoutInfo().itemHeight,\n            getTemplateId: (_element) => 'suggestion'\n        }, [renderer], {\n            alwaysConsumeMouseWheel: true,\n            useShadows: false,\n            mouseSupport: false,\n            multipleSelectionSupport: false,\n            accessibilityProvider: {\n                getRole: () => 'option',\n                getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\n                getWidgetRole: () => 'listbox',\n                getAriaLabel: (item) => {\n                    let label = item.textLabel;\n                    if (typeof item.completion.label !== 'string') {\n                        const { detail, description } = item.completion.label;\n                        if (detail && description) {\n                            label = nls.localize('label.full', '{0}{1}, {2}', label, detail, description);\n                        }\n                        else if (detail) {\n                            label = nls.localize('label.detail', '{0}{1}', label, detail);\n                        }\n                        else if (description) {\n                            label = nls.localize('label.desc', '{0}, {1}', label, description);\n                        }\n                    }\n                    if (!item.isResolved || !this._isDetailsVisible()) {\n                        return label;\n                    }\n                    const { documentation, detail } = item.completion;\n                    const docs = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\n                    return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", label, docs);\n                },\n            }\n        });\n        this._list.style(getListStyles({\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n            listInactiveFocusOutline: activeContrastBorder\n        }));\n        this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode, suggestWidgetStatusbarMenu);\n        const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(114 /* EditorOption.suggest */).showStatusBar);\n        applyStatusBarStyle();\n        this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\n        this._onThemeChange(_themeService.getColorTheme());\n        this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\n        this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\n        this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\n        this._disposables.add(this.editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(114 /* EditorOption.suggest */)) {\n                applyStatusBarStyle();\n                applyIconStyle();\n            }\n        }));\n        this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetHasFocusedSuggestion = SuggestContext.HasFocusedSuggestion.bindTo(_contextKeyService);\n        this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\n            this._onDetailsKeydown.fire(e);\n        }));\n        this._disposables.add(this.editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n    }\n    dispose() {\n        var _a;\n        this._details.widget.dispose();\n        this._details.dispose();\n        this._list.dispose();\n        this._status.dispose();\n        this._disposables.dispose();\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._pendingLayout.dispose();\n        this._pendingShowDetails.dispose();\n        this._showTimeout.dispose();\n        this._contentWidget.dispose();\n        this.element.dispose();\n    }\n    _onEditorMouseDown(mouseEvent) {\n        if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\n            // Clicking inside details\n            this._details.widget.domNode.focus();\n        }\n        else {\n            // Clicking outside details and inside suggest\n            if (this.element.domNode.contains(mouseEvent.target.element)) {\n                this.editor.focus();\n            }\n        }\n    }\n    _onCursorSelectionChanged() {\n        if (this._state !== 0 /* State.Hidden */) {\n            this._contentWidget.layout();\n        }\n    }\n    _onListMouseDownOrTap(e) {\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n            return;\n        }\n        // prevent stealing browser focus from the editor\n        e.browserEvent.preventDefault();\n        e.browserEvent.stopPropagation();\n        this._select(e.element, e.index);\n    }\n    _onListSelection(e) {\n        if (e.elements.length) {\n            this._select(e.elements[0], e.indexes[0]);\n        }\n    }\n    _select(item, index) {\n        const completionModel = this._completionModel;\n        if (completionModel) {\n            this._onDidSelect.fire({ item, index, model: completionModel });\n            this.editor.focus();\n        }\n    }\n    _onThemeChange(theme) {\n        this._details.widget.borderWidth = isHighContrast(theme.type) ? 2 : 1;\n    }\n    _onListFocus(e) {\n        var _a;\n        if (this._ignoreFocusEvents) {\n            return;\n        }\n        if (!e.elements.length) {\n            if (this._currentSuggestionDetails) {\n                this._currentSuggestionDetails.cancel();\n                this._currentSuggestionDetails = undefined;\n                this._focusedItem = undefined;\n            }\n            this.editor.setAriaOptions({ activeDescendant: undefined });\n            this._ctxSuggestWidgetHasFocusedSuggestion.set(false);\n            return;\n        }\n        if (!this._completionModel) {\n            return;\n        }\n        this._ctxSuggestWidgetHasFocusedSuggestion.set(true);\n        const item = e.elements[0];\n        const index = e.indexes[0];\n        if (item !== this._focusedItem) {\n            (_a = this._currentSuggestionDetails) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._currentSuggestionDetails = undefined;\n            this._focusedItem = item;\n            this._list.reveal(index);\n            this._currentSuggestionDetails = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\n                const loading = disposableTimeout(() => {\n                    if (this._isDetailsVisible()) {\n                        this.showDetails(true);\n                    }\n                }, 250);\n                const sub = token.onCancellationRequested(() => loading.dispose());\n                const result = yield item.resolve(token);\n                loading.dispose();\n                sub.dispose();\n                return result;\n            }));\n            this._currentSuggestionDetails.then(() => {\n                if (index >= this._list.length || item !== this._list.element(index)) {\n                    return;\n                }\n                // item can have extra information, so re-render\n                this._ignoreFocusEvents = true;\n                this._list.splice(index, 1, [item]);\n                this._list.setFocus([index]);\n                this._ignoreFocusEvents = false;\n                if (this._isDetailsVisible()) {\n                    this.showDetails(false);\n                }\n                else {\n                    this.element.domNode.classList.remove('docs-side');\n                }\n                this.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\n            }).catch(onUnexpectedError);\n        }\n        // emit an event\n        this._onDidFocus.fire({ item, index, model: this._completionModel });\n    }\n    _setState(state) {\n        if (this._state === state) {\n            return;\n        }\n        this._state = state;\n        this.element.domNode.classList.toggle('frozen', state === 4 /* State.Frozen */);\n        this.element.domNode.classList.remove('message');\n        switch (state) {\n            case 0 /* State.Hidden */:\n                dom.hide(this._messageElement, this._listElement, this._status.element);\n                this._details.hide(true);\n                this._status.hide();\n                this._contentWidget.hide();\n                this._ctxSuggestWidgetVisible.reset();\n                this._ctxSuggestWidgetMultipleSuggestions.reset();\n                this._ctxSuggestWidgetHasFocusedSuggestion.reset();\n                this._showTimeout.cancel();\n                this.element.domNode.classList.remove('visible');\n                this._list.splice(0, this._list.length);\n                this._focusedItem = undefined;\n                this._cappedHeight = undefined;\n                this._explainMode = false;\n                break;\n            case 1 /* State.Loading */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                break;\n            case 2 /* State.Empty */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                break;\n            case 3 /* State.Open */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 4 /* State.Frozen */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 5 /* State.Details */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._details.show();\n                this._show();\n                break;\n        }\n    }\n    _show() {\n        this._status.show();\n        this._contentWidget.show();\n        this._layout(this._persistedSize.restore());\n        this._ctxSuggestWidgetVisible.set(true);\n        this._showTimeout.cancelAndSet(() => {\n            this.element.domNode.classList.add('visible');\n            this._onDidShow.fire(this);\n        }, 100);\n    }\n    showTriggered(auto, delay) {\n        if (this._state !== 0 /* State.Hidden */) {\n            return;\n        }\n        this._contentWidget.setPosition(this.editor.getPosition());\n        this._isAuto = !!auto;\n        if (!this._isAuto) {\n            this._loadingTimeout = disposableTimeout(() => this._setState(1 /* State.Loading */), delay);\n        }\n    }\n    showSuggestions(completionModel, selectionIndex, isFrozen, isAuto, noFocus) {\n        var _a, _b;\n        this._contentWidget.setPosition(this.editor.getPosition());\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentSuggestionDetails) === null || _b === void 0 ? void 0 : _b.cancel();\n        this._currentSuggestionDetails = undefined;\n        if (this._completionModel !== completionModel) {\n            this._completionModel = completionModel;\n        }\n        if (isFrozen && this._state !== 2 /* State.Empty */ && this._state !== 0 /* State.Hidden */) {\n            this._setState(4 /* State.Frozen */);\n            return;\n        }\n        const visibleCount = this._completionModel.items.length;\n        const isEmpty = visibleCount === 0;\n        this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\n        if (isEmpty) {\n            this._setState(isAuto ? 0 /* State.Hidden */ : 2 /* State.Empty */);\n            this._completionModel = undefined;\n            return;\n        }\n        this._focusedItem = undefined;\n        // calling list.splice triggers focus event which this widget forwards. That can lead to\n        // suggestions being cancelled and the widget being cleared (and hidden). All this happens\n        // before revealing and focusing is done which means revealing and focusing will fail when\n        // they get run.\n        this._onDidFocus.pause();\n        this._onDidSelect.pause();\n        try {\n            this._list.splice(0, this._list.length, this._completionModel.items);\n            this._setState(isFrozen ? 4 /* State.Frozen */ : 3 /* State.Open */);\n            this._list.reveal(selectionIndex, 0);\n            this._list.setFocus(noFocus ? [] : [selectionIndex]);\n        }\n        finally {\n            this._onDidFocus.resume();\n            this._onDidSelect.resume();\n        }\n        this._pendingLayout.value = dom.runAtThisOrScheduleAtNextAnimationFrame(() => {\n            this._pendingLayout.clear();\n            this._layout(this.element.size);\n            // Reset focus border\n            this._details.widget.domNode.classList.remove('focused');\n        });\n    }\n    focusSelected() {\n        if (this._list.length > 0) {\n            this._list.setFocus([0]);\n        }\n    }\n    selectNextPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageDown();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNextPage();\n                return true;\n        }\n    }\n    selectNext() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNext(1, true);\n                return true;\n        }\n    }\n    selectLast() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollBottom();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusLast();\n                return true;\n        }\n    }\n    selectPreviousPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageUp();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPreviousPage();\n                return true;\n        }\n    }\n    selectPrevious() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPrevious(1, true);\n                return false;\n        }\n    }\n    selectFirst() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollTop();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusFirst();\n                return true;\n        }\n    }\n    getFocusedItem() {\n        if (this._state !== 0 /* State.Hidden */\n            && this._state !== 2 /* State.Empty */\n            && this._state !== 1 /* State.Loading */\n            && this._completionModel\n            && this._list.getFocus().length > 0) {\n            return {\n                item: this._list.getFocusedElements()[0],\n                index: this._list.getFocus()[0],\n                model: this._completionModel\n            };\n        }\n        return undefined;\n    }\n    toggleDetailsFocus() {\n        if (this._state === 5 /* State.Details */) {\n            this._setState(3 /* State.Open */);\n            this._details.widget.domNode.classList.remove('focused');\n        }\n        else if (this._state === 3 /* State.Open */ && this._isDetailsVisible()) {\n            this._setState(5 /* State.Details */);\n            this._details.widget.domNode.classList.add('focused');\n        }\n    }\n    toggleDetails() {\n        if (this._isDetailsVisible()) {\n            // hide details widget\n            this._pendingShowDetails.clear();\n            this._ctxSuggestWidgetDetailsVisible.set(false);\n            this._setDetailsVisible(false);\n            this._details.hide();\n            this.element.domNode.classList.remove('shows-details');\n        }\n        else if ((canExpandCompletionItem(this._list.getFocusedElements()[0]) || this._explainMode) && (this._state === 3 /* State.Open */ || this._state === 5 /* State.Details */ || this._state === 4 /* State.Frozen */)) {\n            // show details widget (iff possible)\n            this._ctxSuggestWidgetDetailsVisible.set(true);\n            this._setDetailsVisible(true);\n            this.showDetails(false);\n        }\n    }\n    showDetails(loading) {\n        this._pendingShowDetails.value = dom.runAtThisOrScheduleAtNextAnimationFrame(() => {\n            this._pendingShowDetails.clear();\n            this._details.show();\n            if (loading) {\n                this._details.widget.renderLoading();\n            }\n            else {\n                this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\n            }\n            this._positionDetails();\n            this.editor.focus();\n            this.element.domNode.classList.add('shows-details');\n        });\n    }\n    toggleExplainMode() {\n        if (this._list.getFocusedElements()[0]) {\n            this._explainMode = !this._explainMode;\n            if (!this._isDetailsVisible()) {\n                this.toggleDetails();\n            }\n            else {\n                this.showDetails(false);\n            }\n        }\n    }\n    resetPersistedSize() {\n        this._persistedSize.reset();\n    }\n    hideWidget() {\n        var _a;\n        this._pendingLayout.clear();\n        this._pendingShowDetails.clear();\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._setState(0 /* State.Hidden */);\n        this._onDidHide.fire(this);\n        this.element.clearSashHoverState();\n        // ensure that a reasonable widget height is persisted so that\n        // accidential \"resize-to-single-items\" cases aren't happening\n        const dim = this._persistedSize.restore();\n        const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\n        if (dim && dim.height < minPersistedHeight) {\n            this._persistedSize.store(dim.with(undefined, minPersistedHeight));\n        }\n    }\n    isFrozen() {\n        return this._state === 4 /* State.Frozen */;\n    }\n    _afterRender(position) {\n        if (position === null) {\n            if (this._isDetailsVisible()) {\n                this._details.hide(); //todo@jrieken soft-hide\n            }\n            return;\n        }\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // no special positioning when widget isn't showing list\n            return;\n        }\n        if (this._isDetailsVisible()) {\n            this._details.show();\n        }\n        this._positionDetails();\n    }\n    _layout(size) {\n        var _a, _b, _c;\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (!this.editor.getDomNode()) {\n            // happens when running tests\n            return;\n        }\n        const bodyBox = dom.getClientArea(document.body);\n        const info = this.getLayoutInfo();\n        if (!size) {\n            size = info.defaultSize;\n        }\n        let height = size.height;\n        let width = size.width;\n        // status bar\n        this._status.element.style.height = `${info.itemHeight}px`;\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // showing a message only\n            height = info.itemHeight + info.borderHeight;\n            width = info.defaultSize.width / 2;\n            this.element.enableSashes(false, false, false, false);\n            this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\n            this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n        else {\n            // showing items\n            // width math\n            const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\n            if (width > maxWidth) {\n                width = maxWidth;\n            }\n            const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\n            // height math\n            const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\n            const minHeight = info.itemHeight + info.statusBarHeight;\n            const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\n            const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n            const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\n            const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\n            const availableSpaceAbove = editorBox.top + cursorBox.top - info.verticalPadding;\n            const maxHeightAbove = Math.min(availableSpaceAbove, fullHeight);\n            let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\n            if (height === ((_a = this._cappedHeight) === null || _a === void 0 ? void 0 : _a.capped)) {\n                // Restore the old (wanted) height when the current\n                // height is capped to fit\n                height = this._cappedHeight.wanted;\n            }\n            if (height < minHeight) {\n                height = minHeight;\n            }\n            if (height > maxHeight) {\n                height = maxHeight;\n            }\n            const forceRenderingAboveRequiredSpace = 150;\n            if (height > maxHeightBelow || (this._forceRenderingAbove && availableSpaceAbove > forceRenderingAboveRequiredSpace)) {\n                this._contentWidget.setPreference(1 /* ContentWidgetPositionPreference.ABOVE */);\n                this.element.enableSashes(true, true, false, false);\n                maxHeight = maxHeightAbove;\n            }\n            else {\n                this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n                this.element.enableSashes(false, true, true, false);\n                maxHeight = maxHeightBelow;\n            }\n            this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\n            this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\n            this.element.minSize = new dom.Dimension(220, minHeight);\n            // Know when the height was capped to fit and remember\n            // the wanted height for later. This is required when going\n            // left to widen suggestions.\n            this._cappedHeight = height === fullHeight\n                ? { wanted: (_c = (_b = this._cappedHeight) === null || _b === void 0 ? void 0 : _b.wanted) !== null && _c !== void 0 ? _c : size.height, capped: height }\n                : undefined;\n        }\n        this._resize(width, height);\n    }\n    _resize(width, height) {\n        const { width: maxWidth, height: maxHeight } = this.element.maxSize;\n        width = Math.min(maxWidth, width);\n        height = Math.min(maxHeight, height);\n        const { statusBarHeight } = this.getLayoutInfo();\n        this._list.layout(height - statusBarHeight, width);\n        this._listElement.style.height = `${height - statusBarHeight}px`;\n        this.element.layout(height, width);\n        this._contentWidget.layout();\n        this._positionDetails();\n    }\n    _positionDetails() {\n        var _a;\n        if (this._isDetailsVisible()) {\n            this._details.placeAtAnchor(this.element.domNode, ((_a = this._contentWidget.getPosition()) === null || _a === void 0 ? void 0 : _a.preference[0]) === 2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n    }\n    getLayoutInfo() {\n        const fontInfo = this.editor.getOption(48 /* EditorOption.fontInfo */);\n        const itemHeight = clamp(this.editor.getOption(116 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight, 8, 1000);\n        const statusBarHeight = !this.editor.getOption(114 /* EditorOption.suggest */).showStatusBar || this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */ ? 0 : itemHeight;\n        const borderWidth = this._details.widget.borderWidth;\n        const borderHeight = 2 * borderWidth;\n        return {\n            itemHeight,\n            statusBarHeight,\n            borderWidth,\n            borderHeight,\n            typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\n            verticalPadding: 22,\n            horizontalPadding: 14,\n            defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\n        };\n    }\n    _isDetailsVisible() {\n        return this._storageService.getBoolean('expandSuggestionDocs', 0 /* StorageScope.PROFILE */, false);\n    }\n    _setDetailsVisible(value) {\n        this._storageService.store('expandSuggestionDocs', value, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n    }\n    forceRenderingAbove() {\n        if (!this._forceRenderingAbove) {\n            this._forceRenderingAbove = true;\n            this._layout(this._persistedSize.restore());\n        }\n    }\n    stopForceRenderingAbove() {\n        this._forceRenderingAbove = false;\n    }\n};\nSuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\nSuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\nSuggestWidget = __decorate([\n    __param(1, IStorageService),\n    __param(2, IContextKeyService),\n    __param(3, IThemeService),\n    __param(4, IInstantiationService)\n], SuggestWidget);\nexport class SuggestContentWidget {\n    constructor(_widget, _editor) {\n        this._widget = _widget;\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._preferenceLocked = false;\n        this._added = false;\n        this._hidden = false;\n    }\n    dispose() {\n        if (this._added) {\n            this._added = false;\n            this._editor.removeContentWidget(this);\n        }\n    }\n    getId() {\n        return 'editor.widget.suggestWidget';\n    }\n    getDomNode() {\n        return this._widget.element.domNode;\n    }\n    show() {\n        this._hidden = false;\n        if (!this._added) {\n            this._added = true;\n            this._editor.addContentWidget(this);\n        }\n    }\n    hide() {\n        if (!this._hidden) {\n            this._hidden = true;\n            this.layout();\n        }\n    }\n    layout() {\n        this._editor.layoutContentWidget(this);\n    }\n    getPosition() {\n        if (this._hidden || !this._position || !this._preference) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [this._preference]\n        };\n    }\n    beforeRender() {\n        const { height, width } = this._widget.element.size;\n        const { borderWidth, horizontalPadding } = this._widget.getLayoutInfo();\n        return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\n    }\n    afterRender(position) {\n        this._widget._afterRender(position);\n    }\n    setPreference(preference) {\n        if (!this._preferenceLocked) {\n            this._preference = preference;\n        }\n    }\n    lockPreference() {\n        this._preferenceLocked = true;\n    }\n    unlockPreference() {\n        this._preferenceLocked = false;\n    }\n    setPosition(position) {\n        this._position = position;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { IdleValue } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { KeyCodeChord } from '../../../../base/common/keybindings.js';\nimport { DisposableStore, dispose, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType, isObject } from '../../../../base/common/types.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { WordContextKey } from './wordContextKey.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\nimport { SuggestAlternatives } from './suggestAlternatives.js';\nimport { CommitCharacterController } from './suggestCommitCharacters.js';\nimport { SuggestModel } from './suggestModel.js';\nimport { OvertypingCapturer } from './suggestOvertypingCapturer.js';\nimport { SuggestWidget } from './suggestWidget.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { basename, extname } from '../../../../base/common/resources.js';\nimport { hash } from '../../../../base/common/hash.js';\n// sticky suggest widget which doesn't disappear on focus out and such\nconst _sticky = false;\nclass LineSuffix {\n    constructor(_model, _position) {\n        this._model = _model;\n        this._position = _position;\n        // spy on what's happening right of the cursor. two cases:\n        // 1. end of line -> check that it's still end of line\n        // 2. mid of line -> add a marker and compute the delta\n        const maxColumn = _model.getLineMaxColumn(_position.lineNumber);\n        if (maxColumn !== _position.column) {\n            const offset = _model.getOffsetAt(_position);\n            const end = _model.getPositionAt(offset + 1);\n            this._marker = _model.deltaDecorations([], [{\n                    range: Range.fromPositions(_position, end),\n                    options: { description: 'suggest-line-suffix', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */ }\n                }]);\n        }\n    }\n    dispose() {\n        if (this._marker && !this._model.isDisposed()) {\n            this._model.deltaDecorations(this._marker, []);\n        }\n    }\n    delta(position) {\n        if (this._model.isDisposed() || this._position.lineNumber !== position.lineNumber) {\n            // bail out early if things seems fishy\n            return 0;\n        }\n        // read the marker (in case suggest was triggered at line end) or compare\n        // the cursor to the line end.\n        if (this._marker) {\n            const range = this._model.getDecorationRange(this._marker[0]);\n            const end = this._model.getOffsetAt(range.getStartPosition());\n            return end - this._model.getOffsetAt(position);\n        }\n        else {\n            return this._model.getLineMaxColumn(position.lineNumber) - position.column;\n        }\n    }\n}\nexport let SuggestController = class SuggestController {\n    static get(editor) {\n        return editor.getContribution(SuggestController.ID);\n    }\n    constructor(editor, _memoryService, _commandService, _contextKeyService, _instantiationService, _logService, _telemetryService) {\n        this._memoryService = _memoryService;\n        this._commandService = _commandService;\n        this._contextKeyService = _contextKeyService;\n        this._instantiationService = _instantiationService;\n        this._logService = _logService;\n        this._telemetryService = _telemetryService;\n        this._lineSuffix = new MutableDisposable();\n        this._toDispose = new DisposableStore();\n        this._selectors = new PriorityRegistry(s => s.priority);\n        this._telemetryGate = 0;\n        this.editor = editor;\n        this.model = _instantiationService.createInstance(SuggestModel, this.editor);\n        // default selector\n        this._selectors.register({\n            priority: 0,\n            select: (model, pos, items) => this._memoryService.select(model, pos, items)\n        });\n        // context key: update insert/replace mode\n        const ctxInsertMode = SuggestContext.InsertMode.bindTo(_contextKeyService);\n        ctxInsertMode.set(editor.getOption(114 /* EditorOption.suggest */).insertMode);\n        this.model.onDidTrigger(() => ctxInsertMode.set(editor.getOption(114 /* EditorOption.suggest */).insertMode));\n        this.widget = this._toDispose.add(new IdleValue(() => {\n            const widget = this._instantiationService.createInstance(SuggestWidget, this.editor);\n            this._toDispose.add(widget);\n            this._toDispose.add(widget.onDidSelect(item => this._insertSuggestion(item, 0 /* InsertFlags.None */), this));\n            // Wire up logic to accept a suggestion on certain characters\n            const commitCharacterController = new CommitCharacterController(this.editor, widget, this.model, item => this._insertSuggestion(item, 2 /* InsertFlags.NoAfterUndoStop */));\n            this._toDispose.add(commitCharacterController);\n            // Wire up makes text edit context key\n            const ctxMakesTextEdit = SuggestContext.MakesTextEdit.bindTo(this._contextKeyService);\n            const ctxHasInsertAndReplace = SuggestContext.HasInsertAndReplaceRange.bindTo(this._contextKeyService);\n            const ctxCanResolve = SuggestContext.CanResolve.bindTo(this._contextKeyService);\n            this._toDispose.add(toDisposable(() => {\n                ctxMakesTextEdit.reset();\n                ctxHasInsertAndReplace.reset();\n                ctxCanResolve.reset();\n            }));\n            this._toDispose.add(widget.onDidFocus(({ item }) => {\n                // (ctx: makesTextEdit)\n                const position = this.editor.getPosition();\n                const startColumn = item.editStart.column;\n                const endColumn = position.column;\n                let value = true;\n                if (this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */) === 'smart'\n                    && this.model.state === 2 /* State.Auto */\n                    && !item.completion.additionalTextEdits\n                    && !(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)\n                    && endColumn - startColumn === item.completion.insertText.length) {\n                    const oldText = this.editor.getModel().getValueInRange({\n                        startLineNumber: position.lineNumber,\n                        startColumn,\n                        endLineNumber: position.lineNumber,\n                        endColumn\n                    });\n                    value = oldText !== item.completion.insertText;\n                }\n                ctxMakesTextEdit.set(value);\n                // (ctx: hasInsertAndReplaceRange)\n                ctxHasInsertAndReplace.set(!Position.equals(item.editInsertEnd, item.editReplaceEnd));\n                // (ctx: canResolve)\n                ctxCanResolve.set(Boolean(item.provider.resolveCompletionItem) || Boolean(item.completion.documentation) || item.completion.detail !== item.completion.label);\n            }));\n            this._toDispose.add(widget.onDetailsKeyDown(e => {\n                // cmd + c on macOS, ctrl + c on Win / Linux\n                if (e.toKeyCodeChord().equals(new KeyCodeChord(true, false, false, false, 33 /* KeyCode.KeyC */)) ||\n                    (platform.isMacintosh && e.toKeyCodeChord().equals(new KeyCodeChord(false, false, false, true, 33 /* KeyCode.KeyC */)))) {\n                    e.stopPropagation();\n                    return;\n                }\n                if (!e.toKeyCodeChord().isModifierKey()) {\n                    this.editor.focus();\n                }\n            }));\n            return widget;\n        }));\n        // Wire up text overtyping capture\n        this._overtypingCapturer = this._toDispose.add(new IdleValue(() => {\n            return this._toDispose.add(new OvertypingCapturer(this.editor, this.model));\n        }));\n        this._alternatives = this._toDispose.add(new IdleValue(() => {\n            return this._toDispose.add(new SuggestAlternatives(this.editor, this._contextKeyService));\n        }));\n        this._toDispose.add(_instantiationService.createInstance(WordContextKey, editor));\n        this._toDispose.add(this.model.onDidTrigger(e => {\n            this.widget.value.showTriggered(e.auto, e.shy ? 250 : 50);\n            this._lineSuffix.value = new LineSuffix(this.editor.getModel(), e.position);\n        }));\n        this._toDispose.add(this.model.onDidSuggest(e => {\n            if (e.triggerOptions.shy) {\n                return;\n            }\n            let index = -1;\n            for (const selector of this._selectors.itemsOrderedByPriorityDesc) {\n                index = selector.select(this.editor.getModel(), this.editor.getPosition(), e.completionModel.items);\n                if (index !== -1) {\n                    break;\n                }\n            }\n            if (index === -1) {\n                index = 0;\n            }\n            let noFocus = false;\n            if (e.triggerOptions.auto) {\n                // don't \"focus\" item when configured to do\n                const options = this.editor.getOption(114 /* EditorOption.suggest */);\n                if (options.selectionMode === 'never' || options.selectionMode === 'always') {\n                    // simple: always or never\n                    noFocus = options.selectionMode === 'never';\n                }\n                else if (options.selectionMode === 'whenTriggerCharacter') {\n                    // on with trigger character\n                    noFocus = e.triggerOptions.triggerKind !== 1 /* CompletionTriggerKind.TriggerCharacter */;\n                }\n                else if (options.selectionMode === 'whenQuickSuggestion') {\n                    // without trigger character or when refiltering\n                    noFocus = e.triggerOptions.triggerKind === 1 /* CompletionTriggerKind.TriggerCharacter */ && !e.triggerOptions.refilter;\n                }\n            }\n            this.widget.value.showSuggestions(e.completionModel, index, e.isFrozen, e.triggerOptions.auto, noFocus);\n        }));\n        this._toDispose.add(this.model.onDidCancel(e => {\n            if (!e.retrigger) {\n                this.widget.value.hideWidget();\n            }\n        }));\n        this._toDispose.add(this.editor.onDidBlurEditorWidget(() => {\n            if (!_sticky) {\n                this.model.cancel();\n                this.model.clear();\n            }\n        }));\n        // Manage the acceptSuggestionsOnEnter context key\n        const acceptSuggestionsOnEnter = SuggestContext.AcceptSuggestionsOnEnter.bindTo(_contextKeyService);\n        const updateFromConfig = () => {\n            const acceptSuggestionOnEnter = this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */);\n            acceptSuggestionsOnEnter.set(acceptSuggestionOnEnter === 'on' || acceptSuggestionOnEnter === 'smart');\n        };\n        this._toDispose.add(this.editor.onDidChangeConfiguration(() => updateFromConfig()));\n        updateFromConfig();\n    }\n    dispose() {\n        this._alternatives.dispose();\n        this._toDispose.dispose();\n        this.widget.dispose();\n        this.model.dispose();\n        this._lineSuffix.dispose();\n    }\n    _insertSuggestion(event, flags) {\n        if (!event || !event.item) {\n            this._alternatives.value.reset();\n            this.model.cancel();\n            this.model.clear();\n            return;\n        }\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const snippetController = SnippetController2.get(this.editor);\n        if (!snippetController) {\n            return;\n        }\n        const model = this.editor.getModel();\n        const modelVersionNow = model.getAlternativeVersionId();\n        const { item } = event;\n        //\n        const tasks = [];\n        const cts = new CancellationTokenSource();\n        // pushing undo stops *before* additional text edits and\n        // *after* the main edit\n        if (!(flags & 1 /* InsertFlags.NoBeforeUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        // compute overwrite[Before|After] deltas BEFORE applying extra edits\n        const info = this.getOverwriteInfo(item, Boolean(flags & 8 /* InsertFlags.AlternativeOverwriteConfig */));\n        // keep item in memory\n        this._memoryService.memorize(model, this.editor.getPosition(), item);\n        if (Array.isArray(item.completion.additionalTextEdits)) {\n            // cancel -> stops all listening and closes widget\n            this.model.cancel();\n            // sync additional edits\n            const scrollState = StableEditorScrollState.capture(this.editor);\n            this.editor.executeEdits('suggestController.additionalTextEdits.sync', item.completion.additionalTextEdits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n            scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n        }\n        else if (!item.isResolved) {\n            // async additional edits\n            const sw = new StopWatch(true);\n            let position;\n            const docListener = model.onDidChangeContent(e => {\n                if (e.isFlush) {\n                    cts.cancel();\n                    docListener.dispose();\n                    return;\n                }\n                for (const change of e.changes) {\n                    const thisPosition = Range.getEndPosition(change.range);\n                    if (!position || Position.isBefore(thisPosition, position)) {\n                        position = thisPosition;\n                    }\n                }\n            });\n            const oldFlags = flags;\n            flags |= 2 /* InsertFlags.NoAfterUndoStop */;\n            let didType = false;\n            const typeListener = this.editor.onWillType(() => {\n                typeListener.dispose();\n                didType = true;\n                if (!(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n            });\n            tasks.push(item.resolve(cts.token).then(() => {\n                if (!item.completion.additionalTextEdits || cts.token.isCancellationRequested) {\n                    return false;\n                }\n                if (position && item.completion.additionalTextEdits.some(edit => Position.isBefore(position, Range.getStartPosition(edit.range)))) {\n                    return false;\n                }\n                if (didType) {\n                    this.editor.pushUndoStop();\n                }\n                const scrollState = StableEditorScrollState.capture(this.editor);\n                this.editor.executeEdits('suggestController.additionalTextEdits.async', item.completion.additionalTextEdits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n                scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n                if (didType || !(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n                return true;\n            }).then(applied => {\n                this._logService.trace('[suggest] async resolving of edits DONE (ms, applied?)', sw.elapsed(), applied);\n                docListener.dispose();\n                typeListener.dispose();\n            }));\n        }\n        let { insertText } = item.completion;\n        if (!(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)) {\n            insertText = SnippetParser.escape(insertText);\n        }\n        // cancel -> stops all listening and closes widget\n        this.model.cancel();\n        snippetController.insert(insertText, {\n            overwriteBefore: info.overwriteBefore,\n            overwriteAfter: info.overwriteAfter,\n            undoStopBefore: false,\n            undoStopAfter: false,\n            adjustWhitespace: !(item.completion.insertTextRules & 1 /* CompletionItemInsertTextRule.KeepWhitespace */),\n            clipboardText: event.model.clipboardText,\n            overtypingCapturer: this._overtypingCapturer.value\n        });\n        if (!(flags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        if (item.completion.command) {\n            if (item.completion.command.id === TriggerSuggestAction.id) {\n                // retigger\n                this.model.trigger({ auto: true, retrigger: true });\n            }\n            else {\n                // exec command, done\n                tasks.push(this._commandService.executeCommand(item.completion.command.id, ...(item.completion.command.arguments ? [...item.completion.command.arguments] : [])).catch(e => {\n                    if (item.completion.extensionId) {\n                        onUnexpectedExternalError(e);\n                    }\n                    else {\n                        onUnexpectedError(e);\n                    }\n                }));\n            }\n        }\n        if (flags & 4 /* InsertFlags.KeepAlternativeSuggestions */) {\n            this._alternatives.value.set(event, next => {\n                // cancel resolving of additional edits\n                cts.cancel();\n                // this is not so pretty. when inserting the 'next'\n                // suggestion we undo until we are at the state at\n                // which we were before inserting the previous suggestion...\n                while (model.canUndo()) {\n                    if (modelVersionNow !== model.getAlternativeVersionId()) {\n                        model.undo();\n                    }\n                    this._insertSuggestion(next, 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */ | (flags & 8 /* InsertFlags.AlternativeOverwriteConfig */ ? 8 /* InsertFlags.AlternativeOverwriteConfig */ : 0));\n                    break;\n                }\n            });\n        }\n        this._alertCompletionItem(item);\n        // clear only now - after all tasks are done\n        Promise.all(tasks).finally(() => {\n            this._reportSuggestionAcceptedTelemetry(item, model, event);\n            this.model.clear();\n            cts.dispose();\n        });\n    }\n    _reportSuggestionAcceptedTelemetry(item, model, acceptedSuggestion) {\n        var _a;\n        if (this._telemetryGate++ % 100 !== 0) {\n            return;\n        }\n        // _debugDisplayName looks like `vscode.css-language-features(/-:)`, where the last bit is the trigger chars\n        // normalize it to just the extension ID and lowercase\n        const providerId = item.extensionId ? item.extensionId.value : ((_a = acceptedSuggestion.item.provider._debugDisplayName) !== null && _a !== void 0 ? _a : 'unknown').split('(', 1)[0].toLowerCase();\n        this._telemetryService.publicLog2('suggest.acceptedSuggestion', {\n            providerId,\n            kind: item.completion.kind,\n            basenameHash: hash(basename(model.uri)).toString(16),\n            languageId: model.getLanguageId(),\n            fileExtension: extname(model.uri),\n        });\n    }\n    getOverwriteInfo(item, toggleMode) {\n        assertType(this.editor.hasModel());\n        let replace = this.editor.getOption(114 /* EditorOption.suggest */).insertMode === 'replace';\n        if (toggleMode) {\n            replace = !replace;\n        }\n        const overwriteBefore = item.position.column - item.editStart.column;\n        const overwriteAfter = (replace ? item.editReplaceEnd.column : item.editInsertEnd.column) - item.position.column;\n        const columnDelta = this.editor.getPosition().column - item.position.column;\n        const suffixDelta = this._lineSuffix.value ? this._lineSuffix.value.delta(this.editor.getPosition()) : 0;\n        return {\n            overwriteBefore: overwriteBefore + columnDelta,\n            overwriteAfter: overwriteAfter + suffixDelta\n        };\n    }\n    _alertCompletionItem(item) {\n        if (isNonEmptyArray(item.completion.additionalTextEdits)) {\n            const msg = nls.localize('aria.alert.snippet', \"Accepting '{0}' made {1} additional edits\", item.textLabel, item.completion.additionalTextEdits.length);\n            alert(msg);\n        }\n    }\n    triggerSuggest(onlyFrom, auto, noFilter) {\n        if (this.editor.hasModel()) {\n            this.model.trigger({\n                auto: auto !== null && auto !== void 0 ? auto : false,\n                completionOptions: { providerFilter: onlyFrom, kindFilter: noFilter ? new Set() : undefined }\n            });\n            this.editor.revealPosition(this.editor.getPosition(), 0 /* ScrollType.Smooth */);\n            this.editor.focus();\n        }\n    }\n    triggerSuggestAndAcceptBest(arg) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const positionNow = this.editor.getPosition();\n        const fallback = () => {\n            if (positionNow.equals(this.editor.getPosition())) {\n                this._commandService.executeCommand(arg.fallback);\n            }\n        };\n        const makesTextEdit = (item) => {\n            if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */ || item.completion.additionalTextEdits) {\n                // snippet, other editor -> makes edit\n                return true;\n            }\n            const position = this.editor.getPosition();\n            const startColumn = item.editStart.column;\n            const endColumn = position.column;\n            if (endColumn - startColumn !== item.completion.insertText.length) {\n                // unequal lengths -> makes edit\n                return true;\n            }\n            const textNow = this.editor.getModel().getValueInRange({\n                startLineNumber: position.lineNumber,\n                startColumn,\n                endLineNumber: position.lineNumber,\n                endColumn\n            });\n            // unequal text -> makes edit\n            return textNow !== item.completion.insertText;\n        };\n        Event.once(this.model.onDidTrigger)(_ => {\n            // wait for trigger because only then the cancel-event is trustworthy\n            const listener = [];\n            Event.any(this.model.onDidTrigger, this.model.onDidCancel)(() => {\n                // retrigger or cancel -> try to type default text\n                dispose(listener);\n                fallback();\n            }, undefined, listener);\n            this.model.onDidSuggest(({ completionModel }) => {\n                dispose(listener);\n                if (completionModel.items.length === 0) {\n                    fallback();\n                    return;\n                }\n                const index = this._memoryService.select(this.editor.getModel(), this.editor.getPosition(), completionModel.items);\n                const item = completionModel.items[index];\n                if (!makesTextEdit(item)) {\n                    fallback();\n                    return;\n                }\n                this.editor.pushUndoStop();\n                this._insertSuggestion({ index, item, model: completionModel }, 4 /* InsertFlags.KeepAlternativeSuggestions */ | 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */);\n            }, undefined, listener);\n        });\n        this.model.trigger({ auto: false, shy: true });\n        this.editor.revealPosition(positionNow, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    acceptSelectedSuggestion(keepAlternativeSuggestions, alternativeOverwriteConfig) {\n        const item = this.widget.value.getFocusedItem();\n        let flags = 0;\n        if (keepAlternativeSuggestions) {\n            flags |= 4 /* InsertFlags.KeepAlternativeSuggestions */;\n        }\n        if (alternativeOverwriteConfig) {\n            flags |= 8 /* InsertFlags.AlternativeOverwriteConfig */;\n        }\n        this._insertSuggestion(item, flags);\n    }\n    acceptNextSuggestion() {\n        this._alternatives.value.next();\n    }\n    acceptPrevSuggestion() {\n        this._alternatives.value.prev();\n    }\n    cancelSuggestWidget() {\n        this.model.cancel();\n        this.model.clear();\n        this.widget.value.hideWidget();\n    }\n    focusSuggestion() {\n        this.widget.value.focusSelected();\n    }\n    selectNextSuggestion() {\n        this.widget.value.selectNext();\n    }\n    selectNextPageSuggestion() {\n        this.widget.value.selectNextPage();\n    }\n    selectLastSuggestion() {\n        this.widget.value.selectLast();\n    }\n    selectPrevSuggestion() {\n        this.widget.value.selectPrevious();\n    }\n    selectPrevPageSuggestion() {\n        this.widget.value.selectPreviousPage();\n    }\n    selectFirstSuggestion() {\n        this.widget.value.selectFirst();\n    }\n    toggleSuggestionDetails() {\n        this.widget.value.toggleDetails();\n    }\n    toggleExplainMode() {\n        this.widget.value.toggleExplainMode();\n    }\n    toggleSuggestionFocus() {\n        this.widget.value.toggleDetailsFocus();\n    }\n    resetWidgetSize() {\n        this.widget.value.resetPersistedSize();\n    }\n    forceRenderingAbove() {\n        this.widget.value.forceRenderingAbove();\n    }\n    stopForceRenderingAbove() {\n        if (!this.widget.isInitialized) {\n            // This method has no effect if the widget is not initialized yet.\n            return;\n        }\n        this.widget.value.stopForceRenderingAbove();\n    }\n    registerSelector(selector) {\n        return this._selectors.register(selector);\n    }\n};\nSuggestController.ID = 'editor.contrib.suggestController';\nSuggestController = __decorate([\n    __param(1, ISuggestMemoryService),\n    __param(2, ICommandService),\n    __param(3, IContextKeyService),\n    __param(4, IInstantiationService),\n    __param(5, ILogService),\n    __param(6, ITelemetryService)\n], SuggestController);\nclass PriorityRegistry {\n    constructor(prioritySelector) {\n        this.prioritySelector = prioritySelector;\n        this._items = new Array();\n    }\n    register(value) {\n        if (this._items.indexOf(value) !== -1) {\n            throw new Error('Value is already registered');\n        }\n        this._items.push(value);\n        this._items.sort((s1, s2) => this.prioritySelector(s2) - this.prioritySelector(s1));\n        return {\n            dispose: () => {\n                const idx = this._items.indexOf(value);\n                if (idx >= 0) {\n                    this._items.splice(idx, 1);\n                }\n            }\n        };\n    }\n    get itemsOrderedByPriorityDesc() {\n        return this._items;\n    }\n}\nexport class TriggerSuggestAction extends EditorAction {\n    constructor() {\n        super({\n            id: TriggerSuggestAction.id,\n            label: nls.localize('suggest.trigger.label', \"Trigger Suggest\"),\n            alias: 'Trigger Suggest',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCompletionItemProvider, SuggestContext.Visible.toNegated()),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [512 /* KeyMod.Alt */ | 9 /* KeyCode.Escape */, 2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        const controller = SuggestController.get(editor);\n        if (!controller) {\n            return;\n        }\n        let auto;\n        if (args && typeof args === 'object') {\n            if (args.auto === true) {\n                auto = true;\n            }\n        }\n        controller.triggerSuggest(undefined, auto, undefined);\n    }\n}\nTriggerSuggestAction.id = 'editor.action.triggerSuggest';\nregisterEditorContribution(SuggestController.ID, SuggestController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(TriggerSuggestAction);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 90;\nconst SuggestCommand = EditorCommand.bindToContribution(SuggestController.get);\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion),\n    handler(x) {\n        x.acceptSelectedSuggestion(true, false);\n    },\n    kbOpts: [{\n            // normal tab\n            primary: 2 /* KeyCode.Tab */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\n            weight,\n        }, {\n            // accept on enter has special rules\n            primary: 3 /* KeyCode.Enter */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.AcceptSuggestionsOnEnter, SuggestContext.MakesTextEdit),\n            weight,\n        }],\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: SuggestContext.HasInsertAndReplaceRange.toNegated()\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert'))\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.replace', \"Replace\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace'))\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptAlternativeSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.HasFocusedSuggestion),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n        secondary: [1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */],\n    },\n    handler(x) {\n        x.acceptSelectedSuggestion(false, true);\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert')),\n            title: nls.localize('accept.replace', \"Replace\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace')),\n            title: nls.localize('accept.insert', \"Insert\")\n        }]\n}));\n// continue to support the old command\nCommandsRegistry.registerCommandAlias('acceptSelectedSuggestionOnEnter', 'acceptSelectedSuggestion');\nregisterEditorCommand(new SuggestCommand({\n    id: 'hideSuggestWidget',\n    precondition: SuggestContext.Visible,\n    handler: x => x.cancelSuggestWidget(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 18 /* KeyCode.DownArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n        mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */, 256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectNextPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 12 /* KeyCode.PageDown */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 12 /* KeyCode.PageDown */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectLastSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectLastSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 16 /* KeyCode.UpArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n        mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */, 256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectPrevPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 11 /* KeyCode.PageUp */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 11 /* KeyCode.PageUp */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectFirstSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectFirstSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'focusSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion.negate()),\n    handler: x => x.focusSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] }\n    },\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'focusAndAcceptSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion.negate()),\n    handler: c => {\n        c.focusSuggestion();\n        c.acceptSelectedSuggestion(true, false);\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionDetails',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion),\n    handler: x => x.toggleSuggestionDetails(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] }\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible, SuggestContext.CanResolve),\n            title: nls.localize('detail.more', \"show less\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible.toNegated(), SuggestContext.CanResolve),\n            title: nls.localize('detail.less', \"show more\")\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleExplainMode',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleExplainMode(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */,\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionFocus',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleSuggestionFocus(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */,\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */ }\n    }\n}));\n//#region tab completions\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertBestCompletion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), WordContextKey.AtEnd, SuggestContext.Visible.toNegated(), SuggestAlternatives.OtherSuggestions.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: (x, arg) => {\n        x.triggerSuggestAndAcceptBest(isObject(arg) ? Object.assign({ fallback: 'tab' }, arg) : { fallback: 'tab' });\n    },\n    kbOpts: {\n        weight,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertNextSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertPrevSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorAction(class extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.resetSuggestSize',\n            label: nls.localize('suggest.reset.label', \"Reset Suggest Widget Size\"),\n            alias: 'Reset Suggest Widget Size',\n            precondition: undefined\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        (_a = SuggestController.get(editor)) === null || _a === void 0 ? void 0 : _a.resetWidgetSize();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { RefCountedDisposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CompletionModel, LineContext } from './completionModel.js';\nimport { CompletionOptions, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nclass SuggestInlineCompletion {\n    constructor(range, insertText, filterText, additionalTextEdits, command, completion) {\n        this.range = range;\n        this.insertText = insertText;\n        this.filterText = filterText;\n        this.additionalTextEdits = additionalTextEdits;\n        this.command = command;\n        this.completion = completion;\n    }\n}\nlet InlineCompletionResults = class InlineCompletionResults extends RefCountedDisposable {\n    constructor(model, line, word, completionModel, completions, _suggestMemoryService) {\n        super(completions.disposable);\n        this.model = model;\n        this.line = line;\n        this.word = word;\n        this.completionModel = completionModel;\n        this._suggestMemoryService = _suggestMemoryService;\n    }\n    canBeReused(model, line, word) {\n        return this.model === model // same model\n            && this.line === line\n            && this.word.word.length > 0\n            && this.word.startColumn === word.startColumn && this.word.endColumn < word.endColumn // same word\n            && this.completionModel.getIncompleteProvider().size === 0; // no incomplete results\n    }\n    get items() {\n        var _a;\n        const result = [];\n        // Split items by preselected index. This ensures the memory-selected item shows first and that better/worst\n        // ranked items are before/after\n        const { items } = this.completionModel;\n        const selectedIndex = this._suggestMemoryService.select(this.model, { lineNumber: this.line, column: this.word.endColumn + this.completionModel.lineContext.characterCountDelta }, items);\n        const first = Iterable.slice(items, selectedIndex);\n        const second = Iterable.slice(items, 0, selectedIndex);\n        let resolveCount = 5;\n        for (const item of Iterable.concat(first, second)) {\n            if (item.score === FuzzyScore.Default) {\n                // skip items that have no overlap\n                continue;\n            }\n            const range = new Range(item.editStart.lineNumber, item.editStart.column, item.editInsertEnd.lineNumber, item.editInsertEnd.column + this.completionModel.lineContext.characterCountDelta // end PLUS character delta\n            );\n            const insertText = item.completion.insertTextRules && (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)\n                ? { snippet: item.completion.insertText }\n                : item.completion.insertText;\n            result.push(new SuggestInlineCompletion(range, insertText, (_a = item.filterTextLow) !== null && _a !== void 0 ? _a : item.labelLow, item.completion.additionalTextEdits, item.completion.command, item));\n            // resolve the first N suggestions eagerly\n            if (resolveCount-- >= 0) {\n                item.resolve(CancellationToken.None);\n            }\n        }\n        return result;\n    }\n};\nInlineCompletionResults = __decorate([\n    __param(5, ISuggestMemoryService)\n], InlineCompletionResults);\nexport let SuggestInlineCompletions = class SuggestInlineCompletions {\n    constructor(_getEditorOption, _languageFeatureService, _clipboardService, _suggestMemoryService) {\n        this._getEditorOption = _getEditorOption;\n        this._languageFeatureService = _languageFeatureService;\n        this._clipboardService = _clipboardService;\n        this._suggestMemoryService = _suggestMemoryService;\n    }\n    provideInlineCompletions(model, position, context, token) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (context.selectedSuggestionInfo) {\n                return;\n            }\n            const config = this._getEditorOption(86 /* EditorOption.quickSuggestions */, model);\n            if (QuickSuggestionsOptions.isAllOff(config)) {\n                // quick suggest is off (for this model/language)\n                return;\n            }\n            model.tokenization.tokenizeIfCheap(position.lineNumber);\n            const lineTokens = model.tokenization.getLineTokens(position.lineNumber);\n            const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(position.column - 1 - 1, 0)));\n            if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'inline') {\n                // quick suggest is off (for this token)\n                return undefined;\n            }\n            // We consider non-empty leading words and trigger characters. The latter only\n            // when no word is being typed (word characters superseed trigger characters)\n            let wordInfo = model.getWordAtPosition(position);\n            let triggerCharacterInfo;\n            if (!(wordInfo === null || wordInfo === void 0 ? void 0 : wordInfo.word)) {\n                triggerCharacterInfo = this._getTriggerCharacterInfo(model, position);\n            }\n            if (!(wordInfo === null || wordInfo === void 0 ? void 0 : wordInfo.word) && !triggerCharacterInfo) {\n                // not at word, not a trigger character\n                return;\n            }\n            // ensure that we have word information and that we are at the end of a word\n            // otherwise we stop because we don't want to do quick suggestions inside words\n            if (!wordInfo) {\n                wordInfo = model.getWordUntilPosition(position);\n            }\n            if (wordInfo.endColumn !== position.column) {\n                return;\n            }\n            let result;\n            const leadingLineContents = model.getValueInRange(new Range(position.lineNumber, 1, position.lineNumber, position.column));\n            if (!triggerCharacterInfo && ((_a = this._lastResult) === null || _a === void 0 ? void 0 : _a.canBeReused(model, position.lineNumber, wordInfo))) {\n                // reuse a previous result iff possible, only a refilter is needed\n                // TODO@jrieken this can be improved further and only incomplete results can be updated\n                // console.log(`REUSE with ${wordInfo.word}`);\n                const newLineContext = new LineContext(leadingLineContents, position.column - this._lastResult.word.endColumn);\n                this._lastResult.completionModel.lineContext = newLineContext;\n                this._lastResult.acquire();\n                result = this._lastResult;\n            }\n            else {\n                // refesh model is required\n                const completions = yield provideSuggestionItems(this._languageFeatureService.completionProvider, model, position, new CompletionOptions(undefined, undefined, triggerCharacterInfo === null || triggerCharacterInfo === void 0 ? void 0 : triggerCharacterInfo.providers), triggerCharacterInfo && { triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */, triggerCharacter: triggerCharacterInfo.ch }, token);\n                let clipboardText;\n                if (completions.needsClipboard) {\n                    clipboardText = yield this._clipboardService.readText();\n                }\n                const completionModel = new CompletionModel(completions.items, position.column, new LineContext(leadingLineContents, 0), WordDistance.None, this._getEditorOption(114 /* EditorOption.suggest */, model), this._getEditorOption(108 /* EditorOption.snippetSuggestions */, model), { boostFullMatch: false, firstMatchCanBeWeak: false }, clipboardText);\n                result = new InlineCompletionResults(model, position.lineNumber, wordInfo, completionModel, completions, this._suggestMemoryService);\n            }\n            this._lastResult = result;\n            return result;\n        });\n    }\n    handleItemDidShow(_completions, item) {\n        item.completion.resolve(CancellationToken.None);\n    }\n    freeInlineCompletions(result) {\n        result.release();\n    }\n    _getTriggerCharacterInfo(model, position) {\n        var _a;\n        const ch = model.getValueInRange(Range.fromPositions({ lineNumber: position.lineNumber, column: position.column - 1 }, position));\n        const providers = new Set();\n        for (const provider of this._languageFeatureService.completionProvider.all(model)) {\n            if ((_a = provider.triggerCharacters) === null || _a === void 0 ? void 0 : _a.includes(ch)) {\n                providers.add(provider);\n            }\n        }\n        if (providers.size === 0) {\n            return undefined;\n        }\n        return { providers, ch };\n    }\n};\nSuggestInlineCompletions = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IClipboardService),\n    __param(3, ISuggestMemoryService)\n], SuggestInlineCompletions);\nlet EditorContribution = class EditorContribution {\n    constructor(_editor, languageFeatureService, editorService, instaService) {\n        // HACK - way to contribute something only once\n        if (++EditorContribution._counter === 1) {\n            const provider = instaService.createInstance(SuggestInlineCompletions, (id, model) => {\n                var _a;\n                // HACK - reuse the editor options world outside from a \"normal\" contribution\n                const editor = (_a = editorService.listCodeEditors().find(editor => editor.getModel() === model)) !== null && _a !== void 0 ? _a : _editor;\n                return editor.getOption(id);\n            });\n            EditorContribution._disposable = languageFeatureService.inlineCompletionsProvider.register('*', provider);\n        }\n    }\n    dispose() {\n        var _a;\n        if (--EditorContribution._counter === 0) {\n            (_a = EditorContribution._disposable) === null || _a === void 0 ? void 0 : _a.dispose();\n            EditorContribution._disposable = undefined;\n        }\n    }\n};\nEditorContribution._counter = 0;\nEditorContribution = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ICodeEditorService),\n    __param(3, IInstantiationService)\n], EditorContribution);\nregisterEditorContribution('suggest.inlineCompletionsProvider', EditorContribution, 0 /* EditorContributionInstantiation.Eager */); // eager because the contribution is used as a way to ONCE access a service to which a provider is registered\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { TernarySearchTree } from '../../../../base/common/ternarySearchTree.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, WillSaveStateReason } from '../../../../platform/storage/common/storage.js';\nexport class Memory {\n    constructor(name) {\n        this.name = name;\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const topScore = items[0].score[0];\n        for (let i = 0; i < items.length; i++) {\n            const { score, completion: suggestion } = items[i];\n            if (score[0] !== topScore) {\n                // stop when leaving the group of top matches\n                break;\n            }\n            if (suggestion.preselect) {\n                // stop when seeing an auto-select-item\n                return i;\n            }\n        }\n        return 0;\n    }\n}\nexport class NoMemory extends Memory {\n    constructor() {\n        super('first');\n    }\n    memorize(model, pos, item) {\n        // no-op\n    }\n    toJSON() {\n        return undefined;\n    }\n    fromJSON() {\n        //\n    }\n}\nexport class LRUMemory extends Memory {\n    constructor() {\n        super('recentlyUsed');\n        this._cache = new LRUCache(300, 0.66);\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const key = `${model.getLanguageId()}/${item.textLabel}`;\n        this._cache.set(key, {\n            touch: this._seq++,\n            type: item.completion.kind,\n            insertText: item.completion.insertText\n        });\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const lineSuffix = model.getLineContent(pos.lineNumber).substr(pos.column - 10, pos.column - 1);\n        if (/\\s$/.test(lineSuffix)) {\n            return super.select(model, pos, items);\n        }\n        const topScore = items[0].score[0];\n        let indexPreselect = -1;\n        let indexRecency = -1;\n        let seq = -1;\n        for (let i = 0; i < items.length; i++) {\n            if (items[i].score[0] !== topScore) {\n                // consider only top items\n                break;\n            }\n            const key = `${model.getLanguageId()}/${items[i].textLabel}`;\n            const item = this._cache.peek(key);\n            if (item && item.touch > seq && item.type === items[i].completion.kind && item.insertText === items[i].completion.insertText) {\n                seq = item.touch;\n                indexRecency = i;\n            }\n            if (items[i].completion.preselect && indexPreselect === -1) {\n                // stop when seeing an auto-select-item\n                return indexPreselect = i;\n            }\n        }\n        if (indexRecency !== -1) {\n            return indexRecency;\n        }\n        else if (indexPreselect !== -1) {\n            return indexPreselect;\n        }\n        else {\n            return 0;\n        }\n    }\n    toJSON() {\n        return this._cache.toJSON();\n    }\n    fromJSON(data) {\n        this._cache.clear();\n        const seq = 0;\n        for (const [key, value] of data) {\n            value.touch = seq;\n            value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n            this._cache.set(key, value);\n        }\n        this._seq = this._cache.size;\n    }\n}\nexport class PrefixMemory extends Memory {\n    constructor() {\n        super('recentlyUsedByPrefix');\n        this._trie = TernarySearchTree.forStrings();\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const { word } = model.getWordUntilPosition(pos);\n        const key = `${model.getLanguageId()}/${word}`;\n        this._trie.set(key, {\n            type: item.completion.kind,\n            insertText: item.completion.insertText,\n            touch: this._seq++\n        });\n    }\n    select(model, pos, items) {\n        const { word } = model.getWordUntilPosition(pos);\n        if (!word) {\n            return super.select(model, pos, items);\n        }\n        const key = `${model.getLanguageId()}/${word}`;\n        let item = this._trie.get(key);\n        if (!item) {\n            item = this._trie.findSubstr(key);\n        }\n        if (item) {\n            for (let i = 0; i < items.length; i++) {\n                const { kind, insertText } = items[i].completion;\n                if (kind === item.type && insertText === item.insertText) {\n                    return i;\n                }\n            }\n        }\n        return super.select(model, pos, items);\n    }\n    toJSON() {\n        const entries = [];\n        this._trie.forEach((value, key) => entries.push([key, value]));\n        // sort by last recently used (touch), then\n        // take the top 200 item and normalize their\n        // touch\n        entries\n            .sort((a, b) => -(a[1].touch - b[1].touch))\n            .forEach((value, i) => value[1].touch = i);\n        return entries.slice(0, 200);\n    }\n    fromJSON(data) {\n        this._trie.clear();\n        if (data.length > 0) {\n            this._seq = data[0][1].touch + 1;\n            for (const [key, value] of data) {\n                value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n                this._trie.set(key, value);\n            }\n        }\n    }\n}\nexport let SuggestMemoryService = class SuggestMemoryService {\n    constructor(_storageService, _configService) {\n        this._storageService = _storageService;\n        this._configService = _configService;\n        this._disposables = new DisposableStore();\n        this._persistSoon = new RunOnceScheduler(() => this._saveState(), 500);\n        this._disposables.add(_storageService.onWillSaveState(e => {\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\n                this._saveState();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._persistSoon.dispose();\n    }\n    memorize(model, pos, item) {\n        this._withStrategy(model, pos).memorize(model, pos, item);\n        this._persistSoon.schedule();\n    }\n    select(model, pos, items) {\n        return this._withStrategy(model, pos).select(model, pos, items);\n    }\n    _withStrategy(model, pos) {\n        var _a;\n        const mode = this._configService.getValue('editor.suggestSelection', {\n            overrideIdentifier: model.getLanguageIdAtPosition(pos.lineNumber, pos.column),\n            resource: model.uri\n        });\n        if (((_a = this._strategy) === null || _a === void 0 ? void 0 : _a.name) !== mode) {\n            this._saveState();\n            const ctor = SuggestMemoryService._strategyCtors.get(mode) || NoMemory;\n            this._strategy = new ctor();\n            try {\n                const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n                const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n                const raw = this._storageService.get(`${SuggestMemoryService._storagePrefix}/${mode}`, scope);\n                if (raw) {\n                    this._strategy.fromJSON(JSON.parse(raw));\n                }\n            }\n            catch (e) {\n                // things can go wrong with JSON...\n            }\n        }\n        return this._strategy;\n    }\n    _saveState() {\n        if (this._strategy) {\n            const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n            const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n            const raw = JSON.stringify(this._strategy);\n            this._storageService.store(`${SuggestMemoryService._storagePrefix}/${this._strategy.name}`, raw, scope, 1 /* StorageTarget.MACHINE */);\n        }\n    }\n};\nSuggestMemoryService._strategyCtors = new Map([\n    ['recentlyUsedByPrefix', PrefixMemory],\n    ['recentlyUsed', LRUMemory],\n    ['first', NoMemory]\n]);\nSuggestMemoryService._storagePrefix = 'suggest/memories';\nSuggestMemoryService = __decorate([\n    __param(0, IStorageService),\n    __param(1, IConfigurationService)\n], SuggestMemoryService);\nexport const ISuggestMemoryService = createDecorator('ISuggestMemories');\nregisterSingleton(ISuggestMemoryService, SuggestMemoryService, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { binarySearch, isFalsyOrEmpty } from '../../../../base/common/arrays.js';\nimport { Range } from '../../../common/core/range.js';\nimport { BracketSelectionRangeProvider } from '../../smartSelect/browser/bracketSelections.js';\nexport class WordDistance {\n    static create(service, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!editor.getOption(114 /* EditorOption.suggest */).localityBonus) {\n                return WordDistance.None;\n            }\n            if (!editor.hasModel()) {\n                return WordDistance.None;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!service.canComputeWordRanges(model.uri)) {\n                return WordDistance.None;\n            }\n            const [ranges] = yield new BracketSelectionRangeProvider().provideSelectionRanges(model, [position]);\n            if (ranges.length === 0) {\n                return WordDistance.None;\n            }\n            const wordRanges = yield service.computeWordRanges(model.uri, ranges[0].range);\n            if (!wordRanges) {\n                return WordDistance.None;\n            }\n            // remove current word\n            const wordUntilPos = model.getWordUntilPosition(position);\n            delete wordRanges[wordUntilPos.word];\n            return new class extends WordDistance {\n                distance(anchor, item) {\n                    if (!position.equals(editor.getPosition())) {\n                        return 0;\n                    }\n                    if (item.kind === 17 /* CompletionItemKind.Keyword */) {\n                        return 2 << 20;\n                    }\n                    const word = typeof item.label === 'string' ? item.label : item.label.label;\n                    const wordLines = wordRanges[word];\n                    if (isFalsyOrEmpty(wordLines)) {\n                        return 2 << 20;\n                    }\n                    const idx = binarySearch(wordLines, Range.fromPositions(anchor), Range.compareRangesUsingStarts);\n                    const bestWordRange = idx >= 0 ? wordLines[idx] : wordLines[Math.max(0, ~idx - 1)];\n                    let blockDistance = ranges.length;\n                    for (const range of ranges) {\n                        if (!Range.containsRange(range.range, bestWordRange)) {\n                            break;\n                        }\n                        blockDistance -= 1;\n                    }\n                    return blockDistance;\n                }\n            };\n        });\n    }\n}\nWordDistance.None = new class extends WordDistance {\n    distance() { return 0; }\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './symbolIcons.css';\nimport { localize } from '../../../../nls.js';\nimport { foreground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nexport const SYMBOL_ICON_ARRAY_FOREGROUND = registerColor('symbolIcon.arrayForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.arrayForeground', 'The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_BOOLEAN_FOREGROUND = registerColor('symbolIcon.booleanForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.booleanForeground', 'The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CLASS_FOREGROUND = registerColor('symbolIcon.classForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.classForeground', 'The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_COLOR_FOREGROUND = registerColor('symbolIcon.colorForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.colorForeground', 'The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTANT_FOREGROUND = registerColor('symbolIcon.constantForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.constantForeground', 'The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTRUCTOR_FOREGROUND = registerColor('symbolIcon.constructorForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.constructorForeground', 'The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_FOREGROUND = registerColor('symbolIcon.enumeratorForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.enumeratorForeground', 'The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND = registerColor('symbolIcon.enumeratorMemberForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.enumeratorMemberForeground', 'The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_EVENT_FOREGROUND = registerColor('symbolIcon.eventForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.eventForeground', 'The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FIELD_FOREGROUND = registerColor('symbolIcon.fieldForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.fieldForeground', 'The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FILE_FOREGROUND = registerColor('symbolIcon.fileForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.fileForeground', 'The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FOLDER_FOREGROUND = registerColor('symbolIcon.folderForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.folderForeground', 'The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FUNCTION_FOREGROUND = registerColor('symbolIcon.functionForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.functionForeground', 'The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_INTERFACE_FOREGROUND = registerColor('symbolIcon.interfaceForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.interfaceForeground', 'The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEY_FOREGROUND = registerColor('symbolIcon.keyForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.keyForeground', 'The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEYWORD_FOREGROUND = registerColor('symbolIcon.keywordForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.keywordForeground', 'The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_METHOD_FOREGROUND = registerColor('symbolIcon.methodForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.methodForeground', 'The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_MODULE_FOREGROUND = registerColor('symbolIcon.moduleForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.moduleForeground', 'The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NAMESPACE_FOREGROUND = registerColor('symbolIcon.namespaceForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.namespaceForeground', 'The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NULL_FOREGROUND = registerColor('symbolIcon.nullForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.nullForeground', 'The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NUMBER_FOREGROUND = registerColor('symbolIcon.numberForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.numberForeground', 'The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OBJECT_FOREGROUND = registerColor('symbolIcon.objectForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.objectForeground', 'The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OPERATOR_FOREGROUND = registerColor('symbolIcon.operatorForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.operatorForeground', 'The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PACKAGE_FOREGROUND = registerColor('symbolIcon.packageForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.packageForeground', 'The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PROPERTY_FOREGROUND = registerColor('symbolIcon.propertyForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.propertyForeground', 'The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_REFERENCE_FOREGROUND = registerColor('symbolIcon.referenceForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.referenceForeground', 'The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_SNIPPET_FOREGROUND = registerColor('symbolIcon.snippetForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.snippetForeground', 'The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRING_FOREGROUND = registerColor('symbolIcon.stringForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.stringForeground', 'The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRUCT_FOREGROUND = registerColor('symbolIcon.structForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.structForeground', 'The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TEXT_FOREGROUND = registerColor('symbolIcon.textForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.textForeground', 'The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TYPEPARAMETER_FOREGROUND = registerColor('symbolIcon.typeParameterForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.typeParameterForeground', 'The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_UNIT_FOREGROUND = registerColor('symbolIcon.unitForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.unitForeground', 'The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_VARIABLE_FOREGROUND = registerColor('symbolIcon.variableForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC',\n}, localize('symbolIcon.variableForeground', 'The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\n"],"names":["AbstractEditorCommandsQuickAccessProvider","AbstractCommandsQuickAccessProvider","constructor","options","instantiationService","keybindingService","commandService","telemetryService","dialogService","super","getCodeEditorCommandPicks","activeTextEditorControl","this","editorCommandPicks","editorAction","getSupportedActions","push","commandId","id","commandAlias","alias","label","stripIcons","AbstractEditorNavigationQuickAccessProvider","rangeHighlightDecorationId","undefined","provide","picker","token","_a","disposables","DisposableStore","canAcceptInBackground","matchOnLabel","matchOnDescription","matchOnDetail","sortByLabel","pickerDisposable","add","MutableDisposable","value","doProvide","onDidActiveTextEditorControlChange","editor","canProvideWithTextEditor","context","codeEditor","getCodeEditor","lastKnownEditorViewState","withNullAsUndefined","saveViewState","onDidChangeCursorPosition","restoreViewState","once","onCancellationRequested","call","toDisposable","clearDecorations","provideWithTextEditor","provideWithoutTextEditor","gotoLocation","_ref","setSelection","range","revealRangeInCenter","preserveFocus","focus","model","getModel","alert","concat","getLineContent","startLineNumber","isDiffEditor","modified","addDecorations","changeDecorations","changeAccessor","deleteDecorations","overviewRulerDecorationId","rangeHighlightId","newDecorations","description","className","isWholeLine","overviewRuler","color","themeColorFromId","overviewRulerRangeHighlight","position","OverviewRulerLane","Full","deltaDecorations","AbstractGotoLineQuickAccessProvider","localize","items","ariaLabel","Disposable","None","onDidAccept","event","item","selectedItems","isValidLineNumber","lineNumber","toRange","column","keyMods","inBackground","hide","updatePickerAndEditor","parsePosition","trim","substr","PREFIX","length","getPickLabel","onDidChangeValue","getOptions","get","renderType","updateOptions","lineNumbers","arguments","startColumn","endLineNumber","endColumn","numbers","split","map","part","parseInt","filter","isNaN","endLine","lineCount","isValidColumn","getPosition","positionCandidate","validatePosition","equals","_b","getLineCount","__decorate","decorators","target","key","desc","d","c","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","AbstractGotoSymbolQuickAccessProvider","_languageFeaturesService","_outlineModelService","create","provideLabelPick","documentSymbolProvider","has","doProvideWithEditorSymbols","doProvideWithoutEditorSymbols","waitForLanguageSymbolRegistry","isCancellationRequested","index","kind","symbolProviderRegistryPromise","DeferredPromise","symbolProviderListener","onDidChange","dispose","complete","p","selection","onDidTriggerItemButton","forceSideBySide","symbolsPromise","getDocumentSymbols","picksCts","updatePickerItems","positionToEnclose","busy","CancellationTokenSource","query","prepareQuery","doGetSymbolPicks","original","candidate","findLast","Boolean","type","Range","containsPosition","decoration","activeItems","getSelection","onDidChangeActive","symbols","filterBySymbolKind","indexOf","SCOPE_PREFIX","filterPos","symbolQuery","containerQuery","buttons","values","pieceToQuery","slice","openSideBySideDirection","iconClass","ThemeIcon","asClassName","Codicon","splitHorizontal","splitVertical","tooltip","filteredSymbolPicks","symbol","symbolLabel","name","symbolLabelWithIcon","SymbolKinds","toIcon","symbolLabelIconOffset","symbolScore","symbolMatches","containerScore","containerMatches","containerLabel","containerName","extraContainerLabel","skipContainerQuery","scoreFuzzy2","assign","deprecated","tags","score","highlights","collapseToStart","selectionRange","strikethrough","sortedFilteredSymbolPicks","sort","symbolA","symbolB","compareByKindAndScore","compareByScore","symbolPicks","lastSymbolKind","lastSeparator","lastSymbolKindCounter","updateLastSeparatorLabel","format","NLS_SYMBOL_KIND_CACHE","FALLBACK_NLS_SYMBOL_KIND","symbolPick","kindA","kindB","localeCompare","document","getOrCreate","asListOfDocumentSymbols","PREFIX_BY_CATEGORY","ILanguageFeaturesService","IOutlineModelService","ReadOnlyMessageController","_register","onDidAttemptReadOnlyEdit","_onDidAttemptReadOnlyEdit","messageController","MessageController","hasModel","isSimpleWidget","showMessage","nls","ID","registerEditorContribution","CONTEXT_RENAME_INPUT_VISIBLE","RawContextKey","RenameInputField","_editor","_acceptKeybindings","_themeService","_keybindingService","contextKeyService","_disposables","allowEditorOverflow","_visibleContextKey","bindTo","addContentWidget","onDidChangeConfiguration","hasChanged","_updateFont","onDidColorThemeChange","_updateStyles","removeContentWidget","getId","getDomNode","_domNode","createElement","_input","setAttribute","appendChild","_label","getColorTheme","theme","_c","_d","widgetShadowColor","getColor","widgetShadow","widgetBorderColor","widgetBorder","style","backgroundColor","String","editorWidgetBackground","boxShadow","border","inputForeground","inputBackground","inputBorder","borderWidth","borderStyle","borderColor","toString","fontInfo","getOption","fontFamily","fontWeight","fontSize","_visible","_position","preference","beforeRender","accept","preview","innerText","comment","lookupKeybinding","getLabel","afterRender","cancelInput","acceptInput","wantsPreview","_currentAcceptInput","focusEditor","_currentCancelInput","getInput","where","selectionStart","selectionEnd","supportPreview","classList","toggle","Position","size","Math","max","disposeOnDone","newName","onDidBlurEditorWidget","hasFocus","_show","finally","_hide","revealLineInCenterIfOutsideViewport","set","layoutContentWidget","setTimeout","setSelectionRange","getAttribute","reset","IThemeService","IKeybindingService","IContextKeyService","RenameSkeleton","registry","_providerRenameIdx","_providers","ordered","hasProvider","resolveRenameLocation","rejects","provider","res","rejectReason","word","getWordAtPosition","text","join","fromPositions","provideRenameEdits","_provideRenameEdits","edits","rename","skeleton","loc","CancellationToken","RenameController","getContribution","_instaService","_notificationService","_bulkEditService","_progressService","_logService","_configService","_disposableStore","_cts","_renameInputField","createInstance","run","renameProvider","cts1","EditorStateCancellationTokenSource","resolveLocationOperation","showWhile","cts2","isEmpty","spansMultipleLines","containsRange","min","hasPreviewHandler","getValue","uri","inputFieldResult","renameOperation","raceCancellation","renameResult","info","showPreview","code","quotableLabel","respectAutoSaveConfig","ariaSummary","catch","err","error","acceptRenameInput","cancelRenameInput","IInstantiationService","INotificationService","IBulkEditService","IEditorProgressService","ILogService","ITextResourceConfigurationService","RenameAction","EditorAction","precondition","ContextKeyExpr","and","EditorContextKeys","writable","hasRenameProvider","kbOpts","kbExpr","editorTextFocus","primary","weight","contextMenuOpts","group","order","runCommand","accessor","args","editorService","ICodeEditorService","pos","Array","isArray","URI","isUri","isIPosition","openCodeEditor","resource","getActiveCodeEditor","setPosition","invokeWithinContext","reportTelemetry","onUnexpectedError","controller","registerEditorAction","RenameCommand","EditorCommand","bindToContribution","registerEditorCommand","handler","x","not","secondary","registerModelAndPositionCommand","_len","_key","assertType","Error","Registry","as","Extensions","Configuration","registerConfiguration","properties","scope","default","DocumentSemanticTokensFeature","semanticTokensStylingService","modelService","themeService","configurationService","languageFeatureDebounceService","languageFeaturesService","_watchers","register","ModelSemanticColoring","deregister","modelSemanticColoring","handleSettingOrThemeChange","getModels","curr","isSemanticColoringEnabled","onModelAdded","onModelRemoved","affectsConfiguration","SEMANTIC_HIGHLIGHTING_SETTING_ID","watcher","ISemanticTokensStylingService","IModelService","IConfigurationService","ILanguageFeatureDebounceService","_semanticTokensStylingService","_isDisposed","_model","_provider","documentSemanticTokensProvider","_debounceInformation","for","REQUEST_MIN_DELAY","REQUEST_MAX_DELAY","_fetchDocumentSemanticTokens","RunOnceScheduler","_fetchDocumentSemanticTokensNow","_currentDocumentResponse","_currentDocumentRequestCancellationTokenSource","_documentProvidersChangeListeners","_providersChangedDuringRequest","onDidChangeContent","isScheduled","schedule","onDidChangeAttached","onDidChangeLanguage","cancel","_setDocumentSemanticTokens","bindDocumentChangeListeners","all","_","hasDocumentSemanticTokensProvider","tokenization","setSemanticTokens","isAttachedToEditor","cancellationTokenSource","lastProvider","lastResultId","resultId","request","getDocumentSemanticTokens","pendingChanges","contentChangeListener","sw","StopWatch","update","elapsed","tokens","styling","getStyling","errors","message","_copy","src","srcOffset","dest","destOffset","currentResponse","rescheduleIfNeeded","releaseDocumentSemanticTokens","isSemanticTokensEdits","data","deltaLength","edit","deleteCount","srcData","destData","Uint32Array","srcLastStart","destLastStart","start","warnInvalidEditStart","copyCount","isSemanticTokens","SemanticTokensResponse","toMultilineTokens2","getLanguageId","change","area","singleChange","changes","applyEdit","registerEditorFeature","ViewportSemanticTokensContribution","_configurationService","documentRangeSemanticTokensProvider","_tokenizeViewport","_tokenizeViewportNow","_outstandingRequests","scheduleTokenizeViewport","onDidScrollChange","onDidChangeModel","_cancelAll","onDidChangeModelContent","_removeOutstandingRequest","req","len","splice","hasCompleteSemanticTokens","hasSomeSemanticTokens","hasDocumentRangeSemanticTokensProvider","visibleRanges","getVisibleRangesPlusViewportAboveBelow","_requestRange","requestVersionId","getVersionId","createCancelablePromise","getDocumentRangeSemanticTokens","isDisposed","setPartialSemanticTokens","v","DocumentSemanticTokensResult","providers","groups","orderedGroups","getDocumentSemanticTokensProviders","results","provideDocumentSemanticTokens","DocumentRangeSemanticTokensResult","getDocumentRangeSemanticTokensProviders","provideDocumentRangeSemanticTokens","onUnexpectedExternalError","CommandsRegistry","registerCommand","_getDocumentSemanticTokensProviderHighestGroup","getLegend","ICommandService","executeCommand","_len2","_key2","getFullModelRange","buff","encodeSemanticTokensDto","_len3","_key3","isIRange","console","warn","lift","_len4","_key4","setting","overrideIdentifier","enabled","semanticHighlighting","BracketSelectionRangeProvider","provideSelectionRanges","positions","bucket","ranges","Map","_bracketsRightYield","_bracketsLeftYield","round","counts","t1","Date","now","_maxRounds","bracket","bracketPairs","findNextBracket","_maxDuration","bracketInfo","isOpeningBracket","bracketText","val","getOpeningBrackets","list","LinkedList","getEndPosition","findPrevBracket","closing","shift","delete","innerBracket","getStartPosition","outerBracket","_addBracketLeading","startLine","getLineFirstNonWhitespaceColumn","aboveLine","getLineLastNonWhitespaceColumn","WordSelectionRangeProvider","_addInWordRanges","_addWordRanges","_addWhitespaceLine","obj","offset","end","lastCh","ch","charCodeAt","isLowerAsciiLetter","isUpperAsciiLetter","getLineLength","getLineMaxColumn","SelectionRanges","mov","fwd","equalsRange","SmartSelectController","_ignoreSelection","_selectionListener","forward","selections","getSelections","_state","selectionRangeProvider","s","arrays","a","b","equalsSelection","unshift","state","newSelections","Selection","setSelections","AbstractSmartSelect","opts","_forward","_accessor","registerCommandAlias","work","allRawRanges","allProviderRanges","oneProviderRanges","oneRawRanges","isBefore","oneRanges","last","selectLeadingAndTrailingWhitespace","oneRangesWithTrivia","prev","cur","rangeNoWhitespace","rangeFull","mac","menuOpts","menuId","MenuId","MenubarSelectionMenu","title","reference","ITextModelService","createModelReference","object","textEditorModel","_defaultOptions","overwriteBefore","overwriteAfter","undoStopBefore","undoStopAfter","adjustWhitespace","clipboardText","overtypingCapturer","SnippetController2","_languageConfigurationService","_snippetListener","_modelVersionId","_inSnippet","InSnippetMode","_hasNextTabstop","HasNextTabstop","_hasPrevTabstop","HasPrevTabstop","_session","insert","template","_doInsert","_logInfo","clear","pushStackElement","merge","getAlternativeVersionId","SnippetSession","hasChoice","_choiceCompletionItemProvider","provideCompletionItems","activeChoice","choice","getValueInRange","isAnyOfOptions","find","o","suggestions","option","insertText","sortText","repeat","filterText","command","registration","completionProvider","language","pattern","fsPath","scheme","exclusive","_updateState","isFlush","onDidChangeCursorSelection","hasPlaceholder","isAtLastPlaceholder","isSelectionWithinPlaceholders","isAtFirstPlaceholder","_handleChoice","_currentChoice","queueMicrotask","showSimpleSuggestions","finish","resetSelection","isInSnippet","ILanguageConfigurationService","CommandCtor","ctrl","Scanner","isDigitCharacter","isVariableCharacter","tokenText","_table","Marker","_children","child","Text","parent","replace","others","idx","children","newChildren","_fixParent","rightMostDescendant","snippet","TextmateSnippet","reduce","clone","TransformableMarker","Placeholder","compareByIndex","isFinalTabstop","Choice","ret","transform","marker","forEach","Transform","regexp","RegExp","_this","didMatch","_replace","prototype","some","FormatString","elseValue","source","ignoreCase","global","shorthandName","ifValue","toLocaleUpperCase","toLocaleLowerCase","_toPascalCase","_toCamelCase","match","charAt","toUpperCase","toLowerCase","Variable","resolver","walk","visitor","stack","placeholderInfo","_placeholders","placeholders","found","fullLen","enclosingPlaceholders","placeholder","resolveVariables","SnippetParser","_scanner","_token","escape","guessNeedsClipboard","test","parse","insertFinalTabstop","enforceFinalTabstop","parseFragment","ensureFinalTabstop","_parse","placeholderDefaultValues","incompletePlaceholders","fillInIncompletePlaceholder","defaultValues","newChild","Set","_accept","_backTo","_until","nextToken","substring","_parseEscaped","_parseTabstopOrVariableName","_parseComplexPlaceholder","_parseComplexVariable","_parseAnything","Number","_parseTransform","_parseChoiceElement","variable","regexValue","regexOptions","escaped","_parseFormatString","complex","shorthand","freeze","CompositeSnippetVariableResolver","_delegates","delegate","SelectionBasedVariableResolver","_selection","_selectionIdx","_overtypingCapturer","isMultiline","getLastOvertypedInfo","multiline","line","lineLeadingWhitespace","getLeadingWhitespace","varLeadingWhitespace","splitLines","pop","whitespaceCommonLength","commonPrefixLength","m","newline","rest","positionLineNumber","positionColumn","ModelBasedVariableResolver","_labelService","path","lastIndexOf","getUriLabel","dirname","relative","noPrefix","ClipboardBasedVariableResolver","_readClipboardText","_selectionCount","_spread","lines","isFalsyOrWhitespace","CommentBasedVariableResolver","langId","getLanguageIdAtPosition","selectionStartLineNumber","selectionStartColumn","config","getLanguageConfiguration","comments","lineCommentToken","blockCommentStartToken","blockCommentEndToken","TimeBasedVariableResolver","_date","getFullYear","getMonth","valueOf","padStart","getDate","getHours","getMinutes","getSeconds","dayNames","getDay","dayNamesShort","monthNames","monthNamesShort","floor","getTime","rawTimeOffset","getTimezoneOffset","sign","hours","trunc","abs","hoursString","minutes","WorkspaceBasedVariableResolver","_workspaceService","workspaceIdentifier","toWorkspaceIdentifier","getWorkspace","isEmptyWorkspaceIdentifier","_resolveWorkspaceName","_resoveWorkspacePath","isSingleFolderWorkspaceIdentifier","filename","configPath","endsWith","WORKSPACE_EXTENSION","normalizeDriveLetter","folderpath","RandomBasedVariableResolver","random","generateUuid","OneSnippet","_snippet","_snippetLineLeadingWhitespace","_offset","_nestingLevel","_placeholderGroups","groupBy","_placeholderGroupsIdx","initialize","textChange","newPosition","_placeholderDecorations","removeDecorations","_initDecorations","placeholderOffset","placeholderLen","getPositionAt","_decor","inactiveFinal","inactive","handle","addDecoration","move","operations","getDecorationRange","currentValue","transformedValueLines","normalizeIndentation","EditOperation","getEOL","executeEdits","couldSkipThisPlaceholder","activePlaceholders","_hasPlaceholderBeenCollapsed","changeDecorationOptions","activeFinal","active","enclosingPlaceholder","isTrivialSnippet","computePossibleSelections","placeholdersWithEqualIndex","nested","assert","indexLastPlaceholder","nestedPlaceholder","removeDecoration","ModelDecorationOptions","stickiness","adjustIndentation","snippetTextString","prevChar","newValue","adjustSelection","positionColumnBefore","positionColumnAfter","validateRange","createWithDirection","getDirection","createEditsAndSnippetsFromSelections","languageConfigurationService","snippets","workspaceService","IWorkspaceContextService","modelBasedVariableResolver","ILabelService","readClipboardText","firstBeforeText","firstAfterText","firstLineFirstNonWhitespace","indexedSelections","compareRangesUsingStarts","extensionBefore","extensionAfter","snippetSelection","setStartPosition","setEndPosition","snippetLineLeadingWhitespace","identifier","major","minor","_isTracked","createEditsAndSnippetsFromEdits","snippetEdits","parser","lastRange","textRange","textNode","newNodes","snippetText","snippetFragmentText","_template","_options","_templateMerges","_snippets","_undoEdits","undoEdits","_move","revealRange","revealPositionInCenterIfOutsideViewport","oneSelection","allPossibleSelections","possibleSelections","array","StickyScrollWidgetState","lastLineRelativePosition","_ttPolicy","createTrustedTypesPolicy","createHTML","StickyScrollWidget","_rootDomNode","_lineNumbers","_lastLineRelativePosition","_hoverOnLine","_hoverOnColumn","_layoutInfo","getLayoutInfo","EmbeddedCodeEditorWidget","width","minimap","minimapCanvasOuterWidth","verticalScrollbarWidth","hoverOnLine","hoverOnColumn","getCurrentLines","setState","dom","editorLineHeight","_renderRootNode","_getViewModel","entries","childNode","_renderChildNode","widgetHeight","display","height","side","marginLeft","viewModel","viewLineNumber","coordinatesConverter","convertModelPositionToViewPosition","lineRenderingData","getViewLineRenderingData","layoutInfo","minimapSide","lineHeight","lineNumberOption","actualInlineDecorations","LineDecoration","inlineDecorations","minColumn","maxColumn","renderLineInput","RenderLineInput","content","continuesWithWrappedLine","isBasicASCII","containsRTL","tabSize","startVisibleColumn","sb","StringBuilder","newLine","renderViewLine","build","lineHTMLNode","innerHTML","lineNumberHTMLNode","contentLeft","innerLineNumberHTML","lineNumbersWidth","paddingLeft","lineNumbersLeft","applyFontInfo","tabIndex","zIndex","top","StandardMouseEvent","StickyRange","StickyElement","StickyModel","version","element","outlineProviderId","ModelProvider","Status","StickyModelProvider","defaultModel","_modelProviders","_modelPromise","_updateScheduler","Delayer","stickyModelFromCandidateOutlineProvider","StickyModelFromCandidateOutlineProvider","stickyModelFromSyntaxFoldingProvider","StickyModelFromCandidateSyntaxFoldingProvider","stickyModelFromIndentationFoldingProvider","StickyModelFromCandidateIndentationFoldingProvider","OUTLINE_MODEL","FOLDING_PROVIDER_MODEL","INDENTATION_MODEL","_store","_cancelModelPromise","textModel","textModelVersionId","trigger","modelProvider","statusPromise","modelPromise","computeStickyModel","status","CANCELED","VALID","stickyModel","StickyModelCandidateProvider","_stickyModel","_invalid","INVALID","modelVersionId","isProviderValid","providerModelPromise","createModelFromProvider","providerModel","isModelValid","createStickyModel","OutlineModel","stickyOutlineElement","providerID","_stickyModelFromOutlineModel","outlineModel","preferredProvider","outlineElements","Iterable","first","OutlineGroup","outlineGroupOfModel","optimalOutlineGroup","tempID","maxTotalSumOfRanges","outlineGroup","totalSumRanges","_findSumOfRangesOfGroup","stickyChildren","outlineElementsArray","from","element1","element2","range1","range2","_comparator","outlineElement","_stickyModelFromOutlineElement","previousStartLine","subchild","child1","child2","outline","OutlineElement","StickyModelFromCandidateFoldingProvider","_foldingLimitReporter","RangesLimitReporter","foldingElement","_fromFoldingRegions","foldingRegions","orderedStickyElements","parentIndex","getParentIndex","parentNode","getStartLineNumber","getEndLineNumber","IndentRangeProvider","compute","FoldingController","getFoldingRangeProviders","selectedProviders","SyntaxRangeProvider","StickyLineCandidate","nestingDepth","StickyLineCandidateProvider","_onDidChangeStickyScroll","Emitter","onDidChangeStickyScroll","_stickyModelProvider","_sessionStore","_updateSoon","readConfiguration","onDidChangeHiddenAreas","updateStickyModel","fire","resetHandle","isEqual","clearTimeout","updateIndex","getCandidateStickyLinesIntersectingFromStickyModel","depth","lastStartLineNumber","lastLine","childrenStartLines","lowerBound","binarySearch","upperBound","childStartLine","childEndLine","getCandidateStickyLinesIntersecting","stickyLineCandidates","hiddenRanges","getHiddenAreas","hiddenRange","stickyLine","StickyScrollController","_contextMenuService","_languageFeatureDebounceService","_contextKeyService","_maxStickyLines","MAX_SAFE_INTEGER","_candidateDefinitionsLength","_focusedStickyElementIndex","_enabled","_focused","_positionRevealed","_onMouseDown","_stickyScrollWidget","_stickyLineCandidateProvider","_widgetState","_readConfiguration","CONTEXT_MENU","_onContextMenu","_stickyScrollFocusedContextKey","stickyScrollFocused","_stickyScrollVisibleContextKey","stickyScrollVisible","focusTracker","onDidBlur","clientHeight","_disposeFocusStickyScrollStore","onDidFocus","_createClickLinkGesture","MOUSE_DOWN","_focusDisposableStore","rootNode","lastElementChild","_stickyElements","focusNext","_focusNav","focusPrevious","selectEditor","direction","goToFocused","_revealPosition","revealPosition","linkGestureStore","sessionStore","gesture","ClickLinkGesture","onMouseMoveOrRelevantKeyDown","mouseEvent","_keyboardEvent","hasTriggerModifier","targetMouseEvent","detail","stickyPositionProjectedOnEditor","_stickyRangeProjectedOnEditor","textDecoration","cancellationToken","currentHTMLChild","getDefinitionsAtPosition","definitionProvider","candidateDefinitions","childHTML","onCancel","onExecute","invokeFunction","goToDefinitionWithLocation","isRightClick","showContextMenu","StickyScrollContext","getAnchor","removeOverlayWidget","addOverlayWidget","_renderStickyScroll","onDidLayoutChange","_onDidResize","onDidChangeModelTokens","_onTokensChange","_needsUpdate","stickyLineNumbers","stickyLineNumber","fromLineNumber","toLineNumber","theoreticalLines","stickyLineVersion","findScrollWidgetState","focusedStickyElementLineNumber","includes","maxNumberStickyLines","maxLineCount","scrollTop","getScrollTop","arrayVisibleRanges","getVisibleRanges","fullVisibleRange","candidateRanges","topOfElementAtDepth","bottomOfElementAtDepth","bottomOfBeginningLine","getBottomForLineNumber","topOfEndLine","getTopForLineNumber","bottomOfEndLine","IContextMenuService","ToggleStickyScroll","Action2","mnemonicTitle","category","Categories","View","toggled","condition","menu","CommandPalette","MenubarViewMenu","updateValue","FocusStickyScroll","EditorAction2","runEditorCommand","SelectNextStickyScrollLine","isEqualTo","keybinding","SelectPreviousStickyScrollLine","GoToStickyScrollLine","SelectEditor","registerAction2","LineContext","leadingLineContent","characterCountDelta","CompletionModel","lineContext","wordDistance","snippetSuggestions","fuzzyScoreOptions","FuzzyScoreOptions","_snippetCompareFn","_compareCompletionItems","_items","_column","_wordDistance","_refilterKind","_lineContext","_fuzzyScoreOptions","_compareCompletionItemsSnippetsUp","_compareCompletionItemsSnippetsDown","_filteredItems","_ensureCachedState","getItemsByProvider","_itemsByProvider","getIncompleteProvider","container","incomplete","stats","_stats","_createCachedState","labelLengths","wordLow","scoreFn","filterGraceful","fuzzyScore","fuzzyScoreGracefulAggressive","isInvalid","arr","editStart","wordLen","FuzzyScore","Default","wordPos","completion","filterTextLow","compareIgnoreCase","textLabel","anyScore","labelLow","distance","pLabelLen","quickSelect","Context","Visible","historyNavigationVisible","HasFocusedSuggestion","DetailsVisible","MultipleSuggestions","MakesTextEdit","AcceptSuggestionsOnEnter","HasInsertAndReplaceRange","InsertMode","CanResolve","suggestWidgetStatusbarMenu","CompletionItem","sortTextLow","extensionId","editInsertEnd","editReplaceEnd","resolveCompletionItem","_resolveCache","_isResolved","isResolved","sub","isCancellationError","CompletionOptions","snippetSortOrder","kindFilter","providerFilter","providerItemsToReuse","showDeprecated","_snippetSuggestSupport","getSnippetSuggestSupport","CompletionItemModel","needsClipboard","durations","disposable","provideSuggestionItems","triggerKind","defaultReplaceRange","defaultRange","onCompletionList","didAddResult","suggestion","insertTextRules","isDisposable","providerName","_debugDisplayName","elapsedProvider","duration","elapsedOverall","snippetCompletions","reuseItems","providerGroup","CancellationError","snippetConfig","_snippetComparators","defaultComparator","triggerSuggest","triggerCharacter","maxItemsToResolve","ref","resolving","actualPosition","completions","QuickSuggestionsOptions","isAllOff","other","strings","isAllOn","valueFor","tokenType","WordContextKey","_ckAtEnd","AtEnd","_configListener","_update","checkForWordEnd","SuggestAlternatives","_index","_ckOtherSuggestions","OtherSuggestions","_listener","_acceptNext","_ignore","acceptNext","_moveIndex","newIndex","rounds","additionalTextEdits","CommitCharacterController","widget","onDidSuggest","completionModel","onDidCancel","onDidShow","_onItem","getFocusedItem","onDidHide","onWillType","_active","isFrozen","acceptCharacters","selected","isNonEmptyArray","commitCharacters","CharacterSet","shouldAutoTrigger","tokenizeIfCheap","triggerOptions","leadingWord","getWordUntilPosition","SuggestModel","_editorWorkerService","_clipboardService","_telemetryService","_toDispose","_triggerCharacterListener","_triggerQuickSuggest","TimeoutTimer","_triggerState","_completionDisposables","_onDidCancel","_onDidTrigger","_onDidSuggest","onDidTrigger","_telemetryGate","_currentSelection","_updateTriggerCharacters","onDidChangeModelLanguage","_updateActiveSuggestSession","editorIsComposing","onDidCompositionStart","onDidCompositionEnd","_onCompositionEnd","_onCursorChange","_refilterCompletionItems","supportsByTriggerCharacter","support","triggerCharacters","checkTriggerCharacter","getContextKeyValue","suppressSuggestions","InlineCompletionContextKeys","canShowSuggestOnTriggerCharacters","lastChar","isLowSurrogate","isHighSurrogate","supports","_completionModel","auto","retrigger","completionOptions","onDidType","_requestToken","_context","prevSelection","reason","isBeforeOrEqual","_doTriggerQuickSuggest","snippetsPreventQuickSuggestions","cancelAndSet","hasWidgetFocus","lineTokens","getLineTokens","getStandardTokenType","findTokenIndexAtOffset","inlineSuggestionVisible","canShowQuickSuggest","ctx","refilter","_onNewContext","_e","_f","shy","suggestCtx","itemKind","itemKindFilter","_createSuggestFilter","WordDistance","_g","readText","fuzzySearchOptions","firstMatchCanBeWeak","matchOnWordStartOnly","_reportDurationsTelemetry","publicLog2","JSON","stringify","debug","suggestOptions","showMethods","showFunctions","showConstructors","showFields","showVariables","showClasses","showStructs","showInterfaces","showModules","showProperties","showEvents","showOperators","showUnits","showValues","showConstants","showEnums","showEnumMembers","showKeywords","showWords","showColors","showFiles","showReferences","showFolders","showTypeParameters","showSnippets","showUsers","showIssues","oldLineContext","IEditorWorkerService","IClipboardService","ITelemetryService","OvertypingCapturer","suggestModel","_lastOvertyped","_locked","selectionsLength","willOvertype","getValueLengthInRange","_maxSelectionLength","StatusBarViewItem","MenuEntryActionViewItem","updateLabel","kb","_action","textContent","symbolPrintEnter","SuggestWidgetStatus","_menuId","_menuService","_menuDisposables","$","actionViewItemProvider","action","MenuItemAction","_leftActions","ActionBar","_rightActions","domNode","remove","show","createMenu","renderMenu","left","right","actions","getActions","IMenuService","canExpandCompletionItem","documentation","SuggestDetailsWidget","instaService","_onDidClose","onDidClose","_onDidChangeContents","onDidChangeContents","_renderDisposeable","_borderWidth","_size","_markdownRenderer","MarkdownRenderer","_body","_scrollbar","DomScrollableElement","alwaysConsumeMouseWheel","_header","_close","asCSSSelector","close","_type","_docs","_configureFont","getMassagedFontFamily","fontSizePx","lineHeightPx","fontFeatureSettings","borderHeight","verticalPadding","horizontalPadding","renderLoading","layout","renderItem","explainMode","md","MarkdownString","appendCodeblock","cappedDetail","renderedContents","render","onDidRenderAsync","userSelect","onmousedown","preventDefault","stopPropagation","onclick","clearContents","newSize","scanDomNode","scrollDown","much","scrollUp","scrollBottom","scrollHeight","pageDown","pageUp","SuggestDetailsOverlay","topLeftNow","sizeNow","_added","_preferAlignAtTop","_resizable","ResizableHTMLElement","enableSashes","deltaTop","deltaLeft","onDidWillResize","_topLeft","onDidResize","dimension","updateTopLeft","west","north","_applyTopLeft","_userSize","_anchorBox","_placeAtAnchor","sessionEnded","clearSashHoverState","placeAtAnchor","anchor","preferAlignAtTop","anchorBox","getBoundingClientRect","bodyBox","body","defaultMinSize","defaultTop","eastPlacement","maxSizeTop","maxSizeBottom","with","fit","minSize","placements","placement","bottom","alignAtTop","maxHeight","maxSize","topLeft","getAriaId","suggestMoreInfoIcon","registerIcon","chevronRight","_completionItemColor","ColorExtractor","extract","out","_regexStrict","_regexRelaxed","exec","ItemRenderer","_modelService","_languageService","_onDidToggleDetails","onDidToggleDetails","templateId","renderTemplate","root","icon","append","colorspan","main","iconContainer","iconLabel","IconLabel","supportHighlights","supportIcons","parametersLabel","qualifierLabel","detailsLabel","readMore","configureFont","letterSpacing","letterSpacingPx","renderElement","labelOptions","labelEscapeNewLines","matches","createMatches","getFileIconTheme","hasFileIcons","labelClasses","getIconClasses","FileKind","FILE","detailClasses","extraClasses","hasFolderIcons","FOLDER","flat","asClassNameArray","CompletionItemKinds","setLabel","stripNewLines","showInlineDetails","disposeTemplate","templateData","str","ILanguageService","registerColor","dark","light","hcDark","hcLight","editorWidgetBorder","editorSuggestWidgetForeground","editorForeground","quickInputListFocusForeground","quickInputListFocusIconForeground","editorSuggestWidgetSelectedBackground","quickInputListFocusBackground","listHighlightForeground","listFocusHighlightForeground","transparent","PersistedWidgetSize","_service","getEditorType","restore","raw","is","store","SuggestWidget","_storageService","_isAuto","_pendingLayout","_pendingShowDetails","_ignoreFocusEvents","_forceRenderingAbove","_explainMode","_showTimeout","_onDidSelect","PauseableEmitter","_onDidFocus","_onDidHide","_onDidShow","onDidSelect","_onDetailsKeydown","onDetailsKeyDown","_contentWidget","SuggestContentWidget","_persistedSize","ResizeState","persistedSize","currentSize","persistHeight","persistWidth","lockPreference","_resize","south","east","itemHeight","defaultSize","threshold","unlockPreference","_messageElement","_listElement","details","toggleDetails","_details","applyIconStyle","showIcons","renderer","_list","List","getHeight","_element","getTemplateId","useShadows","mouseSupport","multipleSelectionSupport","accessibilityProvider","getRole","getWidgetAriaLabel","getWidgetRole","getAriaLabel","_isDetailsVisible","docs","getListStyles","listInactiveFocusBackground","listInactiveFocusOutline","activeContrastBorder","_status","applyStatusBarStyle","showStatusBar","t","_onThemeChange","onMouseDown","_onListMouseDownOrTap","onTap","onDidChangeSelection","_onListSelection","onDidChangeFocus","_onListFocus","_onCursorSelectionChanged","_ctxSuggestWidgetVisible","SuggestContext","_ctxSuggestWidgetDetailsVisible","_ctxSuggestWidgetMultipleSuggestions","_ctxSuggestWidgetHasFocusedSuggestion","_onEditorMouseDown","_loadingTimeout","contains","browserEvent","_select","elements","indexes","isHighContrast","_currentSuggestionDetails","_focusedItem","setAriaOptions","activeDescendant","reveal","loading","disposableTimeout","showDetails","setFocus","_setState","_cappedHeight","LOADING_MESSAGE","NO_SUGGESTIONS_MESSAGE","_layout","showTriggered","delay","showSuggestions","selectionIndex","isAuto","noFocus","visibleCount","pause","resume","focusSelected","selectNextPage","focusNextPage","selectNext","selectLast","focusLast","selectPreviousPage","focusPreviousPage","selectPrevious","selectFirst","focusFirst","getFocus","getFocusedElements","toggleDetailsFocus","_setDetailsVisible","_positionDetails","toggleExplainMode","resetPersistedSize","hideWidget","dim","minPersistedHeight","ceil","_afterRender","setPreference","maxWidth","preferredWidth","typicalHalfwidthCharacterWidth","fullHeight","statusBarHeight","contentHeight","minHeight","editorBox","cursorBox","getScrolledVisiblePosition","cursorBottom","maxHeightBelow","availableSpaceAbove","maxHeightAbove","capped","wanted","forceRenderingAboveRequiredSpace","preferredSize","clamp","getBoolean","forceRenderingAbove","stopForceRenderingAbove","IStorageService","_widget","suppressMouseDown","_preferenceLocked","_hidden","_preference","LineSuffix","getOffsetAt","_marker","delta","SuggestController","_memoryService","_commandService","_instantiationService","_lineSuffix","_selectors","PriorityRegistry","priority","select","ctxInsertMode","insertMode","IdleValue","_insertSuggestion","commitCharacterController","ctxMakesTextEdit","ctxHasInsertAndReplace","ctxCanResolve","toKeyCodeChord","KeyCodeChord","platform","isModifierKey","_alternatives","selector","itemsOrderedByPriorityDesc","selectionMode","acceptSuggestionsOnEnter","updateFromConfig","acceptSuggestionOnEnter","flags","snippetController","modelVersionNow","tasks","cts","pushUndoStop","getOverwriteInfo","memorize","scrollState","StableEditorScrollState","capture","replaceMove","restoreRelativeVerticalPositionOfCursor","docListener","thisPosition","oldFlags","didType","typeListener","applied","trace","TriggerSuggestAction","canUndo","undo","_alertCompletionItem","_reportSuggestionAcceptedTelemetry","acceptedSuggestion","providerId","basenameHash","hash","basename","languageId","fileExtension","extname","toggleMode","msg","onlyFrom","noFilter","triggerSuggestAndAcceptBest","arg","positionNow","fallback","makesTextEdit","Event","listener","any","_ref2","acceptSelectedSuggestion","keepAlternativeSuggestions","alternativeOverwriteConfig","acceptNextSuggestion","acceptPrevSuggestion","cancelSuggestWidget","focusSuggestion","selectNextSuggestion","selectNextPageSuggestion","selectLastSuggestion","selectPrevSuggestion","selectPrevPageSuggestion","selectFirstSuggestion","toggleSuggestionDetails","toggleSuggestionFocus","resetWidgetSize","isInitialized","registerSelector","ISuggestMemoryService","prioritySelector","s1","s2","hasCompletionItemProvider","toNegated","textInputFocus","SuggestCommand","when","or","negate","isObject","SuggestInlineCompletion","InlineCompletionResults","RefCountedDisposable","_suggestMemoryService","canBeReused","selectedIndex","second","resolveCount","SuggestInlineCompletions","_getEditorOption","_languageFeatureService","provideInlineCompletions","selectedSuggestionInfo","triggerCharacterInfo","wordInfo","_getTriggerCharacterInfo","leadingLineContents","_lastResult","newLineContext","acquire","boostFullMatch","handleItemDidShow","_completions","freeInlineCompletions","release","EditorContribution","languageFeatureService","_counter","listCodeEditors","_disposable","inlineCompletionsProvider","Memory","topScore","preselect","NoMemory","toJSON","fromJSON","SuggestMemoryService","_persistSoon","_saveState","onWillSaveState","WillSaveStateReason","SHUTDOWN","_withStrategy","mode","_strategy","ctor","_strategyCtors","_storagePrefix","_trie","TernarySearchTree","forStrings","_seq","touch","findSubstr","fromString","_cache","LRUCache","lineSuffix","indexPreselect","indexRecency","seq","peek","createDecorator","registerSingleton","service","localityBonus","canComputeWordRanges","wordRanges","computeWordRanges","wordUntilPos","wordLines","isFalsyOrEmpty","bestWordRange","blockDistance","foreground"],"sourceRoot":""}