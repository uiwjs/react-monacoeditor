{"version":3,"file":"static/js/monaco-editor-vendor.1b18e904.4abf5294.js","mappings":"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","sources":["../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/hiddenRangeModel.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/folding.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingDecorations.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingModel.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingRanges.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/indentRangeProvider.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/syntaxRangeProvider.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/browser/fontZoom.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/format.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formatActions.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formattingEdit.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/markerNavigationService.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoErrorWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoError.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToSymbol.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesTree.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/referencesModel.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findFirstIdxMonotonousOrArrLen } from '../../../../base/common/arraysFind.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Range } from '../../../common/core/range.js';\nimport { countEOL } from '../../../common/core/eolCounter.js';\nexport class HiddenRangeModel {\n    get onDidChange() { return this._updateEventEmitter.event; }\n    get hiddenRanges() { return this._hiddenRanges; }\n    constructor(model) {\n        this._updateEventEmitter = new Emitter();\n        this._hasLineChanges = false;\n        this._foldingModel = model;\n        this._foldingModelListener = model.onDidChange(_ => this.updateHiddenRanges());\n        this._hiddenRanges = [];\n        if (model.regions.length) {\n            this.updateHiddenRanges();\n        }\n    }\n    notifyChangeModelContent(e) {\n        if (this._hiddenRanges.length && !this._hasLineChanges) {\n            this._hasLineChanges = e.changes.some(change => {\n                return change.range.endLineNumber !== change.range.startLineNumber || countEOL(change.text)[0] !== 0;\n            });\n        }\n    }\n    updateHiddenRanges() {\n        let updateHiddenAreas = false;\n        const newHiddenAreas = [];\n        let i = 0; // index into hidden\n        let k = 0;\n        let lastCollapsedStart = Number.MAX_VALUE;\n        let lastCollapsedEnd = -1;\n        const ranges = this._foldingModel.regions;\n        for (; i < ranges.length; i++) {\n            if (!ranges.isCollapsed(i)) {\n                continue;\n            }\n            const startLineNumber = ranges.getStartLineNumber(i) + 1; // the first line is not hidden\n            const endLineNumber = ranges.getEndLineNumber(i);\n            if (lastCollapsedStart <= startLineNumber && endLineNumber <= lastCollapsedEnd) {\n                // ignore ranges contained in collapsed regions\n                continue;\n            }\n            if (!updateHiddenAreas && k < this._hiddenRanges.length && this._hiddenRanges[k].startLineNumber === startLineNumber && this._hiddenRanges[k].endLineNumber === endLineNumber) {\n                // reuse the old ranges\n                newHiddenAreas.push(this._hiddenRanges[k]);\n                k++;\n            }\n            else {\n                updateHiddenAreas = true;\n                newHiddenAreas.push(new Range(startLineNumber, 1, endLineNumber, 1));\n            }\n            lastCollapsedStart = startLineNumber;\n            lastCollapsedEnd = endLineNumber;\n        }\n        if (this._hasLineChanges || updateHiddenAreas || k < this._hiddenRanges.length) {\n            this.applyHiddenRanges(newHiddenAreas);\n        }\n    }\n    applyHiddenRanges(newHiddenAreas) {\n        this._hiddenRanges = newHiddenAreas;\n        this._hasLineChanges = false;\n        this._updateEventEmitter.fire(newHiddenAreas);\n    }\n    hasRanges() {\n        return this._hiddenRanges.length > 0;\n    }\n    isHidden(line) {\n        return findRange(this._hiddenRanges, line) !== null;\n    }\n    adjustSelections(selections) {\n        let hasChanges = false;\n        const editorModel = this._foldingModel.textModel;\n        let lastRange = null;\n        const adjustLine = (line) => {\n            if (!lastRange || !isInside(line, lastRange)) {\n                lastRange = findRange(this._hiddenRanges, line);\n            }\n            if (lastRange) {\n                return lastRange.startLineNumber - 1;\n            }\n            return null;\n        };\n        for (let i = 0, len = selections.length; i < len; i++) {\n            let selection = selections[i];\n            const adjustedStartLine = adjustLine(selection.startLineNumber);\n            if (adjustedStartLine) {\n                selection = selection.setStartPosition(adjustedStartLine, editorModel.getLineMaxColumn(adjustedStartLine));\n                hasChanges = true;\n            }\n            const adjustedEndLine = adjustLine(selection.endLineNumber);\n            if (adjustedEndLine) {\n                selection = selection.setEndPosition(adjustedEndLine, editorModel.getLineMaxColumn(adjustedEndLine));\n                hasChanges = true;\n            }\n            selections[i] = selection;\n        }\n        return hasChanges;\n    }\n    dispose() {\n        if (this.hiddenRanges.length > 0) {\n            this._hiddenRanges = [];\n            this._updateEventEmitter.fire(this._hiddenRanges);\n        }\n        if (this._foldingModelListener) {\n            this._foldingModelListener.dispose();\n            this._foldingModelListener = null;\n        }\n    }\n}\nfunction isInside(line, range) {\n    return line >= range.startLineNumber && line <= range.endLineNumber;\n}\nfunction findRange(ranges, line) {\n    const i = findFirstIdxMonotonousOrArrLen(ranges, r => line < r.startLineNumber) - 1;\n    if (i >= 0 && ranges[i].endLineNumber >= line) {\n        return ranges[i];\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar FoldingController_1;\nimport { createCancelablePromise, Delayer, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport * as types from '../../../../base/common/types.js';\nimport './folding.css';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { FoldingRangeKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { FoldingModel, getNextFoldLine, getParentFoldLine as getParentFoldLine, getPreviousFoldLine, setCollapseStateAtLevel, setCollapseStateForMatchingLines, setCollapseStateForRest, setCollapseStateForType, setCollapseStateLevelsDown, setCollapseStateLevelsUp, setCollapseStateUp, toggleCollapseState } from './foldingModel.js';\nimport { HiddenRangeModel } from './hiddenRangeModel.js';\nimport { IndentRangeProvider } from './indentRangeProvider.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { FoldingDecorationProvider } from './foldingDecorations.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { SyntaxRangeProvider } from './syntaxRangeProvider.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nconst CONTEXT_FOLDING_ENABLED = new RawContextKey('foldingEnabled', false);\nlet FoldingController = FoldingController_1 = class FoldingController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(FoldingController_1.ID);\n    }\n    static getFoldingRangeProviders(languageFeaturesService, model) {\n        var _a, _b;\n        const foldingRangeProviders = languageFeaturesService.foldingRangeProvider.ordered(model);\n        return (_b = ((_a = FoldingController_1._foldingRangeSelector) === null || _a === void 0 ? void 0 : _a.call(FoldingController_1, foldingRangeProviders, model))) !== null && _b !== void 0 ? _b : foldingRangeProviders;\n    }\n    constructor(editor, contextKeyService, languageConfigurationService, notificationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this.contextKeyService = contextKeyService;\n        this.languageConfigurationService = languageConfigurationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.localToDispose = this._register(new DisposableStore());\n        this.editor = editor;\n        this._foldingLimitReporter = new RangesLimitReporter(editor);\n        const options = this.editor.getOptions();\n        this._isEnabled = options.get(43 /* EditorOption.folding */);\n        this._useFoldingProviders = options.get(44 /* EditorOption.foldingStrategy */) !== 'indentation';\n        this._unfoldOnClickAfterEndOfLine = options.get(48 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n        this._restoringViewState = false;\n        this._currentModelHasFoldedImports = false;\n        this._foldingImportsByDefault = options.get(46 /* EditorOption.foldingImportsByDefault */);\n        this.updateDebounceInfo = languageFeatureDebounceService.for(languageFeaturesService.foldingRangeProvider, 'Folding', { min: 200 });\n        this.foldingModel = null;\n        this.hiddenRangeModel = null;\n        this.rangeProvider = null;\n        this.foldingRegionPromise = null;\n        this.foldingModelPromise = null;\n        this.updateScheduler = null;\n        this.cursorChangedScheduler = null;\n        this.mouseDownInfo = null;\n        this.foldingDecorationProvider = new FoldingDecorationProvider(editor);\n        this.foldingDecorationProvider.showFoldingControls = options.get(109 /* EditorOption.showFoldingControls */);\n        this.foldingDecorationProvider.showFoldingHighlights = options.get(45 /* EditorOption.foldingHighlight */);\n        this.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService);\n        this.foldingEnabled.set(this._isEnabled);\n        this._register(this.editor.onDidChangeModel(() => this.onModelChanged()));\n        this._register(this.editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(43 /* EditorOption.folding */)) {\n                this._isEnabled = this.editor.getOptions().get(43 /* EditorOption.folding */);\n                this.foldingEnabled.set(this._isEnabled);\n                this.onModelChanged();\n            }\n            if (e.hasChanged(47 /* EditorOption.foldingMaximumRegions */)) {\n                this.onModelChanged();\n            }\n            if (e.hasChanged(109 /* EditorOption.showFoldingControls */) || e.hasChanged(45 /* EditorOption.foldingHighlight */)) {\n                const options = this.editor.getOptions();\n                this.foldingDecorationProvider.showFoldingControls = options.get(109 /* EditorOption.showFoldingControls */);\n                this.foldingDecorationProvider.showFoldingHighlights = options.get(45 /* EditorOption.foldingHighlight */);\n                this.triggerFoldingModelChanged();\n            }\n            if (e.hasChanged(44 /* EditorOption.foldingStrategy */)) {\n                this._useFoldingProviders = this.editor.getOptions().get(44 /* EditorOption.foldingStrategy */) !== 'indentation';\n                this.onFoldingStrategyChanged();\n            }\n            if (e.hasChanged(48 /* EditorOption.unfoldOnClickAfterEndOfLine */)) {\n                this._unfoldOnClickAfterEndOfLine = this.editor.getOptions().get(48 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n            }\n            if (e.hasChanged(46 /* EditorOption.foldingImportsByDefault */)) {\n                this._foldingImportsByDefault = this.editor.getOptions().get(46 /* EditorOption.foldingImportsByDefault */);\n            }\n        }));\n        this.onModelChanged();\n    }\n    /**\n     * Store view state.\n     */\n    saveViewState() {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\n            return {};\n        }\n        if (this.foldingModel) { // disposed ?\n            const collapsedRegions = this.foldingModel.getMemento();\n            const provider = this.rangeProvider ? this.rangeProvider.id : undefined;\n            return { collapsedRegions, lineCount: model.getLineCount(), provider, foldedImports: this._currentModelHasFoldedImports };\n        }\n        return undefined;\n    }\n    /**\n     * Restore view state.\n     */\n    restoreViewState(state) {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization() || !this.hiddenRangeModel) {\n            return;\n        }\n        if (!state) {\n            return;\n        }\n        this._currentModelHasFoldedImports = !!state.foldedImports;\n        if (state.collapsedRegions && state.collapsedRegions.length > 0 && this.foldingModel) {\n            this._restoringViewState = true;\n            try {\n                this.foldingModel.applyMemento(state.collapsedRegions);\n            }\n            finally {\n                this._restoringViewState = false;\n            }\n        }\n    }\n    onModelChanged() {\n        this.localToDispose.clear();\n        const model = this.editor.getModel();\n        if (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\n            // huge files get no view model, so they cannot support hidden areas\n            return;\n        }\n        this._currentModelHasFoldedImports = false;\n        this.foldingModel = new FoldingModel(model, this.foldingDecorationProvider);\n        this.localToDispose.add(this.foldingModel);\n        this.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\n        this.localToDispose.add(this.hiddenRangeModel);\n        this.localToDispose.add(this.hiddenRangeModel.onDidChange(hr => this.onHiddenRangesChanges(hr)));\n        this.updateScheduler = new Delayer(this.updateDebounceInfo.get(model));\n        this.cursorChangedScheduler = new RunOnceScheduler(() => this.revealCursor(), 200);\n        this.localToDispose.add(this.cursorChangedScheduler);\n        this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(() => this.onFoldingStrategyChanged()));\n        this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(() => this.onFoldingStrategyChanged())); // covers model language changes as well\n        this.localToDispose.add(this.editor.onDidChangeModelContent(e => this.onDidChangeModelContent(e)));\n        this.localToDispose.add(this.editor.onDidChangeCursorPosition(() => this.onCursorPositionChanged()));\n        this.localToDispose.add(this.editor.onMouseDown(e => this.onEditorMouseDown(e)));\n        this.localToDispose.add(this.editor.onMouseUp(e => this.onEditorMouseUp(e)));\n        this.localToDispose.add({\n            dispose: () => {\n                var _a, _b;\n                if (this.foldingRegionPromise) {\n                    this.foldingRegionPromise.cancel();\n                    this.foldingRegionPromise = null;\n                }\n                (_a = this.updateScheduler) === null || _a === void 0 ? void 0 : _a.cancel();\n                this.updateScheduler = null;\n                this.foldingModel = null;\n                this.foldingModelPromise = null;\n                this.hiddenRangeModel = null;\n                this.cursorChangedScheduler = null;\n                (_b = this.rangeProvider) === null || _b === void 0 ? void 0 : _b.dispose();\n                this.rangeProvider = null;\n            }\n        });\n        this.triggerFoldingModelChanged();\n    }\n    onFoldingStrategyChanged() {\n        var _a;\n        (_a = this.rangeProvider) === null || _a === void 0 ? void 0 : _a.dispose();\n        this.rangeProvider = null;\n        this.triggerFoldingModelChanged();\n    }\n    getRangeProvider(editorModel) {\n        if (this.rangeProvider) {\n            return this.rangeProvider;\n        }\n        const indentRangeProvider = new IndentRangeProvider(editorModel, this.languageConfigurationService, this._foldingLimitReporter);\n        this.rangeProvider = indentRangeProvider; // fallback\n        if (this._useFoldingProviders && this.foldingModel) {\n            const selectedProviders = FoldingController_1.getFoldingRangeProviders(this.languageFeaturesService, editorModel);\n            if (selectedProviders.length > 0) {\n                this.rangeProvider = new SyntaxRangeProvider(editorModel, selectedProviders, () => this.triggerFoldingModelChanged(), this._foldingLimitReporter, indentRangeProvider);\n            }\n        }\n        return this.rangeProvider;\n    }\n    getFoldingModel() {\n        return this.foldingModelPromise;\n    }\n    onDidChangeModelContent(e) {\n        var _a;\n        (_a = this.hiddenRangeModel) === null || _a === void 0 ? void 0 : _a.notifyChangeModelContent(e);\n        this.triggerFoldingModelChanged();\n    }\n    triggerFoldingModelChanged() {\n        if (this.updateScheduler) {\n            if (this.foldingRegionPromise) {\n                this.foldingRegionPromise.cancel();\n                this.foldingRegionPromise = null;\n            }\n            this.foldingModelPromise = this.updateScheduler.trigger(() => {\n                const foldingModel = this.foldingModel;\n                if (!foldingModel) { // null if editor has been disposed, or folding turned off\n                    return null;\n                }\n                const sw = new StopWatch();\n                const provider = this.getRangeProvider(foldingModel.textModel);\n                const foldingRegionPromise = this.foldingRegionPromise = createCancelablePromise(token => provider.compute(token));\n                return foldingRegionPromise.then(foldingRanges => {\n                    if (foldingRanges && foldingRegionPromise === this.foldingRegionPromise) { // new request or cancelled in the meantime?\n                        let scrollState;\n                        if (this._foldingImportsByDefault && !this._currentModelHasFoldedImports) {\n                            const hasChanges = foldingRanges.setCollapsedAllOfType(FoldingRangeKind.Imports.value, true);\n                            if (hasChanges) {\n                                scrollState = StableEditorScrollState.capture(this.editor);\n                                this._currentModelHasFoldedImports = hasChanges;\n                            }\n                        }\n                        // some cursors might have moved into hidden regions, make sure they are in expanded regions\n                        const selections = this.editor.getSelections();\n                        const selectionLineNumbers = selections ? selections.map(s => s.startLineNumber) : [];\n                        foldingModel.update(foldingRanges, selectionLineNumbers);\n                        scrollState === null || scrollState === void 0 ? void 0 : scrollState.restore(this.editor);\n                        // update debounce info\n                        const newValue = this.updateDebounceInfo.update(foldingModel.textModel, sw.elapsed());\n                        if (this.updateScheduler) {\n                            this.updateScheduler.defaultDelay = newValue;\n                        }\n                    }\n                    return foldingModel;\n                });\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return null;\n            });\n        }\n    }\n    onHiddenRangesChanges(hiddenRanges) {\n        if (this.hiddenRangeModel && hiddenRanges.length && !this._restoringViewState) {\n            const selections = this.editor.getSelections();\n            if (selections) {\n                if (this.hiddenRangeModel.adjustSelections(selections)) {\n                    this.editor.setSelections(selections);\n                }\n            }\n        }\n        this.editor.setHiddenAreas(hiddenRanges, this);\n    }\n    onCursorPositionChanged() {\n        if (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\n            this.cursorChangedScheduler.schedule();\n        }\n    }\n    revealCursor() {\n        const foldingModel = this.getFoldingModel();\n        if (!foldingModel) {\n            return;\n        }\n        foldingModel.then(foldingModel => {\n            if (foldingModel) {\n                const selections = this.editor.getSelections();\n                if (selections && selections.length > 0) {\n                    const toToggle = [];\n                    for (const selection of selections) {\n                        const lineNumber = selection.selectionStartLineNumber;\n                        if (this.hiddenRangeModel && this.hiddenRangeModel.isHidden(lineNumber)) {\n                            toToggle.push(...foldingModel.getAllRegionsAtLine(lineNumber, r => r.isCollapsed && lineNumber > r.startLineNumber));\n                        }\n                    }\n                    if (toToggle.length) {\n                        foldingModel.toggleCollapseState(toToggle);\n                        this.reveal(selections[0].getPosition());\n                    }\n                }\n            }\n        }).then(undefined, onUnexpectedError);\n    }\n    onEditorMouseDown(e) {\n        this.mouseDownInfo = null;\n        if (!this.hiddenRangeModel || !e.target || !e.target.range) {\n            return;\n        }\n        if (!e.event.leftButton && !e.event.middleButton) {\n            return;\n        }\n        const range = e.target.range;\n        let iconClicked = false;\n        switch (e.target.type) {\n            case 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */: {\n                const data = e.target.detail;\n                const offsetLeftInGutter = e.target.element.offsetLeft;\n                const gutterOffsetX = data.offsetX - offsetLeftInGutter;\n                // const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\n                // TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\n                if (gutterOffsetX < 4) { // the whitespace between the border and the real folding icon border is 4px\n                    return;\n                }\n                iconClicked = true;\n                break;\n            }\n            case 7 /* MouseTargetType.CONTENT_EMPTY */: {\n                if (this._unfoldOnClickAfterEndOfLine && this.hiddenRangeModel.hasRanges()) {\n                    const data = e.target.detail;\n                    if (!data.isAfterLines) {\n                        break;\n                    }\n                }\n                return;\n            }\n            case 6 /* MouseTargetType.CONTENT_TEXT */: {\n                if (this.hiddenRangeModel.hasRanges()) {\n                    const model = this.editor.getModel();\n                    if (model && range.startColumn === model.getLineMaxColumn(range.startLineNumber)) {\n                        break;\n                    }\n                }\n                return;\n            }\n            default:\n                return;\n        }\n        this.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked };\n    }\n    onEditorMouseUp(e) {\n        const foldingModel = this.foldingModel;\n        if (!foldingModel || !this.mouseDownInfo || !e.target) {\n            return;\n        }\n        const lineNumber = this.mouseDownInfo.lineNumber;\n        const iconClicked = this.mouseDownInfo.iconClicked;\n        const range = e.target.range;\n        if (!range || range.startLineNumber !== lineNumber) {\n            return;\n        }\n        if (iconClicked) {\n            if (e.target.type !== 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */) {\n                return;\n            }\n        }\n        else {\n            const model = this.editor.getModel();\n            if (!model || range.startColumn !== model.getLineMaxColumn(lineNumber)) {\n                return;\n            }\n        }\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region && region.startLineNumber === lineNumber) {\n            const isCollapsed = region.isCollapsed;\n            if (iconClicked || isCollapsed) {\n                const surrounding = e.event.altKey;\n                let toToggle = [];\n                if (surrounding) {\n                    const filter = (otherRegion) => !otherRegion.containedBy(region) && !region.containedBy(otherRegion);\n                    const toMaybeToggle = foldingModel.getRegionsInside(null, filter);\n                    for (const r of toMaybeToggle) {\n                        if (r.isCollapsed) {\n                            toToggle.push(r);\n                        }\n                    }\n                    // if any surrounding regions are folded, unfold those. Otherwise, fold all surrounding\n                    if (toToggle.length === 0) {\n                        toToggle = toMaybeToggle;\n                    }\n                }\n                else {\n                    const recursive = e.event.middleButton || e.event.shiftKey;\n                    if (recursive) {\n                        for (const r of foldingModel.getRegionsInside(region)) {\n                            if (r.isCollapsed === isCollapsed) {\n                                toToggle.push(r);\n                            }\n                        }\n                    }\n                    // when recursive, first only collapse all children. If all are already folded or there are no children, also fold parent.\n                    if (isCollapsed || !recursive || toToggle.length === 0) {\n                        toToggle.push(region);\n                    }\n                }\n                foldingModel.toggleCollapseState(toToggle);\n                this.reveal({ lineNumber, column: 1 });\n            }\n        }\n    }\n    reveal(position) {\n        this.editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n    }\n};\nFoldingController.ID = 'editor.contrib.folding';\nFoldingController = FoldingController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageConfigurationService),\n    __param(3, INotificationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], FoldingController);\nexport { FoldingController };\nexport class RangesLimitReporter {\n    constructor(editor) {\n        this.editor = editor;\n        this._onDidChange = new Emitter();\n        this._computed = 0;\n        this._limited = false;\n    }\n    get limit() {\n        return this.editor.getOptions().get(47 /* EditorOption.foldingMaximumRegions */);\n    }\n    update(computed, limited) {\n        if (computed !== this._computed || limited !== this._limited) {\n            this._computed = computed;\n            this._limited = limited;\n            this._onDidChange.fire();\n        }\n    }\n}\nclass FoldingAction extends EditorAction {\n    runEditorCommand(accessor, editor, args) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const foldingController = FoldingController.get(editor);\n        if (!foldingController) {\n            return;\n        }\n        const foldingModelPromise = foldingController.getFoldingModel();\n        if (foldingModelPromise) {\n            this.reportTelemetry(accessor, editor);\n            return foldingModelPromise.then(foldingModel => {\n                if (foldingModel) {\n                    this.invoke(foldingController, foldingModel, editor, args, languageConfigurationService);\n                    const selection = editor.getSelection();\n                    if (selection) {\n                        foldingController.reveal(selection.getStartPosition());\n                    }\n                }\n            });\n        }\n    }\n    getSelectedLines(editor) {\n        const selections = editor.getSelections();\n        return selections ? selections.map(s => s.startLineNumber) : [];\n    }\n    getLineNumbers(args, editor) {\n        if (args && args.selectionLines) {\n            return args.selectionLines.map(l => l + 1); // to 0-bases line numbers\n        }\n        return this.getSelectedLines(editor);\n    }\n    run(_accessor, _editor) {\n    }\n}\nfunction foldingArgumentsConstraint(args) {\n    if (!types.isUndefined(args)) {\n        if (!types.isObject(args)) {\n            return false;\n        }\n        const foldingArgs = args;\n        if (!types.isUndefined(foldingArgs.levels) && !types.isNumber(foldingArgs.levels)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.direction) && !types.isString(foldingArgs.direction)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.selectionLines) && (!Array.isArray(foldingArgs.selectionLines) || !foldingArgs.selectionLines.every(types.isNumber))) {\n            return false;\n        }\n    }\n    return true;\n}\nclass UnfoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfold',\n            label: nls.localize('unfoldAction.label', \"Unfold\"),\n            alias: 'Unfold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 94 /* KeyCode.BracketRight */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 94 /* KeyCode.BracketRight */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            description: {\n                description: 'Unfold the content in the editor',\n                args: [\n                    {\n                        name: 'Unfold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                    'default': 1\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                    'default': 'down'\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const levels = args && args.levels || 1;\n        const lineNumbers = this.getLineNumbers(args, editor);\n        if (args && args.direction === 'up') {\n            setCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\n        }\n        else {\n            setCollapseStateLevelsDown(foldingModel, false, levels, lineNumbers);\n        }\n    }\n}\nclass UnFoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldRecursively',\n            label: nls.localize('unFoldRecursivelyAction.label', \"Unfold Recursively\"),\n            alias: 'Unfold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 94 /* KeyCode.BracketRight */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, _args) {\n        setCollapseStateLevelsDown(foldingModel, false, Number.MAX_VALUE, this.getSelectedLines(editor));\n    }\n}\nclass FoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.fold',\n            label: nls.localize('foldAction.label', \"Fold\"),\n            alias: 'Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 92 /* KeyCode.BracketLeft */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 92 /* KeyCode.BracketLeft */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            description: {\n                description: 'Fold the content in the editor',\n                args: [\n                    {\n                        name: 'Fold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const lineNumbers = this.getLineNumbers(args, editor);\n        const levels = args && args.levels;\n        const direction = args && args.direction;\n        if (typeof levels !== 'number' && typeof direction !== 'string') {\n            // fold the region at the location or if already collapsed, the first uncollapsed parent instead.\n            setCollapseStateUp(foldingModel, true, lineNumbers);\n        }\n        else {\n            if (direction === 'up') {\n                setCollapseStateLevelsUp(foldingModel, true, levels || 1, lineNumbers);\n            }\n            else {\n                setCollapseStateLevelsDown(foldingModel, true, levels || 1, lineNumbers);\n            }\n        }\n    }\n}\nclass ToggleFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.toggleFold',\n            label: nls.localize('toggleFoldAction.label', \"Toggle Fold\"),\n            alias: 'Toggle Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 42 /* KeyCode.KeyL */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        toggleCollapseState(foldingModel, 1, selectedLines);\n    }\n}\nclass FoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldRecursively',\n            label: nls.localize('foldRecursivelyAction.label', \"Fold Recursively\"),\n            alias: 'Fold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 92 /* KeyCode.BracketLeft */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateLevelsDown(foldingModel, true, Number.MAX_VALUE, selectedLines);\n    }\n}\nclass FoldAllBlockCommentsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllBlockComments',\n            label: nls.localize('foldAllBlockComments.label', \"Fold All Block Comments\"),\n            alias: 'Fold All Block Comments',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Comment.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const comments = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).comments;\n            if (comments && comments.blockCommentStartToken) {\n                const regExp = new RegExp('^\\\\s*' + escapeRegExpCharacters(comments.blockCommentStartToken));\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass FoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllMarkerRegions',\n            label: nls.localize('foldAllMarkerRegions.label', \"Fold All Regions\"),\n            alias: 'Fold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 29 /* KeyCode.Digit8 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass UnfoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllMarkerRegions',\n            label: nls.localize('unfoldAllMarkerRegions.label', \"Unfold All Regions\"),\n            alias: 'Unfold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 30 /* KeyCode.Digit9 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, false);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, false);\n            }\n        }\n    }\n}\nclass FoldAllExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllExcept',\n            label: nls.localize('foldAllExcept.label', \"Fold All Except Selected\"),\n            alias: 'Fold All Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 88 /* KeyCode.Minus */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, true, selectedLines);\n    }\n}\nclass UnfoldAllExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllExcept',\n            label: nls.localize('unfoldAllExcept.label', \"Unfold All Except Selected\"),\n            alias: 'Unfold All Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 86 /* KeyCode.Equal */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, false, selectedLines);\n    }\n}\nclass FoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAll',\n            label: nls.localize('foldAllAction.label', \"Fold All\"),\n            alias: 'Fold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 21 /* KeyCode.Digit0 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, true);\n    }\n}\nclass UnfoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAll',\n            label: nls.localize('unfoldAllAction.label', \"Unfold All\"),\n            alias: 'Unfold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 40 /* KeyCode.KeyJ */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, false);\n    }\n}\nclass FoldLevelAction extends FoldingAction {\n    getFoldingLevel() {\n        return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length));\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        setCollapseStateAtLevel(foldingModel, this.getFoldingLevel(), true, this.getSelectedLines(editor));\n    }\n}\nFoldLevelAction.ID_PREFIX = 'editor.foldLevel';\nFoldLevelAction.ID = (level) => FoldLevelAction.ID_PREFIX + level;\n/** Action to go to the parent fold of current line */\nclass GotoParentFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoParentFold',\n            label: nls.localize('gotoParentFold.label', \"Go to Parent Fold\"),\n            alias: 'Go to Parent Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getParentFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the previous fold of current line */\nclass GotoPreviousFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoPreviousFold',\n            label: nls.localize('gotoPreviousFold.label', \"Go to Previous Folding Range\"),\n            alias: 'Go to Previous Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getPreviousFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the next fold of current line */\nclass GotoNextFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoNextFold',\n            label: nls.localize('gotoNextFold.label', \"Go to Next Folding Range\"),\n            alias: 'Go to Next Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getNextFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\nclass FoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.createFoldingRangeFromSelection',\n            label: nls.localize('createManualFoldRange.label', \"Create Folding Range from Selection\"),\n            alias: 'Create Folding Range from Selection',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 87 /* KeyCode.Comma */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        var _a;\n        const collapseRanges = [];\n        const selections = editor.getSelections();\n        if (selections) {\n            for (const selection of selections) {\n                let endLineNumber = selection.endLineNumber;\n                if (selection.endColumn === 1) {\n                    --endLineNumber;\n                }\n                if (endLineNumber > selection.startLineNumber) {\n                    collapseRanges.push({\n                        startLineNumber: selection.startLineNumber,\n                        endLineNumber: endLineNumber,\n                        type: undefined,\n                        isCollapsed: true,\n                        source: 1 /* FoldSource.userDefined */\n                    });\n                    editor.setSelection({\n                        startLineNumber: selection.startLineNumber,\n                        startColumn: 1,\n                        endLineNumber: selection.startLineNumber,\n                        endColumn: 1\n                    });\n                }\n            }\n            if (collapseRanges.length > 0) {\n                collapseRanges.sort((a, b) => {\n                    return a.startLineNumber - b.startLineNumber;\n                });\n                const newRanges = FoldingRegions.sanitizeAndMerge(foldingModel.regions, collapseRanges, (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLineCount());\n                foldingModel.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n            }\n        }\n    }\n}\nclass RemoveFoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.removeManualFoldingRanges',\n            label: nls.localize('removeManualFoldingRanges.label', \"Remove Manual Folding Ranges\"),\n            alias: 'Remove Manual Folding Ranges',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(foldingController, foldingModel, editor) {\n        const selections = editor.getSelections();\n        if (selections) {\n            const ranges = [];\n            for (const selection of selections) {\n                const { startLineNumber, endLineNumber } = selection;\n                ranges.push(endLineNumber >= startLineNumber ? { startLineNumber, endLineNumber } : { endLineNumber, startLineNumber });\n            }\n            foldingModel.removeManualRanges(ranges);\n            foldingController.triggerFoldingModelChanged();\n        }\n    }\n}\nregisterEditorContribution(FoldingController.ID, FoldingController, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(UnfoldAction);\nregisterEditorAction(UnFoldRecursivelyAction);\nregisterEditorAction(FoldAction);\nregisterEditorAction(FoldRecursivelyAction);\nregisterEditorAction(FoldAllAction);\nregisterEditorAction(UnfoldAllAction);\nregisterEditorAction(FoldAllBlockCommentsAction);\nregisterEditorAction(FoldAllRegionsAction);\nregisterEditorAction(UnfoldAllRegionsAction);\nregisterEditorAction(FoldAllExceptAction);\nregisterEditorAction(UnfoldAllExceptAction);\nregisterEditorAction(ToggleFoldAction);\nregisterEditorAction(GotoParentFoldAction);\nregisterEditorAction(GotoPreviousFoldAction);\nregisterEditorAction(GotoNextFoldAction);\nregisterEditorAction(FoldRangeFromSelectionAction);\nregisterEditorAction(RemoveFoldRangeFromSelectionAction);\nfor (let i = 1; i <= 7; i++) {\n    registerInstantiatedEditorAction(new FoldLevelAction({\n        id: FoldLevelAction.ID(i),\n        label: nls.localize('foldLevelAction.label', \"Fold Level {0}\", i),\n        alias: `Fold Level ${i}`,\n        precondition: CONTEXT_FOLDING_ENABLED,\n        kbOpts: {\n            kbExpr: EditorContextKeys.editorTextFocus,\n            primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | (21 /* KeyCode.Digit0 */ + i)),\n            weight: 100 /* KeybindingWeight.EditorContrib */\n        }\n    }));\n}\nCommandsRegistry.registerCommand('_executeFoldingRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource] = args;\n        if (!(resource instanceof URI)) {\n            throw illegalArgument();\n        }\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = accessor.get(IModelService).getModel(resource);\n        if (!model) {\n            throw illegalArgument();\n        }\n        const configurationService = accessor.get(IConfigurationService);\n        if (!configurationService.getValue('editor.folding', { resource })) {\n            return [];\n        }\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const strategy = configurationService.getValue('editor.foldingStrategy', { resource });\n        const foldingLimitReporter = {\n            get limit() {\n                return configurationService.getValue('editor.foldingMaximumRegions', { resource });\n            },\n            update: (computed, limited) => { }\n        };\n        const indentRangeProvider = new IndentRangeProvider(model, languageConfigurationService, foldingLimitReporter);\n        let rangeProvider = indentRangeProvider;\n        if (strategy !== 'indentation') {\n            const providers = FoldingController.getFoldingRangeProviders(languageFeaturesService, model);\n            if (providers.length) {\n                rangeProvider = new SyntaxRangeProvider(model, providers, () => { }, foldingLimitReporter, indentRangeProvider);\n            }\n        }\n        const ranges = yield rangeProvider.compute(CancellationToken.None);\n        const result = [];\n        try {\n            if (ranges) {\n                for (let i = 0; i < ranges.length; i++) {\n                    const type = ranges.getType(i);\n                    result.push({ start: ranges.getStartLineNumber(i), end: ranges.getEndLineNumber(i), kind: type ? FoldingRangeKind.fromValue(type) : undefined });\n                }\n            }\n            return result;\n        }\n        finally {\n            rangeProvider.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { MinimapPosition } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { localize } from '../../../../nls.js';\nimport { editorSelectionBackground, iconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nconst foldBackground = registerColor('editor.foldBackground', { light: transparent(editorSelectionBackground, 0.3), dark: transparent(editorSelectionBackground, 0.3), hcDark: null, hcLight: null }, localize('foldBackgroundBackground', \"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations.\"), true);\nregisterColor('editorGutter.foldingControlForeground', { dark: iconForeground, light: iconForeground, hcDark: iconForeground, hcLight: iconForeground }, localize('editorGutter.foldingControlForeground', 'Color of the folding control in the editor gutter.'));\nexport const foldingExpandedIcon = registerIcon('folding-expanded', Codicon.chevronDown, localize('foldingExpandedIcon', 'Icon for expanded ranges in the editor glyph margin.'));\nexport const foldingCollapsedIcon = registerIcon('folding-collapsed', Codicon.chevronRight, localize('foldingCollapsedIcon', 'Icon for collapsed ranges in the editor glyph margin.'));\nexport const foldingManualCollapsedIcon = registerIcon('folding-manual-collapsed', foldingCollapsedIcon, localize('foldingManualCollapedIcon', 'Icon for manually collapsed ranges in the editor glyph margin.'));\nexport const foldingManualExpandedIcon = registerIcon('folding-manual-expanded', foldingExpandedIcon, localize('foldingManualExpandedIcon', 'Icon for manually expanded ranges in the editor glyph margin.'));\nconst foldedBackgroundMinimap = { color: themeColorFromId(foldBackground), position: MinimapPosition.Inline };\nexport class FoldingDecorationProvider {\n    constructor(editor) {\n        this.editor = editor;\n        this.showFoldingControls = 'mouseover';\n        this.showFoldingHighlights = true;\n    }\n    getDecorationOption(isCollapsed, isHidden, isManual) {\n        if (isHidden) { // is inside another collapsed region\n            return FoldingDecorationProvider.HIDDEN_RANGE_DECORATION;\n        }\n        if (this.showFoldingControls === 'never') {\n            if (isCollapsed) {\n                return this.showFoldingHighlights ? FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION : FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION;\n            }\n            return FoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION;\n        }\n        if (isCollapsed) {\n            return isManual ?\n                (this.showFoldingHighlights ? FoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION)\n                : (this.showFoldingHighlights ? FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION);\n        }\n        else if (this.showFoldingControls === 'mouseover') {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION;\n        }\n        else {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION;\n        }\n    }\n    changeDecorations(callback) {\n        return this.editor.changeDecorations(callback);\n    }\n    removeDecorations(decorationIds) {\n        this.editor.removeDecorations(decorationIds);\n    }\n}\nFoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon),\n});\nFoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n});\nFoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true\n});\nFoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true\n});\nFoldingDecorationProvider.EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingExpandedIcon)\n});\nFoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-auto-hide-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingExpandedIcon)\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingManualExpandedIcon)\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-auto-hide-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualExpandedIcon)\n});\nFoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true\n});\nFoldingDecorationProvider.HIDDEN_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-hidden-range-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { hash } from '../../../../base/common/hash.js';\nexport class FoldingModel {\n    get regions() { return this._regions; }\n    get textModel() { return this._textModel; }\n    constructor(textModel, decorationProvider) {\n        this._updateEventEmitter = new Emitter();\n        this.onDidChange = this._updateEventEmitter.event;\n        this._textModel = textModel;\n        this._decorationProvider = decorationProvider;\n        this._regions = new FoldingRegions(new Uint32Array(0), new Uint32Array(0));\n        this._editorDecorationIds = [];\n    }\n    toggleCollapseState(toggledRegions) {\n        if (!toggledRegions.length) {\n            return;\n        }\n        toggledRegions = toggledRegions.sort((r1, r2) => r1.regionIndex - r2.regionIndex);\n        const processed = {};\n        this._decorationProvider.changeDecorations(accessor => {\n            let k = 0; // index from [0 ... this.regions.length]\n            let dirtyRegionEndLine = -1; // end of the range where decorations need to be updated\n            let lastHiddenLine = -1; // the end of the last hidden lines\n            const updateDecorationsUntil = (index) => {\n                while (k < index) {\n                    const endLineNumber = this._regions.getEndLineNumber(k);\n                    const isCollapsed = this._regions.isCollapsed(k);\n                    if (endLineNumber <= dirtyRegionEndLine) {\n                        const isManual = this.regions.getSource(k) !== 0 /* FoldSource.provider */;\n                        accessor.changeDecorationOptions(this._editorDecorationIds[k], this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual));\n                    }\n                    if (isCollapsed && endLineNumber > lastHiddenLine) {\n                        lastHiddenLine = endLineNumber;\n                    }\n                    k++;\n                }\n            };\n            for (const region of toggledRegions) {\n                const index = region.regionIndex;\n                const editorDecorationId = this._editorDecorationIds[index];\n                if (editorDecorationId && !processed[editorDecorationId]) {\n                    processed[editorDecorationId] = true;\n                    updateDecorationsUntil(index); // update all decorations up to current index using the old dirtyRegionEndLine\n                    const newCollapseState = !this._regions.isCollapsed(index);\n                    this._regions.setCollapsed(index, newCollapseState);\n                    dirtyRegionEndLine = Math.max(dirtyRegionEndLine, this._regions.getEndLineNumber(index));\n                }\n            }\n            updateDecorationsUntil(this._regions.length);\n        });\n        this._updateEventEmitter.fire({ model: this, collapseStateChanged: toggledRegions });\n    }\n    removeManualRanges(ranges) {\n        const newFoldingRanges = new Array();\n        const intersects = (foldRange) => {\n            for (const range of ranges) {\n                if (!(range.startLineNumber > foldRange.endLineNumber || foldRange.startLineNumber > range.endLineNumber)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        for (let i = 0; i < this._regions.length; i++) {\n            const foldRange = this._regions.toFoldRange(i);\n            if (foldRange.source === 0 /* FoldSource.provider */ || !intersects(foldRange)) {\n                newFoldingRanges.push(foldRange);\n            }\n        }\n        this.updatePost(FoldingRegions.fromFoldRanges(newFoldingRanges));\n    }\n    update(newRegions, blockedLineNumers = []) {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges(blockedLineNumers);\n        const newRanges = FoldingRegions.sanitizeAndMerge(newRegions, foldedOrManualRanges, this._textModel.getLineCount());\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    updatePost(newRegions) {\n        const newEditorDecorations = [];\n        let lastHiddenLine = -1;\n        for (let index = 0, limit = newRegions.length; index < limit; index++) {\n            const startLineNumber = newRegions.getStartLineNumber(index);\n            const endLineNumber = newRegions.getEndLineNumber(index);\n            const isCollapsed = newRegions.isCollapsed(index);\n            const isManual = newRegions.getSource(index) !== 0 /* FoldSource.provider */;\n            const decorationRange = {\n                startLineNumber: startLineNumber,\n                startColumn: this._textModel.getLineMaxColumn(startLineNumber),\n                endLineNumber: endLineNumber,\n                endColumn: this._textModel.getLineMaxColumn(endLineNumber) + 1\n            };\n            newEditorDecorations.push({ range: decorationRange, options: this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual) });\n            if (isCollapsed && endLineNumber > lastHiddenLine) {\n                lastHiddenLine = endLineNumber;\n            }\n        }\n        this._decorationProvider.changeDecorations(accessor => this._editorDecorationIds = accessor.deltaDecorations(this._editorDecorationIds, newEditorDecorations));\n        this._regions = newRegions;\n        this._updateEventEmitter.fire({ model: this });\n    }\n    _currentFoldedOrManualRanges(blockedLineNumers = []) {\n        const isBlocked = (startLineNumber, endLineNumber) => {\n            for (const blockedLineNumber of blockedLineNumers) {\n                if (startLineNumber < blockedLineNumber && blockedLineNumber <= endLineNumber) { // first line is visible\n                    return true;\n                }\n            }\n            return false;\n        };\n        const foldedRanges = [];\n        for (let i = 0, limit = this._regions.length; i < limit; i++) {\n            let isCollapsed = this.regions.isCollapsed(i);\n            const source = this.regions.getSource(i);\n            if (isCollapsed || source !== 0 /* FoldSource.provider */) {\n                const foldRange = this._regions.toFoldRange(i);\n                const decRange = this._textModel.getDecorationRange(this._editorDecorationIds[i]);\n                if (decRange) {\n                    if (isCollapsed && isBlocked(decRange.startLineNumber, decRange.endLineNumber)) {\n                        isCollapsed = false; // uncollapse is the range is blocked\n                    }\n                    foldedRanges.push({\n                        startLineNumber: decRange.startLineNumber,\n                        endLineNumber: decRange.endLineNumber,\n                        type: foldRange.type,\n                        isCollapsed,\n                        source\n                    });\n                }\n            }\n        }\n        return foldedRanges;\n    }\n    /**\n     * Collapse state memento, for persistence only\n     */\n    getMemento() {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges();\n        const result = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (let i = 0, limit = foldedOrManualRanges.length; i < limit; i++) {\n            const range = foldedOrManualRanges[i];\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            result.push({\n                startLineNumber: range.startLineNumber,\n                endLineNumber: range.endLineNumber,\n                isCollapsed: range.isCollapsed,\n                source: range.source,\n                checksum: checksum\n            });\n        }\n        return (result.length > 0) ? result : undefined;\n    }\n    /**\n     * Apply persisted state, for persistence only\n     */\n    applyMemento(state) {\n        var _a, _b;\n        if (!Array.isArray(state)) {\n            return;\n        }\n        const rangesToRestore = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (const range of state) {\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            if (!range.checksum || checksum === range.checksum) {\n                rangesToRestore.push({\n                    startLineNumber: range.startLineNumber,\n                    endLineNumber: range.endLineNumber,\n                    type: undefined,\n                    isCollapsed: (_a = range.isCollapsed) !== null && _a !== void 0 ? _a : true,\n                    source: (_b = range.source) !== null && _b !== void 0 ? _b : 0 /* FoldSource.provider */\n                });\n            }\n        }\n        const newRanges = FoldingRegions.sanitizeAndMerge(this._regions, rangesToRestore, maxLineNumber);\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    _getLinesChecksum(lineNumber1, lineNumber2) {\n        const h = hash(this._textModel.getLineContent(lineNumber1)\n            + this._textModel.getLineContent(lineNumber2));\n        return h % 1000000; // 6 digits is plenty\n    }\n    dispose() {\n        this._decorationProvider.removeDecorations(this._editorDecorationIds);\n    }\n    getAllRegionsAtLine(lineNumber, filter) {\n        const result = [];\n        if (this._regions) {\n            let index = this._regions.findRange(lineNumber);\n            let level = 1;\n            while (index >= 0) {\n                const current = this._regions.toRegion(index);\n                if (!filter || filter(current, level)) {\n                    result.push(current);\n                }\n                level++;\n                index = current.parentIndex;\n            }\n        }\n        return result;\n    }\n    getRegionAtLine(lineNumber) {\n        if (this._regions) {\n            const index = this._regions.findRange(lineNumber);\n            if (index >= 0) {\n                return this._regions.toRegion(index);\n            }\n        }\n        return null;\n    }\n    getRegionsInside(region, filter) {\n        const result = [];\n        const index = region ? region.regionIndex + 1 : 0;\n        const endLineNumber = region ? region.endLineNumber : Number.MAX_VALUE;\n        if (filter && filter.length === 2) {\n            const levelStack = [];\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    while (levelStack.length > 0 && !current.containedBy(levelStack[levelStack.length - 1])) {\n                        levelStack.pop();\n                    }\n                    levelStack.push(current);\n                    if (filter(current, levelStack.length)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else {\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    if (!filter || filter(current)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return result;\n    }\n}\n/**\n * Collapse or expand the regions at the given locations\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function toggleCollapseState(foldingModel, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region) {\n            const doCollapse = !region.isCollapsed;\n            toToggle.push(region);\n            if (levels > 1) {\n                const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                toToggle.push(...regionsInside);\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all children.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function setCollapseStateLevelsDown(foldingModel, doCollapse, levels = Number.MAX_VALUE, lineNumbers) {\n    const toToggle = [];\n    if (lineNumbers && lineNumbers.length > 0) {\n        for (const lineNumber of lineNumbers) {\n            const region = foldingModel.getRegionAtLine(lineNumber);\n            if (region) {\n                if (region.isCollapsed !== doCollapse) {\n                    toToggle.push(region);\n                }\n                if (levels > 1) {\n                    const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                    toToggle.push(...regionsInside);\n                }\n            }\n        }\n    }\n    else {\n        const regionsInside = foldingModel.getRegionsInside(null, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n        toToggle.push(...regionsInside);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all parents.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateLevelsUp(foldingModel, doCollapse, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region, level) => region.isCollapsed !== doCollapse && level <= levels);\n        toToggle.push(...regions);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand a region at the given locations. If the inner most region is already collapsed/expanded, uses the first parent instead.\n * @param doCollapse Whether to collapse or expand\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateUp(foldingModel, doCollapse, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region) => region.isCollapsed !== doCollapse);\n        if (regions.length > 0) {\n            toToggle.push(regions[0]);\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions that have a given level, except if they contain one of the blocked lines.\n * @param foldLevel level. Level == 1 is the top level\n * @param doCollapse Whether to collapse or expand\n*/\nexport function setCollapseStateAtLevel(foldingModel, foldLevel, doCollapse, blockedLineNumbers) {\n    const filter = (region, level) => level === foldLevel && region.isCollapsed !== doCollapse && !blockedLineNumbers.some(line => region.containsLine(line));\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions, except if they contain or are contained by a region of one of the blocked lines.\n * @param doCollapse Whether to collapse or expand\n * @param blockedLineNumbers the location of regions to not collapse or expand\n */\nexport function setCollapseStateForRest(foldingModel, doCollapse, blockedLineNumbers) {\n    const filteredRegions = [];\n    for (const lineNumber of blockedLineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, undefined);\n        if (regions.length > 0) {\n            filteredRegions.push(regions[0]);\n        }\n    }\n    const filter = (region) => filteredRegions.every((filteredRegion) => !filteredRegion.containedBy(region) && !region.containedBy(filteredRegion)) && region.isCollapsed !== doCollapse;\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions for which the lines start with a given regex\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForMatchingLines(foldingModel, regExp, doCollapse) {\n    const editorModel = foldingModel.textModel;\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i)) {\n            const startLineNumber = regions.getStartLineNumber(i);\n            if (regExp.test(editorModel.getLineContent(startLineNumber))) {\n                toToggle.push(regions.toRegion(i));\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions of the given type\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForType(foldingModel, type, doCollapse) {\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i) && type === regions.getType(i)) {\n            toToggle.push(regions.toRegion(i));\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Get line to go to for parent fold of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Parent fold start line\n */\nexport function getParentFoldLine(lineNumber, foldingModel) {\n    let startLineNumber = null;\n    const foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    if (foldingRegion !== null) {\n        startLineNumber = foldingRegion.startLineNumber;\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to parent fold\n        if (lineNumber === startLineNumber) {\n            const parentFoldingIdx = foldingRegion.parentIndex;\n            if (parentFoldingIdx !== -1) {\n                startLineNumber = foldingModel.regions.getStartLineNumber(parentFoldingIdx);\n            }\n            else {\n                startLineNumber = null;\n            }\n        }\n    }\n    return startLineNumber;\n}\n/**\n * Get line to go to for previous fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Previous fold start line\n */\nexport function getPreviousFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to previous sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to previous fold.\n        if (lineNumber !== foldingRegion.startLineNumber) {\n            return foldingRegion.startLineNumber;\n        }\n        else {\n            // Find min line number to stay within parent.\n            const expectedParentIndex = foldingRegion.parentIndex;\n            let minLineNumber = 0;\n            if (expectedParentIndex !== -1) {\n                minLineNumber = foldingModel.regions.getStartLineNumber(foldingRegion.parentIndex);\n            }\n            // Find fold at same level.\n            while (foldingRegion !== null) {\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                    // Keep at same level.\n                    if (foldingRegion.startLineNumber <= minLineNumber) {\n                        return null;\n                    }\n                    else if (foldingRegion.parentIndex === expectedParentIndex) {\n                        return foldingRegion.startLineNumber;\n                    }\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n    }\n    else {\n        // Go to last fold that's before the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(foldingModel.regions.length - 1);\n            while (foldingRegion !== null) {\n                // Found fold before current line.\n                if (foldingRegion.startLineNumber < lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n/**\n * Get line to go to next fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Next fold start line\n */\nexport function getNextFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to next sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // Find max line number to stay within parent.\n        const expectedParentIndex = foldingRegion.parentIndex;\n        let maxLineNumber = 0;\n        if (expectedParentIndex !== -1) {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingRegion.parentIndex);\n        }\n        else if (foldingModel.regions.length === 0) {\n            return null;\n        }\n        else {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingModel.regions.length - 1);\n        }\n        // Find fold at same level.\n        while (foldingRegion !== null) {\n            if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                // Keep at same level.\n                if (foldingRegion.startLineNumber >= maxLineNumber) {\n                    return null;\n                }\n                else if (foldingRegion.parentIndex === expectedParentIndex) {\n                    return foldingRegion.startLineNumber;\n                }\n            }\n            else {\n                return null;\n            }\n        }\n    }\n    else {\n        // Go to first fold that's after the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(0);\n            while (foldingRegion !== null) {\n                // Found fold after current line.\n                if (foldingRegion.startLineNumber > lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const foldSourceAbbr = {\n    [0 /* FoldSource.provider */]: ' ',\n    [1 /* FoldSource.userDefined */]: 'u',\n    [2 /* FoldSource.recovered */]: 'r',\n};\nexport const MAX_FOLDING_REGIONS = 0xFFFF;\nexport const MAX_LINE_NUMBER = 0xFFFFFF;\nconst MASK_INDENT = 0xFF000000;\nclass BitField {\n    constructor(size) {\n        const numWords = Math.ceil(size / 32);\n        this._states = new Uint32Array(numWords);\n    }\n    get(index) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        return (this._states[arrayIndex] & (1 << bit)) !== 0;\n    }\n    set(index, newState) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        const value = this._states[arrayIndex];\n        if (newState) {\n            this._states[arrayIndex] = value | (1 << bit);\n        }\n        else {\n            this._states[arrayIndex] = value & ~(1 << bit);\n        }\n    }\n}\nexport class FoldingRegions {\n    constructor(startIndexes, endIndexes, types) {\n        if (startIndexes.length !== endIndexes.length || startIndexes.length > MAX_FOLDING_REGIONS) {\n            throw new Error('invalid startIndexes or endIndexes size');\n        }\n        this._startIndexes = startIndexes;\n        this._endIndexes = endIndexes;\n        this._collapseStates = new BitField(startIndexes.length);\n        this._userDefinedStates = new BitField(startIndexes.length);\n        this._recoveredStates = new BitField(startIndexes.length);\n        this._types = types;\n        this._parentsComputed = false;\n    }\n    ensureParentIndices() {\n        if (!this._parentsComputed) {\n            this._parentsComputed = true;\n            const parentIndexes = [];\n            const isInsideLast = (startLineNumber, endLineNumber) => {\n                const index = parentIndexes[parentIndexes.length - 1];\n                return this.getStartLineNumber(index) <= startLineNumber && this.getEndLineNumber(index) >= endLineNumber;\n            };\n            for (let i = 0, len = this._startIndexes.length; i < len; i++) {\n                const startLineNumber = this._startIndexes[i];\n                const endLineNumber = this._endIndexes[i];\n                if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n                    throw new Error('startLineNumber or endLineNumber must not exceed ' + MAX_LINE_NUMBER);\n                }\n                while (parentIndexes.length > 0 && !isInsideLast(startLineNumber, endLineNumber)) {\n                    parentIndexes.pop();\n                }\n                const parentIndex = parentIndexes.length > 0 ? parentIndexes[parentIndexes.length - 1] : -1;\n                parentIndexes.push(i);\n                this._startIndexes[i] = startLineNumber + ((parentIndex & 0xFF) << 24);\n                this._endIndexes[i] = endLineNumber + ((parentIndex & 0xFF00) << 16);\n            }\n        }\n    }\n    get length() {\n        return this._startIndexes.length;\n    }\n    getStartLineNumber(index) {\n        return this._startIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getEndLineNumber(index) {\n        return this._endIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getType(index) {\n        return this._types ? this._types[index] : undefined;\n    }\n    hasTypes() {\n        return !!this._types;\n    }\n    isCollapsed(index) {\n        return this._collapseStates.get(index);\n    }\n    setCollapsed(index, newState) {\n        this._collapseStates.set(index, newState);\n    }\n    isUserDefined(index) {\n        return this._userDefinedStates.get(index);\n    }\n    setUserDefined(index, newState) {\n        return this._userDefinedStates.set(index, newState);\n    }\n    isRecovered(index) {\n        return this._recoveredStates.get(index);\n    }\n    setRecovered(index, newState) {\n        return this._recoveredStates.set(index, newState);\n    }\n    getSource(index) {\n        if (this.isUserDefined(index)) {\n            return 1 /* FoldSource.userDefined */;\n        }\n        else if (this.isRecovered(index)) {\n            return 2 /* FoldSource.recovered */;\n        }\n        return 0 /* FoldSource.provider */;\n    }\n    setSource(index, source) {\n        if (source === 1 /* FoldSource.userDefined */) {\n            this.setUserDefined(index, true);\n            this.setRecovered(index, false);\n        }\n        else if (source === 2 /* FoldSource.recovered */) {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, true);\n        }\n        else {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, false);\n        }\n    }\n    setCollapsedAllOfType(type, newState) {\n        let hasChanged = false;\n        if (this._types) {\n            for (let i = 0; i < this._types.length; i++) {\n                if (this._types[i] === type) {\n                    this.setCollapsed(i, newState);\n                    hasChanged = true;\n                }\n            }\n        }\n        return hasChanged;\n    }\n    toRegion(index) {\n        return new FoldingRegion(this, index);\n    }\n    getParentIndex(index) {\n        this.ensureParentIndices();\n        const parent = ((this._startIndexes[index] & MASK_INDENT) >>> 24) + ((this._endIndexes[index] & MASK_INDENT) >>> 16);\n        if (parent === MAX_FOLDING_REGIONS) {\n            return -1;\n        }\n        return parent;\n    }\n    contains(index, line) {\n        return this.getStartLineNumber(index) <= line && this.getEndLineNumber(index) >= line;\n    }\n    findIndex(line) {\n        let low = 0, high = this._startIndexes.length;\n        if (high === 0) {\n            return -1; // no children\n        }\n        while (low < high) {\n            const mid = Math.floor((low + high) / 2);\n            if (line < this.getStartLineNumber(mid)) {\n                high = mid;\n            }\n            else {\n                low = mid + 1;\n            }\n        }\n        return low - 1;\n    }\n    findRange(line) {\n        let index = this.findIndex(line);\n        if (index >= 0) {\n            const endLineNumber = this.getEndLineNumber(index);\n            if (endLineNumber >= line) {\n                return index;\n            }\n            index = this.getParentIndex(index);\n            while (index !== -1) {\n                if (this.contains(index, line)) {\n                    return index;\n                }\n                index = this.getParentIndex(index);\n            }\n        }\n        return -1;\n    }\n    toString() {\n        const res = [];\n        for (let i = 0; i < this.length; i++) {\n            res[i] = `[${foldSourceAbbr[this.getSource(i)]}${this.isCollapsed(i) ? '+' : '-'}] ${this.getStartLineNumber(i)}/${this.getEndLineNumber(i)}`;\n        }\n        return res.join(', ');\n    }\n    toFoldRange(index) {\n        return {\n            startLineNumber: this._startIndexes[index] & MAX_LINE_NUMBER,\n            endLineNumber: this._endIndexes[index] & MAX_LINE_NUMBER,\n            type: this._types ? this._types[index] : undefined,\n            isCollapsed: this.isCollapsed(index),\n            source: this.getSource(index)\n        };\n    }\n    static fromFoldRanges(ranges) {\n        const rangesLength = ranges.length;\n        const startIndexes = new Uint32Array(rangesLength);\n        const endIndexes = new Uint32Array(rangesLength);\n        let types = [];\n        let gotTypes = false;\n        for (let i = 0; i < rangesLength; i++) {\n            const range = ranges[i];\n            startIndexes[i] = range.startLineNumber;\n            endIndexes[i] = range.endLineNumber;\n            types.push(range.type);\n            if (range.type) {\n                gotTypes = true;\n            }\n        }\n        if (!gotTypes) {\n            types = undefined;\n        }\n        const regions = new FoldingRegions(startIndexes, endIndexes, types);\n        for (let i = 0; i < rangesLength; i++) {\n            if (ranges[i].isCollapsed) {\n                regions.setCollapsed(i, true);\n            }\n            regions.setSource(i, ranges[i].source);\n        }\n        return regions;\n    }\n    /**\n     * Two inputs, each a FoldingRegions or a FoldRange[], are merged.\n     * Each input must be pre-sorted on startLineNumber.\n     * The first list is assumed to always include all regions currently defined by range providers.\n     * The second list only contains the previously collapsed and all manual ranges.\n     * If the line position matches, the range of the new range is taken, and the range is no longer manual\n     * When an entry in one list overlaps an entry in the other, the second list's entry \"wins\" and\n     * overlapping entries in the first list are discarded.\n     * Invalid entries are discarded. An entry is invalid if:\n     * \t\tthe start and end line numbers aren't a valid range of line numbers,\n     * \t\tit is out of sequence or has the same start line as a preceding entry,\n     * \t\tit overlaps a preceding entry and is not fully contained by that entry.\n     */\n    static sanitizeAndMerge(rangesA, rangesB, maxLineNumber) {\n        maxLineNumber = maxLineNumber !== null && maxLineNumber !== void 0 ? maxLineNumber : Number.MAX_VALUE;\n        const getIndexedFunction = (r, limit) => {\n            return Array.isArray(r)\n                ? ((i) => { return (i < limit) ? r[i] : undefined; })\n                : ((i) => { return (i < limit) ? r.toFoldRange(i) : undefined; });\n        };\n        const getA = getIndexedFunction(rangesA, rangesA.length);\n        const getB = getIndexedFunction(rangesB, rangesB.length);\n        let indexA = 0;\n        let indexB = 0;\n        let nextA = getA(0);\n        let nextB = getB(0);\n        const stackedRanges = [];\n        let topStackedRange;\n        let prevLineNumber = 0;\n        const resultRanges = [];\n        while (nextA || nextB) {\n            let useRange = undefined;\n            if (nextB && (!nextA || nextA.startLineNumber >= nextB.startLineNumber)) {\n                if (nextA && nextA.startLineNumber === nextB.startLineNumber) {\n                    if (nextB.source === 1 /* FoldSource.userDefined */) {\n                        // a user defined range (possibly unfolded)\n                        useRange = nextB;\n                    }\n                    else {\n                        // a previously folded range or a (possibly unfolded) recovered range\n                        useRange = nextA;\n                        useRange.isCollapsed = nextB.isCollapsed && nextA.endLineNumber === nextB.endLineNumber;\n                        useRange.source = 0 /* FoldSource.provider */;\n                    }\n                    nextA = getA(++indexA); // not necessary, just for speed\n                }\n                else {\n                    useRange = nextB;\n                    if (nextB.isCollapsed && nextB.source === 0 /* FoldSource.provider */) {\n                        // a previously collapsed range\n                        useRange.source = 2 /* FoldSource.recovered */;\n                    }\n                }\n                nextB = getB(++indexB);\n            }\n            else {\n                // nextA is next. The user folded B set takes precedence and we sometimes need to look\n                // ahead in it to check for an upcoming conflict.\n                let scanIndex = indexB;\n                let prescanB = nextB;\n                while (true) {\n                    if (!prescanB || prescanB.startLineNumber > nextA.endLineNumber) {\n                        useRange = nextA;\n                        break; // no conflict, use this nextA\n                    }\n                    if (prescanB.source === 1 /* FoldSource.userDefined */ && prescanB.endLineNumber > nextA.endLineNumber) {\n                        // we found a user folded range, it wins\n                        break; // without setting nextResult, so this nextA gets skipped\n                    }\n                    prescanB = getB(++scanIndex);\n                }\n                nextA = getA(++indexA);\n            }\n            if (useRange) {\n                while (topStackedRange\n                    && topStackedRange.endLineNumber < useRange.startLineNumber) {\n                    topStackedRange = stackedRanges.pop();\n                }\n                if (useRange.endLineNumber > useRange.startLineNumber\n                    && useRange.startLineNumber > prevLineNumber\n                    && useRange.endLineNumber <= maxLineNumber\n                    && (!topStackedRange\n                        || topStackedRange.endLineNumber >= useRange.endLineNumber)) {\n                    resultRanges.push(useRange);\n                    prevLineNumber = useRange.startLineNumber;\n                    if (topStackedRange) {\n                        stackedRanges.push(topStackedRange);\n                    }\n                    topStackedRange = useRange;\n                }\n            }\n        }\n        return resultRanges;\n    }\n}\nexport class FoldingRegion {\n    constructor(ranges, index) {\n        this.ranges = ranges;\n        this.index = index;\n    }\n    get startLineNumber() {\n        return this.ranges.getStartLineNumber(this.index);\n    }\n    get endLineNumber() {\n        return this.ranges.getEndLineNumber(this.index);\n    }\n    get regionIndex() {\n        return this.index;\n    }\n    get parentIndex() {\n        return this.ranges.getParentIndex(this.index);\n    }\n    get isCollapsed() {\n        return this.ranges.isCollapsed(this.index);\n    }\n    containedBy(range) {\n        return range.startLineNumber <= this.startLineNumber && range.endLineNumber >= this.endLineNumber;\n    }\n    containsLine(lineNumber) {\n        return this.startLineNumber <= lineNumber && lineNumber <= this.endLineNumber;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { computeIndentLevel } from '../../../common/model/utils.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT = 5000;\nconst ID_INDENT_PROVIDER = 'indent';\nexport class IndentRangeProvider {\n    constructor(editorModel, languageConfigurationService, foldingRangesLimit) {\n        this.editorModel = editorModel;\n        this.languageConfigurationService = languageConfigurationService;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.id = ID_INDENT_PROVIDER;\n    }\n    dispose() { }\n    compute(cancelationToken) {\n        const foldingRules = this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules;\n        const offSide = foldingRules && !!foldingRules.offSide;\n        const markers = foldingRules && foldingRules.markers;\n        return Promise.resolve(computeRanges(this.editorModel, offSide, markers, this.foldingRangesLimit));\n    }\n}\n// public only for testing\nexport class RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._indentOccurrences = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    insertFirst(startLineNumber, endLineNumber, indent) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._length++;\n        if (indent < 1000) {\n            this._indentOccurrences[indent] = (this._indentOccurrences[indent] || 0) + 1;\n        }\n    }\n    toIndentRanges(model) {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = this._length - 1, k = 0; i >= 0; i--, k++) {\n                startIndexes[k] = this._startIndexes[i];\n                endIndexes[k] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxIndent = this._indentOccurrences.length;\n            for (let i = 0; i < this._indentOccurrences.length; i++) {\n                const n = this._indentOccurrences[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxIndent = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const tabSize = model.getOptions().tabSize;\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            for (let i = this._length - 1, k = 0; i >= 0; i--) {\n                const startIndex = this._startIndexes[i];\n                const lineContent = model.getLineContent(startIndex);\n                const indent = computeIndentLevel(lineContent, tabSize);\n                if (indent < maxIndent || (indent === maxIndent && entries++ < limit)) {\n                    startIndexes[k] = startIndex;\n                    endIndexes[k] = this._endIndexes[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n    }\n}\nconst foldingRangesLimitDefault = {\n    limit: MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT,\n    update: () => { }\n};\nexport function computeRanges(model, offSide, markers, foldingRangesLimit = foldingRangesLimitDefault) {\n    const tabSize = model.getOptions().tabSize;\n    const result = new RangesCollector(foldingRangesLimit);\n    let pattern = undefined;\n    if (markers) {\n        pattern = new RegExp(`(${markers.start.source})|(?:${markers.end.source})`);\n    }\n    const previousRegions = [];\n    const line = model.getLineCount() + 1;\n    previousRegions.push({ indent: -1, endAbove: line, line }); // sentinel, to make sure there's at least one entry\n    for (let line = model.getLineCount(); line > 0; line--) {\n        const lineContent = model.getLineContent(line);\n        const indent = computeIndentLevel(lineContent, tabSize);\n        let previous = previousRegions[previousRegions.length - 1];\n        if (indent === -1) {\n            if (offSide) {\n                // for offSide languages, empty lines are associated to the previous block\n                // note: the next block is already written to the results, so this only\n                // impacts the end position of the block before\n                previous.endAbove = line;\n            }\n            continue; // only whitespace\n        }\n        let m;\n        if (pattern && (m = lineContent.match(pattern))) {\n            // folding pattern match\n            if (m[1]) { // start pattern match\n                // discard all regions until the folding pattern\n                let i = previousRegions.length - 1;\n                while (i > 0 && previousRegions[i].indent !== -2) {\n                    i--;\n                }\n                if (i > 0) {\n                    previousRegions.length = i + 1;\n                    previous = previousRegions[i];\n                    // new folding range from pattern, includes the end line\n                    result.insertFirst(line, previous.line, indent);\n                    previous.line = line;\n                    previous.indent = indent;\n                    previous.endAbove = line;\n                    continue;\n                }\n                else {\n                    // no end marker found, treat line as a regular line\n                }\n            }\n            else { // end pattern match\n                previousRegions.push({ indent: -2, endAbove: line, line });\n                continue;\n            }\n        }\n        if (previous.indent > indent) {\n            // discard all regions with larger indent\n            do {\n                previousRegions.pop();\n                previous = previousRegions[previousRegions.length - 1];\n            } while (previous.indent > indent);\n            // new folding range\n            const endLineNumber = previous.endAbove - 1;\n            if (endLineNumber - line >= 1) { // needs at east size 1\n                result.insertFirst(line, endLineNumber, indent);\n            }\n        }\n        if (previous.indent === indent) {\n            previous.endAbove = line;\n        }\n        else { // previous.indent < indent\n            // new region with a bigger indent\n            previousRegions.push({ indent, endAbove: line, line });\n        }\n    }\n    return result.toIndentRanges(model);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst foldingContext = {};\nconst ID_SYNTAX_PROVIDER = 'syntax';\nexport class SyntaxRangeProvider {\n    constructor(editorModel, providers, handleFoldingRangesChange, foldingRangesLimit, fallbackRangeProvider // used when all providers return null\n    ) {\n        this.editorModel = editorModel;\n        this.providers = providers;\n        this.handleFoldingRangesChange = handleFoldingRangesChange;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.fallbackRangeProvider = fallbackRangeProvider;\n        this.id = ID_SYNTAX_PROVIDER;\n        this.disposables = new DisposableStore();\n        if (fallbackRangeProvider) {\n            this.disposables.add(fallbackRangeProvider);\n        }\n        for (const provider of providers) {\n            if (typeof provider.onDidChange === 'function') {\n                this.disposables.add(provider.onDidChange(handleFoldingRangesChange));\n            }\n        }\n    }\n    compute(cancellationToken) {\n        return collectSyntaxRanges(this.providers, this.editorModel, cancellationToken).then(ranges => {\n            var _a, _b;\n            if (ranges) {\n                const res = sanitizeRanges(ranges, this.foldingRangesLimit);\n                return res;\n            }\n            return (_b = (_a = this.fallbackRangeProvider) === null || _a === void 0 ? void 0 : _a.compute(cancellationToken)) !== null && _b !== void 0 ? _b : null;\n        });\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nfunction collectSyntaxRanges(providers, model, cancellationToken) {\n    let rangeData = null;\n    const promises = providers.map((provider, i) => {\n        return Promise.resolve(provider.provideFoldingRanges(model, foldingContext, cancellationToken)).then(ranges => {\n            if (cancellationToken.isCancellationRequested) {\n                return;\n            }\n            if (Array.isArray(ranges)) {\n                if (!Array.isArray(rangeData)) {\n                    rangeData = [];\n                }\n                const nLines = model.getLineCount();\n                for (const r of ranges) {\n                    if (r.start > 0 && r.end > r.start && r.end <= nLines) {\n                        rangeData.push({ start: r.start, end: r.end, rank: i, kind: r.kind });\n                    }\n                }\n            }\n        }, onUnexpectedExternalError);\n    });\n    return Promise.all(promises).then(_ => {\n        return rangeData;\n    });\n}\nclass RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._nestingLevels = [];\n        this._nestingLevelCounts = [];\n        this._types = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    add(startLineNumber, endLineNumber, type, nestingLevel) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._nestingLevels[index] = nestingLevel;\n        this._types[index] = type;\n        this._length++;\n        if (nestingLevel < 30) {\n            this._nestingLevelCounts[nestingLevel] = (this._nestingLevelCounts[nestingLevel] || 0) + 1;\n        }\n    }\n    toIndentRanges() {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = 0; i < this._length; i++) {\n                startIndexes[i] = this._startIndexes[i];\n                endIndexes[i] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes, this._types);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxLevel = this._nestingLevelCounts.length;\n            for (let i = 0; i < this._nestingLevelCounts.length; i++) {\n                const n = this._nestingLevelCounts[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxLevel = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            const types = [];\n            for (let i = 0, k = 0; i < this._length; i++) {\n                const level = this._nestingLevels[i];\n                if (level < maxLevel || (level === maxLevel && entries++ < limit)) {\n                    startIndexes[k] = this._startIndexes[i];\n                    endIndexes[k] = this._endIndexes[i];\n                    types[k] = this._types[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes, types);\n        }\n    }\n}\nexport function sanitizeRanges(rangeData, foldingRangesLimit) {\n    const sorted = rangeData.sort((d1, d2) => {\n        let diff = d1.start - d2.start;\n        if (diff === 0) {\n            diff = d1.rank - d2.rank;\n        }\n        return diff;\n    });\n    const collector = new RangesCollector(foldingRangesLimit);\n    let top = undefined;\n    const previous = [];\n    for (const entry of sorted) {\n        if (!top) {\n            top = entry;\n            collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n        }\n        else {\n            if (entry.start > top.start) {\n                if (entry.end <= top.end) {\n                    previous.push(top);\n                    top = entry;\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n                else {\n                    if (entry.start > top.end) {\n                        do {\n                            top = previous.pop();\n                        } while (top && entry.start > top.end);\n                        if (top) {\n                            previous.push(top);\n                        }\n                        top = entry;\n                    }\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n            }\n        }\n    }\n    return collector.toIndentRanges();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorZoom } from '../../../common/config/editorZoom.js';\nimport * as nls from '../../../../nls.js';\nclass EditorFontZoomIn extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomIn',\n            label: nls.localize('EditorFontZoomIn.label', \"Editor Font Zoom In\"),\n            alias: 'Editor Font Zoom In',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\n    }\n}\nclass EditorFontZoomOut extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomOut',\n            label: nls.localize('EditorFontZoomOut.label', \"Editor Font Zoom Out\"),\n            alias: 'Editor Font Zoom Out',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\n    }\n}\nclass EditorFontZoomReset extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomReset',\n            label: nls.localize('EditorFontZoomReset.label', \"Editor Font Zoom Reset\"),\n            alias: 'Editor Font Zoom Reset',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(0);\n    }\n}\nregisterEditorAction(EditorFontZoomIn);\nregisterEditorAction(EditorFontZoomOut);\nregisterEditorAction(EditorFontZoomReset);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { asArray, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ExtensionIdentifierSet } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nexport function alertFormattingEdits(edits) {\n    edits = edits.filter(edit => edit.range);\n    if (!edits.length) {\n        return;\n    }\n    let { range } = edits[0];\n    for (let i = 1; i < edits.length; i++) {\n        range = Range.plusRange(range, edits[i].range);\n    }\n    const { startLineNumber, endLineNumber } = range;\n    if (startLineNumber === endLineNumber) {\n        if (edits.length === 1) {\n            alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\n        }\n        else {\n            alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\n        }\n    }\n    else {\n        if (edits.length === 1) {\n            alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\n        }\n        else {\n            alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\n        }\n    }\n}\nexport function getRealAndSyntheticDocumentFormattersOrdered(documentFormattingEditProvider, documentRangeFormattingEditProvider, model) {\n    const result = [];\n    const seen = new ExtensionIdentifierSet();\n    // (1) add all document formatter\n    const docFormatter = documentFormattingEditProvider.ordered(model);\n    for (const formatter of docFormatter) {\n        result.push(formatter);\n        if (formatter.extensionId) {\n            seen.add(formatter.extensionId);\n        }\n    }\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\n    const rangeFormatter = documentRangeFormattingEditProvider.ordered(model);\n    for (const formatter of rangeFormatter) {\n        if (formatter.extensionId) {\n            if (seen.has(formatter.extensionId)) {\n                continue;\n            }\n            seen.add(formatter.extensionId);\n        }\n        result.push({\n            displayName: formatter.displayName,\n            extensionId: formatter.extensionId,\n            provideDocumentFormattingEdits(model, options, token) {\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\n            }\n        });\n    }\n    return result;\n}\nexport class FormattingConflicts {\n    static setFormatterSelector(selector) {\n        const remove = FormattingConflicts._selectors.unshift(selector);\n        return { dispose: remove };\n    }\n    static select(formatter, document, mode) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (formatter.length === 0) {\n                return undefined;\n            }\n            const selector = Iterable.first(FormattingConflicts._selectors);\n            if (selector) {\n                return yield selector(formatter, document, mode);\n            }\n            return undefined;\n        });\n    }\n}\nFormattingConflicts._selectors = new LinkedList();\nexport function formatDocumentRangesWithSelectedProvider(accessor, editorOrModel, rangeOrRanges, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const { documentRangeFormattingEditProvider: documentRangeFormattingEditProviderRegistry } = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = documentRangeFormattingEditProviderRegistry.ordered(model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentRangesWithProvider, selected, editorOrModel, rangeOrRanges, token);\n        }\n    });\n}\nexport function formatDocumentRangesWithProvider(accessor, provider, editorOrModel, rangeOrRanges, token) {\n    var _a, _b;\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        const logService = accessor.get(ILogService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        // make sure that ranges don't overlap nor touch each other\n        const ranges = [];\n        let len = 0;\n        for (const range of asArray(rangeOrRanges).sort(Range.compareRangesUsingStarts)) {\n            if (len > 0 && Range.areIntersectingOrTouching(ranges[len - 1], range)) {\n                ranges[len - 1] = Range.fromPositions(ranges[len - 1].getStartPosition(), range.getEndPosition());\n            }\n            else {\n                len = ranges.push(range);\n            }\n        }\n        const computeEdits = (range) => __awaiter(this, void 0, void 0, function* () {\n            var _c, _d;\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, (_c = provider.extensionId) === null || _c === void 0 ? void 0 : _c.value, range);\n            const result = (yield provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)) || [];\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, (_d = provider.extensionId) === null || _d === void 0 ? void 0 : _d.value, result);\n            return result;\n        });\n        const hasIntersectingEdit = (a, b) => {\n            if (!a.length || !b.length) {\n                return false;\n            }\n            // quick exit if the list of ranges are completely unrelated [O(n)]\n            const mergedA = a.reduce((acc, val) => { return Range.plusRange(acc, val.range); }, a[0].range);\n            if (!b.some(x => { return Range.intersectRanges(mergedA, x.range); })) {\n                return false;\n            }\n            // fallback to a complete check [O(n^2)]\n            for (const edit of a) {\n                for (const otherEdit of b) {\n                    if (Range.intersectRanges(edit.range, otherEdit.range)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        };\n        const allEdits = [];\n        const rawEditsList = [];\n        try {\n            if (typeof provider.provideDocumentRangesFormattingEdits === 'function') {\n                logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, (_a = provider.extensionId) === null || _a === void 0 ? void 0 : _a.value, ranges);\n                const result = (yield provider.provideDocumentRangesFormattingEdits(model, ranges, model.getFormattingOptions(), cts.token)) || [];\n                logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, (_b = provider.extensionId) === null || _b === void 0 ? void 0 : _b.value, result);\n                rawEditsList.push(result);\n            }\n            else {\n                for (const range of ranges) {\n                    if (cts.token.isCancellationRequested) {\n                        return true;\n                    }\n                    rawEditsList.push(yield computeEdits(range));\n                }\n                for (let i = 0; i < ranges.length; ++i) {\n                    for (let j = i + 1; j < ranges.length; ++j) {\n                        if (cts.token.isCancellationRequested) {\n                            return true;\n                        }\n                        if (hasIntersectingEdit(rawEditsList[i], rawEditsList[j])) {\n                            // Merge ranges i and j into a single range, recompute the associated edits\n                            const mergedRange = Range.plusRange(ranges[i], ranges[j]);\n                            const edits = yield computeEdits(mergedRange);\n                            ranges.splice(j, 1);\n                            ranges.splice(i, 1);\n                            ranges.push(mergedRange);\n                            rawEditsList.splice(j, 1);\n                            rawEditsList.splice(i, 1);\n                            rawEditsList.push(edits);\n                            // Restart scanning\n                            i = 0;\n                            j = 0;\n                        }\n                    }\n                }\n            }\n            for (const rawEdits of rawEditsList) {\n                if (cts.token.isCancellationRequested) {\n                    return true;\n                }\n                const minimalEdits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n                if (minimalEdits) {\n                    allEdits.push(...minimalEdits);\n                }\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (allEdits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, allEdits, true);\n            alertFormattingEdits(allEdits);\n            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = allEdits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], allEdits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token);\n        }\n    });\n}\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        let edits;\n        try {\n            const rawEdits = yield provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token);\n            edits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            if (cts.token.isCancellationRequested) {\n                return true;\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (!edits || edits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, edits, mode !== 2 /* FormattingMode.Silent */);\n            if (mode !== 2 /* FormattingMode.Silent */) {\n                alertFormattingEdits(edits);\n                editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n            }\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = edits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], edits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, model, range, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = languageFeaturesService.documentRangeFormattingEditProvider.ordered(model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, model, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getOnTypeFormattingEdits(workerService, languageFeaturesService, model, position, ch, options, token) {\n    const providers = languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n    if (providers.length === 0) {\n        return Promise.resolve(undefined);\n    }\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\n        return Promise.resolve(undefined);\n    }\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, token)).catch(onUnexpectedExternalError).then(edits => {\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\n    });\n}\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, range, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Range.isIRange(range));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, Range.lift(range), options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, options] = args;\n        assertType(URI.isUri(resource));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, position, ch, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Position.isIPosition(position));\n        assertType(typeof ch === 'string');\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getOnTypeFormattingEdits(workerService, languageFeaturesService, reference.object.textEditorModel, Position.lift(position), ch, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { alertFormattingEdits, formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider, getOnTypeFormattingEdits } from './format.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorProgressService, Progress } from '../../../../platform/progress/common/progress.js';\nlet FormatOnType = class FormatOnType {\n    constructor(_editor, _languageFeaturesService, _workerService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._workerService = _workerService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._disposables.add(_languageFeaturesService.onTypeFormattingEditProvider.onDidChange(this._update, this));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(56 /* EditorOption.formatOnType */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._sessionDisposables.dispose();\n    }\n    _update() {\n        // clean up\n        this._sessionDisposables.clear();\n        // we are disabled\n        if (!this._editor.getOption(56 /* EditorOption.formatOnType */)) {\n            return;\n        }\n        // no model\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        // no support\n        const [support] = this._languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n        if (!support || !support.autoFormatTriggerCharacters) {\n            return;\n        }\n        // register typing listeners that will trigger the format\n        const triggerChars = new CharacterSet();\n        for (const ch of support.autoFormatTriggerCharacters) {\n            triggerChars.add(ch.charCodeAt(0));\n        }\n        this._sessionDisposables.add(this._editor.onDidType((text) => {\n            const lastCharCode = text.charCodeAt(text.length - 1);\n            if (triggerChars.has(lastCharCode)) {\n                this._trigger(String.fromCharCode(lastCharCode));\n            }\n        }));\n    }\n    _trigger(ch) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (this._editor.getSelections().length > 1 || !this._editor.getSelection().isEmpty()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const cts = new CancellationTokenSource();\n        // install a listener that checks if edits happens before the\n        // position on which we format right now. If so, we won't\n        // apply the format edits\n        const unbind = this._editor.onDidChangeModelContent((e) => {\n            if (e.isFlush) {\n                // a model.setValue() was called\n                // cancel only once\n                cts.cancel();\n                unbind.dispose();\n                return;\n            }\n            for (let i = 0, len = e.changes.length; i < len; i++) {\n                const change = e.changes[i];\n                if (change.range.endLineNumber <= position.lineNumber) {\n                    // cancel only once\n                    cts.cancel();\n                    unbind.dispose();\n                    return;\n                }\n            }\n        });\n        getOnTypeFormattingEdits(this._workerService, this._languageFeaturesService, model, position, ch, model.getFormattingOptions(), cts.token).then(edits => {\n            if (cts.token.isCancellationRequested) {\n                return;\n            }\n            if (isNonEmptyArray(edits)) {\n                FormattingEdit.execute(this._editor, edits, true);\n                alertFormattingEdits(edits);\n            }\n        }).finally(() => {\n            unbind.dispose();\n        });\n    }\n};\nFormatOnType.ID = 'editor.contrib.autoFormat';\nFormatOnType = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IEditorWorkerService)\n], FormatOnType);\nexport { FormatOnType };\nlet FormatOnPaste = class FormatOnPaste {\n    constructor(editor, _languageFeaturesService, _instantiationService) {\n        this.editor = editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instantiationService = _instantiationService;\n        this._callOnDispose = new DisposableStore();\n        this._callOnModel = new DisposableStore();\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\n        this._callOnDispose.add(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(this._update, this));\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        this._callOnModel.dispose();\n    }\n    _update() {\n        // clean up\n        this._callOnModel.clear();\n        // we are disabled\n        if (!this.editor.getOption(55 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        // no formatter\n        if (!this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())) {\n            return;\n        }\n        this._callOnModel.add(this.editor.onDidPaste(({ range }) => this._trigger(range)));\n    }\n    _trigger(range) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (this.editor.getSelections().length > 1) {\n            return;\n        }\n        this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, this.editor, range, 2 /* FormattingMode.Silent */, Progress.None, CancellationToken.None).catch(onUnexpectedError);\n    }\n};\nFormatOnPaste.ID = 'editor.contrib.formatOnPaste';\nFormatOnPaste = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IInstantiationService)\n], FormatOnPaste);\nclass FormatDocumentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatDocument',\n            label: nls.localize('formatDocument.label', \"Format Document\"),\n            alias: 'Format Document',\n            precondition: ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor, EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 39 /* KeyCode.KeyI */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.3\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                const instaService = accessor.get(IInstantiationService);\n                const progressService = accessor.get(IEditorProgressService);\n                yield progressService.showWhile(instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n            }\n        });\n    }\n}\nclass FormatSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatSelection',\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\n            alias: 'Format Selection',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                when: EditorContextKeys.hasNonEmptySelection,\n                group: '1_modification',\n                order: 1.31\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!editor.hasModel()) {\n                return;\n            }\n            const instaService = accessor.get(IInstantiationService);\n            const model = editor.getModel();\n            const ranges = editor.getSelections().map(range => {\n                return range.isEmpty()\n                    ? new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber))\n                    : range;\n            });\n            const progressService = accessor.get(IEditorProgressService);\n            yield progressService.showWhile(instaService.invokeFunction(formatDocumentRangesWithSelectedProvider, editor, ranges, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n        });\n    }\n}\nregisterEditorContribution(FormatOnType.ID, FormatOnType, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(FormatDocumentAction);\nregisterEditorAction(FormatSelectionAction);\n// this is the old format action that does both (format document OR format selection)\n// and we keep it here such that existing keybinding configurations etc will still work\nCommandsRegistry.registerCommand('editor.action.format', (accessor) => __awaiter(void 0, void 0, void 0, function* () {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (!editor || !editor.hasModel()) {\n        return;\n    }\n    const commandService = accessor.get(ICommandService);\n    if (editor.getSelection().isEmpty()) {\n        yield commandService.executeCommand('editor.action.formatDocument');\n    }\n    else {\n        yield commandService.executeCommand('editor.action.formatSelection');\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nexport class FormattingEdit {\n    static _handleEolEdits(editor, edits) {\n        let newEol = undefined;\n        const singleEdits = [];\n        for (const edit of edits) {\n            if (typeof edit.eol === 'number') {\n                newEol = edit.eol;\n            }\n            if (edit.range && typeof edit.text === 'string') {\n                singleEdits.push(edit);\n            }\n        }\n        if (typeof newEol === 'number') {\n            if (editor.hasModel()) {\n                editor.getModel().pushEOL(newEol);\n            }\n        }\n        return singleEdits;\n    }\n    static _isFullModelReplaceEdit(editor, edit) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const editRange = model.validateRange(edit.range);\n        const fullModelRange = model.getFullModelRange();\n        return fullModelRange.equalsRange(editRange);\n    }\n    static execute(editor, _edits, addUndoStops) {\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        const scrollState = StableEditorScrollState.capture(editor);\n        const edits = FormattingEdit._handleEolEdits(editor, _edits);\n        if (edits.length === 1 && FormattingEdit._isFullModelReplaceEdit(editor, edits[0])) {\n            // We use replace semantics and hope that markers stay put...\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text)));\n        }\n        else {\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n        }\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        scrollState.restoreRelativeVerticalPositionOfCursor(editor);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nlet MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const compareOrder = this._configService.getValue('problems.sortOrder');\n        const compareMarker = (a, b) => {\n            let res = compare(a.resource.toString(), b.resource.toString());\n            if (res === 0) {\n                if (compareOrder === 'position') {\n                    res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n                }\n                else {\n                    res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n                }\n            }\n            return res;\n        };\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        const oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IConfigurationService)\n], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (const provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService, this._configService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService),\n    __param(1, IConfigurationService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MarkerNavigationWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { splitLines } from '../../../../base/common/strings.js';\nimport './media/gotoErrorWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { peekViewTitleForeground, peekViewTitleInfoForeground, PeekViewWidget } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { SeverityIcon } from '../../../../platform/severityIcon/browser/severityIcon.js';\nimport { contrastBorder, editorBackground, editorErrorBorder, editorErrorForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, oneOf, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nclass MessageWidget {\n    constructor(parent, editor, onRelatedInformation, _openerService, _labelService) {\n        this._openerService = _openerService;\n        this._labelService = _labelService;\n        this._lines = 0;\n        this._longestLineLength = 0;\n        this._relatedDiagnostics = new WeakMap();\n        this._disposables = new DisposableStore();\n        this._editor = editor;\n        const domNode = document.createElement('div');\n        domNode.className = 'descriptioncontainer';\n        this._messageBlock = document.createElement('div');\n        this._messageBlock.classList.add('message');\n        this._messageBlock.setAttribute('aria-live', 'assertive');\n        this._messageBlock.setAttribute('role', 'alert');\n        domNode.appendChild(this._messageBlock);\n        this._relatedBlock = document.createElement('div');\n        domNode.appendChild(this._relatedBlock);\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', event => {\n            event.preventDefault();\n            const related = this._relatedDiagnostics.get(event.target);\n            if (related) {\n                onRelatedInformation(related);\n            }\n        }));\n        this._scrollable = new ScrollableElement(domNode, {\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            vertical: 1 /* ScrollbarVisibility.Auto */,\n            useShadows: false,\n            horizontalScrollbarSize: 6,\n            verticalScrollbarSize: 6\n        });\n        parent.appendChild(this._scrollable.getDomNode());\n        this._disposables.add(this._scrollable.onScroll(e => {\n            domNode.style.left = `-${e.scrollLeft}px`;\n            domNode.style.top = `-${e.scrollTop}px`;\n        }));\n        this._disposables.add(this._scrollable);\n    }\n    dispose() {\n        dispose(this._disposables);\n    }\n    update(marker) {\n        const { source, message, relatedInformation, code } = marker;\n        let sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\n        if (code) {\n            if (typeof code === 'string') {\n                sourceAndCodeLength += code.length;\n            }\n            else {\n                sourceAndCodeLength += code.value.length;\n            }\n        }\n        const lines = splitLines(message);\n        this._lines = lines.length;\n        this._longestLineLength = 0;\n        for (const line of lines) {\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\n        }\n        dom.clearNode(this._messageBlock);\n        this._messageBlock.setAttribute('aria-label', this.getAriaLabel(marker));\n        this._editor.applyFontInfo(this._messageBlock);\n        let lastLineElement = this._messageBlock;\n        for (const line of lines) {\n            lastLineElement = document.createElement('div');\n            lastLineElement.innerText = line;\n            if (line === '') {\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\n            }\n            this._messageBlock.appendChild(lastLineElement);\n        }\n        if (source || code) {\n            const detailsElement = document.createElement('span');\n            detailsElement.classList.add('details');\n            lastLineElement.appendChild(detailsElement);\n            if (source) {\n                const sourceElement = document.createElement('span');\n                sourceElement.innerText = source;\n                sourceElement.classList.add('source');\n                detailsElement.appendChild(sourceElement);\n            }\n            if (code) {\n                if (typeof code === 'string') {\n                    const codeElement = document.createElement('span');\n                    codeElement.innerText = `(${code})`;\n                    codeElement.classList.add('code');\n                    detailsElement.appendChild(codeElement);\n                }\n                else {\n                    this._codeLink = dom.$('a.code-link');\n                    this._codeLink.setAttribute('href', `${code.target.toString()}`);\n                    this._codeLink.onclick = (e) => {\n                        this._openerService.open(code.target, { allowCommands: true });\n                        e.preventDefault();\n                        e.stopPropagation();\n                    };\n                    const codeElement = dom.append(this._codeLink, dom.$('span'));\n                    codeElement.innerText = code.value;\n                    detailsElement.appendChild(this._codeLink);\n                }\n            }\n        }\n        dom.clearNode(this._relatedBlock);\n        this._editor.applyFontInfo(this._relatedBlock);\n        if (isNonEmptyArray(relatedInformation)) {\n            const relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\n            relatedInformationNode.style.paddingTop = `${Math.floor(this._editor.getOption(66 /* EditorOption.lineHeight */) * 0.66)}px`;\n            this._lines += 1;\n            for (const related of relatedInformation) {\n                const container = document.createElement('div');\n                const relatedResource = document.createElement('a');\n                relatedResource.classList.add('filename');\n                relatedResource.innerText = `${this._labelService.getUriBasenameLabel(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `;\n                relatedResource.title = this._labelService.getUriLabel(related.resource);\n                this._relatedDiagnostics.set(relatedResource, related);\n                const relatedMessage = document.createElement('span');\n                relatedMessage.innerText = related.message;\n                container.appendChild(relatedResource);\n                container.appendChild(relatedMessage);\n                this._lines += 1;\n                relatedInformationNode.appendChild(container);\n            }\n        }\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        const scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\n        const scrollHeight = fontInfo.lineHeight * this._lines;\n        this._scrollable.setScrollDimensions({ scrollWidth, scrollHeight });\n    }\n    layout(height, width) {\n        this._scrollable.getDomNode().style.height = `${height}px`;\n        this._scrollable.getDomNode().style.width = `${width}px`;\n        this._scrollable.setScrollDimensions({ width, height });\n    }\n    getHeightInLines() {\n        return Math.min(17, this._lines);\n    }\n    getAriaLabel(marker) {\n        let severityLabel = '';\n        switch (marker.severity) {\n            case MarkerSeverity.Error:\n                severityLabel = nls.localize('Error', \"Error\");\n                break;\n            case MarkerSeverity.Warning:\n                severityLabel = nls.localize('Warning', \"Warning\");\n                break;\n            case MarkerSeverity.Info:\n                severityLabel = nls.localize('Info', \"Info\");\n                break;\n            case MarkerSeverity.Hint:\n                severityLabel = nls.localize('Hint', \"Hint\");\n                break;\n        }\n        let ariaLabel = nls.localize('marker aria', \"{0} at {1}. \", severityLabel, marker.startLineNumber + ':' + marker.startColumn);\n        const model = this._editor.getModel();\n        if (model && (marker.startLineNumber <= model.getLineCount()) && (marker.startLineNumber >= 1)) {\n            const lineContent = model.getLineContent(marker.startLineNumber);\n            ariaLabel = `${lineContent}, ${ariaLabel}`;\n        }\n        return ariaLabel;\n    }\n}\nlet MarkerNavigationWidget = MarkerNavigationWidget_1 = class MarkerNavigationWidget extends PeekViewWidget {\n    constructor(editor, _themeService, _openerService, _menuService, instantiationService, _contextKeyService, _labelService) {\n        super(editor, { showArrow: true, showFrame: true, isAccessible: true, frameWidth: 1 }, instantiationService);\n        this._themeService = _themeService;\n        this._openerService = _openerService;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._labelService = _labelService;\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectRelatedInformation = new Emitter();\n        this.onDidSelectRelatedInformation = this._onDidSelectRelatedInformation.event;\n        this._severity = MarkerSeverity.Warning;\n        this._backgroundColor = Color.white;\n        this._applyTheme(_themeService.getColorTheme());\n        this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this.create();\n    }\n    _applyTheme(theme) {\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\n        let colorId = editorMarkerNavigationError;\n        let headerBackground = editorMarkerNavigationErrorHeader;\n        if (this._severity === MarkerSeverity.Warning) {\n            colorId = editorMarkerNavigationWarning;\n            headerBackground = editorMarkerNavigationWarningHeader;\n        }\n        else if (this._severity === MarkerSeverity.Info) {\n            colorId = editorMarkerNavigationInfo;\n            headerBackground = editorMarkerNavigationInfoHeader;\n        }\n        const frameColor = theme.getColor(colorId);\n        const headerBg = theme.getColor(headerBackground);\n        this.style({\n            arrowColor: frameColor,\n            frameColor: frameColor,\n            headerBackgroundColor: headerBg,\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n        }); // style() will trigger _applyStyles\n    }\n    _applyStyles() {\n        if (this._parentContainer) {\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\n        }\n        super._applyStyles();\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        super.dispose();\n    }\n    _fillHead(container) {\n        super._fillHead(container);\n        this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(e => this.editor.focus()));\n        const actions = [];\n        const menu = this._menuService.createMenu(MarkerNavigationWidget_1.TitleMenu, this._contextKeyService);\n        createAndFillInActionBarActions(menu, undefined, actions);\n        this._actionbarWidget.push(actions, { label: false, icon: true, index: 0 });\n        menu.dispose();\n    }\n    _fillTitleIcon(container) {\n        this._icon = dom.append(container, dom.$(''));\n    }\n    _fillBody(container) {\n        this._parentContainer = container;\n        container.classList.add('marker-widget');\n        this._parentContainer.tabIndex = 0;\n        this._parentContainer.setAttribute('role', 'tooltip');\n        this._container = document.createElement('div');\n        container.appendChild(this._container);\n        this._message = new MessageWidget(this._container, this.editor, related => this._onDidSelectRelatedInformation.fire(related), this._openerService, this._labelService);\n        this._disposables.add(this._message);\n    }\n    show() {\n        throw new Error('call showAtMarker');\n    }\n    showAtMarker(marker, markerIdx, markerCount) {\n        // update:\n        // * title\n        // * message\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n        // update frame color (only applied on 'show')\n        this._severity = marker.severity;\n        this._applyTheme(this._themeService.getColorTheme());\n        // show\n        const range = Range.lift(marker);\n        const editorPosition = this.editor.getPosition();\n        const position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\n        super.show(position, this.computeRequiredHeight());\n        const model = this.editor.getModel();\n        if (model) {\n            const detail = markerCount > 1\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\n            this.setTitle(basename(model.uri), detail);\n        }\n        this._icon.className = `codicon ${SeverityIcon.className(MarkerSeverity.toSeverity(this._severity))}`;\n        this.editor.revealPositionNearTop(position, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    updateMarker(marker) {\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n    }\n    showStale() {\n        this._container.classList.add('stale');\n        this._relayout();\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._heightInPixel = heightInPixel;\n        this._message.layout(heightInPixel, widthInPixel);\n        this._container.style.height = `${heightInPixel}px`;\n    }\n    _onWidth(widthInPixel) {\n        this._message.layout(this._heightInPixel, widthInPixel);\n    }\n    _relayout() {\n        super._relayout(this.computeRequiredHeight());\n    }\n    computeRequiredHeight() {\n        return 3 + this._message.getHeightInLines();\n    }\n};\nMarkerNavigationWidget.TitleMenu = new MenuId('gotoErrorTitleMenu');\nMarkerNavigationWidget = MarkerNavigationWidget_1 = __decorate([\n    __param(1, IThemeService),\n    __param(2, IOpenerService),\n    __param(3, IMenuService),\n    __param(4, IInstantiationService),\n    __param(5, IContextKeyService),\n    __param(6, ILabelService)\n], MarkerNavigationWidget);\nexport { MarkerNavigationWidget };\n// theming\nconst errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\nconst warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\nconst infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\nconst editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\nconst editorMarkerNavigationErrorHeader = registerColor('editorMarkerNavigationError.headerBackground', { dark: transparent(editorMarkerNavigationError, .1), light: transparent(editorMarkerNavigationError, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationErrorHeaderBackground', 'Editor marker navigation widget error heading background.'));\nconst editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\nconst editorMarkerNavigationWarningHeader = registerColor('editorMarkerNavigationWarning.headerBackground', { dark: transparent(editorMarkerNavigationWarning, .1), light: transparent(editorMarkerNavigationWarning, .1), hcDark: '#0C141F', hcLight: transparent(editorMarkerNavigationWarning, .2) }, nls.localize('editorMarkerNavigationWarningBackground', 'Editor marker navigation widget warning heading background.'));\nconst editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\nconst editorMarkerNavigationInfoHeader = registerColor('editorMarkerNavigationInfo.headerBackground', { dark: transparent(editorMarkerNavigationInfo, .1), light: transparent(editorMarkerNavigationInfo, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationInfoHeaderBackground', 'Editor marker navigation widget info heading background.'));\nconst editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: editorBackground, light: editorBackground, hcDark: editorBackground, hcLight: editorBackground }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar MarkerController_1;\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IMarkerNavigationService } from './markerNavigationService.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\nlet MarkerController = MarkerController_1 = class MarkerController {\n    static get(editor) {\n        return editor.getContribution(MarkerController_1.ID);\n    }\n    constructor(editor, _markerNavigationService, _contextKeyService, _editorService, _instantiationService) {\n        this._markerNavigationService = _markerNavigationService;\n        this._contextKeyService = _contextKeyService;\n        this._editorService = _editorService;\n        this._instantiationService = _instantiationService;\n        this._sessionDispoables = new DisposableStore();\n        this._editor = editor;\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\n    }\n    dispose() {\n        this._cleanUp();\n        this._sessionDispoables.dispose();\n    }\n    _cleanUp() {\n        this._widgetVisible.reset();\n        this._sessionDispoables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    _getOrCreateModel(uri) {\n        if (this._model && this._model.matches(uri)) {\n            return this._model;\n        }\n        let reusePosition = false;\n        if (this._model) {\n            reusePosition = true;\n            this._cleanUp();\n        }\n        this._model = this._markerNavigationService.getMarkerList(uri);\n        if (reusePosition) {\n            this._model.move(true, this._editor.getModel(), this._editor.getPosition());\n        }\n        this._widget = this._instantiationService.createInstance(MarkerNavigationWidget, this._editor);\n        this._widget.onDidClose(() => this.close(), this, this._sessionDispoables);\n        this._widgetVisible.set(true);\n        this._sessionDispoables.add(this._model);\n        this._sessionDispoables.add(this._widget);\n        // follow cursor\n        this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e => {\n            var _a, _b, _c;\n            if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.selected) || !Range.containsPosition((_b = this._model) === null || _b === void 0 ? void 0 : _b.selected.marker, e.position)) {\n                (_c = this._model) === null || _c === void 0 ? void 0 : _c.resetIndex();\n            }\n        }));\n        // update markers\n        this._sessionDispoables.add(this._model.onDidChange(() => {\n            if (!this._widget || !this._widget.position || !this._model) {\n                return;\n            }\n            const info = this._model.find(this._editor.getModel().uri, this._widget.position);\n            if (info) {\n                this._widget.updateMarker(info.marker);\n            }\n            else {\n                this._widget.showStale();\n            }\n        }));\n        // open related\n        this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(related => {\n            this._editorService.openCodeEditor({\n                resource: related.resource,\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\n            }, this._editor);\n            this.close(false);\n        }));\n        this._sessionDispoables.add(this._editor.onDidChangeModel(() => this._cleanUp()));\n        return this._model;\n    }\n    close(focusEditor = true) {\n        this._cleanUp();\n        if (focusEditor) {\n            this._editor.focus();\n        }\n    }\n    showAtMarker(marker) {\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(this._editor.getModel().uri);\n            model.resetIndex();\n            model.move(true, this._editor.getModel(), new Position(marker.startLineNumber, marker.startColumn));\n            if (model.selected) {\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n    nagivate(next, multiFile) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._editor.hasModel()) {\n                const model = this._getOrCreateModel(multiFile ? undefined : this._editor.getModel().uri);\n                model.move(next, this._editor.getModel(), this._editor.getPosition());\n                if (!model.selected) {\n                    return;\n                }\n                if (model.selected.marker.resource.toString() !== this._editor.getModel().uri.toString()) {\n                    // show in different editor\n                    this._cleanUp();\n                    const otherEditor = yield this._editorService.openCodeEditor({\n                        resource: model.selected.marker.resource,\n                        options: { pinned: false, revealIfOpened: true, selectionRevealType: 2 /* TextEditorSelectionRevealType.NearTop */, selection: model.selected.marker }\n                    }, this._editor);\n                    if (otherEditor) {\n                        (_a = MarkerController_1.get(otherEditor)) === null || _a === void 0 ? void 0 : _a.close();\n                        (_b = MarkerController_1.get(otherEditor)) === null || _b === void 0 ? void 0 : _b.nagivate(next, multiFile);\n                    }\n                }\n                else {\n                    // show in this editor\n                    this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n                }\n            }\n        });\n    }\n};\nMarkerController.ID = 'editor.contrib.markerController';\nMarkerController = MarkerController_1 = __decorate([\n    __param(1, IMarkerNavigationService),\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, IInstantiationService)\n], MarkerController);\nexport { MarkerController };\nclass MarkerNavigationAction extends EditorAction {\n    constructor(_next, _multiFile, opts) {\n        super(opts);\n        this._next = _next;\n        this._multiFile = _multiFile;\n    }\n    run(_accessor, editor) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                (_a = MarkerController.get(editor)) === null || _a === void 0 ? void 0 : _a.nagivate(this._next, this._multiFile);\n            }\n        });\n    }\n}\nexport class NextMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, false, {\n            id: NextMarkerAction.ID,\n            label: NextMarkerAction.LABEL,\n            alias: 'Go to Next Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: NextMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-next', Codicon.arrowDown, nls.localize('nextMarkerIcon', 'Icon for goto next marker.')),\n                group: 'navigation',\n                order: 1\n            }\n        });\n    }\n}\nNextMarkerAction.ID = 'editor.action.marker.next';\nNextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\nclass PrevMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, false, {\n            id: PrevMarkerAction.ID,\n            label: PrevMarkerAction.LABEL,\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: PrevMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-previous', Codicon.arrowUp, nls.localize('previousMarkerIcon', 'Icon for goto previous marker.')),\n                group: 'navigation',\n                order: 2\n            }\n        });\n    }\n}\nPrevMarkerAction.ID = 'editor.action.marker.prev';\nPrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\nclass NextMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, true, {\n            id: 'editor.action.marker.nextInFiles',\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\"),\n                group: '6_problem_nav',\n                order: 1\n            }\n        });\n    }\n}\nclass PrevMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, true, {\n            id: 'editor.action.marker.prevInFiles',\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\"),\n                group: '6_problem_nav',\n                order: 2\n            }\n        });\n    }\n}\nregisterEditorContribution(MarkerController.ID, MarkerController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(NextMarkerAction);\nregisterEditorAction(PrevMarkerAction);\nregisterEditorAction(NextMarkerInFilesAction);\nregisterEditorAction(PrevMarkerInFilesAction);\nconst CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\nconst MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\nregisterEditorCommand(new MarkerCommand({\n    id: 'closeMarkersNavigation',\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\n    handler: x => x.close(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 50,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        var _a, _b;\n        this._ctxHasSymbols.reset();\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        var _a;\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, 1 /* InstantiationType.Delayed */);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 70 /* KeyCode.F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* KeyCode.Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        var _a;\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a, _b, _c, _d, _e, _f, _g, _h;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { IsWebContext } from '../../../../platform/contextkey/common/contextkeys.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nexport class SymbolNavigationAnchor {\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction2 {\n    static all() {\n        return SymbolNavigationAction._allSymbolNavigationCommands.values();\n    }\n    static _patchConfig(opts) {\n        const result = Object.assign(Object.assign({}, opts), { f1: true });\n        // patch context menu when clause\n        if (result.menu) {\n            for (const item of Iterable.wrap(result.menu)) {\n                if (item.id === MenuId.EditorContext || item.id === MenuId.EditorContextPeek) {\n                    item.when = ContextKeyExpr.and(opts.precondition, item.when);\n                }\n            }\n        }\n        return result;\n    }\n    constructor(configuration, opts) {\n        super(SymbolNavigationAction._patchConfig(opts));\n        this.configuration = configuration;\n        SymbolNavigationAction._allSymbolNavigationCommands.set(opts.id, this);\n    }\n    runEditorCommand(accessor, editor, arg, range) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const instaService = accessor.get(IInstantiationService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const promise = raceCancellation(this._getLocationModel(languageFeaturesService, anchor.model, anchor.position, cts.token), cts.token).then((references) => __awaiter(this, void 0, void 0, function* () {\n            var _j;\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (!SymbolNavigationAction._activeAlternativeCommands.has(altActionId) && SymbolNavigationAction._allSymbolNavigationCommands.has(altActionId)) {\n                    altAction = SymbolNavigationAction._allSymbolNavigationCommands.get(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    (_j = MessageController.get(editor)) === null || _j === void 0 ? void 0 : _j.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                SymbolNavigationAction._activeAlternativeCommands.add(this.desc.id);\n                instaService.invokeFunction((accessor) => altAction.runEditorCommand(accessor, editor, arg, range).finally(() => {\n                    SymbolNavigationAction._activeAlternativeCommands.delete(this.desc.id);\n                }));\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references, range);\n            }\n        }), (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    _onResult(editorService, symbolNavService, editor, model, range) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const gotoLocation = this._getGoToPreference(editor);\n            if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n                this._openInPeek(editor, model, range);\n            }\n            else {\n                const next = model.firstReference();\n                const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n                const targetEditor = yield this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n                if (peek && targetEditor) {\n                    this._openInPeek(targetEditor, model, range);\n                }\n                else {\n                    model.dispose();\n                }\n                // keep remaining locations around when using\n                // 'goto'-mode\n                if (gotoLocation === 'goto') {\n                    symbolNavService.put(next);\n                }\n            }\n        });\n    }\n    _openReference(editor, editorService, reference, sideBySide, highlight) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // range is the target-selection-range when we have one\n            // and the fallback is the 'full' range\n            let range = undefined;\n            if (isLocationLink(reference)) {\n                range = reference.targetSelectionRange;\n            }\n            if (!range) {\n                range = reference.range;\n            }\n            if (!range) {\n                return undefined;\n            }\n            const targetEditor = yield editorService.openCodeEditor({\n                resource: reference.uri,\n                options: {\n                    selection: Range.collapseToStart(range),\n                    selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */,\n                    selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */\n                }\n            }, editor, sideBySide);\n            if (!targetEditor) {\n                return undefined;\n            }\n            if (highlight) {\n                const modelNow = targetEditor.getModel();\n                const decorations = targetEditor.createDecorationsCollection([{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n                setTimeout(() => {\n                    if (targetEditor.getModel() === modelNow) {\n                        decorations.clear();\n                    }\n                }, 350);\n            }\n            return targetEditor;\n        });\n    }\n    _openInPeek(target, model, range) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(range !== null && range !== void 0 ? range : target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\nSymbolNavigationAction._allSymbolNavigationCommands = new Map();\nSymbolNavigationAction._activeAlternativeCommands = new Set();\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, token), nls.localize('def.title', 'Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleDefinitions;\n    }\n}\nregisterAction2((_a = class GoToDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _a.id,\n                title: {\n                    value: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\n                    original: 'Go to Definition',\n                    mnemonicTitle: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: [{\n                        when: EditorContextKeys.editorTextFocus,\n                        primary: 70 /* KeyCode.F12 */,\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }, {\n                        when: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, IsWebContext),\n                        primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }],\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.1\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 2,\n                    }]\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', _a.id);\n        }\n    },\n    _a.id = 'editor.action.revealDefinition',\n    _a));\nregisterAction2((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: true,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _b.id,\n                title: {\n                    value: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n                    original: 'Open Definition to the Side'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: [{\n                        when: EditorContextKeys.editorTextFocus,\n                        primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 70 /* KeyCode.F12 */),\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }, {\n                        when: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, IsWebContext),\n                        primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */),\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }]\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', _b.id);\n        }\n    },\n    _b.id = 'editor.action.revealDefinitionAside',\n    _b));\nregisterAction2((_c = class PeekDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: _c.id,\n                title: {\n                    value: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\n                    original: 'Peek Definition'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 512 /* KeyMod.Alt */ | 70 /* KeyCode.F12 */,\n                    linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */ },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 2\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', _c.id);\n        }\n    },\n    _c.id = 'editor.action.peekDefinition',\n    _c));\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, token), nls.localize('decl.title', 'Declarations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleDeclarations;\n    }\n}\nregisterAction2((_d = class GoToDeclarationAction extends DeclarationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _d.id,\n                title: {\n                    value: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\n                    original: 'Go to Declaration',\n                    mnemonicTitle: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.3\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }],\n            });\n        }\n        _getNoResultFoundMessage(info) {\n            return info && info.word\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\n        }\n    },\n    _d.id = 'editor.action.revealDeclaration',\n    _d));\nregisterAction2(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            title: {\n                value: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\n                original: 'Peek Declaration'\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterAction2((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _e.ID,\n                title: {\n                    value: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                    original: 'Go to Type Definition',\n                    mnemonicTitle: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 0,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.4\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }]\n            });\n        }\n    },\n    _e.ID = 'editor.action.goToTypeDefinition',\n    _e));\nregisterAction2((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: _f.ID,\n                title: {\n                    value: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n                    original: 'Peek Type Definition'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 4\n                }\n            });\n        }\n    },\n    _f.ID = 'editor.action.peekTypeDefinition',\n    _f));\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, token), nls.localize('impl.title', 'Implementations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleImplementations;\n    }\n}\nregisterAction2((_g = class GoToImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _g.ID,\n                title: {\n                    value: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\n                    original: 'Go to Implementations',\n                    mnemonicTitle: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.45\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 4,\n                    }]\n            });\n        }\n    },\n    _g.ID = 'editor.action.goToImplementation',\n    _g));\nregisterAction2((_h = class PeekImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: _h.ID,\n                title: {\n                    value: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\n                    original: 'Peek Implementations'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 5\n                }\n            });\n        }\n    },\n    _h.ID = 'editor.action.peekImplementation',\n    _h));\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n}\nregisterAction2(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            title: {\n                value: nls.localize('goToReferences.label', \"Go to References\"),\n                original: 'Go to References',\n                mnemonicTitle: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.45\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 5,\n                }]\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, true, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\nregisterAction2(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            title: {\n                value: nls.localize('references.action.label', \"Peek References\"),\n                original: 'Peek References'\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            title: {\n                value: nls.localize('label.generic', \"Go to Any Symbol\"),\n                original: 'Go to Any Symbol'\n            },\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    _getLocationModel(languageFeaturesService, _model, _position, _token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        var _j;\n        return (_j = this._gotoMultipleBehaviour) !== null && _j !== void 0 ? _j : editor.getOption(58 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    description: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => __awaiter(void 0, void 0, void 0, function* () {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = yield editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    })\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    description: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple) => __awaiter(void 0, void 0, void 0, function* () {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    })\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(languageFeaturesService.referenceProvider, control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ReferencesModel } from './referencesModel.js';\nfunction getLocationLinks(model, position, registry, provide) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const provider = registry.ordered(model);\n        // get results\n        const promises = provider.map((provider) => {\n            return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\n                onUnexpectedExternalError(err);\n                return undefined;\n            });\n        });\n        const values = yield Promise.all(promises);\n        return coalesce(values.flat());\n    });\n}\nexport function getDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDefinition(model, position, token);\n    });\n}\nexport function getDeclarationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDeclaration(model, position, token);\n    });\n}\nexport function getImplementationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideImplementation(model, position, token);\n    });\n}\nexport function getTypeDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideTypeDefinition(model, position, token);\n    });\n}\nexport function getReferencesAtPosition(registry, model, position, compact, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => __awaiter(this, void 0, void 0, function* () {\n        const result = yield provider.provideReferences(model, position, { includeDeclaration: true }, token);\n        if (!compact || !result || result.length !== 2) {\n            return result;\n        }\n        const resultWithoutDeclaration = yield provider.provideReferences(model, position, { includeDeclaration: false }, token);\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\n            return resultWithoutDeclaration;\n        }\n        return result;\n    }));\n}\n// -- API commands ----\nfunction _sortedAndDeduped(callback) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const rawLinks = yield callback();\n        const model = new ReferencesModel(rawLinks, '');\n        const modelLinks = model.references.map(ref => ref.link);\n        model.dispose();\n        return modelLinks;\n    });\n}\nregisterModelAndPositionCommand('_executeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDeclarationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeReferenceProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeImplementationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../../base/common/platform.js';\nfunction hasModifier(e, modifier) {\n    return !!e[modifier];\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkMouseEvent {\n    constructor(source, opts) {\n        this.target = source.target;\n        this.isLeftClick = source.event.leftButton;\n        this.isMiddleClick = source.event.middleButton;\n        this.isRightClick = source.event.rightButton;\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\n    }\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkKeyboardEvent {\n    constructor(source, opts) {\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n    }\n}\nexport class ClickLinkOptions {\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n        this.triggerKey = triggerKey;\n        this.triggerModifier = triggerModifier;\n        this.triggerSideBySideKey = triggerSideBySideKey;\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\n    }\n    equals(other) {\n        return (this.triggerKey === other.triggerKey\n            && this.triggerModifier === other.triggerModifier\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\n    }\n}\nfunction createOptions(multiCursorModifier) {\n    if (multiCursorModifier === 'altKey') {\n        if (platform.isMacintosh) {\n            return new ClickLinkOptions(57 /* KeyCode.Meta */, 'metaKey', 6 /* KeyCode.Alt */, 'altKey');\n        }\n        return new ClickLinkOptions(5 /* KeyCode.Ctrl */, 'ctrlKey', 6 /* KeyCode.Alt */, 'altKey');\n    }\n    if (platform.isMacintosh) {\n        return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 57 /* KeyCode.Meta */, 'metaKey');\n    }\n    return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 5 /* KeyCode.Ctrl */, 'ctrlKey');\n}\nexport class ClickLinkGesture extends Disposable {\n    constructor(editor, opts) {\n        var _a;\n        super();\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\n        this._onExecute = this._register(new Emitter());\n        this.onExecute = this._onExecute.event;\n        this._onCancel = this._register(new Emitter());\n        this.onCancel = this._onCancel.event;\n        this._editor = editor;\n        this._extractLineNumberFromMouseEvent = (_a = opts === null || opts === void 0 ? void 0 : opts.extractLineNumberFromMouseEvent) !== null && _a !== void 0 ? _a : ((e) => e.target.position ? e.target.position.lineNumber : 0);\n        this._opts = createOptions(this._editor.getOption(77 /* EditorOption.multiCursorModifier */));\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._lineNumberOnMouseDown = 0;\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(77 /* EditorOption.multiCursorModifier */)) {\n                const newOpts = createOptions(this._editor.getOption(77 /* EditorOption.multiCursorModifier */));\n                if (this._opts.equals(newOpts)) {\n                    return;\n                }\n                this._opts = newOpts;\n                this._lastMouseMoveEvent = null;\n                this._hasTriggerKeyOnMouseDown = false;\n                this._lineNumberOnMouseDown = 0;\n                this._onCancel.fire();\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\n                this._resetHandler();\n            }\n        }));\n    }\n    _onDidChangeCursorSelection(e) {\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\n        }\n    }\n    _onEditorMouseMove(mouseEvent) {\n        this._lastMouseMoveEvent = mouseEvent;\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n    }\n    _onEditorMouseDown(mouseEvent) {\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n        // release the mouse button without wanting to do the navigation.\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n        this._lineNumberOnMouseDown = this._extractLineNumberFromMouseEvent(mouseEvent);\n    }\n    _onEditorMouseUp(mouseEvent) {\n        const currentLineNumber = this._extractLineNumberFromMouseEvent(mouseEvent);\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber) {\n            this._onExecute.fire(mouseEvent);\n        }\n    }\n    _onEditorKeyDown(e) {\n        if (this._lastMouseMoveEvent\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n            )) {\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\n        }\n        else if (e.hasTriggerModifier) {\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n        }\n    }\n    _onEditorKeyUp(e) {\n        if (e.keyCodeIsTriggerKey) {\n            this._onCancel.fire();\n        }\n    }\n    _resetHandler() {\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._onCancel.fire();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar GotoDefinitionAtPositionEditorContribution_1;\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../../common/model/textModel.js';\nlet GotoDefinitionAtPositionEditorContribution = GotoDefinitionAtPositionEditorContribution_1 = class GotoDefinitionAtPositionEditorContribution {\n    constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        this.linkDecorations = this.editor.createDecorationsCollection();\n        const linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, keyboardEvent !== null && keyboardEvent !== void 0 ? keyboardEvent : undefined);\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier)\n                    .catch((error) => {\n                    onUnexpectedError(error);\n                })\n                    .finally(() => {\n                    this.removeLinkDecorations();\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution_1.ID);\n    }\n    startFindDefinitionFromCursor(position) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // For issue: https://github.com/microsoft/vscode/issues/46257\n            // equivalent to mouse move with meta/ctrl key\n            // First find the definition and add decorations\n            // to the editor to be shown with the content hover widget\n            yield this.startFindDefinition(position);\n            // Add listeners for editor cursor move and key down events\n            // Dismiss the \"extended\" editor decorations when the user hides\n            // the hover widget. There is no event for the widget itself so these\n            // serve as a best effort. After removing the link decorations, the hover\n            // widget is clean and will only show declarations per next request.\n            this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }));\n            this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n                if (e) {\n                    this.currentWordAtPosition = null;\n                    this.removeLinkDecorations();\n                    this.toUnhookForKeyboard.clear();\n                }\n            }));\n        });\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    startFindDefinition(position) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // Dispose listeners for updating decorations when using keyboard to show definition hover\n            this.toUnhookForKeyboard.clear();\n            // Find word at mouse position\n            const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n            if (!word) {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                return;\n            }\n            // Return early if word at position is still the same\n            if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n                return;\n            }\n            this.currentWordAtPosition = word;\n            // Find definition and decorate word if found\n            const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n            if (this.previousPromise) {\n                this.previousPromise.cancel();\n                this.previousPromise = null;\n            }\n            this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n            let results;\n            try {\n                results = yield this.previousPromise;\n            }\n            catch (error) {\n                onUnexpectedError(error);\n                return;\n            }\n            if (!results || !results.length || !state.validate(this.editor)) {\n                this.removeLinkDecorations();\n                return;\n            }\n            const linkRange = results[0].originSelectionRange\n                ? Range.lift(results[0].originSelectionRange)\n                : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n            // Multiple results\n            if (results.length > 1) {\n                let combinedRange = linkRange;\n                for (const { originSelectionRange } of results) {\n                    if (originSelectionRange) {\n                        combinedRange = Range.plusRange(combinedRange, originSelectionRange);\n                    }\n                }\n                this.addDecoration(combinedRange, new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n            }\n            else {\n                // Single result\n                const result = results[0];\n                if (!result.uri) {\n                    return;\n                }\n                this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                    if (!ref.object || !ref.object.textEditorModel) {\n                        ref.dispose();\n                        return;\n                    }\n                    const { object: { textEditorModel } } = ref;\n                    const { startLineNumber } = result.range;\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                        // invalid range\n                        ref.dispose();\n                        return;\n                    }\n                    const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                    const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                    this.addDecoration(linkRange, previewValue ? new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue) : undefined);\n                    ref.dispose();\n                });\n            }\n        });\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.range;\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution_1.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution_1.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations.set([newDecorations]);\n    }\n    removeLinkDecorations() {\n        this.linkDecorations.clear();\n    }\n    isEnabled(mouseEvent, withKey) {\n        var _a;\n        return this.editor.hasModel()\n            && mouseEvent.isLeftClick\n            && mouseEvent.isNoneOrSingleMouseDown\n            && mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */\n            && !(((_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options) instanceof ModelDecorationInjectedTextOptions)\n            && (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false))\n            && this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(87 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n            return action.run(accessor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n        this.toUnhookForKeyboard.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = GotoDefinitionAtPositionEditorContribution_1 = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService),\n    __param(3, ILanguageFeaturesService)\n], GotoDefinitionAtPositionEditorContribution);\nexport { GotoDefinitionAtPositionEditorContribution };\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar FileReferencesRenderer_1;\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CountBadge } from '../../../../../base/browser/ui/countBadge/countBadge.js';\nimport { HighlightedLabel } from '../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { IconLabel } from '../../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { createMatches, FuzzyScore } from '../../../../../base/common/filters.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { basename, dirname } from '../../../../../base/common/resources.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { defaultCountBadgeStyles } from '../../../../../platform/theme/browser/defaultStyles.js';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel.js';\nlet DataSource = class DataSource {\n    constructor(_resolverService) {\n        this._resolverService = _resolverService;\n    }\n    hasChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return true;\n        }\n        if (element instanceof FileReferences) {\n            return true;\n        }\n        return false;\n    }\n    getChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return element.groups;\n        }\n        if (element instanceof FileReferences) {\n            return element.resolve(this._resolverService).then(val => {\n                // if (element.failure) {\n                // \t// refresh the element on failure so that\n                // \t// we can update its rendering\n                // \treturn tree.refresh(element).then(() => val.children);\n                // }\n                return val.children;\n            });\n        }\n        throw new Error('bad tree');\n    }\n};\nDataSource = __decorate([\n    __param(0, ITextModelService)\n], DataSource);\nexport { DataSource };\n//#endregion\nexport class Delegate {\n    getHeight() {\n        return 23;\n    }\n    getTemplateId(element) {\n        if (element instanceof FileReferences) {\n            return FileReferencesRenderer.id;\n        }\n        else {\n            return OneReferenceRenderer.id;\n        }\n    }\n}\nlet StringRepresentationProvider = class StringRepresentationProvider {\n    constructor(_keybindingService) {\n        this._keybindingService = _keybindingService;\n    }\n    getKeyboardNavigationLabel(element) {\n        var _a;\n        if (element instanceof OneReference) {\n            const parts = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n            if (parts) {\n                return parts.value;\n            }\n        }\n        // FileReferences or unresolved OneReference\n        return basename(element.uri);\n    }\n};\nStringRepresentationProvider = __decorate([\n    __param(0, IKeybindingService)\n], StringRepresentationProvider);\nexport { StringRepresentationProvider };\nexport class IdentityProvider {\n    getId(element) {\n        return element instanceof OneReference ? element.id : element.uri;\n    }\n}\n//#region render: File\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\n    constructor(container, _labelService) {\n        super();\n        this._labelService = _labelService;\n        const parent = document.createElement('div');\n        parent.classList.add('reference-file');\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')), {}, defaultCountBadgeStyles);\n        container.appendChild(parent);\n    }\n    set(element, matches) {\n        const parent = dirname(element.uri);\n        this.file.setLabel(this._labelService.getUriBasenameLabel(element.uri), this._labelService.getUriLabel(parent, { relative: true }), { title: this._labelService.getUriLabel(element.uri), matches });\n        const len = element.children.length;\n        this.badge.setCount(len);\n        if (len > 1) {\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n        }\n        else {\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n        }\n    }\n};\nFileReferencesTemplate = __decorate([\n    __param(1, ILabelService)\n], FileReferencesTemplate);\nlet FileReferencesRenderer = FileReferencesRenderer_1 = class FileReferencesRenderer {\n    constructor(_instantiationService) {\n        this._instantiationService = _instantiationService;\n        this.templateId = FileReferencesRenderer_1.id;\n    }\n    renderTemplate(container) {\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\n    }\n    renderElement(node, index, template) {\n        template.set(node.element, createMatches(node.filterData));\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n};\nFileReferencesRenderer.id = 'FileReferencesRenderer';\nFileReferencesRenderer = FileReferencesRenderer_1 = __decorate([\n    __param(0, IInstantiationService)\n], FileReferencesRenderer);\nexport { FileReferencesRenderer };\n//#endregion\n//#region render: Reference\nclass OneReferenceTemplate {\n    constructor(container) {\n        this.label = new HighlightedLabel(container);\n    }\n    set(element, score) {\n        var _a;\n        const preview = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n        if (!preview || !preview.value) {\n            // this means we FAILED to resolve the document or the value is the empty string\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\n        }\n        else {\n            // render search match as highlight unless\n            // we have score, then render the score\n            const { value, highlight } = preview;\n            if (score && !FuzzyScore.isDefault(score)) {\n                this.label.element.classList.toggle('referenceMatch', false);\n                this.label.set(value, createMatches(score));\n            }\n            else {\n                this.label.element.classList.toggle('referenceMatch', true);\n                this.label.set(value, [highlight]);\n            }\n        }\n    }\n}\nexport class OneReferenceRenderer {\n    constructor() {\n        this.templateId = OneReferenceRenderer.id;\n    }\n    renderTemplate(container) {\n        return new OneReferenceTemplate(container);\n    }\n    renderElement(node, index, templateData) {\n        templateData.set(node.element, node.filterData);\n    }\n    disposeTemplate() {\n    }\n}\nOneReferenceRenderer.id = 'OneReferenceRenderer';\n//#endregion\nexport class AccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('treeAriaLabel', \"References\");\n    }\n    getAriaLabel(element) {\n        return element.ariaMessage;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../common/languages/modesRegistry.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../../platform/list/browser/listService.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            const oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        this._editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations([], newDecorations);\n            for (let i = 0; i < decorations.length; i++) {\n                this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n            }\n        });\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.removeDecorations(toRemove);\n    }\n    removeDecorations() {\n        this._editor.removeDecorations([...this._decorations.keys()]);\n        this._decorations.clear();\n    }\n}\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n    description: 'reference-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'reference-decoration'\n});\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch (_a) {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _languageService, _languageConfigurationService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._undoRedoService = _undoRedoService;\n        this._keybindingService = _keybindingService;\n        this._languageService = _languageService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    dispose() {\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* Orientation.HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        const options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: true\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, {}, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null, this._undoRedoService, this._languageService, this._languageConfigurationService);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* KeyCode.Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        const onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        });\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._revealReference(reference, false);\n            this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n        });\n    }\n    _revealReference(reference, revealParent) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // check if there is anything to do...\n            if (this._revealedReference === reference) {\n                return;\n            }\n            this._revealedReference = reference;\n            // Update widget header\n            if (reference.uri.scheme !== Schemas.inMemory) {\n                this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n            }\n            else {\n                this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n            }\n            const promise = this._textModelResolverService.createModelReference(reference.uri);\n            if (this._tree.getInput() === reference.parent) {\n                this._tree.reveal(reference);\n            }\n            else {\n                if (revealParent) {\n                    this._tree.reveal(reference.parent);\n                }\n                yield this._tree.expand(reference.parent);\n                this._tree.reveal(reference);\n            }\n            const ref = yield promise;\n            if (!this._model) {\n                // disposed\n                ref.dispose();\n                return;\n            }\n            dispose(this._previewModelReference);\n            // show in editor\n            const model = ref.object;\n            if (model) {\n                const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* ScrollType.Smooth */ : 1 /* ScrollType.Immediate */;\n                const sel = Range.lift(reference.range).collapseToStart();\n                this._previewModelReference = ref;\n                this._preview.setModel(model.textEditorModel);\n                this._preview.setSelection(sel);\n                this._preview.revealRangeInCenter(sel, scrollType);\n            }\n            else {\n                this._preview.setModel(this._previewNotAvailableMessage);\n                ref.dispose();\n            }\n        });\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IUndoRedoService),\n    __param(9, IKeybindingService),\n    __param(10, ILanguageService),\n    __param(11, ILanguageConfigurationService)\n], ReferenceWidget);\nexport { ReferenceWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar ReferencesController_1;\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { getOuterEditor, PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IListService, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse, WorkbenchTreeElementCanExpand } from '../../../../../platform/list/browser/listService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { OneReference } from '../referencesModel.js';\nimport { LayoutData, ReferenceWidget } from './referencesWidget.js';\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\nlet ReferencesController = ReferencesController_1 = class ReferencesController {\n    static get(editor) {\n        return editor.getContribution(ReferencesController_1.ID);\n    }\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this._editor = _editor;\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._instantiationService = _instantiationService;\n        this._storageService = _storageService;\n        this._configurationService = _configurationService;\n        this._disposables = new DisposableStore();\n        this._requestIdPool = 0;\n        this._ignoreModelChangeEvent = false;\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\n    }\n    dispose() {\n        var _a, _b;\n        this._referenceSearchVisible.reset();\n        this._disposables.dispose();\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    toggleWidget(range, modelPromise, peekMode) {\n        // close current widget and return early is position didn't change\n        let widgetPosition;\n        if (this._widget) {\n            widgetPosition = this._widget.position;\n        }\n        this.closeWidget();\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\n            return;\n        }\n        this._peekMode = peekMode;\n        this._referenceSearchVisible.set(true);\n        // close the widget on model/mode changes\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\n        this._disposables.add(this._editor.onDidChangeModel(() => {\n            if (!this._ignoreModelChangeEvent) {\n                this.closeWidget();\n            }\n        }));\n        const storageKey = 'peekViewLayout';\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* StorageScope.PROFILE */, '{}'));\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\n        this._widget.show(range);\n        this._disposables.add(this._widget.onDidClose(() => {\n            modelPromise.cancel();\n            if (this._widget) {\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n                this._widget = undefined;\n            }\n            this.closeWidget();\n        }));\n        this._disposables.add(this._widget.onDidSelectReference(event => {\n            const { element, kind } = event;\n            if (!element) {\n                return;\n            }\n            switch (kind) {\n                case 'open':\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\n                        // when stable peek is configured we don't close\n                        // the peek window on selecting the editor\n                        this.openReference(element, false, false);\n                    }\n                    break;\n                case 'side':\n                    this.openReference(element, true, false);\n                    break;\n                case 'goto':\n                    if (peekMode) {\n                        this._gotoReference(element, true);\n                    }\n                    else {\n                        this.openReference(element, false, true);\n                    }\n                    break;\n            }\n        }));\n        const requestId = ++this._requestIdPool;\n        modelPromise.then(model => {\n            var _a;\n            // still current request? widget still open?\n            if (requestId !== this._requestIdPool || !this._widget) {\n                model.dispose();\n                return undefined;\n            }\n            (_a = this._model) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._model = model;\n            // show widget\n            return this._widget.setModel(this._model).then(() => {\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\n                    // set title\n                    if (!this._model.isEmpty) {\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\n                    }\n                    else {\n                        this._widget.setMetaTitle('');\n                    }\n                    // set 'best' selection\n                    const uri = this._editor.getModel().uri;\n                    const pos = new Position(range.startLineNumber, range.startColumn);\n                    const selection = this._model.nearestReference(uri, pos);\n                    if (selection) {\n                        return this._widget.setSelection(selection).then(() => {\n                            if (this._widget && this._editor.getOption(86 /* EditorOption.peekWidgetDefaultFocus */) === 'editor') {\n                                this._widget.focusOnPreviewEditor();\n                            }\n                        });\n                    }\n                }\n                return undefined;\n            });\n        }, error => {\n            this._notificationService.error(error);\n        });\n    }\n    changeFocusBetweenPreviewAndReferences() {\n        if (!this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        if (this._widget.isPreviewEditorFocused()) {\n            this._widget.focusOnReferenceTree();\n        }\n        else {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    goToNextOrPreviousReference(fwd) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            const currentPosition = this._widget.position;\n            if (!currentPosition) {\n                return;\n            }\n            const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\n            if (!source) {\n                return;\n            }\n            const target = this._model.nextOrPreviousReference(source, fwd);\n            const editorFocus = this._editor.hasTextFocus();\n            const previewEditorFocus = this._widget.isPreviewEditorFocused();\n            yield this._widget.setSelection(target);\n            yield this._gotoReference(target, false);\n            if (editorFocus) {\n                this._editor.focus();\n            }\n            else if (this._widget && previewEditorFocus) {\n                this._widget.focusOnPreviewEditor();\n            }\n        });\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            yield this._widget.revealReference(reference);\n        });\n    }\n    closeWidget(focusEditor = true) {\n        var _a, _b;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._referenceSearchVisible.reset();\n        this._disposables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n        if (focusEditor) {\n            this._editor.focus();\n        }\n        this._requestIdPool += 1; // Cancel pending requests\n    }\n    _gotoReference(ref, pinned) {\n        var _a;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.hide();\n        this._ignoreModelChangeEvent = true;\n        const range = Range.lift(ref.range).collapseToStart();\n        return this._editorService.openCodeEditor({\n            resource: ref.uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor).then(openedEditor => {\n            var _a;\n            this._ignoreModelChangeEvent = false;\n            if (!openedEditor || !this._widget) {\n                // something went wrong...\n                this.closeWidget();\n                return;\n            }\n            if (this._editor === openedEditor) {\n                //\n                this._widget.show(range);\n                this._widget.focusOnReferenceTree();\n            }\n            else {\n                // we opened a different editor instance which means a different controller instance.\n                // therefore we stop with this controller and continue with the other\n                const other = ReferencesController_1.get(openedEditor);\n                const model = this._model.clone();\n                this.closeWidget();\n                openedEditor.focus();\n                other === null || other === void 0 ? void 0 : other.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), (_a = this._peekMode) !== null && _a !== void 0 ? _a : false);\n            }\n        }, (err) => {\n            this._ignoreModelChangeEvent = false;\n            onUnexpectedError(err);\n        });\n    }\n    openReference(ref, sideBySide, pinned) {\n        // clear stage\n        if (!sideBySide) {\n            this.closeWidget();\n        }\n        const { uri, range } = ref;\n        this._editorService.openCodeEditor({\n            resource: uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor, sideBySide);\n    }\n};\nReferencesController.ID = 'editor.contrib.referencesController';\nReferencesController = ReferencesController_1 = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, INotificationService),\n    __param(5, IInstantiationService),\n    __param(6, IStorageService),\n    __param(7, IConfigurationService)\n], ReferencesController);\nexport { ReferencesController };\nfunction withController(accessor, fn) {\n    const outerEditor = getOuterEditor(accessor);\n    if (!outerEditor) {\n        return;\n    }\n    const controller = ReferencesController.get(outerEditor);\n    if (controller) {\n        fn(controller);\n    }\n}\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'togglePeekWidgetFocus',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 60 /* KeyCode.F2 */),\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.changeFocusBetweenPreviewAndReferences();\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToNextReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 62 /* KeyCode.F4 */,\n    secondary: [70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(true);\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToPreviousReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 1024 /* KeyMod.Shift */ | 62 /* KeyCode.F4 */,\n    secondary: [1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(false);\n        });\n    }\n});\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\n// close\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 101,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */ + 50,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'revealReference',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    primary: 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 3 /* KeyCode.Enter */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */]\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.revealReference(focus[0]));\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'openReferenceToSide',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 256 /* KeyMod.WinCtrl */ | 3 /* KeyCode.Enter */\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\n        }\n    }\n});\nCommandsRegistry.registerCommand('openReference', (accessor) => {\n    var _a;\n    const listService = accessor.get(IListService);\n    const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultGenerator } from '../../../../base/common/idGenerator.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { basename, extUri } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nexport class OneReference {\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\n        this.isProviderFirst = isProviderFirst;\n        this.parent = parent;\n        this.link = link;\n        this._rangeCallback = _rangeCallback;\n        this.id = defaultGenerator.nextId();\n    }\n    get uri() {\n        return this.link.uri;\n    }\n    get range() {\n        var _a, _b;\n        return (_b = (_a = this._range) !== null && _a !== void 0 ? _a : this.link.targetSelectionRange) !== null && _b !== void 0 ? _b : this.link.range;\n    }\n    set range(value) {\n        this._range = value;\n        this._rangeCallback(this);\n    }\n    get ariaMessage() {\n        var _a;\n        const preview = (_a = this.parent.getPreview(this)) === null || _a === void 0 ? void 0 : _a.preview(this.range);\n        if (!preview) {\n            return localize('aria.oneReference', \"in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n        else {\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"{0} in {1} on line {2} at column {3}\", preview.value, basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n    }\n}\nexport class FilePreview {\n    constructor(_modelReference) {\n        this._modelReference = _modelReference;\n    }\n    dispose() {\n        this._modelReference.dispose();\n    }\n    preview(range, n = 8) {\n        const model = this._modelReference.object.textEditorModel;\n        if (!model) {\n            return undefined;\n        }\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\n        const inside = model.getValueInRange(range);\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\n        return {\n            value: before + inside + after,\n            highlight: { start: before.length, end: before.length + inside.length }\n        };\n    }\n}\nexport class FileReferences {\n    constructor(parent, uri) {\n        this.parent = parent;\n        this.uri = uri;\n        this.children = [];\n        this._previews = new ResourceMap();\n    }\n    dispose() {\n        dispose(this._previews.values());\n        this._previews.clear();\n    }\n    getPreview(child) {\n        return this._previews.get(child.uri);\n    }\n    get ariaMessage() {\n        const len = this.children.length;\n        if (len === 1) {\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\n        }\n        else {\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\n        }\n    }\n    resolve(textModelResolverService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._previews.size !== 0) {\n                return this;\n            }\n            for (const child of this.children) {\n                if (this._previews.has(child.uri)) {\n                    continue;\n                }\n                try {\n                    const ref = yield textModelResolverService.createModelReference(child.uri);\n                    this._previews.set(child.uri, new FilePreview(ref));\n                }\n                catch (err) {\n                    onUnexpectedError(err);\n                }\n            }\n            return this;\n        });\n    }\n}\nexport class ReferencesModel {\n    constructor(links, title) {\n        this.groups = [];\n        this.references = [];\n        this._onDidChangeReferenceRange = new Emitter();\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\n        this._links = links;\n        this._title = title;\n        // grouping and sorting\n        const [providersFirst] = links;\n        links.sort(ReferencesModel._compareReferences);\n        let current;\n        for (const link of links) {\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\n                // new group\n                current = new FileReferences(this, link.uri);\n                this.groups.push(current);\n            }\n            // append, check for equality first!\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\n                this.references.push(oneRef);\n                current.children.push(oneRef);\n            }\n        }\n    }\n    dispose() {\n        dispose(this.groups);\n        this._onDidChangeReferenceRange.dispose();\n        this.groups.length = 0;\n    }\n    clone() {\n        return new ReferencesModel(this._links, this._title);\n    }\n    get title() {\n        return this._title;\n    }\n    get isEmpty() {\n        return this.groups.length === 0;\n    }\n    get ariaMessage() {\n        if (this.isEmpty) {\n            return localize('aria.result.0', \"No results found\");\n        }\n        else if (this.references.length === 1) {\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\n        }\n        else if (this.groups.length === 1) {\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\n        }\n        else {\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\n        }\n    }\n    nextOrPreviousReference(reference, next) {\n        const { parent } = reference;\n        let idx = parent.children.indexOf(reference);\n        const childCount = parent.children.length;\n        const groupCount = parent.parent.groups.length;\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\n            // cycling within one file\n            if (next) {\n                idx = (idx + 1) % childCount;\n            }\n            else {\n                idx = (idx + childCount - 1) % childCount;\n            }\n            return parent.children[idx];\n        }\n        idx = parent.parent.groups.indexOf(parent);\n        if (next) {\n            idx = (idx + 1) % groupCount;\n            return parent.parent.groups[idx].children[0];\n        }\n        else {\n            idx = (idx + groupCount - 1) % groupCount;\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\n        }\n    }\n    nearestReference(resource, position) {\n        const nearest = this.references.map((ref, idx) => {\n            return {\n                idx,\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\n            };\n        }).sort((a, b) => {\n            if (a.prefixLen > b.prefixLen) {\n                return -1;\n            }\n            else if (a.prefixLen < b.prefixLen) {\n                return 1;\n            }\n            else if (a.offsetDist < b.offsetDist) {\n                return -1;\n            }\n            else if (a.offsetDist > b.offsetDist) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        })[0];\n        if (nearest) {\n            return this.references[nearest.idx];\n        }\n        return undefined;\n    }\n    referenceAt(resource, position) {\n        for (const ref of this.references) {\n            if (ref.uri.toString() === resource.toString()) {\n                if (Range.containsPosition(ref.range, position)) {\n                    return ref;\n                }\n            }\n        }\n        return undefined;\n    }\n    firstReference() {\n        for (const ref of this.references) {\n            if (ref.isProviderFirst) {\n                return ref;\n            }\n        }\n        return this.references[0];\n    }\n    static _compareReferences(a, b) {\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\n    }\n}\n"],"names":["HiddenRangeModel","onDidChange","this","_updateEventEmitter","event","hiddenRanges","_hiddenRanges","constructor","model","Emitter","_hasLineChanges","_foldingModel","_foldingModelListener","_","updateHiddenRanges","regions","length","notifyChangeModelContent","e","changes","some","change","range","endLineNumber","startLineNumber","countEOL","text","updateHiddenAreas","newHiddenAreas","i","k","lastCollapsedStart","Number","MAX_VALUE","lastCollapsedEnd","ranges","isCollapsed","getStartLineNumber","getEndLineNumber","push","Range","applyHiddenRanges","fire","hasRanges","isHidden","line","findRange","adjustSelections","selections","hasChanges","editorModel","textModel","lastRange","adjustLine","isInside","len","selection","adjustedStartLine","setStartPosition","getLineMaxColumn","adjustedEndLine","setEndPosition","dispose","findFirstIdxMonotonousOrArrLen","r","FoldingController_1","__decorate","decorators","target","key","desc","d","c","arguments","Object","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","apply","CONTEXT_FOLDING_ENABLED","RawContextKey","FoldingController","Disposable","get","editor","getContribution","ID","getFoldingRangeProviders","languageFeaturesService","_a","_b","foldingRangeProviders","foldingRangeProvider","ordered","_foldingRangeSelector","call","contextKeyService","languageConfigurationService","notificationService","languageFeatureDebounceService","super","localToDispose","_register","DisposableStore","_foldingLimitReporter","RangesLimitReporter","options","getOptions","_isEnabled","_useFoldingProviders","_unfoldOnClickAfterEndOfLine","_restoringViewState","_currentModelHasFoldedImports","_foldingImportsByDefault","updateDebounceInfo","for","min","foldingModel","hiddenRangeModel","rangeProvider","foldingRegionPromise","foldingModelPromise","updateScheduler","cursorChangedScheduler","mouseDownInfo","foldingDecorationProvider","FoldingDecorationProvider","showFoldingControls","showFoldingHighlights","foldingEnabled","bindTo","set","onDidChangeModel","onModelChanged","onDidChangeConfiguration","hasChanged","triggerFoldingModelChanged","onFoldingStrategyChanged","saveViewState","getModel","isTooLargeForTokenization","collapsedRegions","getMemento","provider","id","undefined","lineCount","getLineCount","foldedImports","restoreViewState","state","applyMemento","clear","FoldingModel","add","hr","onHiddenRangesChanges","Delayer","RunOnceScheduler","revealCursor","onDidChangeModelLanguageConfiguration","onDidChangeModelContent","onDidChangeCursorPosition","onCursorPositionChanged","onMouseDown","onEditorMouseDown","onMouseUp","onEditorMouseUp","cancel","getRangeProvider","indentRangeProvider","IndentRangeProvider","selectedProviders","SyntaxRangeProvider","getFoldingModel","trigger","sw","StopWatch","createCancelablePromise","token","compute","foldingRanges","scrollState","setCollapsedAllOfType","FoldingRangeKind","Imports","StableEditorScrollState","capture","getSelections","selectionLineNumbers","map","s","update","restore","newValue","elapsed","defaultDelay","err","onUnexpectedError","setSelections","setHiddenAreas","schedule","toToggle","lineNumber","selectionStartLineNumber","getAllRegionsAtLine","toggleCollapseState","reveal","getPosition","leftButton","middleButton","iconClicked","type","data","detail","offsetLeftInGutter","element","offsetLeft","offsetX","isAfterLines","startColumn","region","getRegionAtLine","altKey","filter","otherRegion","containedBy","toMaybeToggle","getRegionsInside","recursive","shiftKey","column","position","revealPositionInCenterIfOutsideViewport","IContextKeyService","ILanguageConfigurationService","INotificationService","ILanguageFeatureDebounceService","ILanguageFeaturesService","_onDidChange","_computed","_limited","limit","computed","limited","FoldingAction","EditorAction","runEditorCommand","accessor","args","foldingController","reportTelemetry","invoke","getSelection","getStartPosition","getSelectedLines","getLineNumbers","selectionLines","l","run","_accessor","_editor","foldingArgumentsConstraint","types","foldingArgs","levels","direction","Array","isArray","every","FoldLevelAction","getFoldingLevel","parseInt","substr","ID_PREFIX","_foldingController","setCollapseStateAtLevel","level","registerEditorContribution","registerEditorAction","label","nls","alias","precondition","kbOpts","kbExpr","EditorContextKeys","editorTextFocus","primary","mac","weight","description","name","constraint","schema","lineNumbers","setCollapseStateLevelsUp","setCollapseStateLevelsDown","KeyChord","_args","setCollapseStateUp","selectedLines","hasTypes","setCollapseStateForType","Comment","comments","getLanguageConfiguration","getLanguageId","blockCommentStartToken","regExp","RegExp","escapeRegExpCharacters","setCollapseStateForMatchingLines","Region","foldingRules","markers","start","setCollapseStateForRest","getParentFoldLine","setSelection","endColumn","getPreviousFoldLine","getNextFoldLine","collapseRanges","source","sort","a","b","newRanges","FoldingRegions","sanitizeAndMerge","updatePost","fromFoldRanges","removeManualRanges","registerInstantiatedEditorAction","concat","CommandsRegistry","registerCommand","_len","_key","resource","URI","illegalArgument","IModelService","configurationService","IConfigurationService","getValue","strategy","foldingLimitReporter","providers","CancellationToken","None","getType","end","kind","fromValue","foldBackground","registerColor","light","transparent","editorSelectionBackground","dark","hcDark","hcLight","localize","iconForeground","foldingExpandedIcon","registerIcon","Codicon","chevronDown","foldingCollapsedIcon","chevronRight","foldingManualCollapsedIcon","foldingManualExpandedIcon","foldedBackgroundMinimap","color","themeColorFromId","MinimapPosition","Inline","getDecorationOption","isManual","HIDDEN_RANGE_DECORATION","NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION","NO_CONTROLS_COLLAPSED_RANGE_DECORATION","NO_CONTROLS_EXPANDED_RANGE_DECORATION","MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION","MANUALLY_COLLAPSED_VISUAL_DECORATION","COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION","COLLAPSED_VISUAL_DECORATION","MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION","EXPANDED_AUTO_HIDE_VISUAL_DECORATION","MANUALLY_EXPANDED_VISUAL_DECORATION","EXPANDED_VISUAL_DECORATION","changeDecorations","callback","removeDecorations","decorationIds","ModelDecorationOptions","register","stickiness","afterContentClassName","isWholeLine","firstLineDecorationClassName","ThemeIcon","asClassName","className","minimap","_regions","_textModel","decorationProvider","_decorationProvider","Uint32Array","_editorDecorationIds","toggledRegions","r1","r2","regionIndex","processed","dirtyRegionEndLine","lastHiddenLine","updateDecorationsUntil","index","getSource","changeDecorationOptions","editorDecorationId","newCollapseState","setCollapsed","Math","max","collapseStateChanged","newFoldingRanges","intersects","foldRange","toFoldRange","newRegions","blockedLineNumers","foldedOrManualRanges","_currentFoldedOrManualRanges","newEditorDecorations","decorationRange","deltaDecorations","isBlocked","blockedLineNumber","foldedRanges","decRange","getDecorationRange","maxLineNumber","checksum","_getLinesChecksum","rangesToRestore","lineNumber1","lineNumber2","hash","getLineContent","current","toRegion","parentIndex","levelStack","pop","doCollapse","regionsInside","foldLevel","blockedLineNumbers","containsLine","filteredRegions","filteredRegion","test","foldingRegion","parentFoldingIdx","expectedParentIndex","minLineNumber","foldSourceAbbr","MAX_LINE_NUMBER","MASK_INDENT","BitField","size","numWords","ceil","_states","arrayIndex","bit","newState","startIndexes","endIndexes","Error","_startIndexes","_endIndexes","_collapseStates","_userDefinedStates","_recoveredStates","_types","_parentsComputed","ensureParentIndices","parentIndexes","isInsideLast","isUserDefined","setUserDefined","isRecovered","setRecovered","setSource","FoldingRegion","getParentIndex","parent","contains","findIndex","low","high","mid","floor","toString","res","join","rangesLength","gotTypes","rangesA","rangesB","getIndexedFunction","getA","getB","indexA","indexB","nextA","nextB","stackedRanges","topStackedRange","prevLineNumber","resultRanges","useRange","scanIndex","prescanB","foldingRangesLimit","cancelationToken","offSide","foldingRangesLimitDefault","tabSize","RangesCollector","pattern","previousRegions","indent","endAbove","lineContent","computeIndentLevel","m","previous","match","insertFirst","toIndentRanges","computeRanges","_indentOccurrences","_length","_foldingRangesLimit","entries","maxIndent","n","startIndex","foldingContext","handleFoldingRangesChange","fallbackRangeProvider","disposables","cancellationToken","rangeData","promises","provideFoldingRanges","isCancellationRequested","nLines","rank","onUnexpectedExternalError","all","collectSyntaxRanges","sorted","d1","d2","diff","collector","top","entry","sanitizeRanges","_nestingLevels","_nestingLevelCounts","nestingLevel","maxLevel","EditorFontZoomIn","EditorZoom","setZoomLevel","getZoomLevel","EditorFontZoomOut","EditorFontZoomReset","alertFormattingEdits","edits","edit","plusRange","alert","getRealAndSyntheticDocumentFormattersOrdered","documentFormattingEditProvider","documentRangeFormattingEditProvider","seen","ExtensionIdentifierSet","docFormatter","formatter","extensionId","rangeFormatter","has","displayName","provideDocumentFormattingEdits","provideDocumentRangeFormattingEdits","getFullModelRange","FormattingConflicts","setFormatterSelector","selector","_selectors","unshift","select","document","mode","Iterable","first","formatDocumentRangesWithSelectedProvider","editorOrModel","rangeOrRanges","progress","instaService","IInstantiationService","documentRangeFormattingEditProviderRegistry","isCodeEditor","selected","report","invokeFunction","formatDocumentRangesWithProvider","workerService","IEditorWorkerService","logService","ILogService","cts","EditorStateCancellationTokenSource","TextModelCancellationTokenSource","asArray","compareRangesUsingStarts","areIntersectingOrTouching","fromPositions","getEndPosition","computeEdits","_c","_d","trace","getFormattingOptions","hasIntersectingEdit","mergedA","reduce","acc","val","x","intersectRanges","otherEdit","allEdits","rawEditsList","provideDocumentRangesFormattingEdits","j","mergedRange","splice","rawEdits","minimalEdits","computeMoreMinimalEdits","uri","FormattingEdit","execute","initialSelection","Selection","pushEditOperations","lift","forceMoveMarkers","undoEdits","formatDocumentWithSelectedProvider","formatDocumentWithProvider","getOnTypeFormattingEdits","ch","onTypeFormattingEditProvider","autoFormatTriggerCharacters","indexOf","provideOnTypeFormattingEdits","catch","LinkedList","assertType","isUri","isIRange","resolverService","ITextModelService","reference","createModelReference","isNonEmptyArray","getDocumentRangeFormattingEditsUntilResult","object","textEditorModel","_len2","_key2","getDocumentFormattingEditsUntilResult","_len3","_key3","Position","isIPosition","FormatOnType","_languageFeaturesService","_workerService","_disposables","_sessionDisposables","_update","onDidChangeModelLanguage","getOption","hasModel","support","triggerChars","CharacterSet","charCodeAt","onDidType","lastCharCode","_trigger","String","fromCharCode","isEmpty","CancellationTokenSource","unbind","isFlush","finally","FormatOnPaste","_instantiationService","_callOnDispose","_callOnModel","onDidPaste","_ref","Progress","FormatDocumentAction","ContextKeyExpr","and","notInCompositeEditor","writable","hasDocumentFormattingProvider","linux","contextMenuOpts","group","order","progressService","IEditorProgressService","showWhile","FormatSelectionAction","hasDocumentSelectionFormattingProvider","when","hasNonEmptySelection","ICodeEditorService","getFocusedCodeEditor","commandService","ICommandService","executeCommand","_handleEolEdits","newEol","singleEdits","eol","pushEOL","_isFullModelReplaceEdit","editRange","validateRange","equalsRange","_edits","addUndoStops","pushUndoStop","executeEdits","EditOperation","replace","replaceMove","restoreRelativeVerticalPositionOfCursor","MarkerCoordinate","marker","total","MarkerList","resourceFilter","_markerService","_configService","_dispoables","_markers","_nextIdx","_resourceFilter","compareOrder","compareMarker","compare","MarkerSeverity","severity","updateMarker","read","severities","Warning","Info","onMarkerChanged","uris","matches","_initIdx","fwd","found","idx","binarySearch","word","getWordAtPosition","containsPosition","isBeforeOrEqual","resetIndex","move","oldIdx","find","IMarkerService","IMarkerNavigationService","createDecorator","MarkerNavigationService","_provider","getMarkerList","registerSingleton","MarkerNavigationWidget_1","MessageWidget","onRelatedInformation","_openerService","_labelService","_lines","_longestLineLength","_relatedDiagnostics","WeakMap","domNode","createElement","_messageBlock","classList","setAttribute","appendChild","_relatedBlock","dom","preventDefault","related","_scrollable","ScrollableElement","horizontal","vertical","useShadows","horizontalScrollbarSize","verticalScrollbarSize","getDomNode","onScroll","style","left","scrollLeft","scrollTop","message","relatedInformation","code","sourceAndCodeLength","lines","splitLines","getAriaLabel","applyFontInfo","lastLineElement","innerText","height","lineHeight","detailsElement","sourceElement","codeElement","_codeLink","$","onclick","open","allowCommands","stopPropagation","relatedInformationNode","paddingTop","container","relatedResource","getUriBasenameLabel","title","getUriLabel","relatedMessage","fontInfo","scrollWidth","typicalFullwidthCharacterWidth","scrollHeight","setScrollDimensions","layout","width","getHeightInLines","severityLabel","Hint","ariaLabel","MarkerNavigationWidget","PeekViewWidget","_themeService","_menuService","instantiationService","_contextKeyService","showArrow","showFrame","isAccessible","frameWidth","_onDidSelectRelatedInformation","onDidSelectRelatedInformation","_severity","_backgroundColor","Color","white","_applyTheme","getColorTheme","onDidColorThemeChange","bind","create","theme","getColor","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","headerBackground","editorMarkerNavigationErrorHeader","editorMarkerNavigationWarning","editorMarkerNavigationWarningHeader","editorMarkerNavigationInfo","editorMarkerNavigationInfoHeader","frameColor","headerBg","arrowColor","headerBackgroundColor","primaryHeadingColor","peekViewTitleForeground","secondaryHeadingColor","peekViewTitleInfoForeground","_applyStyles","_parentContainer","backgroundColor","_fillHead","_actionbarWidget","actionRunner","onWillRun","focus","actions","menu","createMenu","TitleMenu","createAndFillInActionBarActions","icon","_fillTitleIcon","_icon","_fillBody","tabIndex","_container","_message","show","showAtMarker","markerIdx","markerCount","remove","editorPosition","computeRequiredHeight","setTitle","basename","SeverityIcon","toSeverity","revealPositionNearTop","showStale","_relayout","_doLayoutBody","heightInPixel","widthInPixel","_heightInPixel","_onWidth","MenuId","IThemeService","IOpenerService","IMenuService","ILabelService","errorDefault","oneOf","editorErrorForeground","editorErrorBorder","warningDefault","editorWarningForeground","editorWarningBorder","infoDefault","editorInfoForeground","editorInfoBorder","contrastBorder","editorBackground","MarkerController_1","MarkerController","_markerNavigationService","_editorService","_sessionDispoables","_widgetVisible","CONTEXT_MARKERS_NAVIGATION_VISIBLE","_cleanUp","reset","_widget","_model","_getOrCreateModel","reusePosition","createInstance","onDidClose","close","info","openCodeEditor","pinned","revealIfOpened","collapseToStart","focusEditor","nagivate","multiFile","otherEditor","selectionRevealType","MarkerNavigationAction","_next","_multiFile","opts","NextMarkerAction","LABEL","menuOpts","menuId","arrowDown","PrevMarkerAction","arrowUp","MenubarGoMenu","comment","MarkerCommand","EditorCommand","bindToContribution","registerEditorCommand","handler","secondary","ctxHasSymbols","ISymbolNavigationService","SymbolNavigationService","_notificationService","_keybindingService","_currentModel","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","_currentState","_currentMessage","put","anchor","refModel","references","_showMessage","editorState","EditorState","listener","getActiveCodeEditor","seenUri","seenPosition","isEqual","combinedDisposable","revealNext","kb","lookupKeybinding","getLabel","status","IKeybindingService","KeybindingsRegistry","registerCommandAndKeybindingRule","editorService","_listener","Map","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","forEach","values","delete","_e","_f","_g","_h","MenuRegistry","appendMenuItem","EditorContext","submenu","EditorContextPeek","SymbolNavigationAnchor","is","thing","corePosition","SymbolNavigationAction","EditorAction2","_allSymbolNavigationCommands","_patchConfig","assign","f1","item","wrap","configuration","arg","symbolNavService","promise","raceCancellation","_getLocationModel","_j","altAction","ariaMessage","referenceAt","altActionId","_getAlternativeCommand","_activeAlternativeCommands","referenceCount","muteMessage","MessageController","showMessage","_getNoResultFoundMessage","_onResult","error","gotoLocation","_getGoToPreference","EmbeddedCodeEditorWidget","openInPeek","firstReference","peek","targetEditor","_openReference","openToSide","_openInPeek","sideBySide","highlight","isLocationLink","targetSelectionRange","selectionSource","modelNow","decorations","createDecorationsCollection","setTimeout","controller","ReferencesController","toggleWidget","Set","DefinitionAction","ReferencesModel","getDefinitionsAtPosition","definitionProvider","alternativeDefinitionCommand","multipleDefinitions","registerAction2","original","mnemonicTitle","hasDefinitionProvider","isInWalkThroughSnippet","toNegated","keybinding","IsWebContext","registerCommandAlias","PeekContext","notInPeekEditor","DeclarationAction","getDeclarationsAtPosition","declarationProvider","alternativeDeclarationCommand","multipleDeclarations","hasDeclarationProvider","TypeDefinitionAction","getTypeDefinitionsAtPosition","typeDefinitionProvider","alternativeTypeDefinitionCommand","multipleTypeDefinitions","hasTypeDefinitionProvider","ImplementationAction","getImplementationsAtPosition","implementationProvider","alternativeImplementationCommand","multipleImplementations","hasImplementationProvider","ReferencesAction","alternativeReferenceCommand","multipleReferences","hasReferenceProvider","getReferencesAtPosition","referenceProvider","GenericGoToLocationAction","config","_references","_gotoMultipleBehaviour","_position","_token","multiple","noResultsMessage","setPosition","invokeWithinContext","command","Boolean","codeEditorService","control","getLocationLinks","registry","provide","coalesce","flat","provideDefinition","provideDeclaration","provideImplementation","provideTypeDefinition","compact","provideReferences","includeDeclaration","resultWithoutDeclaration","_sortedAndDeduped","rawLinks","modelLinks","ref","link","registerModelAndPositionCommand","hasModifier","modifier","ClickLinkMouseEvent","isLeftClick","isMiddleClick","isRightClick","rightButton","hasTriggerModifier","triggerModifier","hasSideBySideModifier","triggerSideBySideModifier","isNoneOrSingleMouseDown","ClickLinkKeyboardEvent","keyCodeIsTriggerKey","keyCode","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","equals","other","createOptions","multiCursorModifier","platform","ClickLinkGesture","_onMouseMoveOrRelevantKeyDown","onMouseMoveOrRelevantKeyDown","_onExecute","onExecute","_onCancel","onCancel","_extractLineNumberFromMouseEvent","extractLineNumberFromMouseEvent","_opts","_lastMouseMoveEvent","_hasTriggerKeyOnMouseDown","_lineNumberOnMouseDown","newOpts","onMouseMove","_onEditorMouseMove","_onEditorMouseDown","_onEditorMouseUp","onKeyDown","_onEditorKeyDown","onKeyUp","_onEditorKeyUp","onMouseDrag","_resetHandler","onDidChangeCursorSelection","_onDidChangeCursorSelection","onDidScrollChange","scrollTopChanged","scrollLeftChanged","mouseEvent","currentLineNumber","GotoDefinitionAtPositionEditorContribution_1","GotoDefinitionAtPositionEditorContribution","textModelResolverService","languageService","toUnhook","toUnhookForKeyboard","currentWordAtPosition","previousPromise","linkDecorations","linkGesture","keyboardEvent","startFindDefinitionFromMouse","isEnabled","gotoDefinition","removeLinkDecorations","startFindDefinitionFromCursor","startFindDefinition","withKey","results","findDefinition","validate","linkRange","originSelectionRange","combinedRange","addDecoration","MarkdownString","appendText","previewValue","getPreviewValue","languageId","guessLanguageIdByFilepathOrFirstLine","appendCodeblock","rangeToUse","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","minIndent","getLineFirstNonWhitespaceColumn","endIndent","getValueInRange","trim","startIndent","hoverMessage","newDecorations","inlineClassName","injectedText","ModelDecorationInjectedTextOptions","canPeek","isInPeekEditor","inPeekEditor","ILanguageService","FileReferencesRenderer_1","DataSource","_resolverService","hasChildren","FileReferences","getChildren","groups","children","Delegate","getHeight","getTemplateId","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","getKeyboardNavigationLabel","OneReference","parts","getPreview","preview","IdentityProvider","getId","FileReferencesTemplate","file","IconLabel","supportHighlights","badge","CountBadge","defaultCountBadgeStyles","dirname","setLabel","relative","setCount","setTitleFormat","templateId","renderTemplate","renderElement","node","template","createMatches","filterData","disposeTemplate","templateData","OneReferenceTemplate","HighlightedLabel","score","FuzzyScore","isDefault","toggle","AccessibilityProvider","getWidgetAriaLabel","DecorationsManager","_decorations","_decorationIgnoreSet","_callOnModelChange","_onModelChanged","_addDecorations","onDidChangeDecorations","_onDecorationChanged","newDecorationsActualIndex","oneReference","DecorationOptions","changeAccessor","toRemove","decorationId","newRange","ignore","spansMultipleLines","keys","LayoutData","ratio","heightInLines","fromJSON","raw","JSON","parse","ReferencesTree","WorkbenchAsyncDataTree","ReferenceWidget","peekView","_defaultTreeKeyboardSupport","layoutData","themeService","_textModelResolverService","_peekViewService","_uriLabel","_undoRedoService","_languageService","_languageConfigurationService","isResizeable","supportOnTitleClick","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","_dim","addExclusiveWidget","setModel","_preview","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","borderColor","where","focusOnReferenceTree","domFocus","focusOnPreviewEditor","isPreviewEditorFocused","hasTextFocus","_onTitleClick","_getFocusedReference","ctrlKey","metaKey","containerElement","setCssClass","_messageContainer","SplitView","orientation","_previewContainer","scrollBeyondLastLine","scrollbar","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","enabled","TextModel","PLAINTEXT_LANGUAGE_ID","DEFAULT_CREATION_OPTIONS","_treeContainer","treeOptions","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","openOnSingleClick","selectionNavigation","overrideStyles","listBackground","dispatchEvent","addView","Event","minimumSize","maximumSize","Sizing","Distribute","onDidSashChange","getViewSize","onEvent","_revealReference","onDidOpen","editorOptions","_viewZone","resizeView","setFocus","newModel","_onNewModel","_decorationsManager","onDidChangeReferenceRange","rerender","setInput","getFocus","revealReference","revealParent","_revealedReference","scheme","Schemas","inMemory","basenameOrAuthority","getInput","expand","scrollType","sel","revealRangeInCenter","IUndoRedoService","ReferencesController_1","ctxReferenceSearchVisible","_storageService","_configurationService","_requestIdPool","_ignoreModelChangeEvent","_referenceSearchVisible","modelPromise","peekMode","widgetPosition","closeWidget","_peekMode","storageKey","store","stringify","openReference","_gotoReference","requestId","setMetaTitle","pos","nearestReference","changeFocusBetweenPreviewAndReferences","goToNextOrPreviousReference","currentPosition","nextOrPreviousReference","editorFocus","previewEditorFocus","hide","openedEditor","clone","withController","fn","outerEditor","getOuterEditor","IStorageService","or","registerKeybindingRule","not","WorkbenchListFocusContextKey","WorkbenchTreeElementCanCollapse","negate","WorkbenchTreeElementCanExpand","IListService","lastFocusedList","isProviderFirst","_rangeCallback","defaultGenerator","nextId","_range","FilePreview","_modelReference","getWordUntilPosition","beforeRange","afterRange","before","inside","_previews","ResourceMap","child","fsPath","links","_onDidChangeReferenceRange","_links","_title","providersFirst","_compareReferences","extUri","oneRef","childCount","groupCount","nearest","prefixLen","strings","offsetDist","abs"],"sourceRoot":""}